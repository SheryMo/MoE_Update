nohup: ignoring input
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
网络架构：{'129': ['113', '254', '60', '201', '85', '163', '80', '67', '206', '64', '212', '213', '5', '229', '93', '25', '7', '191', '92', '70', '125', '185', '109', '183', '224', '75', '164', '58', '47', '59', '222'], '224': ['163', '70', '85', '7', '125', '164', '222', '201', '206', '80', '92', '58', '64', '185', '67', '47', '93', '129', '75', '213', '25', '60', '212', '191', '113', '59', '183', '229', '109', '254', '5'], '92': ['75', '222', '58', '129', '191', '163', '183', '254', '47', '206', '109', '164', '224', '201', '5', '212', '59', '60', '125', '185', '93', '67', '25', '113', '7', '80', '70', '64', '85', '229', '213'], '75': ['85', '164', '163', '191', '47', '25', '58', '60', '80', '183', '224', '92', '212', '113', '185', '93', '7', '201', '206', '67', '125', '59', '229', '64', '213', '70', '222', '254', '5', '109', '129'], '164': ['92', '185', '212', '5', '85', '60', '7', '163', '67', '109', '222', '80', '93', '113', '254', '58', '64', '47', '125', '129', '75', '25', '59', '183', '191', '70', '224', '201', '206', '213', '229'], '7': ['254', '64', '125', '109', '75', '164', '59', '25', '212', '67', '224', '201', '163', '183', '80', '129', '113', '85', '58', '185', '5', '92', '60', '191', '93', '206', '213', '47', '222', '70', '229'], '109': ['183', '206', '224', '80', '212', '164', '58', '47', '229', '25', '67', '185', '85', '64', '70', '163', '213', '254', '125', '93', '191', '113', '59', '5', '201', '222', '75', '129', '60', '7', '92'], '201': ['206', '113', '254', '80', '229', '224', '129', '59', '70', '109', '67', '58', '5', '213', '125', '212', '185', '191', '7', '25', '64', '164', '163', '93', '85', '60', '75', '92', '183', '47', '222'], '67': ['5', '254', '47', '60', '212', '191', '201', '183', '58', '185', '64', '224', '164', '163', '59', '7', '25', '70', '75', '80', '206', '92', '129', '222', '125', '229', '113', '85', '109', '213', '93'], '183': ['201', '191', '67', '64', '113', '212', '60', '59', '85', '125', '47', '58', '92', '109', '75', '213', '25', '93', '222', '70', '80', '229', '5', '185', '254', '224', '206', '7', '163', '129', '164'], '163': ['64', '212', '67', '224', '206', '58', '183', '25', '185', '5', '129', '75', '222', '59', '213', '60', '164', '201', '85', '47', '109', '70', '93', '191', '254', '125', '113', '7', '229', '80', '92'], '213': ['70', '191', '25', '229', '183', '163', '47', '125', '254', '224', '212', '59', '75', '92', '7', '109', '5', '85', '201', '60', '64', '67', '164', '58', '113', '93', '222', '129', '80', '206', '185'], '185': ['58', '47', '113', '92', '5', '224', '254', '67', '229', '201', '25', '213', '7', '222', '64', '183', '75', '85', '70', '60', '191', '163', '93', '80', '212', '164', '125', '109', '206', '129', '59'], '229': ['254', '109', '7', '25', '163', '185', '47', '206', '212', '113', '224', '80', '85', '75', '129', '60', '92', '58', '201', '125', '70', '164', '222', '5', '67', '183', '213', '64', '191', '93', '59'], '222': ['58', '47', '224', '191', '125', '5', '7', '109', '64', '212', '80', '206', '201', '59', '183', '93', '254', '129', '213', '85', '113', '164', '185', '92', '229', '75', '163', '60', '67', '70', '25'], '25': ['7', '75', '185', '80', '222', '70', '163', '113', '191', '164', '206', '201', '213', '5', '109', '47', '254', '64', '58', '92', '59', '85', '67', '212', '129', '93', '183', '60', '224', '229', '125'], '70': ['164', '224', '183', '92', '206', '185', '163', '85', '191', '213', '229', '109', '60', '59', '222', '7', '125', '254', '201', '93', '129', '64', '75', '47', '80', '67', '113', '58', '25', '5', '212'], '5': ['92', '25', '64', '7', '47', '201', '67', '85', '224', '163', '113', '93', '109', '70', '254', '164', '212', '129', '80', '58', '125', '59', '75', '183', '229', '60', '222', '213', '185', '206', '191'], '58': ['5', '80', '60', '7', '183', '191', '185', '64', '85', '201', '129', '75', '59', '47', '213', '93', '67', '109', '229', '206', '70', '25', '125', '212', '113', '92', '164', '254', '222', '163', '224'], '254': ['25', '109', '164', '129', '113', '47', '206', '5', '64', '125', '163', '213', '229', '185', '59', '70', '58', '80', '183', '93', '201', '67', '75', '85', '212', '60', '7', '224', '222', '92', '191'], '60': ['229', '93', '212', '109', '85', '206', '5', '254', '164', '183', '129', '47', '113', '70', '163', '25', '64', '7', '58', '67', '213', '59', '185', '224', '191', '80', '75', '125', '92', '201', '222'], '191': ['109', '113', '224', '206', '125', '254', '229', '80', '185', '129', '47', '70', '5', '212', '222', '164', '183', '213', '93', '201', '60', '7', '75', '58', '64', '163', '59', '25', '92', '67', '85'], '212': ['201', '58', '93', '67', '5', '164', '109', '59', '80', '222', '185', '64', '129', '92', '206', '25', '70', '47', '125', '75', '191', '85', '213', '7', '60', '254', '229', '183', '113', '163', '224'], '206': ['183', '229', '70', '109', '125', '7', '67', '75', '64', '191', '80', '164', '5', '222', '93', '201', '163', '59', '60', '129', '85', '185', '58', '254', '113', '47', '212', '224', '92', '213', '25'], '125': ['254', '60', '85', '64', '7', '67', '5', '59', '201', '93', '224', '92', '25', '129', '80', '58', '229', '212', '222', '185', '191', '163', '164', '47', '109', '70', '75', '183', '113', '213', '206'], '64': ['93', '113', '75', '206', '25', '92', '229', '163', '7', '5', '80', '58', '47', '191', '60', '224', '183', '213', '164', '129', '59', '125', '85', '212', '185', '109', '70', '67', '222', '254', '201'], '93': ['5', '92', '47', '164', '185', '85', '7', '67', '60', '125', '206', '59', '163', '70', '229', '183', '109', '213', '212', '129', '254', '224', '64', '75', '201', '80', '113', '25', '58', '191', '222'], '85': ['80', '58', '206', '25', '254', '191', '213', '224', '212', '93', '92', '113', '183', '222', '163', '129', '64', '47', '70', '7', '229', '109', '75', '59', '5', '60', '125', '185', '67', '164', '201'], '113': ['7', '67', '109', '92', '47', '64', '164', '163', '70', '129', '229', '224', '213', '222', '185', '85', '125', '212', '191', '80', '206', '60', '201', '25', '75', '59', '5', '183', '254', '93', '58'], '80': ['5', '64', '213', '206', '183', '185', '25', '212', '58', '75', '7', '129', '125', '229', '254', '224', '70', '163', '191', '113', '222', '92', '201', '93', '59', '60', '47', '164', '109', '85', '67'], '59': ['222', '7', '70', '129', '224', '80', '60', '93', '229', '75', '85', '164', '191', '25', '109', '212', '47', '201', '163', '113', '206', '64', '183', '58', '213', '67', '5', '185', '254', '125', '92'], '47': ['67', '92', '163', '254', '70', '129', '64', '164', '58', '7', '183', '212', '125', '5', '213', '59', '113', '201', '185', '85', '75', '222', '80', '229', '224', '25', '191', '93', '109', '60', '206']}
129
cuda:0
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:46<00:46, 46.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 27.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 30.30s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 307 136
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 200 530
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 307 139
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 200 231
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 200 512
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140482011866480 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140482011866480 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482011866480 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140482011866480 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140482011866576 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482011866576 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482011866576 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482011866576 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 123725.78it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:03<16:44,  3.36s/it]Running loglikelihood requests:   1%|          | 2/300 [00:04<10:23,  2.09s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:05<05:23,  1.09s/it]Running loglikelihood requests:   2%|▏         | 5/300 [00:06<05:07,  1.04s/it]Running loglikelihood requests:   2%|▏         | 7/300 [00:07<03:41,  1.32it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:08<03:47,  1.28it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:08<02:59,  1.61it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:09<03:10,  1.52it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:10<02:37,  1.82it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:11<02:50,  1.68it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:12<02:23,  1.98it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:12<02:35,  1.82it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:13<02:46,  1.69it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:14<02:19,  2.01it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:14<02:32,  1.84it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:15<02:10,  2.13it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:16<01:57,  2.34it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:17<02:12,  2.07it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:17<01:57,  2.31it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:18<02:11,  2.06it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:19<02:23,  1.88it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:19<02:33,  1.75it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:20<02:41,  1.66it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:21<02:10,  2.04it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:21<01:54,  2.30it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:22<01:45,  2.49it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:23<01:38,  2.64it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:23<01:52,  2.30it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:24<02:05,  2.06it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:25<02:15,  1.89it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:25<01:55,  2.20it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:26<01:44,  2.41it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:27<01:57,  2.14it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:27<01:44,  2.40it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:28<01:35,  2.59it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:29<01:48,  2.28it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:29<01:59,  2.06it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:30<02:08,  1.90it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:31<01:47,  2.25it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:31<01:36,  2.50it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:32<01:29,  2.68it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:33<01:41,  2.35it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:33<01:31,  2.58it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:34<01:43,  2.28it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:34<01:52,  2.07it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:35<02:01,  1.92it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:36<01:40,  2.30it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:36<01:29,  2.56it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:37<01:40,  2.27it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:38<01:49,  2.06it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:38<01:33,  2.40it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:39<01:24,  2.64it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:40<01:18,  2.81it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:40<01:29,  2.46it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:41<01:39,  2.20it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:41<01:47,  2.03it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:42<01:53,  1.91it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:43<01:33,  2.31it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:43<01:41,  2.10it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:44<01:26,  2.44it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:44<01:35,  2.20it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:45<01:23,  2.51it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:46<01:15,  2.74it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:46<01:10,  2.90it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:47<01:20,  2.52it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:48<01:13,  2.75it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:48<01:23,  2.42it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:49<01:14,  2.68it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:49<01:23,  2.37it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:50<01:31,  2.15it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:51<01:37,  2.00it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:51<01:42,  1.90it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:52<01:23,  2.32it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:52<01:30,  2.12it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:53<01:36,  1.98it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:54<01:19,  2.38it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:54<01:10,  2.66it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:55<01:04,  2.87it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:55<01:00,  3.01it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:56<00:58,  3.10it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:57<00:56,  3.18it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:57<01:05,  2.73it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [00:58<01:00,  2.93it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [00:58<01:08,  2.56it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [00:59<01:15,  2.30it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:00<01:21,  2.13it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:00<01:08,  2.51it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:01<01:00,  2.79it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:01<00:55,  3.00it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:02<01:02,  2.64it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:02<01:09,  2.38it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:03<01:14,  2.19it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:04<01:18,  2.07it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:04<01:22,  1.98it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:05<01:05,  2.45it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:05<00:56,  2.78it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:06<01:03,  2.48it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:06<00:55,  2.80it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:07<01:01,  2.50it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:07<01:07,  2.28it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:08<01:11,  2.13it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:09<00:58,  2.56it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:09<00:51,  2.87it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:10<00:47,  3.08it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:10<00:53,  2.70it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:11<00:48,  2.97it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:11<00:44,  3.15it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:12<00:42,  3.29it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:12<00:48,  2.85it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:13<00:44,  3.08it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:14<00:50,  2.66it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:14<00:45,  2.92it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:15<00:42,  3.07it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:15<00:48,  2.69it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:16<00:52,  2.44it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:16<00:56,  2.25it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:17<00:59,  2.12it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:18<00:48,  2.57it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:18<00:42,  2.90it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:19<00:38,  3.12it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:19<00:43,  2.74it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:20<00:48,  2.47it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:20<00:41,  2.83it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:21<00:37,  3.09it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:21<00:41,  2.71it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:22<00:37,  3.02it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:22<00:34,  3.23it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:23<00:38,  2.82it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:23<00:42,  2.54it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:24<00:36,  2.90it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:25<00:41,  2.56it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:25<00:44,  2.36it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:26<00:36,  2.79it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:26<00:39,  2.53it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:27<00:42,  2.34it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:27<00:44,  2.21it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:28<00:36,  2.63it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:28<00:31,  2.97it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:29<00:35,  2.65it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:29<00:30,  2.99it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:30<00:27,  3.23it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:30<00:25,  3.40it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:31<00:29,  2.96it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:31<00:26,  3.22it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:32<00:29,  2.83it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:32<00:32,  2.56it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:33<00:27,  2.95it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:34<00:24,  3.17it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:34<00:27,  2.79it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:35<00:24,  3.10it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:35<00:27,  2.75it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:36<00:23,  3.08it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:36<00:26,  2.73it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:37<00:28,  2.49it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:37<00:23,  2.90it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:38<00:26,  2.61it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:38<00:27,  2.41it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:39<00:29,  2.27it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:39<00:29,  2.18it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:40<00:30,  2.10it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:40<00:30,  2.05it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:41<00:30,  2.03it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:41<00:23,  2.60it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:42<00:19,  3.01it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:42<00:17,  3.29it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:43<00:15,  3.50it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:43<00:14,  3.65it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:44<00:13,  3.75it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:44<00:12,  3.82it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:45<00:12,  3.83it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:45<00:11,  3.87it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:46<00:12,  3.31it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:46<00:14,  2.92it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:47<00:12,  3.25it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:47<00:13,  2.89it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:48<00:11,  3.24it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:48<00:12,  2.84it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:49<00:13,  2.61it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:49<00:13,  2.45it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:50<00:10,  2.96it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:50<00:09,  3.31it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:51<00:07,  3.57it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:51<00:06,  3.78it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:52<00:07,  3.29it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:52<00:06,  3.59it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:53<00:06,  3.15it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:53<00:07,  2.86it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:54<00:05,  3.30it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:54<00:06,  2.96it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:54<00:06,  2.73it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:55<00:06,  2.56it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [01:55<00:04,  3.10it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [01:56<00:03,  3.48it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [01:56<00:02,  3.76it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [01:57<00:02,  3.97it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [01:57<00:02,  3.47it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [01:58<00:01,  3.11it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [01:58<00:01,  3.54it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [01:58<00:00,  3.88it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [01:59<00:00,  3.44it/s]Running loglikelihood requests: 100%|██████████| 300/300 [01:59<00:00,  2.51it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!
Model size: 12.5127 GB
224
cuda:1
copa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:43<00:43, 43.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 25.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 28.35s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646?recursive=False&expand=False HTTP/1.1" 307 138
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646?recursive=False&expand=False HTTP/1.1" 200 501
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/axb?recursive=False&expand=False HTTP/1.1" 307 142
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/axb?recursive=False&expand=False HTTP/1.1" 200 232
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/copa?recursive=False&expand=False HTTP/1.1" 307 143
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/copa?recursive=False&expand=False HTTP/1.1" 200 348
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140483671671536 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 140483671671536 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 140483671671536 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 140483671671536 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 140481469964000 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 140481469964000 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481469964000 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 140481469964000 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " the toilet filled with water." have whitespace
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " water flowed from the spout." have whitespace
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of copa from None to 0
INFO:lm_eval.api.task:Building contexts for copa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 138884.24it/s]
DEBUG:lm_eval.evaluator:Task: copa; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:06,  1.24s/it]Running loglikelihood requests:   1%|          | 2/200 [00:01<02:38,  1.25it/s]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:07,  1.55it/s]Running loglikelihood requests:   2%|▏         | 4/200 [00:02<01:51,  1.75it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:43,  1.88it/s]Running loglikelihood requests:   3%|▎         | 6/200 [00:03<01:38,  1.98it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:34,  2.03it/s]Running loglikelihood requests:   4%|▍         | 8/200 [00:04<01:31,  2.09it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:29,  2.13it/s]Running loglikelihood requests:   5%|▌         | 10/200 [00:05<01:27,  2.16it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:30,  2.10it/s]Running loglikelihood requests:   6%|▌         | 12/200 [00:06<01:27,  2.14it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:26,  2.17it/s]Running loglikelihood requests:   7%|▋         | 14/200 [00:07<01:24,  2.19it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:07<01:23,  2.21it/s]Running loglikelihood requests:   8%|▊         | 16/200 [00:08<01:22,  2.23it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:08<01:21,  2.24it/s]Running loglikelihood requests:   9%|▉         | 18/200 [00:09<01:21,  2.22it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:09<01:20,  2.25it/s]Running loglikelihood requests:  10%|█         | 20/200 [00:09<01:19,  2.26it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:18,  2.27it/s]Running loglikelihood requests:  11%|█         | 22/200 [00:10<01:17,  2.28it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:17,  2.29it/s]Running loglikelihood requests:  12%|█▏        | 24/200 [00:11<01:16,  2.30it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:12<01:15,  2.31it/s]Running loglikelihood requests:  13%|█▎        | 26/200 [00:12<01:15,  2.31it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:12<01:14,  2.31it/s]Running loglikelihood requests:  14%|█▍        | 28/200 [00:13<01:14,  2.31it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:13<01:13,  2.32it/s]Running loglikelihood requests:  15%|█▌        | 30/200 [00:14<01:13,  2.32it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:12,  2.33it/s]Running loglikelihood requests:  16%|█▌        | 32/200 [00:15<01:11,  2.34it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:11,  2.34it/s]Running loglikelihood requests:  17%|█▋        | 34/200 [00:15<01:10,  2.34it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:10,  2.34it/s]Running loglikelihood requests:  18%|█▊        | 36/200 [00:16<01:10,  2.34it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:09,  2.34it/s]Running loglikelihood requests:  19%|█▉        | 38/200 [00:17<01:09,  2.35it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:18<01:08,  2.35it/s]Running loglikelihood requests:  20%|██        | 40/200 [00:18<01:08,  2.35it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:07,  2.35it/s]Running loglikelihood requests:  21%|██        | 42/200 [00:19<01:07,  2.35it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<01:06,  2.35it/s]Running loglikelihood requests:  22%|██▏       | 44/200 [00:20<01:06,  2.35it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<01:05,  2.36it/s]Running loglikelihood requests:  23%|██▎       | 46/200 [00:20<01:05,  2.36it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:21<01:04,  2.36it/s]Running loglikelihood requests:  24%|██▍       | 48/200 [00:21<01:04,  2.36it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:22<01:04,  2.35it/s]Running loglikelihood requests:  25%|██▌       | 50/200 [00:22<01:03,  2.35it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:23<01:03,  2.35it/s]Running loglikelihood requests:  26%|██▌       | 52/200 [00:23<01:02,  2.35it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:23<01:02,  2.35it/s]Running loglikelihood requests:  27%|██▋       | 54/200 [00:24<01:01,  2.36it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:24<01:01,  2.36it/s]Running loglikelihood requests:  28%|██▊       | 56/200 [00:25<01:00,  2.37it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:25<01:00,  2.37it/s]Running loglikelihood requests:  29%|██▉       | 58/200 [00:26<00:59,  2.37it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:26<00:59,  2.37it/s]Running loglikelihood requests:  30%|███       | 60/200 [00:26<00:59,  2.37it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:27<00:58,  2.37it/s]Running loglikelihood requests:  31%|███       | 62/200 [00:27<00:58,  2.37it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:28<00:57,  2.38it/s]Running loglikelihood requests:  32%|███▏      | 64/200 [00:28<00:57,  2.38it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:29<00:56,  2.37it/s]Running loglikelihood requests:  33%|███▎      | 66/200 [00:29<00:56,  2.37it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:29<00:55,  2.38it/s]Running loglikelihood requests:  34%|███▍      | 68/200 [00:30<00:55,  2.38it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:30<00:55,  2.38it/s]Running loglikelihood requests:  35%|███▌      | 70/200 [00:31<00:54,  2.38it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:31<00:54,  2.38it/s]Running loglikelihood requests:  36%|███▌      | 72/200 [00:31<00:53,  2.38it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:32<00:53,  2.39it/s]Running loglikelihood requests:  37%|███▋      | 74/200 [00:32<00:52,  2.40it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:33<00:52,  2.40it/s]Running loglikelihood requests:  38%|███▊      | 76/200 [00:33<00:51,  2.40it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:34<00:51,  2.38it/s]Running loglikelihood requests:  39%|███▉      | 78/200 [00:34<00:51,  2.35it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:34<00:51,  2.35it/s]Running loglikelihood requests:  40%|████      | 80/200 [00:35<00:51,  2.34it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:35<00:50,  2.33it/s]Running loglikelihood requests:  41%|████      | 82/200 [00:36<00:50,  2.33it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:36<00:50,  2.33it/s]Running loglikelihood requests:  42%|████▏     | 84/200 [00:37<00:49,  2.33it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:37<00:49,  2.33it/s]Running loglikelihood requests:  43%|████▎     | 86/200 [00:37<00:48,  2.33it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:38<00:49,  2.30it/s]Running loglikelihood requests:  44%|████▍     | 88/200 [00:38<00:48,  2.33it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:39<00:47,  2.35it/s]Running loglikelihood requests:  45%|████▌     | 90/200 [00:39<00:46,  2.36it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:40<00:46,  2.36it/s]Running loglikelihood requests:  46%|████▌     | 92/200 [00:40<00:45,  2.37it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:40<00:45,  2.37it/s]Running loglikelihood requests:  47%|████▋     | 94/200 [00:41<00:44,  2.37it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:41<00:44,  2.38it/s]Running loglikelihood requests:  48%|████▊     | 96/200 [00:42<00:43,  2.38it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:42<00:43,  2.38it/s]Running loglikelihood requests:  49%|████▉     | 98/200 [00:42<00:42,  2.39it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:43<00:42,  2.40it/s]Running loglikelihood requests:  50%|█████     | 100/200 [00:43<00:41,  2.40it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:44<00:41,  2.41it/s]Running loglikelihood requests:  51%|█████     | 102/200 [00:44<00:40,  2.41it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:45<00:40,  2.41it/s]Running loglikelihood requests:  52%|█████▏    | 104/200 [00:45<00:39,  2.42it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:45<00:39,  2.43it/s]Running loglikelihood requests:  53%|█████▎    | 106/200 [00:46<00:38,  2.42it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:46<00:38,  2.42it/s]Running loglikelihood requests:  54%|█████▍    | 108/200 [00:47<00:37,  2.42it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:47<00:37,  2.42it/s]Running loglikelihood requests:  55%|█████▌    | 110/200 [00:47<00:37,  2.42it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:48<00:36,  2.42it/s]Running loglikelihood requests:  56%|█████▌    | 112/200 [00:48<00:36,  2.41it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:49<00:35,  2.42it/s]Running loglikelihood requests:  57%|█████▋    | 114/200 [00:49<00:35,  2.43it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:49<00:34,  2.44it/s]Running loglikelihood requests:  58%|█████▊    | 116/200 [00:50<00:34,  2.45it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:50<00:33,  2.46it/s]Running loglikelihood requests:  59%|█████▉    | 118/200 [00:51<00:33,  2.46it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:51<00:32,  2.46it/s]Running loglikelihood requests:  60%|██████    | 120/200 [00:52<00:32,  2.45it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:52<00:32,  2.45it/s]Running loglikelihood requests:  61%|██████    | 122/200 [00:52<00:31,  2.45it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:53<00:31,  2.45it/s]Running loglikelihood requests:  62%|██████▏   | 124/200 [00:53<00:30,  2.46it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:54<00:30,  2.46it/s]Running loglikelihood requests:  63%|██████▎   | 126/200 [00:54<00:30,  2.46it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:54<00:29,  2.46it/s]Running loglikelihood requests:  64%|██████▍   | 128/200 [00:55<00:29,  2.45it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:55<00:28,  2.45it/s]Running loglikelihood requests:  65%|██████▌   | 130/200 [00:56<00:28,  2.46it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:56<00:28,  2.46it/s]Running loglikelihood requests:  66%|██████▌   | 132/200 [00:56<00:27,  2.46it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:57<00:27,  2.45it/s]Running loglikelihood requests:  67%|██████▋   | 134/200 [00:57<00:26,  2.45it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:58<00:26,  2.46it/s]Running loglikelihood requests:  68%|██████▊   | 136/200 [00:58<00:26,  2.46it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:58<00:25,  2.46it/s]Running loglikelihood requests:  69%|██████▉   | 138/200 [00:59<00:25,  2.46it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:59<00:24,  2.46it/s]Running loglikelihood requests:  70%|███████   | 140/200 [01:00<00:24,  2.46it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:00<00:23,  2.47it/s]Running loglikelihood requests:  71%|███████   | 142/200 [01:00<00:23,  2.47it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:01<00:23,  2.48it/s]Running loglikelihood requests:  72%|███████▏  | 144/200 [01:01<00:22,  2.49it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:02<00:22,  2.48it/s]Running loglikelihood requests:  73%|███████▎  | 146/200 [01:02<00:21,  2.49it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:02<00:21,  2.50it/s]Running loglikelihood requests:  74%|███████▍  | 148/200 [01:03<00:20,  2.49it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:03<00:20,  2.49it/s]Running loglikelihood requests:  75%|███████▌  | 150/200 [01:04<00:20,  2.49it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:04<00:19,  2.48it/s]Running loglikelihood requests:  76%|███████▌  | 152/200 [01:04<00:19,  2.48it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:05<00:18,  2.48it/s]Running loglikelihood requests:  77%|███████▋  | 154/200 [01:05<00:18,  2.49it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:06<00:18,  2.49it/s]Running loglikelihood requests:  78%|███████▊  | 156/200 [01:06<00:17,  2.50it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:06<00:17,  2.50it/s]Running loglikelihood requests:  79%|███████▉  | 158/200 [01:07<00:16,  2.49it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:07<00:16,  2.50it/s]Running loglikelihood requests:  80%|████████  | 160/200 [01:08<00:15,  2.51it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:08<00:15,  2.52it/s]Running loglikelihood requests:  81%|████████  | 162/200 [01:08<00:15,  2.51it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:09<00:14,  2.52it/s]Running loglikelihood requests:  82%|████████▏ | 164/200 [01:09<00:14,  2.51it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:10<00:13,  2.51it/s]Running loglikelihood requests:  83%|████████▎ | 166/200 [01:10<00:13,  2.52it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:10<00:13,  2.53it/s]Running loglikelihood requests:  84%|████████▍ | 168/200 [01:11<00:12,  2.53it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:11<00:12,  2.53it/s]Running loglikelihood requests:  85%|████████▌ | 170/200 [01:12<00:11,  2.52it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:12<00:11,  2.52it/s]Running loglikelihood requests:  86%|████████▌ | 172/200 [01:12<00:11,  2.52it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:13<00:10,  2.54it/s]Running loglikelihood requests:  87%|████████▋ | 174/200 [01:13<00:10,  2.54it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:14<00:09,  2.55it/s]Running loglikelihood requests:  88%|████████▊ | 176/200 [01:14<00:09,  2.55it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:14<00:09,  2.55it/s]Running loglikelihood requests:  89%|████████▉ | 178/200 [01:15<00:08,  2.56it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:15<00:08,  2.55it/s]Running loglikelihood requests:  90%|█████████ | 180/200 [01:16<00:07,  2.56it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:16<00:07,  2.55it/s]Running loglikelihood requests:  91%|█████████ | 182/200 [01:16<00:07,  2.55it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:17<00:06,  2.57it/s]Running loglikelihood requests:  92%|█████████▏| 184/200 [01:17<00:06,  2.58it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:18<00:05,  2.58it/s]Running loglikelihood requests:  93%|█████████▎| 186/200 [01:18<00:05,  2.58it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:18<00:05,  2.59it/s]Running loglikelihood requests:  94%|█████████▍| 188/200 [01:19<00:04,  2.58it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:19<00:04,  2.59it/s]Running loglikelihood requests:  95%|█████████▌| 190/200 [01:19<00:03,  2.61it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:20<00:03,  2.60it/s]Running loglikelihood requests:  96%|█████████▌| 192/200 [01:20<00:03,  2.60it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:21<00:02,  2.60it/s]Running loglikelihood requests:  97%|█████████▋| 194/200 [01:21<00:02,  2.60it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:21<00:01,  2.64it/s]Running loglikelihood requests:  98%|█████████▊| 196/200 [01:22<00:01,  2.64it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:22<00:01,  2.66it/s]Running loglikelihood requests:  99%|█████████▉| 198/200 [01:22<00:00,  2.67it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:23<00:00,  2.67it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:23<00:00,  2.69it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:23<00:00,  2.39it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'copa': {'alias': 'copa', 'acc,none': 0.82, 'acc_stderr,none': 0.03861229196653691}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7827148355678417
0.8244609672079803
0.649635438690672
0.6067147398962018
0.806517251330611
0.9304450428937726
0.9492767057467371
0.8146777207922447
0.5943920512469448
0.6904992046065734
0.898578027138337
0.9772061768478973
0.9053772479641496
0.8020143483317842
0.5125553000556808
0.7018400400551881
0.8957865573767195
0.6076519427757794
0.975563476608663
0.9639212062070597
0.9296418237714587
0.9150145595079396
0.9197448761365332
0.7066536936990038
0.6639302750778917
0.912306872752127
0.7698141900267782
0.6230420491138425
0.8289959673107662
Total groups 68 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 1, 2, 6, 5, 0]
tensor([7, 3, 4, 1, 2, 6, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 4, 1, 0, 5, 7, 2]
tensor([6, 3, 4, 1, 0, 5, 7, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 4, 3, 2, 0, 5, 6, 1]
tensor([7, 4, 3, 2, 0, 5, 6, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 6, 4, 2, 1, 3, 5, 0]
tensor([7, 6, 4, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 3, 2]
tensor([0, 1, 3, 0, 1, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 1, 0, 2, 3, 2]
tensor([0, 1, 3, 1, 0, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1.0, 1.0, 1]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 3
done!
Normal merging for layer 4
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 8 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 21
done!
Normal merging for layer 22
tensor([0, 4])
tensor(0)
tensor([1, 3])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 23 to 27
done!
Normal merging for layer 28
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 29 to 30
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!
Model size: 12.1348 GB
92
cuda:2
qnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:40<00:40, 40.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 24.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 26.59s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 200 361
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140483673602960 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140483673602960 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140483673602960 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140483673602960 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140483666757200 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140483666757200 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140483666757200 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140483666757200 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qnli from None to 0
INFO:lm_eval.api.task:Building contexts for qnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2552.79it/s]
DEBUG:lm_eval.evaluator:Task: qnli; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<06:06,  1.84s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:52,  1.14it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<02:13,  1.46it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:55,  1.67it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:45,  1.81it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:38,  1.92it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:32,  2.03it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:27,  2.11it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:22,  2.21it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:18,  2.30it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:15,  2.36it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:13,  2.41it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:12<01:11,  2.45it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:13<01:09,  2.47it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:14<01:08,  2.50it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:07,  2.51it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:06,  2.53it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:04,  2.54it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:03,  2.56it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:17<01:02,  2.57it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:01,  2.57it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<01:00,  2.59it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<00:59,  2.61it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:20<00:58,  2.63it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:21<00:56,  2.66it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:22<00:55,  2.68it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:23<00:54,  2.69it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:23<00:53,  2.70it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:24<00:52,  2.71it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:25<00:51,  2.71it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:26<00:51,  2.72it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:26<00:50,  2.73it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:27<00:49,  2.74it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:28<00:47,  2.77it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:28<00:46,  2.80it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:29<00:45,  2.81it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:30<00:44,  2.83it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:31<00:43,  2.84it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:31<00:42,  2.87it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:32<00:41,  2.89it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:33<00:40,  2.90it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:33<00:40,  2.92it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:34<00:39,  2.93it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:35<00:38,  2.95it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:35<00:37,  2.95it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:36<00:36,  2.96it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:37<00:35,  2.98it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:37<00:35,  2.99it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:38<00:34,  3.01it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:39<00:33,  3.02it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:39<00:32,  3.03it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:40<00:31,  3.04it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:41<00:31,  3.05it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:41<00:30,  3.05it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:42<00:29,  3.05it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:43<00:29,  3.06it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:43<00:28,  3.07it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:44<00:27,  3.08it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:44<00:27,  3.05it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:45<00:26,  3.01it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:46<00:25,  3.06it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:46<00:24,  3.10it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:47<00:23,  3.14it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:48<00:22,  3.18it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:48<00:22,  3.20it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:49<00:21,  3.22it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:49<00:20,  3.24it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:50<00:20,  3.25it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:51<00:19,  3.26it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:51<00:18,  3.28it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:52<00:17,  3.30it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:53<00:17,  3.32it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:53<00:16,  3.33it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:54<00:15,  3.35it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:54<00:15,  3.35it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:55<00:14,  3.36it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:55<00:13,  3.37it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:56<00:13,  3.37it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:57<00:12,  3.38it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:57<00:12,  3.38it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:58<00:11,  3.39it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:58<00:10,  3.40it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:59<00:10,  3.42it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:00<00:09,  3.44it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:00<00:08,  3.45it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:01<00:08,  3.49it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:01<00:07,  3.51it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:02<00:07,  3.52it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:02<00:06,  3.53it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:03<00:05,  3.54it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:04<00:05,  3.55it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:04<00:04,  3.56it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:05<00:04,  3.58it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:05<00:03,  3.62it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:06<00:03,  3.66it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:06<00:02,  3.69it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:07<00:01,  3.73it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:07<00:01,  3.76it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:08<00:00,  3.80it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:08<00:00,  3.84it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:08<00:00,  2.91it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'qnli': {'alias': 'qnli', 'acc,none': 0.46, 'acc_stderr,none': 0.05009082659620332}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
0.48800861061165646
0.4420522818267443
0.9519161971847797
0.7484302940574024
0.5133259423607681
0.5588784666822361
0.6658633104669237
0.7569182042181317
0.5308683195195316
0.8457203515884096
0.2160432078364904
0.9025653665852331
0.9196489243365332
0.6742217686289
0.8668007010904994
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 5, 4, 2, 6, 1, 3, 0]
tensor([7, 5, 4, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 1, 3, 6, 2, 7, 0]
tensor([4, 5, 1, 3, 6, 2, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 4, 1, 2, 5, 0]
tensor([0, 1, 3, 4, 1, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 5, 2, 4, 1, 3, 0]
tensor([0, 1, 5, 2, 4, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 4, 1, 2, 1, 3, 5, 0]
tensor([0, 4, 1, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[2, 4, 3, 0, 5, 1, 1, 0]
tensor([2, 4, 3, 0, 5, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 4, 2, 1, 1, 5, 0]
tensor([0, 3, 4, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 1, 3, 2, 0, 3, 1]
tensor([0, 2, 1, 3, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([0, 7])
tensor(0)
tensor([1, 5])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 11
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
done!
Normal merging for layer 12
tensor([3, 7])
tensor(3)
tensor([5, 6])
tensor(5)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 14 to 15
done!
Normal merging for layer 16
tensor([0, 5])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3, 6])
tensor(3)
done!
Cross-layer merge completed for layers 17 to 31
done!
all done!
Model size: 12.3238 GB
75
cuda:3
wikitext
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:42<00:42, 42.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 24.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 27.45s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wikitext] metric word_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
WARNING:lm_eval.api.task:[Task: wikitext] metric word_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
WARNING:lm_eval.api.task:[Task: wikitext] metric byte_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
WARNING:lm_eval.api.task:[Task: wikitext] metric byte_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
WARNING:lm_eval.api.task:[Task: wikitext] metric bits_per_byte is defined, but aggregation is not. using default aggregation=bits_per_byte
WARNING:lm_eval.api.task:[Task: wikitext] metric bits_per_byte is defined, but higher_is_better is not. using default higher_is_better=False
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/wikitext_document_level/EleutherAI/wikitext_document_level.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/wikitext_document_level/resolve/647234772b9554e208af6c826f23b99e3cac88c8/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level/revision/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level/tree/647234772b9554e208af6c826f23b99e3cac88c8?recursive=False&expand=False HTTP/1.1" 200 357
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level/tree/647234772b9554e208af6c826f23b99e3cac88c8/wikitext-103-raw-v1?recursive=False&expand=False HTTP/1.1" 200 488
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level/revision/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/wikitext_document_level/resolve/647234772b9554e208af6c826f23b99e3cac88c8/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level/tree/647234772b9554e208af6c826f23b99e3cac88c8/wikitext-2-raw-v1?recursive=False&expand=False HTTP/1.1" 200 487
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:filelock:Attempting to acquire lock 140481071998368 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Lock 140481071998368 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481071998368 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Lock 140481071998368 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Attempting to acquire lock 140481071830544 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:filelock:Lock 140481071830544 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481071830544 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:filelock:Lock 140481071830544 released on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wikitext from None to 0
INFO:lm_eval.api.task:Building contexts for wikitext on rank 0...
  0%|          | 0/62 [00:00<?, ?it/s]100%|██████████| 62/62 [00:00<00:00, 740.19it/s]
DEBUG:lm_eval.evaluator:Task: wikitext; number of requests on this rank: 62
INFO:lm_eval.evaluator:Running loglikelihood_rolling requests
  0%|          | 0/62 [00:00<?, ?it/s] 19%|█▉        | 12/62 [00:00<00:00, 102.38it/s] 44%|████▎     | 27/62 [00:00<00:00, 116.31it/s] 63%|██████▎   | 39/62 [00:00<00:00, 115.53it/s] 89%|████████▊ | 55/62 [00:00<00:00, 131.26it/s]100%|██████████| 62/62 [00:00<00:00, 126.35it/s]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.21s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.21s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.01s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.01s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.71s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.71s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.53s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.53s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.90s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.90s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.83s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.83s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:11<00:00, 11.81s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:11<00:00, 11.82s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:14<00:00, 14.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:14<00:00, 14.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.80s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.80s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.68s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.68s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.49s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.49s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.79s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.79s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.25s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.25s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.29s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.29s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.36s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:19<00:00, 19.16s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:19<00:00, 19.16s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.85s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.85s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.80s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.80s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.14s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.14s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.78s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.78s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.06s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.07s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.88s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.88s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.80s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.11s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.11s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.79s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.79s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.81s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.41s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.41s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.61s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.61s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.78s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.78s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.43s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.43s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.43s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.43s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.70s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.70s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.47s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.47s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:00<00:00,  1.97it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:00<00:00,  1.97it/s]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:01<00:00,  1.60s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:01<00:00,  1.60s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.69s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.70s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.74s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.74s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.49s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.49s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.78s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.78s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.80s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.80s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.44s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.44s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.86s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.86s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.53s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.53s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.52s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.52s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.67s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.67s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.18s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.18s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.66s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.30s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.30s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.30s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.30s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.09s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.09s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.76s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.76s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.39s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.39s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.01s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.01s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.25s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.25s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.46s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.46s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.66s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.66s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.16s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.16s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.67s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.67s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.77s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.77s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'wikitext': {'alias': 'wikitext', 'word_perplexity,none': 10.41810626477151, 'word_perplexity_stderr,none': 'N/A', 'byte_perplexity,none': 1.5499996141598633, 'byte_perplexity_stderr,none': 'N/A', 'bits_per_byte,none': 0.6322678563706606, 'bits_per_byte_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
0.3112335629956447
0.316268174131358
0.5041948206367306
0.3067038688170426
0.21198641237235732
0.23379101174921613
0.4411951857077822
0.3636022184812837
0.22411151956337602
0.0659668585894146
0.5103891010860186
0.5291148039479469
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
0.3112335629956447
0.316268174131358
0.5041948206367306
0.3067038688170426
0.21198641237235732
0.23379101174921613
0.4411951857077822
0.3636022184812837
0.22411151956337602
0.0659668585894146
0.5103891010860186
0.5291148039479469
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 7, 0, 5, 1, 4, 2]
tensor([6, 3, 7, 0, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[2, 5, 0, 4, 3, 6, 7, 1]
tensor([2, 5, 0, 4, 3, 6, 7, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 7, 5, 2, 0, 3, 1, 4]
tensor([6, 7, 5, 2, 0, 3, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 1, 0, 7, 2, 3, 5, 6]
tensor([4, 1, 0, 7, 2, 3, 5, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 2, 4, 0, 1, 1, 0]
tensor([5, 3, 2, 4, 0, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[3, 2, 0, 1, 5, 0, 4, 1]
tensor([3, 2, 0, 1, 5, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[1, 0, 1, 5, 2, 0, 4, 3]
tensor([1, 0, 1, 5, 2, 0, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 4
done!
Normal merging for layer 5
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 6
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 8
done!
Normal merging for layer 9
tensor([4, 7])
tensor(4)
tensor([5, 6])
tensor(5)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
done!
Normal merging for layer 10
tensor([2, 5])
tensor(2)
tensor([3, 7])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 11 to 12
done!
Normal merging for layer 13
tensor([1, 5])
tensor(1)
tensor([0, 2])
tensor(0)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!
Model size: 12.3867 GB
164
cuda:4
wnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:43<00:43, 43.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 25.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 28.22s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: wnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/wnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/wnli?recursive=False&expand=False HTTP/1.1" 200 352
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140481469967216 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140481469967216 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481469967216 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140481469967216 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140476689243968 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140476689243968 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140476689243968 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140476689243968 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wnli from None to 0
INFO:lm_eval.api.task:Building contexts for wnli on rank 0...
  0%|          | 0/71 [00:00<?, ?it/s]100%|██████████| 71/71 [00:00<00:00, 1329.93it/s]
DEBUG:lm_eval.evaluator:Task: wnli; number of requests on this rank: 142
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/142 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/142 [00:01<03:50,  1.63s/it]Running loglikelihood requests:   2%|▏         | 3/142 [00:02<01:39,  1.39it/s]Running loglikelihood requests:   4%|▎         | 5/142 [00:03<01:15,  1.81it/s]Running loglikelihood requests:   5%|▍         | 7/142 [00:04<01:05,  2.06it/s]Running loglikelihood requests:   6%|▋         | 9/142 [00:04<00:59,  2.24it/s]Running loglikelihood requests:   8%|▊         | 11/142 [00:05<00:54,  2.38it/s]Running loglikelihood requests:   9%|▉         | 13/142 [00:06<00:51,  2.49it/s]Running loglikelihood requests:  11%|█         | 15/142 [00:06<00:48,  2.59it/s]Running loglikelihood requests:  12%|█▏        | 17/142 [00:07<00:46,  2.68it/s]Running loglikelihood requests:  13%|█▎        | 19/142 [00:08<00:44,  2.79it/s]Running loglikelihood requests:  15%|█▍        | 21/142 [00:08<00:42,  2.86it/s]Running loglikelihood requests:  16%|█▌        | 23/142 [00:09<00:40,  2.95it/s]Running loglikelihood requests:  18%|█▊        | 25/142 [00:10<00:38,  3.01it/s]Running loglikelihood requests:  19%|█▉        | 27/142 [00:10<00:37,  3.07it/s]Running loglikelihood requests:  20%|██        | 29/142 [00:11<00:36,  3.11it/s]Running loglikelihood requests:  22%|██▏       | 31/142 [00:12<00:35,  3.14it/s]Running loglikelihood requests:  23%|██▎       | 33/142 [00:12<00:34,  3.16it/s]Running loglikelihood requests:  25%|██▍       | 35/142 [00:13<00:33,  3.18it/s]Running loglikelihood requests:  26%|██▌       | 37/142 [00:13<00:32,  3.19it/s]Running loglikelihood requests:  27%|██▋       | 39/142 [00:14<00:32,  3.21it/s]Running loglikelihood requests:  29%|██▉       | 41/142 [00:15<00:31,  3.22it/s]Running loglikelihood requests:  30%|███       | 43/142 [00:15<00:30,  3.20it/s]Running loglikelihood requests:  32%|███▏      | 45/142 [00:16<00:29,  3.25it/s]Running loglikelihood requests:  33%|███▎      | 47/142 [00:16<00:28,  3.30it/s]Running loglikelihood requests:  35%|███▍      | 49/142 [00:17<00:27,  3.35it/s]Running loglikelihood requests:  36%|███▌      | 51/142 [00:18<00:26,  3.42it/s]Running loglikelihood requests:  37%|███▋      | 53/142 [00:18<00:26,  3.41it/s]Running loglikelihood requests:  39%|███▊      | 55/142 [00:19<00:25,  3.45it/s]Running loglikelihood requests:  40%|████      | 57/142 [00:19<00:24,  3.49it/s]Running loglikelihood requests:  42%|████▏     | 59/142 [00:20<00:23,  3.51it/s]Running loglikelihood requests:  43%|████▎     | 61/142 [00:20<00:22,  3.53it/s]Running loglikelihood requests:  44%|████▍     | 63/142 [00:21<00:22,  3.55it/s]Running loglikelihood requests:  46%|████▌     | 65/142 [00:22<00:21,  3.57it/s]Running loglikelihood requests:  47%|████▋     | 67/142 [00:22<00:20,  3.58it/s]Running loglikelihood requests:  49%|████▊     | 69/142 [00:23<00:20,  3.60it/s]Running loglikelihood requests:  50%|█████     | 71/142 [00:23<00:19,  3.60it/s]Running loglikelihood requests:  51%|█████▏    | 73/142 [00:24<00:19,  3.62it/s]Running loglikelihood requests:  53%|█████▎    | 75/142 [00:24<00:18,  3.63it/s]Running loglikelihood requests:  54%|█████▍    | 77/142 [00:25<00:17,  3.64it/s]Running loglikelihood requests:  56%|█████▌    | 79/142 [00:25<00:17,  3.66it/s]Running loglikelihood requests:  57%|█████▋    | 81/142 [00:26<00:16,  3.67it/s]Running loglikelihood requests:  58%|█████▊    | 83/142 [00:26<00:16,  3.68it/s]Running loglikelihood requests:  60%|█████▉    | 85/142 [00:27<00:15,  3.68it/s]Running loglikelihood requests:  61%|██████▏   | 87/142 [00:28<00:14,  3.70it/s]Running loglikelihood requests:  63%|██████▎   | 89/142 [00:28<00:14,  3.70it/s]Running loglikelihood requests:  64%|██████▍   | 91/142 [00:29<00:13,  3.71it/s]Running loglikelihood requests:  65%|██████▌   | 93/142 [00:29<00:13,  3.73it/s]Running loglikelihood requests:  67%|██████▋   | 95/142 [00:30<00:12,  3.74it/s]Running loglikelihood requests:  68%|██████▊   | 97/142 [00:30<00:12,  3.75it/s]Running loglikelihood requests:  70%|██████▉   | 99/142 [00:31<00:11,  3.76it/s]Running loglikelihood requests:  71%|███████   | 101/142 [00:31<00:10,  3.77it/s]Running loglikelihood requests:  73%|███████▎  | 103/142 [00:32<00:10,  3.79it/s]Running loglikelihood requests:  74%|███████▍  | 105/142 [00:32<00:09,  3.80it/s]Running loglikelihood requests:  75%|███████▌  | 107/142 [00:33<00:09,  3.81it/s]Running loglikelihood requests:  77%|███████▋  | 109/142 [00:33<00:08,  3.82it/s]Running loglikelihood requests:  78%|███████▊  | 111/142 [00:34<00:08,  3.83it/s]Running loglikelihood requests:  80%|███████▉  | 113/142 [00:34<00:07,  3.84it/s]Running loglikelihood requests:  81%|████████  | 115/142 [00:35<00:07,  3.85it/s]Running loglikelihood requests:  82%|████████▏ | 117/142 [00:35<00:06,  3.85it/s]Running loglikelihood requests:  84%|████████▍ | 119/142 [00:36<00:05,  3.86it/s]Running loglikelihood requests:  85%|████████▌ | 121/142 [00:36<00:05,  3.87it/s]Running loglikelihood requests:  87%|████████▋ | 123/142 [00:37<00:04,  3.88it/s]Running loglikelihood requests:  88%|████████▊ | 125/142 [00:37<00:04,  3.90it/s]Running loglikelihood requests:  89%|████████▉ | 127/142 [00:38<00:03,  3.90it/s]Running loglikelihood requests:  91%|█████████ | 129/142 [00:39<00:03,  3.91it/s]Running loglikelihood requests:  92%|█████████▏| 131/142 [00:39<00:02,  3.93it/s]Running loglikelihood requests:  94%|█████████▎| 133/142 [00:40<00:02,  3.95it/s]Running loglikelihood requests:  95%|█████████▌| 135/142 [00:40<00:01,  3.98it/s]Running loglikelihood requests:  96%|█████████▋| 137/142 [00:40<00:01,  4.01it/s]Running loglikelihood requests:  98%|█████████▊| 139/142 [00:41<00:00,  4.03it/s]Running loglikelihood requests:  99%|█████████▉| 141/142 [00:41<00:00,  4.09it/s]Running loglikelihood requests: 100%|██████████| 142/142 [00:41<00:00,  3.38it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'wnli': {'alias': 'wnli', 'acc,none': 0.5352112676056338, 'acc_stderr,none': 0.0596130578497224}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.31190044950254875
0.7306280553786256
0.6985925052465822
0.5843516732063875
0.8124235844589114
0.820438203921003
0.6253838264581936
0.7600037006947045
0.8225872978677496
0.708398461303215
0.8646089269479391
0.8239362351853257
0.7608099850331435
0.6657423857513638
0.7943257460202938
0.7511476003698512
0.9073696655228775
0.8741838353767599
0.7945799099309127
0.9323691001541556
0.865243808509542
0.8176606226311932
0.6785099625983169
0.9579534328203848
0.788928884938056
0.9833718962298513
0.5933012307657521
0.7829988799240639
0.7823073743206628
0.31190044950254875
0.7306280553786256
0.6985925052465822
0.5843516732063875
0.8124235844589114
0.820438203921003
0.6253838264581936
0.7600037006947045
0.8225872978677496
0.708398461303215
0.8646089269479391
0.8239362351853257
0.7608099850331435
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 4, 5, 1, 6, 3, 2, 0]
tensor([7, 4, 5, 1, 6, 3, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 4, 5, 6, 1, 0, 3]
tensor([7, 2, 4, 5, 6, 1, 0, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 5, 4, 1, 2, 0]
tensor([6, 3, 7, 5, 4, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 6, 4, 7, 1, 2, 0]
tensor([5, 3, 6, 4, 7, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 3, 6, 5, 7, 2, 1, 0]
tensor([4, 3, 6, 5, 7, 2, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 2, 3, 2, 3, 0]
tensor([0, 1, 1, 2, 3, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 1, 2, 2, 3, 0, 3, 1]
tensor([0, 1, 2, 2, 3, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 1, 1, 1.0, 1.0, 1.0, 1.0]
tensor([0, 0, 1, 1, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 5 to 15
done!
Normal merging for layer 16
tensor([0, 7])
tensor(0)
tensor([1, 2])
tensor(1)
tensor([3, 5])
tensor(3)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 17
tensor([0, 5])
tensor(0)
tensor([1, 7])
tensor(1)
tensor([2, 3])
tensor(2)
tensor([4, 6])
tensor(4)
done!
Cross-layer merge completed for layers 18 to 30
done!
Normal merging for layer 31
tensor([0, 1])
tensor(0)
tensor([2, 3, 4, 5, 6, 7])
tensor(2)
done!
all done!
Model size: 12.2608 GB
7
cuda:5
wic
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:42<00:42, 42.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:55<00:00, 24.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:55<00:00, 27.55s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wic] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: wic] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/wic?recursive=False&expand=False HTTP/1.1" 307 142
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/wic?recursive=False&expand=False HTTP/1.1" 200 356
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140476671303104 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wic_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 140476671303104 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wic_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 140476671303104 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wic_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 140476671303104 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wic_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 140479055746576 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 140479055746576 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 140479055746576 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 140479055746576 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wic/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wic from None to 0
INFO:lm_eval.api.task:Building contexts for wic on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1589.37it/s]
DEBUG:lm_eval.evaluator:Task: wic; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:42,  1.42s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:06,  1.56it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:36,  2.02it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:24,  2.29it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:17,  2.47it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:04<01:13,  2.59it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:05<01:09,  2.68it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:07,  2.75it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:05,  2.80it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:07<01:04,  2.83it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:02,  2.85it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:01,  2.88it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:09<01:00,  2.90it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<00:59,  2.91it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<00:58,  2.93it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:11<00:57,  2.95it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:12<00:56,  2.96it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<00:55,  2.99it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:13<00:54,  3.00it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:14<00:53,  3.02it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:15<00:52,  3.03it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:15<00:51,  3.04it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:16<00:50,  3.05it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:17<00:50,  3.05it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:17<00:49,  3.05it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:18<00:48,  3.06it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:19<00:47,  3.06it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:19<00:47,  3.07it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:20<00:46,  3.07it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:20<00:45,  3.08it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:21<00:45,  3.08it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:22<00:44,  3.08it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:22<00:43,  3.08it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:23<00:43,  3.08it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:24<00:42,  3.09it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:24<00:41,  3.09it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:25<00:40,  3.11it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:26<00:39,  3.13it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:26<00:39,  3.14it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:27<00:38,  3.14it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:28<00:38,  3.12it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:28<00:37,  3.12it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:29<00:36,  3.14it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:29<00:35,  3.15it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:30<00:35,  3.12it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:31<00:34,  3.13it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:31<00:34,  3.14it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:32<00:33,  3.14it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:33<00:32,  3.15it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:33<00:31,  3.16it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:34<00:31,  3.16it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:35<00:30,  3.17it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:35<00:30,  3.12it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:36<00:29,  3.16it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:36<00:28,  3.18it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:37<00:27,  3.20it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:38<00:27,  3.21it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:38<00:26,  3.22it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:39<00:25,  3.23it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:40<00:25,  3.23it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:40<00:24,  3.24it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:41<00:23,  3.24it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:41<00:23,  3.24it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:42<00:22,  3.24it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:43<00:21,  3.24it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:43<00:21,  3.25it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:44<00:20,  3.26it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:44<00:19,  3.26it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:45<00:19,  3.26it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:46<00:18,  3.26it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:46<00:18,  3.27it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:47<00:17,  3.27it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:47<00:16,  3.28it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:48<00:16,  3.29it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:49<00:15,  3.30it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:49<00:14,  3.31it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:50<00:14,  3.31it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:50<00:13,  3.32it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:51<00:12,  3.33it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:52<00:12,  3.34it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:52<00:11,  3.34it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:53<00:11,  3.34it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:53<00:10,  3.35it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:54<00:09,  3.35it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:55<00:09,  3.36it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:55<00:08,  3.37it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:56<00:07,  3.38it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:56<00:07,  3.39it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:57<00:06,  3.40it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:58<00:06,  3.42it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:58<00:05,  3.42it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:59<00:04,  3.43it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:59<00:04,  3.43it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:00<00:03,  3.44it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:00<00:03,  3.45it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:01<00:02,  3.46it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:02<00:02,  3.47it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:02<00:01,  3.48it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:03<00:00,  3.49it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:03<00:00,  3.50it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:03<00:00,  3.13it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'wic': {'alias': 'wic', 'acc,none': 0.47, 'acc_stderr,none': 0.05016135580465919}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7015569150227223
0.5302361010977743
0.6131123609930033
0.8131827739550247
0.5456264918897312
0.5653128506125247
0.9024119585362896
0.8122852497904204
0.9072724946141106
0.866764102055741
0.8260299199157425
0.7472915500213457
0.8874866998217976
0.7441602305581367
0.22948143665096393
0.6763976434023368
0.5909756859477309
0.6775915070630182
0.8311737665735953
0.5882947608660276
0.7888779075700829
0.9530393862783458
0.7563942945196994
0.7021129984434293
0.9133573687405422
0.8864659884483975
0.43949477197814607
0.49530015739760547
0.9835705252160515
0.7015569150227223
0.5302361010977743
0.6131123609930033
0.8131827739550247
0.5456264918897312
0.5653128506125247
0.9024119585362896
0.8122852497904204
0.9072724946141106
0.866764102055741
0.8260299199157425
0.7472915500213457
0.8874866998217976
0.7441602305581367
Total groups 76 exceeded the threshold, stopping comparison.
The group tensor is
[6, 5, 2, 3, 7, 0, 4, 1]
tensor([6, 5, 2, 3, 7, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 6, 1, 5, 4, 2, 3, 0]
tensor([7, 6, 1, 5, 4, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 6, 2, 4, 5, 0, 3, 1]
tensor([7, 6, 2, 4, 5, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 0, 0, 5, 1, 1, 3, 2]
tensor([4, 0, 0, 5, 1, 1, 3, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 0, 2, 5, 3, 4, 1]
tensor([0, 1, 0, 2, 5, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 0, 1, 4, 1, 2, 3, 0]
tensor([5, 0, 1, 4, 1, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 1, 3, 4, 2, 5, 0]
tensor([0, 1, 1, 3, 4, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 0, 2, 3, 1, 2, 3]
tensor([0, 1, 0, 2, 3, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 2 to 3
done!
Normal merging for layer 4
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 7
done!
Normal merging for layer 8
tensor([1, 2])
tensor(1)
tensor([4, 5])
tensor(4)
tensor([7])
tensor(7)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 9 to 10
done!
Normal merging for layer 11
tensor([0, 2])
tensor(0)
tensor([1, 7])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 12 to 13
done!
Normal merging for layer 14
tensor([1, 7])
tensor(1)
tensor([2, 4])
tensor(2)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
done!
Normal merging for layer 15
tensor([0, 7])
tensor(0)
tensor([1, 2])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Normal merging for layer 16
tensor([0, 2])
tensor(0)
tensor([1, 5])
tensor(1)
tensor([3, 6])
tensor(3)
tensor([4, 7])
tensor(4)
done!
Cross-layer merge completed for layers 17 to 31
done!
all done!
Model size: 12.5757 GB
109
cuda:6
openbookqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:42<00:42, 42.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:55<00:00, 24.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:55<00:00, 27.60s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1408
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/openbookqa/openbookqa.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1408
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 117
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 1408
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454?recursive=False&expand=False HTTP/1.1" 307 142
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454?recursive=False&expand=False HTTP/1.1" 200 390
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/additional?recursive=False&expand=False HTTP/1.1" 307 153
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/additional?recursive=False&expand=False HTTP/1.1" 200 363
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 117
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 1408
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/main?recursive=False&expand=False HTTP/1.1" 307 147
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/main?recursive=False&expand=False HTTP/1.1" 200 359
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140481071865136 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 140481071865136 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481071865136 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 140481071865136 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Attempting to acquire lock 140479055750032 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 140479055750032 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 140479055750032 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 140479055750032 released on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of openbookqa from None to 0
INFO:lm_eval.api.task:Building contexts for openbookqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2768.57it/s]
DEBUG:lm_eval.evaluator:Task: openbookqa; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:01<09:10,  1.38s/it]Running loglikelihood requests:   0%|          | 2/400 [00:02<06:38,  1.00s/it]Running loglikelihood requests:   1%|          | 3/400 [00:02<05:47,  1.14it/s]Running loglikelihood requests:   1%|          | 4/400 [00:03<05:21,  1.23it/s]Running loglikelihood requests:   1%|▏         | 5/400 [00:04<04:48,  1.37it/s]Running loglikelihood requests:   2%|▏         | 6/400 [00:04<04:27,  1.47it/s]Running loglikelihood requests:   2%|▏         | 7/400 [00:05<04:13,  1.55it/s]Running loglikelihood requests:   2%|▏         | 8/400 [00:05<04:03,  1.61it/s]Running loglikelihood requests:   2%|▏         | 9/400 [00:06<03:55,  1.66it/s]Running loglikelihood requests:   2%|▎         | 10/400 [00:06<03:49,  1.70it/s]Running loglikelihood requests:   3%|▎         | 11/400 [00:07<03:45,  1.72it/s]Running loglikelihood requests:   3%|▎         | 12/400 [00:08<03:43,  1.74it/s]Running loglikelihood requests:   3%|▎         | 13/400 [00:08<03:40,  1.76it/s]Running loglikelihood requests:   4%|▍         | 15/400 [00:09<02:47,  2.30it/s]Running loglikelihood requests:   4%|▍         | 16/400 [00:09<02:58,  2.15it/s]Running loglikelihood requests:   4%|▍         | 17/400 [00:10<03:06,  2.05it/s]Running loglikelihood requests:   4%|▍         | 18/400 [00:10<03:11,  1.99it/s]Running loglikelihood requests:   5%|▍         | 19/400 [00:11<03:15,  1.95it/s]Running loglikelihood requests:   5%|▌         | 20/400 [00:11<03:17,  1.92it/s]Running loglikelihood requests:   5%|▌         | 21/400 [00:12<03:18,  1.91it/s]Running loglikelihood requests:   6%|▌         | 22/400 [00:13<03:18,  1.90it/s]Running loglikelihood requests:   6%|▌         | 23/400 [00:13<03:18,  1.90it/s]Running loglikelihood requests:   6%|▌         | 24/400 [00:14<03:18,  1.89it/s]Running loglikelihood requests:   6%|▋         | 25/400 [00:14<03:18,  1.89it/s]Running loglikelihood requests:   6%|▋         | 26/400 [00:15<03:17,  1.89it/s]Running loglikelihood requests:   7%|▋         | 27/400 [00:15<03:16,  1.90it/s]Running loglikelihood requests:   7%|▋         | 28/400 [00:16<03:14,  1.91it/s]Running loglikelihood requests:   7%|▋         | 29/400 [00:16<03:12,  1.93it/s]Running loglikelihood requests:   8%|▊         | 33/400 [00:17<01:39,  3.70it/s]Running loglikelihood requests:   8%|▊         | 34/400 [00:17<01:53,  3.21it/s]Running loglikelihood requests:   9%|▉         | 35/400 [00:18<02:06,  2.88it/s]Running loglikelihood requests:   9%|▉         | 36/400 [00:18<02:17,  2.64it/s]Running loglikelihood requests:   9%|▉         | 37/400 [00:19<02:26,  2.48it/s]Running loglikelihood requests:  10%|▉         | 38/400 [00:19<02:33,  2.36it/s]Running loglikelihood requests:  10%|▉         | 39/400 [00:20<02:38,  2.28it/s]Running loglikelihood requests:  10%|█         | 40/400 [00:20<02:42,  2.22it/s]Running loglikelihood requests:  10%|█         | 41/400 [00:21<02:44,  2.19it/s]Running loglikelihood requests:  10%|█         | 42/400 [00:21<02:45,  2.17it/s]Running loglikelihood requests:  11%|█         | 43/400 [00:21<02:46,  2.15it/s]Running loglikelihood requests:  11%|█         | 44/400 [00:22<02:46,  2.14it/s]Running loglikelihood requests:  11%|█▏        | 45/400 [00:22<02:46,  2.13it/s]Running loglikelihood requests:  12%|█▏        | 46/400 [00:23<02:46,  2.13it/s]Running loglikelihood requests:  12%|█▏        | 47/400 [00:23<02:46,  2.13it/s]Running loglikelihood requests:  12%|█▏        | 48/400 [00:24<02:45,  2.13it/s]Running loglikelihood requests:  12%|█▏        | 49/400 [00:24<02:44,  2.13it/s]Running loglikelihood requests:  12%|█▎        | 50/400 [00:25<02:44,  2.13it/s]Running loglikelihood requests:  13%|█▎        | 51/400 [00:25<02:43,  2.13it/s]Running loglikelihood requests:  13%|█▎        | 52/400 [00:26<02:43,  2.13it/s]Running loglikelihood requests:  13%|█▎        | 53/400 [00:26<02:42,  2.14it/s]Running loglikelihood requests:  14%|█▎        | 54/400 [00:27<02:41,  2.15it/s]Running loglikelihood requests:  14%|█▍        | 55/400 [00:27<02:40,  2.15it/s]Running loglikelihood requests:  14%|█▍        | 57/400 [00:28<02:02,  2.80it/s]Running loglikelihood requests:  15%|█▌        | 60/400 [00:28<01:27,  3.90it/s]Running loglikelihood requests:  15%|█▌        | 61/400 [00:28<01:39,  3.39it/s]Running loglikelihood requests:  16%|█▌        | 62/400 [00:29<01:51,  3.03it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [00:29<02:01,  2.77it/s]Running loglikelihood requests:  16%|█▌        | 64/400 [00:30<02:09,  2.59it/s]Running loglikelihood requests:  16%|█▋        | 65/400 [00:30<02:15,  2.47it/s]Running loglikelihood requests:  16%|█▋        | 66/400 [00:31<02:20,  2.38it/s]Running loglikelihood requests:  17%|█▋        | 67/400 [00:31<02:23,  2.32it/s]Running loglikelihood requests:  17%|█▋        | 68/400 [00:32<02:25,  2.29it/s]Running loglikelihood requests:  17%|█▋        | 69/400 [00:32<02:26,  2.26it/s]Running loglikelihood requests:  18%|█▊        | 70/400 [00:33<02:26,  2.25it/s]Running loglikelihood requests:  18%|█▊        | 71/400 [00:33<02:27,  2.23it/s]Running loglikelihood requests:  18%|█▊        | 72/400 [00:34<02:27,  2.22it/s]Running loglikelihood requests:  18%|█▊        | 73/400 [00:34<02:27,  2.22it/s]Running loglikelihood requests:  18%|█▊        | 74/400 [00:34<02:27,  2.21it/s]Running loglikelihood requests:  19%|█▉        | 75/400 [00:35<02:27,  2.21it/s]Running loglikelihood requests:  19%|█▉        | 76/400 [00:35<02:26,  2.21it/s]Running loglikelihood requests:  19%|█▉        | 77/400 [00:36<02:26,  2.20it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [00:36<02:26,  2.20it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [00:37<02:25,  2.21it/s]Running loglikelihood requests:  20%|██        | 81/400 [00:37<01:50,  2.88it/s]Running loglikelihood requests:  20%|██        | 82/400 [00:38<01:58,  2.68it/s]Running loglikelihood requests:  21%|██        | 83/400 [00:38<02:04,  2.54it/s]Running loglikelihood requests:  21%|██        | 84/400 [00:39<02:09,  2.44it/s]Running loglikelihood requests:  22%|██▏       | 86/400 [00:39<01:43,  3.04it/s]Running loglikelihood requests:  22%|██▏       | 87/400 [00:39<01:52,  2.79it/s]Running loglikelihood requests:  22%|██▏       | 88/400 [00:40<01:58,  2.62it/s]Running loglikelihood requests:  22%|██▏       | 89/400 [00:40<02:03,  2.51it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [00:41<02:07,  2.43it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [00:41<02:10,  2.37it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [00:42<02:12,  2.32it/s]Running loglikelihood requests:  23%|██▎       | 93/400 [00:42<02:13,  2.30it/s]Running loglikelihood requests:  24%|██▎       | 94/400 [00:43<02:14,  2.28it/s]Running loglikelihood requests:  24%|██▍       | 95/400 [00:43<02:14,  2.27it/s]Running loglikelihood requests:  24%|██▍       | 96/400 [00:43<02:14,  2.25it/s]Running loglikelihood requests:  24%|██▍       | 97/400 [00:44<02:14,  2.25it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [00:44<02:14,  2.24it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [00:45<02:14,  2.24it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [00:45<02:14,  2.23it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [00:46<02:13,  2.24it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [00:46<02:13,  2.24it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [00:47<02:12,  2.25it/s]Running loglikelihood requests:  26%|██▋       | 106/400 [00:47<01:21,  3.60it/s]Running loglikelihood requests:  27%|██▋       | 107/400 [00:47<01:31,  3.20it/s]Running loglikelihood requests:  27%|██▋       | 108/400 [00:48<01:40,  2.92it/s]Running loglikelihood requests:  27%|██▋       | 109/400 [00:48<01:47,  2.71it/s]Running loglikelihood requests:  28%|██▊       | 110/400 [00:49<01:52,  2.58it/s]Running loglikelihood requests:  28%|██▊       | 111/400 [00:49<01:56,  2.48it/s]Running loglikelihood requests:  28%|██▊       | 112/400 [00:50<01:59,  2.41it/s]Running loglikelihood requests:  28%|██▊       | 113/400 [00:50<02:01,  2.36it/s]Running loglikelihood requests:  28%|██▊       | 114/400 [00:51<02:02,  2.33it/s]Running loglikelihood requests:  29%|██▉       | 115/400 [00:51<02:02,  2.32it/s]Running loglikelihood requests:  29%|██▉       | 116/400 [00:51<02:02,  2.31it/s]Running loglikelihood requests:  29%|██▉       | 117/400 [00:52<02:02,  2.31it/s]Running loglikelihood requests:  30%|██▉       | 118/400 [00:52<02:02,  2.31it/s]Running loglikelihood requests:  30%|██▉       | 119/400 [00:53<02:01,  2.30it/s]Running loglikelihood requests:  30%|███       | 120/400 [00:53<02:02,  2.29it/s]Running loglikelihood requests:  30%|███       | 121/400 [00:54<02:01,  2.30it/s]Running loglikelihood requests:  30%|███       | 122/400 [00:54<02:01,  2.29it/s]Running loglikelihood requests:  31%|███       | 123/400 [00:54<02:01,  2.28it/s]Running loglikelihood requests:  31%|███       | 124/400 [00:55<02:00,  2.28it/s]Running loglikelihood requests:  31%|███▏      | 125/400 [00:55<02:00,  2.28it/s]Running loglikelihood requests:  32%|███▏      | 126/400 [00:56<02:00,  2.28it/s]Running loglikelihood requests:  32%|███▏      | 127/400 [00:56<01:59,  2.29it/s]Running loglikelihood requests:  32%|███▏      | 128/400 [00:57<01:59,  2.28it/s]Running loglikelihood requests:  32%|███▏      | 129/400 [00:57<01:58,  2.28it/s]Running loglikelihood requests:  32%|███▎      | 130/400 [00:58<01:58,  2.29it/s]Running loglikelihood requests:  33%|███▎      | 131/400 [00:58<01:57,  2.29it/s]Running loglikelihood requests:  33%|███▎      | 132/400 [00:58<01:56,  2.30it/s]Running loglikelihood requests:  33%|███▎      | 133/400 [00:59<01:56,  2.29it/s]Running loglikelihood requests:  34%|███▎      | 134/400 [00:59<01:56,  2.29it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [01:00<01:00,  4.35it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [01:00<01:09,  3.73it/s]Running loglikelihood requests:  35%|███▌      | 140/400 [01:01<01:18,  3.30it/s]Running loglikelihood requests:  35%|███▌      | 141/400 [01:01<01:26,  3.00it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [01:01<01:32,  2.79it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [01:02<01:37,  2.65it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [01:02<01:40,  2.55it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [01:03<01:43,  2.48it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [01:03<01:21,  3.12it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [01:04<01:27,  2.89it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [01:04<01:32,  2.72it/s]Running loglikelihood requests:  38%|███▊      | 151/400 [01:04<01:15,  3.30it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [01:05<01:22,  3.01it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [01:05<01:27,  2.81it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [01:06<01:32,  2.67it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [01:06<01:35,  2.57it/s]Running loglikelihood requests:  39%|███▉      | 156/400 [01:07<01:37,  2.50it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [01:07<01:39,  2.45it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [01:07<01:40,  2.42it/s]Running loglikelihood requests:  40%|███▉      | 159/400 [01:08<01:40,  2.40it/s]Running loglikelihood requests:  40%|████      | 160/400 [01:08<01:40,  2.38it/s]Running loglikelihood requests:  40%|████      | 161/400 [01:09<01:40,  2.37it/s]Running loglikelihood requests:  40%|████      | 162/400 [01:09<01:40,  2.36it/s]Running loglikelihood requests:  41%|████      | 163/400 [01:10<01:40,  2.36it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [01:10<01:01,  3.77it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [01:10<01:09,  3.35it/s]Running loglikelihood requests:  43%|████▎     | 171/400 [01:11<00:44,  5.17it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [01:11<00:52,  4.34it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [01:12<01:00,  3.74it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [01:12<01:07,  3.33it/s]Running loglikelihood requests:  44%|████▍     | 175/400 [01:13<01:13,  3.04it/s]Running loglikelihood requests:  44%|████▍     | 176/400 [01:13<01:18,  2.85it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [01:13<01:22,  2.71it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [01:14<01:24,  2.62it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [01:14<01:27,  2.54it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [01:15<01:28,  2.49it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [01:15<01:29,  2.45it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [01:16<01:30,  2.42it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [01:16<01:30,  2.40it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [01:16<01:29,  2.41it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [01:17<01:29,  2.41it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [01:17<01:28,  2.41it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [01:18<01:28,  2.40it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [01:18<01:28,  2.40it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [01:18<01:07,  3.13it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [01:19<00:57,  3.63it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [01:19<01:03,  3.25it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [01:20<01:09,  2.98it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [01:20<01:13,  2.80it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [01:21<01:16,  2.68it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [01:21<01:18,  2.59it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [01:21<01:19,  2.53it/s]Running loglikelihood requests:  50%|█████     | 202/400 [01:22<00:42,  4.66it/s]Running loglikelihood requests:  51%|█████     | 203/400 [01:22<00:49,  4.00it/s]Running loglikelihood requests:  51%|█████     | 204/400 [01:23<00:55,  3.55it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [01:23<01:00,  3.24it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [01:23<01:04,  3.00it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [01:24<01:08,  2.83it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [01:24<00:55,  3.46it/s]Running loglikelihood requests:  52%|█████▎    | 210/400 [01:25<01:00,  3.15it/s]Running loglikelihood requests:  53%|█████▎    | 211/400 [01:25<01:04,  2.94it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [01:25<01:07,  2.78it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [01:26<01:10,  2.67it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [01:26<01:11,  2.59it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [01:27<01:12,  2.54it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [01:27<01:12,  2.52it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [01:28<01:13,  2.50it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [01:28<01:13,  2.49it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [01:28<01:13,  2.48it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [01:29<01:13,  2.46it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [01:29<01:12,  2.46it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [01:30<01:12,  2.46it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [01:30<01:12,  2.46it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [01:30<01:11,  2.48it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [01:31<01:10,  2.47it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [01:31<01:10,  2.47it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [01:32<01:09,  2.48it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [01:32<01:09,  2.49it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [01:32<01:08,  2.50it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [01:33<01:08,  2.49it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [01:33<01:08,  2.48it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [01:34<01:07,  2.49it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [01:34<01:07,  2.49it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [01:34<01:06,  2.49it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [01:35<01:06,  2.50it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [01:35<00:50,  3.24it/s]Running loglikelihood requests:  60%|█████▉    | 239/400 [01:36<00:42,  3.78it/s]Running loglikelihood requests:  60%|██████    | 240/400 [01:36<00:47,  3.39it/s]Running loglikelihood requests:  60%|██████    | 241/400 [01:36<00:50,  3.12it/s]Running loglikelihood requests:  60%|██████    | 242/400 [01:37<00:53,  2.93it/s]Running loglikelihood requests:  61%|██████    | 243/400 [01:37<00:56,  2.80it/s]Running loglikelihood requests:  61%|██████    | 244/400 [01:38<00:57,  2.70it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [01:38<00:58,  2.63it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [01:38<00:59,  2.58it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [01:39<01:00,  2.55it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [01:39<01:00,  2.52it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [01:40<01:00,  2.50it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [01:40<01:00,  2.50it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [01:40<01:00,  2.48it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [01:41<00:59,  2.48it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [01:41<00:59,  2.48it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [01:42<00:58,  2.50it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [01:42<00:57,  2.51it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [01:42<00:56,  2.53it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [01:43<00:56,  2.53it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [01:43<00:56,  2.53it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [01:44<00:55,  2.52it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [01:44<00:55,  2.52it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [01:44<00:55,  2.51it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [01:45<00:54,  2.51it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [01:45<00:54,  2.54it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [01:46<00:40,  3.31it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [01:46<00:43,  3.10it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [01:46<00:45,  2.92it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [01:47<00:46,  2.81it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [01:47<00:47,  2.74it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [01:48<00:47,  2.71it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [01:48<00:48,  2.66it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [01:48<00:48,  2.63it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [01:49<00:48,  2.63it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [01:49<00:48,  2.59it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [01:49<00:48,  2.57it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [01:50<00:48,  2.55it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [01:50<00:48,  2.55it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [01:51<00:47,  2.55it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [01:51<00:47,  2.54it/s]Running loglikelihood requests:  70%|███████   | 280/400 [01:51<00:47,  2.53it/s]Running loglikelihood requests:  70%|███████   | 281/400 [01:52<00:46,  2.56it/s]Running loglikelihood requests:  70%|███████   | 282/400 [01:52<00:46,  2.56it/s]Running loglikelihood requests:  71%|███████   | 283/400 [01:53<00:45,  2.58it/s]Running loglikelihood requests:  71%|███████   | 284/400 [01:53<00:44,  2.58it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [01:53<00:44,  2.59it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [01:54<00:43,  2.60it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [01:54<00:43,  2.59it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [01:55<00:43,  2.60it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [01:55<00:42,  2.61it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [01:55<00:41,  2.63it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [01:56<00:41,  2.64it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [01:56<00:41,  2.62it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [01:56<00:41,  2.57it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [01:57<00:40,  2.59it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [01:57<00:24,  4.22it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [01:58<00:27,  3.73it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [01:58<00:29,  3.40it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [01:58<00:31,  3.16it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [01:59<00:32,  3.01it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [01:59<00:34,  2.82it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [02:00<00:35,  2.71it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [02:00<00:18,  4.96it/s]Running loglikelihood requests:  77%|███████▋  | 308/400 [02:00<00:21,  4.26it/s]Running loglikelihood requests:  77%|███████▋  | 309/400 [02:01<00:24,  3.78it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [02:01<00:26,  3.44it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [02:01<00:27,  3.20it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [02:02<00:29,  3.01it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [02:02<00:30,  2.87it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [02:03<00:30,  2.79it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [02:03<00:30,  2.75it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [02:03<00:30,  2.73it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [02:04<00:30,  2.72it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [02:04<00:30,  2.68it/s]Running loglikelihood requests:  80%|████████  | 321/400 [02:05<00:18,  4.27it/s]Running loglikelihood requests:  80%|████████  | 322/400 [02:05<00:20,  3.79it/s]Running loglikelihood requests:  81%|████████  | 323/400 [02:05<00:22,  3.46it/s]Running loglikelihood requests:  81%|████████  | 324/400 [02:06<00:23,  3.25it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [02:06<00:24,  3.07it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [02:06<00:25,  2.95it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [02:07<00:25,  2.86it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [02:07<00:25,  2.82it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [02:07<00:25,  2.77it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [02:08<00:25,  2.72it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [02:08<00:25,  2.73it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [02:09<00:25,  2.69it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [02:09<00:24,  2.74it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [02:09<00:24,  2.70it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [02:10<00:18,  3.51it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [02:10<00:19,  3.26it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [02:10<00:19,  3.10it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [02:11<00:20,  2.96it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [02:11<00:20,  2.88it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [02:12<00:20,  2.82it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [02:12<00:20,  2.76it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [02:12<00:20,  2.72it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [02:13<00:20,  2.71it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [02:14<00:27,  1.98it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [02:14<00:24,  2.20it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [02:14<00:22,  2.32it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [02:15<00:21,  2.42it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [02:15<00:20,  2.50it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [02:15<00:19,  2.56it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [02:16<00:18,  2.61it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [02:16<00:17,  2.69it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [02:16<00:17,  2.75it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [02:17<00:16,  2.73it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [02:17<00:16,  2.72it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [02:18<00:15,  2.75it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [02:18<00:15,  2.75it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [02:18<00:15,  2.74it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [02:19<00:14,  2.75it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [02:19<00:14,  2.78it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [02:19<00:08,  4.43it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [02:20<00:09,  3.93it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [02:20<00:09,  3.60it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [02:20<00:10,  3.38it/s]Running loglikelihood requests:  92%|█████████▏| 367/400 [02:21<00:10,  3.24it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [02:21<00:10,  3.09it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [02:21<00:10,  2.99it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [02:22<00:10,  2.94it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [02:22<00:09,  2.93it/s]Running loglikelihood requests:  93%|█████████▎| 372/400 [02:23<00:09,  2.94it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [02:23<00:09,  2.94it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [02:23<00:08,  2.91it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [02:24<00:04,  4.71it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [02:24<00:05,  4.19it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [02:24<00:05,  3.81it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [02:25<00:05,  3.58it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [02:25<00:05,  3.43it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [02:25<00:05,  3.31it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [02:26<00:05,  3.21it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [02:26<00:05,  3.15it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [02:26<00:02,  4.91it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [02:27<00:02,  4.35it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [02:27<00:02,  4.81it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [02:27<00:02,  4.24it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [02:28<00:02,  3.95it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [02:28<00:01,  3.76it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [02:28<00:01,  3.54it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [02:28<00:01,  3.41it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [02:29<00:01,  3.38it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [02:29<00:00,  4.34it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [02:29<00:00,  4.25it/s]Running loglikelihood requests: 100%|██████████| 400/400 [02:29<00:00,  2.67it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'openbookqa': {'alias': 'openbookqa', 'acc,none': 0.25, 'acc_stderr,none': 0.04351941398892446, 'acc_norm,none': 0.39, 'acc_norm_stderr,none': 0.04902071300001973}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7187319796021299
0.7542307644255121
0.9218102409329888
0.9507846064925026
0.9244473932111009
0.9697851265705995
0.9088369054586506
0.9555908644563589
0.6065244449438403
0.8380982140772407
0.9227293008726757
0.940339967265193
0.8763319017557598
0.8956221731459367
0.8537768995934096
0.9486125995141542
0.9673324054839537
0.9137514724447725
0.9379677722073356
0.9822722776537973
0.9198472199854921
0.886666948473494
0.9000260607563779
0.9759633945879138
0.9869744580755335
Total groups 76 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 5, 2, 4, 3, 7, 0]
tensor([6, 1, 5, 2, 4, 3, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 1, 3, 2, 5, 4, 6, 0]
tensor([7, 1, 3, 2, 5, 4, 6, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 1.0, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 6 to 29
done!
Normal merging for layer 30
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!
Model size: 12.3238 GB
201
cuda:7
sciq
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:40<00:40, 40.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 24.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 26.87s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/sciq/sciq.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815?recursive=False&expand=False HTTP/1.1" 307 136
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815?recursive=False&expand=False HTTP/1.1" 200 291
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815/data?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815/data?recursive=False&expand=False HTTP/1.1" 200 358
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140482878270464 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140482878270464 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482878270464 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140482878270464 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Attempting to acquire lock 140483666510864 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140483666510864 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140483666510864 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140483666510864 released on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of sciq from None to 0
INFO:lm_eval.api.task:Building contexts for sciq on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1033.57it/s]
DEBUG:lm_eval.evaluator:Task: sciq; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:04<27:53,  4.19s/it]Running loglikelihood requests:   0%|          | 2/400 [00:07<25:14,  3.80s/it]Running loglikelihood requests:   1%|          | 3/400 [00:11<24:23,  3.69s/it]Running loglikelihood requests:   1%|          | 4/400 [00:14<23:59,  3.63s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:18<23:11,  3.52s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:21<22:38,  3.45s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:24<22:15,  3.40s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:28<21:58,  3.36s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:30<21:03,  3.23s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:33<20:22,  3.14s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:36<19:53,  3.07s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:39<19:32,  3.02s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:42<18:50,  2.92s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:45<18:22,  2.86s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:47<18:00,  2.81s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:50<17:45,  2.77s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:53<17:22,  2.72s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:55<17:06,  2.69s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:58<16:52,  2.66s/it]Running loglikelihood requests:   5%|▌         | 20/400 [01:00<16:42,  2.64s/it]Running loglikelihood requests:   5%|▌         | 21/400 [01:03<16:32,  2.62s/it]Running loglikelihood requests:   6%|▌         | 22/400 [01:06<16:25,  2.61s/it]Running loglikelihood requests:   6%|▌         | 23/400 [01:08<16:19,  2.60s/it]Running loglikelihood requests:   6%|▌         | 24/400 [01:11<16:14,  2.59s/it]Running loglikelihood requests:   6%|▋         | 25/400 [01:13<15:51,  2.54s/it]Running loglikelihood requests:   6%|▋         | 26/400 [01:16<15:33,  2.50s/it]Running loglikelihood requests:   7%|▋         | 27/400 [01:18<15:20,  2.47s/it]Running loglikelihood requests:   7%|▋         | 28/400 [01:20<15:10,  2.45s/it]Running loglikelihood requests:   7%|▋         | 29/400 [01:23<14:38,  2.37s/it]Running loglikelihood requests:   8%|▊         | 30/400 [01:25<14:15,  2.31s/it]Running loglikelihood requests:   8%|▊         | 31/400 [01:27<13:57,  2.27s/it]Running loglikelihood requests:   8%|▊         | 32/400 [01:29<13:44,  2.24s/it]Running loglikelihood requests:   8%|▊         | 33/400 [01:31<13:20,  2.18s/it]Running loglikelihood requests:   8%|▊         | 34/400 [01:33<13:04,  2.14s/it]Running loglikelihood requests:   9%|▉         | 35/400 [01:35<12:49,  2.11s/it]Running loglikelihood requests:   9%|▉         | 36/400 [01:37<12:39,  2.09s/it]Running loglikelihood requests:   9%|▉         | 37/400 [01:39<12:31,  2.07s/it]Running loglikelihood requests:  10%|▉         | 38/400 [01:41<12:25,  2.06s/it]Running loglikelihood requests:  10%|█         | 40/400 [01:43<09:27,  1.58s/it]Running loglikelihood requests:  10%|█         | 41/400 [01:45<09:51,  1.65s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:47<10:09,  1.70s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:49<10:23,  1.75s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:51<10:31,  1.77s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:53<10:30,  1.78s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:54<10:29,  1.78s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:56<10:27,  1.78s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:58<10:26,  1.78s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [02:00<10:23,  1.78s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [02:01<10:20,  1.77s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [02:03<10:17,  1.77s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [02:05<10:15,  1.77s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [02:06<09:54,  1.71s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [02:08<09:38,  1.67s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [02:10<09:26,  1.64s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [02:11<07:03,  1.23s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [02:13<07:25,  1.30s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [02:14<07:41,  1.35s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [02:16<05:05,  1.11it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [02:17<05:46,  1.03s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [02:19<06:21,  1.13s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [02:20<06:46,  1.21s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [02:22<07:05,  1.27s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [02:23<07:19,  1.32s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [02:25<07:30,  1.36s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [02:26<07:36,  1.38s/it]Running loglikelihood requests:  18%|█▊        | 70/400 [02:27<07:39,  1.39s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [02:29<07:41,  1.40s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [02:30<07:41,  1.41s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [02:32<07:40,  1.41s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [02:33<07:39,  1.41s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [02:34<04:43,  1.14it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [02:36<05:16,  1.02it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [02:37<05:44,  1.07s/it]Running loglikelihood requests:  20%|██        | 81/400 [02:38<04:46,  1.11it/s]Running loglikelihood requests:  20%|██        | 82/400 [02:40<05:10,  1.02it/s]Running loglikelihood requests:  21%|██        | 83/400 [02:41<05:29,  1.04s/it]Running loglikelihood requests:  21%|██        | 84/400 [02:42<05:44,  1.09s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:43<05:55,  1.13s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:45<06:03,  1.16s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:46<03:53,  1.33it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [02:47<04:22,  1.18it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [02:48<04:47,  1.08it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [02:50<05:09,  1.01s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:51<05:24,  1.06s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:52<03:03,  1.65it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [02:53<03:33,  1.41it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [02:54<04:01,  1.25it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [02:55<04:26,  1.13it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [02:57<04:46,  1.04it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [02:58<05:02,  1.02s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:59<05:14,  1.06s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [03:00<05:22,  1.09s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [03:01<05:27,  1.11s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [03:03<05:30,  1.12s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [03:04<05:32,  1.13s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [03:05<05:32,  1.14s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [03:06<05:31,  1.14s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [03:07<05:30,  1.14s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [03:08<05:28,  1.14s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [03:09<05:27,  1.14s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [03:10<05:25,  1.13s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [03:12<05:23,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [03:13<05:21,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [03:14<05:18,  1.12s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [03:15<05:15,  1.11s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [03:16<05:11,  1.11s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [03:17<05:09,  1.10s/it]Running loglikelihood requests:  30%|███       | 120/400 [03:18<05:07,  1.10s/it]Running loglikelihood requests:  30%|███       | 121/400 [03:19<05:07,  1.10s/it]Running loglikelihood requests:  30%|███       | 122/400 [03:20<05:05,  1.10s/it]Running loglikelihood requests:  31%|███       | 123/400 [03:22<05:04,  1.10s/it]Running loglikelihood requests:  31%|███       | 124/400 [03:23<05:03,  1.10s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [03:24<05:01,  1.10s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [03:25<04:59,  1.09s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [03:26<04:57,  1.09s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:27<04:55,  1.08s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:28<04:52,  1.08s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:29<04:51,  1.08s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:30<04:49,  1.07s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:31<02:58,  1.49it/s]Running loglikelihood requests:  34%|███▍      | 135/400 [03:32<03:19,  1.33it/s]Running loglikelihood requests:  34%|███▍      | 136/400 [03:33<03:37,  1.21it/s]Running loglikelihood requests:  34%|███▍      | 137/400 [03:34<03:51,  1.13it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [03:35<04:03,  1.08it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [03:37<04:11,  1.04it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [03:38<02:43,  1.58it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [03:39<03:05,  1.39it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [03:40<03:23,  1.26it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [03:41<03:38,  1.16it/s]Running loglikelihood requests:  36%|███▋      | 146/400 [03:42<03:50,  1.10it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [03:43<03:58,  1.06it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [03:44<04:04,  1.03it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [03:45<04:08,  1.01it/s]Running loglikelihood requests:  38%|███▊      | 150/400 [03:46<04:10,  1.00s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:47<04:11,  1.01s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:48<04:11,  1.02s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:49<04:11,  1.02s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:50<04:11,  1.02s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:51<04:10,  1.02s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:52<04:09,  1.02s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:53<04:08,  1.02s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:54<04:07,  1.02s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:55<04:06,  1.02s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:56<04:04,  1.02s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:57<04:03,  1.02s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:58<04:03,  1.02s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:59<04:01,  1.02s/it]Running loglikelihood requests:  41%|████      | 164/400 [04:00<03:58,  1.01s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [04:01<03:55,  1.00s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [04:02<03:53,  1.00it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [04:03<03:51,  1.01it/s]Running loglikelihood requests:  42%|████▏     | 168/400 [04:04<03:49,  1.01it/s]Running loglikelihood requests:  42%|████▏     | 169/400 [04:05<03:47,  1.01it/s]Running loglikelihood requests:  42%|████▎     | 170/400 [04:06<03:45,  1.02it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [04:07<02:51,  1.33it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [04:08<03:01,  1.25it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [04:09<03:08,  1.20it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [04:10<02:04,  1.79it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [04:11<02:21,  1.57it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [04:12<02:35,  1.43it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [04:13<02:46,  1.32it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [04:14<02:54,  1.25it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [04:15<03:00,  1.21it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [04:15<03:04,  1.18it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [04:16<03:07,  1.15it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [04:17<03:08,  1.14it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [04:18<03:09,  1.13it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [04:19<03:09,  1.12it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [04:20<03:09,  1.12it/s]Running loglikelihood requests:  47%|████▋     | 189/400 [04:21<03:08,  1.12it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [04:22<03:08,  1.12it/s]Running loglikelihood requests:  48%|████▊     | 191/400 [04:23<03:06,  1.12it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [04:24<03:05,  1.12it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [04:24<03:03,  1.13it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [04:25<03:02,  1.13it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [04:26<03:00,  1.13it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [04:27<02:59,  1.14it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [04:28<02:57,  1.14it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [04:29<02:55,  1.15it/s]Running loglikelihood requests:  50%|████▉     | 199/400 [04:30<02:54,  1.15it/s]Running loglikelihood requests:  50%|█████     | 200/400 [04:30<02:53,  1.16it/s]Running loglikelihood requests:  50%|█████     | 201/400 [04:31<02:51,  1.16it/s]Running loglikelihood requests:  50%|█████     | 202/400 [04:32<02:50,  1.16it/s]Running loglikelihood requests:  51%|█████     | 203/400 [04:33<02:49,  1.16it/s]Running loglikelihood requests:  51%|█████     | 204/400 [04:34<02:48,  1.17it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:35<02:47,  1.17it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:36<02:46,  1.17it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:36<02:45,  1.17it/s]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:37<02:44,  1.17it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:38<02:43,  1.17it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:39<01:40,  1.88it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:40<01:51,  1.68it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:41<02:01,  1.54it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [04:41<02:08,  1.44it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [04:42<02:14,  1.37it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [04:43<02:18,  1.32it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [04:44<02:21,  1.29it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [04:45<02:22,  1.27it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [04:46<02:24,  1.25it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [04:46<02:24,  1.24it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [04:47<02:24,  1.23it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [04:48<02:23,  1.23it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [04:49<02:23,  1.23it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [04:50<02:22,  1.23it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [04:51<02:21,  1.23it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [04:51<02:21,  1.23it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [04:52<02:20,  1.23it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [04:53<02:19,  1.23it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [04:54<02:18,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [04:55<02:17,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [04:55<02:16,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [04:56<02:15,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [04:57<02:14,  1.24it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [04:58<02:13,  1.24it/s]Running loglikelihood requests:  59%|█████▉    | 236/400 [04:59<02:12,  1.24it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [04:59<02:11,  1.24it/s]Running loglikelihood requests:  60%|██████    | 240/400 [05:00<01:20,  1.99it/s]Running loglikelihood requests:  60%|██████    | 241/400 [05:01<01:29,  1.78it/s]Running loglikelihood requests:  60%|██████    | 242/400 [05:02<01:36,  1.63it/s]Running loglikelihood requests:  61%|██████    | 243/400 [05:03<01:42,  1.53it/s]Running loglikelihood requests:  61%|██████    | 244/400 [05:03<01:47,  1.46it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:04<01:50,  1.41it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:05<01:51,  1.38it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:06<01:53,  1.35it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:06<01:53,  1.34it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:07<01:53,  1.33it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:08<01:53,  1.32it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:09<01:53,  1.32it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:10<01:52,  1.31it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:10<01:51,  1.31it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:11<01:51,  1.31it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:12<01:50,  1.31it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:13<01:49,  1.31it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:13<01:48,  1.32it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:14<01:47,  1.32it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:15<01:47,  1.32it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:16<01:45,  1.32it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:16<01:43,  1.35it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [05:17<01:41,  1.36it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [05:18<01:39,  1.38it/s]Running loglikelihood requests:  66%|██████▌   | 264/400 [05:18<01:37,  1.39it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [05:19<01:34,  1.42it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [05:20<01:32,  1.45it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [05:20<01:30,  1.46it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [05:21<01:29,  1.48it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [05:22<01:27,  1.49it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [05:22<01:26,  1.51it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [05:23<01:24,  1.52it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [05:24<01:23,  1.53it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [05:24<01:21,  1.56it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [05:25<01:19,  1.58it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [05:25<01:18,  1.60it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [05:26<01:16,  1.61it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [05:27<01:15,  1.63it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [05:27<01:14,  1.64it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [05:28<01:13,  1.64it/s]Running loglikelihood requests:  70%|███████   | 280/400 [05:28<01:12,  1.65it/s]Running loglikelihood requests:  70%|███████   | 281/400 [05:29<01:11,  1.67it/s]Running loglikelihood requests:  70%|███████   | 282/400 [05:30<01:10,  1.67it/s]Running loglikelihood requests:  71%|███████   | 283/400 [05:30<01:09,  1.68it/s]Running loglikelihood requests:  71%|███████   | 284/400 [05:31<01:08,  1.68it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [05:31<01:08,  1.68it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [05:32<01:07,  1.69it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [05:33<01:06,  1.69it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [05:33<01:05,  1.70it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [05:34<01:05,  1.70it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [05:34<01:04,  1.70it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [05:35<01:04,  1.70it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [05:36<01:03,  1.70it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [05:36<01:02,  1.70it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [05:37<01:02,  1.70it/s]Running loglikelihood requests:  74%|███████▍  | 295/400 [05:37<01:01,  1.71it/s]Running loglikelihood requests:  74%|███████▍  | 296/400 [05:38<01:00,  1.71it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [05:38<01:00,  1.72it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [05:39<00:59,  1.72it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [05:40<00:58,  1.72it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [05:40<00:57,  1.73it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [05:41<00:57,  1.73it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [05:41<00:56,  1.73it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [05:42<00:55,  1.74it/s]Running loglikelihood requests:  76%|███████▌  | 304/400 [05:43<00:55,  1.74it/s]Running loglikelihood requests:  76%|███████▋  | 305/400 [05:43<00:54,  1.74it/s]Running loglikelihood requests:  76%|███████▋  | 306/400 [05:44<00:53,  1.74it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [05:44<00:53,  1.74it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [05:45<00:32,  2.80it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [05:45<00:35,  2.49it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [05:46<00:38,  2.27it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [05:47<00:41,  2.12it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [05:47<00:42,  2.01it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [05:48<00:43,  1.93it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [05:48<00:44,  1.89it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [05:49<00:44,  1.86it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [05:49<00:44,  1.84it/s]Running loglikelihood requests:  80%|███████▉  | 319/400 [05:50<00:44,  1.84it/s]Running loglikelihood requests:  80%|████████  | 321/400 [05:50<00:33,  2.38it/s]Running loglikelihood requests:  80%|████████  | 322/400 [05:51<00:35,  2.22it/s]Running loglikelihood requests:  81%|████████  | 323/400 [05:51<00:36,  2.11it/s]Running loglikelihood requests:  81%|████████  | 324/400 [05:52<00:37,  2.04it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [05:53<00:37,  1.98it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [05:53<00:37,  1.95it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [05:54<00:37,  1.93it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [05:54<00:37,  1.92it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [05:55<00:37,  1.91it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [05:55<00:36,  1.91it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [05:56<00:36,  1.90it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [05:56<00:35,  1.90it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [05:57<00:35,  1.91it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [05:57<00:34,  1.92it/s]Running loglikelihood requests:  84%|████████▍ | 335/400 [05:58<00:33,  1.93it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [05:58<00:33,  1.94it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [05:59<00:32,  1.94it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [05:59<00:31,  1.95it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [06:00<00:31,  1.95it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [06:00<00:30,  1.96it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [06:01<00:30,  1.96it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [06:01<00:29,  1.96it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [06:02<00:29,  1.96it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [06:02<00:28,  1.96it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [06:03<00:27,  1.97it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [06:03<00:27,  1.97it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [06:04<00:26,  1.98it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [06:04<00:26,  1.98it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [06:05<00:25,  1.99it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [06:05<00:25,  1.99it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [06:06<00:24,  1.99it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [06:06<00:24,  1.99it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [06:07<00:23,  2.00it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [06:07<00:22,  2.00it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [06:08<00:22,  2.00it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [06:08<00:21,  2.01it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [06:09<00:21,  2.02it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [06:09<00:20,  2.02it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [06:10<00:20,  2.03it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [06:10<00:19,  2.03it/s]Running loglikelihood requests:  90%|█████████ | 361/400 [06:11<00:19,  2.03it/s]Running loglikelihood requests:  90%|█████████ | 362/400 [06:11<00:18,  2.04it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [06:12<00:18,  2.04it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [06:12<00:17,  2.04it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [06:13<00:17,  2.05it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [06:13<00:16,  2.05it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [06:14<00:11,  2.67it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [06:14<00:12,  2.49it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [06:15<00:12,  2.36it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [06:15<00:12,  2.27it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [06:16<00:09,  2.82it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [06:16<00:09,  2.60it/s]Running loglikelihood requests:  94%|█████████▍| 375/400 [06:17<00:10,  2.44it/s]Running loglikelihood requests:  94%|█████████▍| 376/400 [06:17<00:10,  2.34it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [06:18<00:10,  2.27it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [06:18<00:09,  2.23it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [06:19<00:09,  2.21it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [06:19<00:09,  2.18it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [06:20<00:08,  2.17it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [06:20<00:08,  2.17it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [06:20<00:07,  2.17it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [06:21<00:07,  2.18it/s]Running loglikelihood requests:  96%|█████████▋| 385/400 [06:21<00:06,  2.18it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [06:22<00:06,  2.18it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [06:22<00:05,  2.18it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [06:23<00:05,  2.19it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [06:23<00:05,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [06:24<00:04,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [06:24<00:04,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [06:25<00:03,  2.20it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [06:25<00:03,  2.20it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [06:25<00:02,  2.21it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [06:26<00:02,  2.21it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [06:26<00:01,  2.21it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [06:27<00:01,  2.22it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [06:27<00:00,  2.23it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [06:28<00:00,  2.23it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:28<00:00,  2.25it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:28<00:00,  1.03it/s]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'sciq': {'alias': 'sciq', 'acc,none': 0.94, 'acc_stderr,none': 0.023868325657594204, 'acc_norm,none': 0.91, 'acc_norm_stderr,none': 0.028762349126466136}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.969062788859705
0.9024924890572922
0.7706109127217512
0.8221264026535647
0.9190490061886575
0.9866654579796295
0.6586322754204971
0.7962110384246164
0.8195614021629236
0.7124178311176441
0.787697814339696
0.7034455022322618
0.8136386046534271
0.8174990104652458
0.6784276389594894
0.8698440245672888
0.8886492811850213
0.6541737276411673
0.6560861559753316
0.8139845219953913
0.6714741870309046
0.6164364868717988
0.8331581872497299
0.9065420049234512
0.9246185715568276
0.7477515960551026
0.574165362968651
0.8586446364199891
0.8889771415746612
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 2, 6, 1, 5, 0]
tensor([7, 3, 4, 2, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 5, 3, 4, 0, 7, 1]
tensor([6, 2, 5, 3, 4, 0, 7, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 6, 2, 7, 1, 4, 0]
tensor([5, 3, 6, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 4, 2, 1, 3, 5, 1]
tensor([0, 0, 4, 2, 1, 3, 5, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 3, 4, 5, 0, 1, 1]
tensor([0, 2, 3, 4, 5, 0, 1, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 0, 2, 2, 3, 1]
tensor([0, 3, 1, 0, 2, 2, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 1, 1.0, 1.0, 1.0, 1.0, 1]
tensor([0, 0, 1, 1, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 4
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 9
done!
Normal merging for layer 10
tensor([0, 1])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 11 to 12
done!
Normal merging for layer 13
tensor([0, 5])
tensor(0)
tensor([6, 7])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 14 to 19
done!
Normal merging for layer 20
tensor([0, 3])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 22 to 23
done!
Normal merging for layer 24
tensor([0, 1])
tensor(0)
tensor([2, 3, 4, 5, 6, 7])
tensor(2)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!
Model size: 12.2608 GB
67
cuda:0
wikitext
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:42<00:42, 42.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 24.63s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 27.25s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wikitext] metric word_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
WARNING:lm_eval.api.task:[Task: wikitext] metric word_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
WARNING:lm_eval.api.task:[Task: wikitext] metric byte_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
WARNING:lm_eval.api.task:[Task: wikitext] metric byte_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
WARNING:lm_eval.api.task:[Task: wikitext] metric bits_per_byte is defined, but aggregation is not. using default aggregation=bits_per_byte
WARNING:lm_eval.api.task:[Task: wikitext] metric bits_per_byte is defined, but higher_is_better is not. using default higher_is_better=False
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/wikitext_document_level/EleutherAI/wikitext_document_level.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/wikitext_document_level HTTP/1.1" 200 1012
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/wikitext_document_level/resolve/647234772b9554e208af6c826f23b99e3cac88c8/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 299
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/wikitext_document_level/resolve/647234772b9554e208af6c826f23b99e3cac88c8/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/EleutherAI/wikitext_document_level/paths-info/647234772b9554e208af6c826f23b99e3cac88c8 HTTP/1.1" 200 293
DEBUG:filelock:Attempting to acquire lock 140482011696880 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Lock 140482011696880 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482011696880 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Lock 140482011696880 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___wikitext_document_level_wikitext-2-raw-v1_0.0.0_647234772b9554e208af6c826f23b99e3cac88c8.lock
DEBUG:filelock:Attempting to acquire lock 140480937970288 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:filelock:Lock 140480937970288 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8/dataset_info.json
DEBUG:filelock:Attempting to release lock 140480937970288 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:filelock:Lock 140480937970288 released on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___wikitext_document_level/wikitext-2-raw-v1/0.0.0/647234772b9554e208af6c826f23b99e3cac88c8_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wikitext from None to 0
INFO:lm_eval.api.task:Building contexts for wikitext on rank 0...
  0%|          | 0/62 [00:00<?, ?it/s]100%|██████████| 62/62 [00:00<00:00, 733.45it/s]
DEBUG:lm_eval.evaluator:Task: wikitext; number of requests on this rank: 62
INFO:lm_eval.evaluator:Running loglikelihood_rolling requests
  0%|          | 0/62 [00:00<?, ?it/s] 18%|█▊        | 11/62 [00:00<00:00, 108.56it/s] 39%|███▊      | 24/62 [00:00<00:00, 120.77it/s] 60%|█████▉    | 37/62 [00:00<00:00, 121.36it/s] 81%|████████  | 50/62 [00:00<00:00, 112.92it/s]100%|██████████| 62/62 [00:00<00:00, 123.87it/s]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.21s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.22s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.11s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.11s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:11<00:00, 11.86s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:11<00:00, 11.86s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:14<00:00, 14.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:14<00:00, 14.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.33s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.33s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.86s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.86s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.40s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.40s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.92s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.92s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.27s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.27s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.22s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:16<00:00, 16.22s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.32s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.32s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.23s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.23s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.08s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.08s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.48s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.48s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.27s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.27s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.31s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.32s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.33s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.33s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.95s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.95s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.71s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.71s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.12s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.12s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.56s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.87s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.87s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.68s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.68s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.45s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.45s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:00<00:00,  1.99it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:00<00:00,  1.99it/s]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:01<00:00,  1.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:01<00:00,  1.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.59s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.68s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.68s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.53s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.31s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:09<00:00,  9.31s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.34s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.39s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.73s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.73s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.38s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.69s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.69s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.61s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.61s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.65s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.62s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.63s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.73s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.94s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:18<00:00, 18.94s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.60s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.57s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:13<00:00, 13.57s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.15s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.15s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.19s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:12<00:00, 12.19s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.27s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.27s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.03s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.03s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.58s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.56s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:07<00:00,  7.56s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.22s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:08<00:00,  8.22s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.74s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.74s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.40s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:15<00:00, 15.40s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.14s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.14s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.04s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:06<00:00,  6.04s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.52s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.52s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:05<00:00,  5.36s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.37s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.36s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.35s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.51s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.64s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.55s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.52s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.52s/it]
Running loglikelihood requests:   0%|          | 0/1 [00:00<?, ?it/s]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]Running loglikelihood requests: 100%|██████████| 1/1 [00:17<00:00, 17.54s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'wikitext': {'alias': 'wikitext', 'word_perplexity,none': 10.41810626477151, 'word_perplexity_stderr,none': 'N/A', 'byte_perplexity,none': 1.5499996141598633, 'byte_perplexity_stderr,none': 'N/A', 'bits_per_byte,none': 0.6322678563706606, 'bits_per_byte_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
0.3112335629956447
0.316268174131358
0.5041948206367306
0.3067038688170426
0.21198641237235732
0.23379101174921613
0.4411951857077822
0.3636022184812837
0.22411151956337602
0.0659668585894146
0.5103891010860186
0.5291148039479469
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
0.3112335629956447
0.316268174131358
0.5041948206367306
0.3067038688170426
0.21198641237235732
0.23379101174921613
0.4411951857077822
0.3636022184812837
0.22411151956337602
0.0659668585894146
0.5103891010860186
0.5291148039479469
0.45530714642366393
0.6593661321025917
0.45166835110772663
0.3470526807104175
0.3369212652555373
0.5686768652815603
0.5380667106744194
0.1994061645434335
0.7857081855506413
0.7236392518096334
0.6975091963753621
0.7192457446547811
0.6820752222558486
0.2553530000000423
0.9092011229700152
0.8474392887638426
0.29700403366343364
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 7, 0, 5, 1, 4, 2]
tensor([6, 3, 7, 0, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[2, 5, 0, 4, 3, 6, 7, 1]
tensor([2, 5, 0, 4, 3, 6, 7, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 7, 5, 2, 0, 3, 1, 4]
tensor([6, 7, 5, 2, 0, 3, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 1, 0, 7, 2, 3, 5, 6]
tensor([4, 1, 0, 7, 2, 3, 5, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 2, 4, 0, 1, 1, 0]
tensor([5, 3, 2, 4, 0, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[3, 2, 0, 1, 5, 0, 4, 1]
tensor([3, 2, 0, 1, 5, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[1, 0, 1, 5, 2, 0, 4, 3]
tensor([1, 0, 1, 5, 2, 0, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 4
done!
Normal merging for layer 5
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 6
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 8
done!
Normal merging for layer 9
tensor([4, 7])
tensor(4)
tensor([5, 6])
tensor(5)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
done!
Normal merging for layer 10
tensor([2, 5])
tensor(2)
tensor([3, 7])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 11 to 12
done!
Normal merging for layer 13
tensor([1, 5])
tensor(1)
tensor([0, 2])
tensor(0)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!
Model size: 12.3867 GB
183
cuda:1
wnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:44<00:44, 44.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:57<00:00, 26.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:57<00:00, 28.92s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: wnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140479994152960 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140479994152960 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140479994152960 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140479994152960 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_wnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140482880065312 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482880065312 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482880065312 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482880065312 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/wnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wnli from None to 0
INFO:lm_eval.api.task:Building contexts for wnli on rank 0...
  0%|          | 0/71 [00:00<?, ?it/s]100%|██████████| 71/71 [00:00<00:00, 2562.15it/s]
DEBUG:lm_eval.evaluator:Task: wnli; number of requests on this rank: 142
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/142 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/142 [00:01<03:21,  1.43s/it]Running loglikelihood requests:   2%|▏         | 3/142 [00:02<01:30,  1.53it/s]Running loglikelihood requests:   4%|▎         | 5/142 [00:02<01:10,  1.95it/s]Running loglikelihood requests:   5%|▍         | 7/142 [00:03<01:01,  2.20it/s]Running loglikelihood requests:   6%|▋         | 9/142 [00:04<00:56,  2.37it/s]Running loglikelihood requests:   8%|▊         | 11/142 [00:05<00:52,  2.50it/s]Running loglikelihood requests:   9%|▉         | 13/142 [00:05<00:49,  2.60it/s]Running loglikelihood requests:  11%|█         | 15/142 [00:06<00:46,  2.70it/s]Running loglikelihood requests:  12%|█▏        | 17/142 [00:07<00:45,  2.74it/s]Running loglikelihood requests:  13%|█▎        | 19/142 [00:07<00:43,  2.82it/s]Running loglikelihood requests:  15%|█▍        | 21/142 [00:08<00:41,  2.89it/s]Running loglikelihood requests:  16%|█▌        | 23/142 [00:09<00:40,  2.96it/s]Running loglikelihood requests:  18%|█▊        | 25/142 [00:09<00:38,  3.02it/s]Running loglikelihood requests:  19%|█▉        | 27/142 [00:10<00:37,  3.08it/s]Running loglikelihood requests:  20%|██        | 29/142 [00:11<00:36,  3.12it/s]Running loglikelihood requests:  22%|██▏       | 31/142 [00:11<00:35,  3.15it/s]Running loglikelihood requests:  23%|██▎       | 33/142 [00:12<00:34,  3.18it/s]Running loglikelihood requests:  25%|██▍       | 35/142 [00:12<00:33,  3.18it/s]Running loglikelihood requests:  26%|██▌       | 37/142 [00:13<00:32,  3.19it/s]Running loglikelihood requests:  27%|██▋       | 39/142 [00:14<00:31,  3.24it/s]Running loglikelihood requests:  29%|██▉       | 41/142 [00:14<00:30,  3.27it/s]Running loglikelihood requests:  30%|███       | 43/142 [00:15<00:29,  3.31it/s]Running loglikelihood requests:  32%|███▏      | 45/142 [00:15<00:28,  3.36it/s]Running loglikelihood requests:  33%|███▎      | 47/142 [00:16<00:27,  3.40it/s]Running loglikelihood requests:  35%|███▍      | 49/142 [00:17<00:26,  3.45it/s]Running loglikelihood requests:  36%|███▌      | 51/142 [00:17<00:25,  3.50it/s]Running loglikelihood requests:  37%|███▋      | 53/142 [00:18<00:25,  3.54it/s]Running loglikelihood requests:  39%|███▊      | 55/142 [00:18<00:24,  3.57it/s]Running loglikelihood requests:  40%|████      | 57/142 [00:19<00:23,  3.59it/s]Running loglikelihood requests:  42%|████▏     | 59/142 [00:19<00:22,  3.61it/s]Running loglikelihood requests:  43%|████▎     | 61/142 [00:20<00:22,  3.63it/s]Running loglikelihood requests:  44%|████▍     | 63/142 [00:20<00:21,  3.64it/s]Running loglikelihood requests:  46%|████▌     | 65/142 [00:21<00:21,  3.65it/s]Running loglikelihood requests:  47%|████▋     | 67/142 [00:21<00:20,  3.66it/s]Running loglikelihood requests:  49%|████▊     | 69/142 [00:22<00:19,  3.68it/s]Running loglikelihood requests:  50%|█████     | 71/142 [00:23<00:19,  3.69it/s]Running loglikelihood requests:  51%|█████▏    | 73/142 [00:23<00:18,  3.71it/s]Running loglikelihood requests:  53%|█████▎    | 75/142 [00:24<00:18,  3.72it/s]Running loglikelihood requests:  54%|█████▍    | 77/142 [00:24<00:17,  3.73it/s]Running loglikelihood requests:  56%|█████▌    | 79/142 [00:25<00:16,  3.74it/s]Running loglikelihood requests:  57%|█████▋    | 81/142 [00:25<00:16,  3.75it/s]Running loglikelihood requests:  58%|█████▊    | 83/142 [00:26<00:15,  3.76it/s]Running loglikelihood requests:  60%|█████▉    | 85/142 [00:26<00:15,  3.76it/s]Running loglikelihood requests:  61%|██████▏   | 87/142 [00:27<00:14,  3.78it/s]Running loglikelihood requests:  63%|██████▎   | 89/142 [00:27<00:13,  3.79it/s]Running loglikelihood requests:  64%|██████▍   | 91/142 [00:28<00:13,  3.79it/s]Running loglikelihood requests:  65%|██████▌   | 93/142 [00:28<00:12,  3.80it/s]Running loglikelihood requests:  67%|██████▋   | 95/142 [00:29<00:12,  3.81it/s]Running loglikelihood requests:  68%|██████▊   | 97/142 [00:29<00:11,  3.82it/s]Running loglikelihood requests:  70%|██████▉   | 99/142 [00:30<00:11,  3.83it/s]Running loglikelihood requests:  71%|███████   | 101/142 [00:30<00:10,  3.84it/s]Running loglikelihood requests:  73%|███████▎  | 103/142 [00:31<00:10,  3.85it/s]Running loglikelihood requests:  74%|███████▍  | 105/142 [00:31<00:09,  3.86it/s]Running loglikelihood requests:  75%|███████▌  | 107/142 [00:32<00:09,  3.87it/s]Running loglikelihood requests:  77%|███████▋  | 109/142 [00:33<00:08,  3.88it/s]Running loglikelihood requests:  78%|███████▊  | 111/142 [00:33<00:07,  3.89it/s]Running loglikelihood requests:  80%|███████▉  | 113/142 [00:34<00:07,  3.91it/s]Running loglikelihood requests:  81%|████████  | 115/142 [00:34<00:06,  3.92it/s]Running loglikelihood requests:  82%|████████▏ | 117/142 [00:35<00:06,  3.92it/s]Running loglikelihood requests:  84%|████████▍ | 119/142 [00:35<00:05,  3.94it/s]Running loglikelihood requests:  85%|████████▌ | 121/142 [00:36<00:05,  3.95it/s]Running loglikelihood requests:  87%|████████▋ | 123/142 [00:36<00:04,  3.97it/s]Running loglikelihood requests:  88%|████████▊ | 125/142 [00:37<00:04,  3.98it/s]Running loglikelihood requests:  89%|████████▉ | 127/142 [00:37<00:03,  3.99it/s]Running loglikelihood requests:  91%|█████████ | 129/142 [00:38<00:03,  4.01it/s]Running loglikelihood requests:  92%|█████████▏| 131/142 [00:38<00:02,  4.02it/s]Running loglikelihood requests:  94%|█████████▎| 133/142 [00:39<00:02,  4.04it/s]Running loglikelihood requests:  95%|█████████▌| 135/142 [00:39<00:01,  4.07it/s]Running loglikelihood requests:  96%|█████████▋| 137/142 [00:39<00:01,  4.10it/s]Running loglikelihood requests:  98%|█████████▊| 139/142 [00:40<00:00,  4.12it/s]Running loglikelihood requests:  99%|█████████▉| 141/142 [00:40<00:00,  4.17it/s]Running loglikelihood requests: 100%|██████████| 142/142 [00:40<00:00,  3.47it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'wnli': {'alias': 'wnli', 'acc,none': 0.5352112676056338, 'acc_stderr,none': 0.0596130578497224}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.31190044950254875
0.7306280553786256
0.6985925052465822
0.5843516732063875
0.8124235844589114
0.820438203921003
0.6253838264581936
0.7600037006947045
0.8225872978677496
0.708398461303215
0.8646089269479391
0.8239362351853257
0.7608099850331435
0.6657423857513638
0.7943257460202938
0.7511476003698512
0.9073696655228775
0.8741838353767599
0.7945799099309127
0.9323691001541556
0.865243808509542
0.8176606226311932
0.6785099625983169
0.9579534328203848
0.788928884938056
0.9833718962298513
0.5933012307657521
0.7829988799240639
0.7823073743206628
0.31190044950254875
0.7306280553786256
0.6985925052465822
0.5843516732063875
0.8124235844589114
0.820438203921003
0.6253838264581936
0.7600037006947045
0.8225872978677496
0.708398461303215
0.8646089269479391
0.8239362351853257
0.7608099850331435
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 4, 5, 1, 6, 3, 2, 0]
tensor([7, 4, 5, 1, 6, 3, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 4, 5, 6, 1, 0, 3]
tensor([7, 2, 4, 5, 6, 1, 0, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 5, 4, 1, 2, 0]
tensor([6, 3, 7, 5, 4, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 6, 4, 7, 1, 2, 0]
tensor([5, 3, 6, 4, 7, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 3, 6, 5, 7, 2, 1, 0]
tensor([4, 3, 6, 5, 7, 2, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 2, 3, 2, 3, 0]
tensor([0, 1, 1, 2, 3, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 1, 2, 2, 3, 0, 3, 1]
tensor([0, 1, 2, 2, 3, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 1, 1, 1.0, 1.0, 1.0, 1.0]
tensor([0, 0, 1, 1, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 5 to 15
done!
Normal merging for layer 16
tensor([0, 7])
tensor(0)
tensor([1, 2])
tensor(1)
tensor([3, 5])
tensor(3)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 17
tensor([0, 5])
tensor(0)
tensor([1, 7])
tensor(1)
tensor([2, 3])
tensor(2)
tensor([4, 6])
tensor(4)
done!
Cross-layer merge completed for layers 18 to 30
done!
Normal merging for layer 31
tensor([0, 1])
tensor(0)
tensor([2, 3, 4, 5, 6, 7])
tensor(2)
done!
all done!
Model size: 12.2608 GB
163
cuda:2
qqp
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:41<00:41, 41.23s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 24.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:54<00:00, 27.12s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 307 140
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 200 355
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140481071873968 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140481071873968 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481071873968 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140481071873968 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140482880076448 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482880076448 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482880076448 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140482880076448 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qqp from None to 0
INFO:lm_eval.api.task:Building contexts for qqp on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2421.49it/s]
DEBUG:lm_eval.evaluator:Task: qqp; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:33,  1.37s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:11,  1.50it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:40,  1.94it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:27,  2.20it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:20,  2.37it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:15,  2.50it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:05<01:12,  2.59it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:09,  2.66it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:07,  2.71it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:07<01:05,  2.75it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:04,  2.79it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:02,  2.83it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<01:00,  2.87it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<00:59,  2.90it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<00:58,  2.93it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<00:57,  2.95it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:12<00:56,  2.97it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<00:55,  2.98it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:14<00:54,  3.00it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:14<00:53,  3.01it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:15<00:52,  3.01it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:16<00:52,  3.02it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:16<00:50,  3.04it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:17<00:49,  3.08it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:17<00:48,  3.11it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:18<00:47,  3.14it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:19<00:46,  3.16it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:19<00:45,  3.18it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:20<00:44,  3.20it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:21<00:43,  3.21it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:21<00:43,  3.22it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:22<00:42,  3.23it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:22<00:41,  3.24it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:23<00:41,  3.19it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:24<00:41,  3.19it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:24<00:40,  3.18it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:25<00:40,  3.15it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:26<00:39,  3.17it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:26<00:38,  3.20it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:27<00:37,  3.22it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:27<00:36,  3.24it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:28<00:35,  3.26it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:29<00:35,  3.27it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:29<00:34,  3.28it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:30<00:33,  3.29it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:30<00:33,  3.30it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:31<00:32,  3.32it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:32<00:31,  3.33it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:32<00:30,  3.34it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:33<00:30,  3.35it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:33<00:29,  3.36it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:34<00:28,  3.37it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:35<00:28,  3.38it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:35<00:27,  3.40it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:36<00:26,  3.40it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:36<00:26,  3.42it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:37<00:25,  3.44it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:37<00:25,  3.39it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:38<00:24,  3.35it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:39<00:23,  3.40it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:39<00:22,  3.44it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:40<00:22,  3.46it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:40<00:21,  3.48it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:41<00:20,  3.50it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:41<00:20,  3.52it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:42<00:19,  3.54it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:43<00:18,  3.55it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:43<00:18,  3.56it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:44<00:17,  3.56it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:44<00:17,  3.57it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:45<00:16,  3.57it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:45<00:15,  3.58it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:46<00:15,  3.59it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:46<00:14,  3.60it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:47<00:14,  3.60it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:48<00:13,  3.62it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:48<00:12,  3.62it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:49<00:12,  3.64it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:49<00:11,  3.66it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:50<00:11,  3.67it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:50<00:10,  3.67it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:51<00:10,  3.68it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:51<00:09,  3.68it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:52<00:08,  3.70it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:52<00:08,  3.71it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:53<00:07,  3.72it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:54<00:07,  3.72it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:54<00:06,  3.73it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:55<00:06,  3.74it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:55<00:05,  3.68it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:56<00:05,  3.68it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:56<00:04,  3.67it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:57<00:04,  3.67it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:57<00:03,  3.64it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:58<00:02,  3.68it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:58<00:02,  3.74it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [00:59<00:01,  3.78it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [00:59<00:01,  3.81it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:00<00:00,  3.85it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:00<00:00,  3.89it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:00<00:00,  3.28it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:58,  1.19s/it]  2%|▏         | 2/100 [00:02<01:58,  1.21s/it]  3%|▎         | 3/100 [00:03<01:56,  1.20s/it]  4%|▍         | 4/100 [00:04<01:55,  1.21s/it]  5%|▌         | 5/100 [00:06<01:54,  1.21s/it]  6%|▌         | 6/100 [00:07<01:53,  1.21s/it]  7%|▋         | 7/100 [00:08<01:52,  1.21s/it]  8%|▊         | 8/100 [00:09<01:52,  1.22s/it]  9%|▉         | 9/100 [00:10<01:51,  1.22s/it] 10%|█         | 10/100 [00:12<01:50,  1.22s/it] 11%|█         | 11/100 [00:13<01:48,  1.22s/it] 12%|█▏        | 12/100 [00:14<01:46,  1.21s/it] 13%|█▎        | 13/100 [00:15<01:45,  1.21s/it] 14%|█▍        | 14/100 [00:16<01:43,  1.21s/it] 15%|█▌        | 15/100 [00:18<01:43,  1.22s/it] 16%|█▌        | 16/100 [00:19<01:41,  1.21s/it] 17%|█▋        | 17/100 [00:20<01:41,  1.22s/it] 18%|█▊        | 18/100 [00:21<01:39,  1.21s/it] 19%|█▉        | 19/100 [00:23<01:37,  1.21s/it] 20%|██        | 20/100 [00:24<01:36,  1.21s/it] 21%|██        | 21/100 [00:25<01:35,  1.21s/it] 22%|██▏       | 22/100 [00:26<01:34,  1.21s/it] 23%|██▎       | 23/100 [00:27<01:32,  1.21s/it] 24%|██▍       | 24/100 [00:29<01:31,  1.21s/it] 25%|██▌       | 25/100 [00:30<01:30,  1.21s/it] 26%|██▌       | 26/100 [00:31<01:29,  1.21s/it] 27%|██▋       | 27/100 [00:32<01:28,  1.21s/it] 28%|██▊       | 28/100 [00:33<01:26,  1.21s/it] 29%|██▉       | 29/100 [00:35<01:25,  1.21s/it] 30%|███       | 30/100 [00:36<01:24,  1.21s/it] 31%|███       | 31/100 [00:37<01:23,  1.20s/it] 32%|███▏      | 32/100 [00:38<01:21,  1.21s/it] 33%|███▎      | 33/100 [00:39<01:20,  1.21s/it] 34%|███▍      | 34/100 [00:41<01:19,  1.21s/it] 35%|███▌      | 35/100 [00:42<01:18,  1.21s/it] 36%|███▌      | 36/100 [00:43<01:17,  1.21s/it] 37%|███▋      | 37/100 [00:44<01:16,  1.21s/it] 38%|███▊      | 38/100 [00:45<01:15,  1.21s/it] 39%|███▉      | 39/100 [00:47<01:13,  1.21s/it] 40%|████      | 40/100 [00:48<01:12,  1.21s/it] 41%|████      | 41/100 [00:49<01:11,  1.21s/it] 42%|████▏     | 42/100 [00:50<01:10,  1.21s/it] 43%|████▎     | 43/100 [00:52<01:08,  1.21s/it] 44%|████▍     | 44/100 [00:53<01:08,  1.22s/it] 45%|████▌     | 45/100 [00:54<01:06,  1.21s/it] 46%|████▌     | 46/100 [00:55<01:05,  1.21s/it] 47%|████▋     | 47/100 [00:56<01:04,  1.21s/it] 48%|████▊     | 48/100 [00:58<01:02,  1.21s/it] 49%|████▉     | 49/100 [00:59<01:01,  1.21s/it] 50%|█████     | 50/100 [01:00<01:00,  1.22s/it] 51%|█████     | 51/100 [01:01<00:59,  1.22s/it] 52%|█████▏    | 52/100 [01:02<00:58,  1.21s/it] 53%|█████▎    | 53/100 [01:04<00:56,  1.21s/it] 54%|█████▍    | 54/100 [01:05<00:55,  1.21s/it] 55%|█████▌    | 55/100 [01:06<00:54,  1.21s/it] 56%|█████▌    | 56/100 [01:07<00:53,  1.21s/it] 57%|█████▋    | 57/100 [01:09<00:52,  1.21s/it] 58%|█████▊    | 58/100 [01:10<00:50,  1.21s/it] 59%|█████▉    | 59/100 [01:11<00:49,  1.21s/it] 60%|██████    | 60/100 [01:12<00:48,  1.21s/it] 61%|██████    | 61/100 [01:13<00:47,  1.21s/it] 62%|██████▏   | 62/100 [01:15<00:46,  1.21s/it] 63%|██████▎   | 63/100 [01:16<00:44,  1.21s/it] 64%|██████▍   | 64/100 [01:17<00:43,  1.21s/it] 65%|██████▌   | 65/100 [01:18<00:42,  1.21s/it] 66%|██████▌   | 66/100 [01:19<00:41,  1.21s/it] 67%|██████▋   | 67/100 [01:21<00:39,  1.21s/it] 68%|██████▊   | 68/100 [01:22<00:38,  1.21s/it] 69%|██████▉   | 69/100 [01:23<00:37,  1.21s/it] 70%|███████   | 70/100 [01:24<00:36,  1.21s/it] 71%|███████   | 71/100 [01:25<00:35,  1.21s/it] 72%|███████▏  | 72/100 [01:27<00:33,  1.21s/it] 73%|███████▎  | 73/100 [01:28<00:32,  1.21s/it] 74%|███████▍  | 74/100 [01:29<00:31,  1.21s/it] 75%|███████▌  | 75/100 [01:30<00:30,  1.21s/it] 76%|███████▌  | 76/100 [01:32<00:29,  1.21s/it] 77%|███████▋  | 77/100 [01:33<00:27,  1.21s/it] 78%|███████▊  | 78/100 [01:34<00:26,  1.21s/it] 79%|███████▉  | 79/100 [01:35<00:25,  1.21s/it] 80%|████████  | 80/100 [01:36<00:24,  1.21s/it] 81%|████████  | 81/100 [01:38<00:22,  1.21s/it] 82%|████████▏ | 82/100 [01:39<00:21,  1.21s/it] 83%|████████▎ | 83/100 [01:40<00:20,  1.21s/it] 84%|████████▍ | 84/100 [01:41<00:19,  1.21s/it] 85%|████████▌ | 85/100 [01:42<00:18,  1.21s/it] 86%|████████▌ | 86/100 [01:44<00:16,  1.21s/it] 87%|████████▋ | 87/100 [01:45<00:15,  1.21s/it] 88%|████████▊ | 88/100 [01:46<00:14,  1.21s/it] 89%|████████▉ | 89/100 [01:47<00:13,  1.21s/it] 90%|█████████ | 90/100 [01:48<00:12,  1.21s/it] 91%|█████████ | 91/100 [01:50<00:10,  1.21s/it] 92%|█████████▏| 92/100 [01:51<00:09,  1.21s/it] 93%|█████████▎| 93/100 [01:52<00:08,  1.21s/it] 94%|█████████▍| 94/100 [01:53<00:07,  1.21s/it] 95%|█████████▌| 95/100 [01:55<00:06,  1.21s/it] 96%|█████████▌| 96/100 [01:56<00:04,  1.21s/it] 97%|█████████▋| 97/100 [01:57<00:03,  1.21s/it] 98%|█████████▊| 98/100 [01:58<00:02,  1.21s/it] 99%|█████████▉| 99/100 [01:59<00:01,  1.22s/it]100%|██████████| 100/100 [02:01<00:00,  1.22s/it]100%|██████████| 100/100 [02:01<00:00,  1.21s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'qqp': {'alias': 'qqp', 'acc,none': 0.3, 'acc_stderr,none': 0.04605661864718382, 'f1,none': np.float64(0.46153846153846156), 'f1_stderr,none': 0.05409397997448054}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
0.5983336442242687
0.5414593978662989
0.3299447012562784
0.4799857918750434
0.8524920468933548
0.713165518996795
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 5, 2, 6, 1, 3, 0]
tensor([7, 4, 5, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 4, 5, 2, 7, 3, 0, 1]
tensor([6, 4, 5, 2, 7, 3, 0, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 7, 4, 2, 5, 0, 1, 3]
tensor([6, 7, 4, 2, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 6, 4, 3, 7, 1, 0, 2]
tensor([5, 6, 4, 3, 7, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 31
done!
all done!
Model size: 12.1348 GB
213
cuda:3
eq_bench
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:45<00:45, 45.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:59<00:00, 26.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:59<00:00, 29.66s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:eq_bench: No `until` specified in `generation_kwargs`! Defaulting to the fewshot_delimiter='\n\n'
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/pbevan11/EQ-Bench/pbevan11/EQ-Bench.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/revision/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3 HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3?recursive=False&expand=False HTTP/1.1" 200 301
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/revision/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3 HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_infos.json HTTP/1.1" 404 0
DEBUG:filelock:Attempting to acquire lock 140482878271136 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 140482878271136 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 140482878271136 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 140482878271136 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Attempting to acquire lock 140476672508656 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 140476672508656 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 140476672508656 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 140476672508656 released on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:eq_bench: Using gen_kwargs: {'do_sample': False, 'temperature': 0.0, 'max_gen_toks': 80, 'until': ['\n\n']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of eq_bench from None to 0
INFO:lm_eval.api.task:Building contexts for eq_bench on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 88975.48it/s]
DEBUG:lm_eval.evaluator:Task: eq_bench; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:08<13:44,  8.32s/it]Running generate_until requests:   2%|▏         | 2/100 [00:15<12:33,  7.69s/it]Running generate_until requests:   3%|▎         | 3/100 [00:22<11:56,  7.38s/it]Running generate_until requests:   4%|▍         | 4/100 [00:29<11:41,  7.31s/it]Running generate_until requests:   5%|▌         | 5/100 [00:36<11:19,  7.15s/it]Running generate_until requests:   6%|▌         | 6/100 [00:43<11:01,  7.03s/it]Running generate_until requests:   7%|▋         | 7/100 [00:49<10:36,  6.84s/it]Running generate_until requests:   8%|▊         | 8/100 [00:56<10:16,  6.70s/it]Running generate_until requests:   9%|▉         | 9/100 [01:03<10:22,  6.84s/it]Running generate_until requests:  10%|█         | 10/100 [01:09<10:03,  6.71s/it]Running generate_until requests:  11%|█         | 11/100 [01:16<09:50,  6.63s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:23<10:02,  6.84s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:30<09:53,  6.83s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:37<09:41,  6.76s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:43<09:33,  6.74s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:50<09:14,  6.60s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:56<09:00,  6.51s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:02<08:46,  6.42s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:08<08:38,  6.40s/it]Running generate_until requests:  20%|██        | 20/100 [02:15<08:26,  6.33s/it]Running generate_until requests:  21%|██        | 21/100 [02:21<08:22,  6.36s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:27<08:16,  6.37s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:34<08:10,  6.37s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:40<08:03,  6.37s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:47<08:14,  6.59s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:53<07:59,  6.49s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:00<07:44,  6.37s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:06<07:40,  6.40s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:12<07:34,  6.40s/it]Running generate_until requests:  30%|███       | 30/100 [03:19<07:25,  6.37s/it]Running generate_until requests:  31%|███       | 31/100 [03:25<07:12,  6.26s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:32<07:16,  6.42s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:38<07:04,  6.33s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:44<06:53,  6.26s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:50<06:43,  6.20s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:56<06:29,  6.08s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:02<06:25,  6.12s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:08<06:13,  6.03s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:14<06:08,  6.04s/it]Running generate_until requests:  40%|████      | 40/100 [04:19<05:57,  5.96s/it]Running generate_until requests:  41%|████      | 41/100 [04:26<06:02,  6.14s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:32<05:56,  6.15s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:38<05:44,  6.04s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:44<05:36,  6.00s/it]Running generate_until requests:  45%|████▌     | 45/100 [04:50<05:27,  5.95s/it]Running generate_until requests:  46%|████▌     | 46/100 [04:56<05:26,  6.04s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:02<05:26,  6.17s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:08<05:14,  6.05s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:14<05:05,  6.00s/it]Running generate_until requests:  50%|█████     | 50/100 [05:20<05:02,  6.05s/it]Running generate_until requests:  51%|█████     | 51/100 [05:26<04:51,  5.95s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:32<04:44,  5.92s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:37<04:32,  5.80s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:43<04:27,  5.81s/it]Running generate_until requests:  55%|█████▌    | 55/100 [05:49<04:15,  5.69s/it]Running generate_until requests:  56%|█████▌    | 56/100 [05:54<04:07,  5.63s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:00<04:05,  5.70s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:06<03:58,  5.67s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:11<03:53,  5.70s/it]Running generate_until requests:  60%|██████    | 60/100 [06:17<03:48,  5.71s/it]Running generate_until requests:  61%|██████    | 61/100 [06:23<03:44,  5.75s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:29<03:40,  5.81s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:34<03:30,  5.70s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:40<03:23,  5.65s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:45<03:17,  5.64s/it]Running generate_until requests:  66%|██████▌   | 66/100 [06:48<02:35,  4.58s/it]Running generate_until requests:  67%|██████▋   | 67/100 [06:53<02:40,  4.85s/it]Running generate_until requests:  68%|██████▊   | 68/100 [06:59<02:44,  5.16s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:04<02:44,  5.29s/it]Running generate_until requests:  70%|███████   | 70/100 [07:10<02:39,  5.33s/it]Running generate_until requests:  71%|███████   | 71/100 [07:12<02:05,  4.33s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:18<02:14,  4.81s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:20<01:47,  3.96s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:25<01:53,  4.36s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:30<01:54,  4.59s/it]Running generate_until requests:  76%|███████▌  | 76/100 [07:35<01:54,  4.77s/it]Running generate_until requests:  77%|███████▋  | 77/100 [07:41<01:54,  4.97s/it]Running generate_until requests:  78%|███████▊  | 78/100 [07:46<01:52,  5.11s/it]Running generate_until requests:  79%|███████▉  | 79/100 [07:52<01:49,  5.22s/it]Running generate_until requests:  80%|████████  | 80/100 [07:57<01:45,  5.26s/it]Running generate_until requests:  81%|████████  | 81/100 [08:02<01:40,  5.28s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:08<01:35,  5.29s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:13<01:29,  5.26s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:18<01:24,  5.28s/it]Running generate_until requests:  85%|████████▌ | 85/100 [08:24<01:20,  5.36s/it]Running generate_until requests:  86%|████████▌ | 86/100 [08:29<01:15,  5.37s/it]Running generate_until requests:  87%|████████▋ | 87/100 [08:31<00:56,  4.32s/it]Running generate_until requests:  88%|████████▊ | 88/100 [08:37<00:56,  4.73s/it]Running generate_until requests:  89%|████████▉ | 89/100 [08:42<00:54,  4.97s/it]Running generate_until requests:  90%|█████████ | 90/100 [08:48<00:51,  5.18s/it]Running generate_until requests:  91%|█████████ | 91/100 [08:53<00:46,  5.20s/it]Running generate_until requests:  92%|█████████▏| 92/100 [08:59<00:41,  5.23s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:04<00:36,  5.18s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:09<00:31,  5.21s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:14<00:25,  5.19s/it]Running generate_until requests:  96%|█████████▌| 96/100 [09:16<00:16,  4.20s/it]Running generate_until requests:  97%|█████████▋| 97/100 [09:18<00:10,  3.46s/it]Running generate_until requests:  98%|█████████▊| 98/100 [09:23<00:07,  3.95s/it]Running generate_until requests:  99%|█████████▉| 99/100 [09:28<00:04,  4.32s/it]Running generate_until requests: 100%|██████████| 100/100 [09:33<00:00,  4.54s/it]Running generate_until requests: 100%|██████████| 100/100 [09:33<00:00,  5.73s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'eq_bench': {'alias': 'eq_bench', 'eqbench,none': -9.075457665929516, 'eqbench_stderr,none': 3.722206958756126, 'percent_parseable,none': 94.0, 'percent_parseable_stderr,none': 2.3868325657594203}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6639018561214101
0.48429197946127234
0.9515491395508957
0.5799692129526803
0.8892832964569847
0.5583880670373075
0.6815933931575056
0.8296184325732159
0.8572432652494972
0.7515568516065031
0.7498285715344476
0.6640770908835784
0.7344737024966144
0.8863376660708159
0.7840365418395101
0.7895254515113318
0.915557892351788
0.8364869594903738
0.8262221986876632
0.8424210311799578
0.9059689119946415
0.938938460185247
0.9139805997979817
0.8791150946846779
0.9604433557463424
0.36429086085480555
0.6224935475213342
0.9367462541020114
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[2, 3, 7, 0, 6, 1, 5, 4]
tensor([2, 3, 7, 0, 6, 1, 5, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 2, 1, 6, 0, 3, 7]
tensor([4, 5, 2, 1, 6, 0, 3, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 7, 1, 2, 6]
tensor([5, 3, 4, 0, 7, 1, 2, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 6, 4, 0, 3, 1, 2, 7]
tensor([5, 6, 4, 0, 3, 1, 2, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 2, 3]
tensor([0, 1, 3, 0, 1, 2, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 0, 1, 1, 2, 3]
tensor([2, 3, 0, 0, 1, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 3, 1, 2, 3]
tensor([2, 0, 1, 0, 3, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 2, 1, 3, 3]
tensor([2, 0, 1, 0, 2, 1, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 6 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
tensor([2, 7])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 18
done!
Normal merging for layer 19
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
tensor([1, 7])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 6])
tensor(0)
tensor([4, 7])
tensor(4)
done!
Normal merging for layer 21
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 4])
tensor(0)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 22 to 24
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 29
done!
Normal merging for layer 30
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
all done!
Model size: 12.7017 GB
185
cuda:4
sciq
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:43<00:43, 43.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 25.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 28.49s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1230
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/sciq/sciq.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140481474686384 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140481474686384 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140481474686384 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140481474686384 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Attempting to acquire lock 140476672516960 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140476672516960 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140476672516960 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140476672516960 released on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of sciq from None to 0
INFO:lm_eval.api.task:Building contexts for sciq on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1036.60it/s]
DEBUG:lm_eval.evaluator:Task: sciq; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:04<27:18,  4.11s/it]Running loglikelihood requests:   0%|          | 2/400 [00:07<24:57,  3.76s/it]Running loglikelihood requests:   1%|          | 3/400 [00:11<24:08,  3.65s/it]Running loglikelihood requests:   1%|          | 4/400 [00:14<23:45,  3.60s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:17<22:59,  3.49s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:21<22:30,  3.43s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:24<22:11,  3.39s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:27<21:56,  3.36s/it]