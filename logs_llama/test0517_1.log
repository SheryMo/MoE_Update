nohup: ignoring input
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
网络架构：{'220': ['164', '227', '18', '101', '69', '19', '253', '216', '180', '4', '113', '139', '52', '132', '191', '202', '55', '231', '92', '99', '48', '195', '228', '15', '63', '116', '176', '186', '189', '170', '83'], '180': ['228', '191', '132', '83', '92', '186', '176', '139', '195', '69', '164', '15', '55', '18', '48', '170', '19', '216', '99', '189', '231', '116', '52', '220', '253', '227', '4', '113', '202', '63', '101'], '83': ['180', '15', '99', '195', '253', '92', '55', '101', '186', '63', '48', '220', '4', '189', '19', '164', '227', '116', '191', '176', '132', '113', '18', '228', '139', '69', '170', '231', '202', '52', '216'], '113': ['52', '191', '164', '55', '231', '69', '4', '18', '83', '92', '180', '186', '63', '228', '253', '101', '132', '220', '216', '116', '15', '170', '202', '48', '195', '189', '139', '19', '176', '227', '99'], '231': ['19', '191', '63', '139', '55', '4', '15', '189', '180', '48', '92', '101', '132', '170', '220', '113', '69', '176', '216', '253', '83', '52', '164', '116', '99', '195', '186', '18', '202', '228', '227'], '52': ['170', '176', '113', '164', '227', '253', '180', '228', '83', '189', '139', '132', '63', '55', '220', '69', '216', '101', '191', '48', '116', '195', '202', '231', '15', '99', '19', '18', '92', '186', '4'], '228': ['164', '176', '48', '220', '227', '116', '99', '19', '186', '92', '132', '253', '63', '139', '216', '101', '69', '170', '191', '18', '55', '15', '52', '4', '202', '195', '189', '180', '83', '231', '113'], '69': ['227', '101', '48', '189', '164', '18', '116', '52', '4', '170', '19', '231', '216', '83', '180', '186', '15', '220', '228', '55', '139', '63', '113', '132', '195', '99', '176', '191', '253', '202', '92'], '216': ['55', '113', '180', '170', '164', '52', '195', '15', '83', '18', '92', '139', '132', '176', '228', '69', '202', '101', '227', '116', '186', '231', '19', '191', '253', '48', '99', '4', '63', '189', '220'], '253': ['186', '227', '83', '48', '180', '139', '116', '55', '99', '195', '189', '164', '170', '101', '18', '228', '132', '176', '113', '191', '220', '52', '216', '63', '4', '19', '202', '69', '231', '92', '15'], '55': ['18', '52', '228', '113', '176', '63', '220', '132', '253', '99', '170', '19', '186', '231', '139', '48', '189', '4', '69', '180', '227', '164', '195', '191', '101', '83', '15', '116', '202', '92', '216'], '195': ['216', '83', '69', '220', '19', '52', '202', '116', '101', '186', '55', '227', '113', '191', '228', '164', '231', '253', '170', '92', '48', '132', '15', '4', '99', '18', '63', '180', '176', '189', '139'], '48': ['231', '195', '191', '116', '228', '55', '4', '52', '18', '101', '176', '99', '227', '216', '113', '132', '170', '19', '180', '83', '63', '15', '69', '189', '202', '253', '139', '92', '164', '186', '220'], '92': ['4', '231', '176', '48', '116', '180', '195', '220', '132', '253', '52', '189', '228', '83', '216', '227', '18', '55', '202', '19', '63', '101', '69', '191', '164', '186', '15', '99', '113', '139', '170'], '164': ['228', '63', '52', '231', '132', '180', '253', '216', '113', '191', '195', '18', '170', '220', '15', '189', '186', '4', '92', '69', '83', '48', '176', '55', '227', '19', '101', '139', '202', '99', '116'], '191': ['4', '231', '176', '164', '69', '227', '99', '48', '132', '83', '216', '101', '189', '139', '52', '92', '18', '202', '186', '15', '55', '228', '253', '220', '195', '180', '19', '63', '116', '113', '170'], '15': ['83', '48', '180', '191', '216', '99', '18', '116', '55', '220', '132', '170', '69', '4', '19', '139', '189', '253', '186', '101', '63', '113', '202', '231', '92', '228', '195', '176', '164', '227', '52'], '186': ['202', '195', '139', '231', '176', '92', '253', '48', '170', '18', '113', '4', '15', '132', '55', '19', '189', '69', '216', '116', '83', '101', '52', '228', '164', '227', '220', '63', '180', '99', '191'], '63': ['220', '99', '48', '132', '18', '139', '191', '19', '113', '101', '231', '202', '116', '186', '176', '253', '164', '170', '69', '195', '228', '52', '189', '15', '83', '216', '92', '180', '227', '55', '4'], '189': ['253', '220', '227', '55', '139', '170', '48', '164', '186', '180', '19', '216', '191', '132', '69', '202', '228', '99', '113', '83', '52', '92', '176', '101', '4', '116', '15', '63', '18', '195', '231'], '202': ['15', '228', '139', '164', '55', '186', '220', '216', '231', '195', '69', '83', '19', '180', '227', '253', '18', '191', '132', '113', '116', '52', '170', '101', '99', '92', '63', '176', '4', '189', '48'], '4': ['19', '216', '176', '170', '132', '191', '231', '101', '55', '202', '195', '139', '180', '253', '189', '92', '220', '48', '83', '164', '186', '116', '52', '227', '69', '63', '15', '113', '99', '228', '18'], '116': ['231', '176', '15', '4', '63', '101', '216', '220', '164', '69', '132', '195', '18', '92', '189', '99', '170', '191', '52', '202', '180', '186', '19', '83', '227', '113', '139', '48', '253', '228', '55'], '19': ['116', '195', '63', '227', '48', '55', '132', '170', '52', '176', '92', '113', '191', '231', '180', '18', '216', '83', '15', '202', '220', '164', '253', '186', '4', '69', '101', '139', '99', '189', '228'], '170': ['228', '4', '113', '216', '19', '48', '15', '69', '101', '116', '139', '18', '63', '92', '195', '191', '52', '253', '55', '189', '220', '132', '176', '180', '186', '231', '164', '99', '202', '227', '83'], '176': ['132', '139', '202', '191', '228', '195', '180', '216', '220', '189', '170', '18', '15', '69', '48', '19', '116', '55', '63', '113', '227', '99', '231', '164', '101', '4', '52', '253', '92', '186', '83'], '139': ['101', '19', '116', '69', '132', '18', '216', '191', '15', '63', '176', '195', '227', '113', '48', '189', '253', '186', '170', '92', '202', '55', '228', '180', '231', '52', '164', '4', '220', '83', '99'], '101': ['19', '170', '164', '113', '83', '216', '139', '231', '52', '4', '180', '48', '92', '116', '189', '227', '195', '99', '55', '253', '63', '132', '186', '69', '202', '220', '191', '15', '176', '228', '18'], '18': ['253', '69', '52', '202', '4', '113', '176', '101', '186', '170', '15', '139', '83', '216', '19', '116', '227', '220', '99', '231', '195', '180', '55', '191', '228', '92', '189', '48', '63', '132', '164'], '99': ['253', '227', '63', '195', '220', '228', '191', '19', '4', '15', '55', '52', '189', '18', '180', '101', '132', '170', '92', '176', '231', '164', '139', '202', '113', '69', '48', '186', '216', '83', '116'], '132': ['220', '92', '48', '180', '228', '191', '253', '202', '15', '101', '99', '170', '19', '63', '186', '164', '52', '18', '189', '216', '195', '113', '139', '4', '116', '55', '83', '176', '227', '231', '69'], '227': ['220', '231', '55', '116', '191', '164', '52', '101', '69', '18', '253', '92', '195', '216', '113', '83', '139', '180', '99', '176', '4', '15', '48', '132', '19', '202', '189', '186', '63', '228', '170']}
220
cuda:0
rte
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.95s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 307 136
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 200 530
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 307 139
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 200 231
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/rte?recursive=False&expand=False HTTP/1.1" 307 140
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/rte?recursive=False&expand=False HTTP/1.1" 200 354
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139673639233792 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139673639233792 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139673639233792 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139673639233792 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139673635695040 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139673635695040 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139673635695040 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139673635695040 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of rte from None to 0
INFO:lm_eval.api.task:Building contexts for rte on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1967.35it/s]
DEBUG:lm_eval.evaluator:Task: rte; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:03<12:46,  3.85s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:05<04:59,  1.52s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:06<03:26,  1.06s/it]Running loglikelihood requests:   4%|▎         | 7/200 [00:07<02:45,  1.17it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:08<02:24,  1.32it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:09<02:10,  1.45it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:11<02:02,  1.53it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:12<01:55,  1.60it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:13<01:50,  1.66it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:14<01:46,  1.71it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:15<01:41,  1.76it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:16<01:38,  1.80it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:17<01:35,  1.83it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:18<01:32,  1.88it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:19<01:29,  1.91it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:20<01:26,  1.94it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:21<01:25,  1.96it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:22<01:23,  1.98it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:23<01:21,  2.00it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:24<01:19,  2.02it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:25<01:18,  2.04it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:26<01:16,  2.05it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:27<01:13,  2.10it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:28<01:11,  2.15it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:29<01:08,  2.21it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:29<01:05,  2.27it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:30<01:03,  2.33it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:31<01:00,  2.38it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:32<00:58,  2.44it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:33<00:56,  2.49it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:33<00:54,  2.53it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:34<00:53,  2.56it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:35<00:52,  2.58it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:36<00:51,  2.60it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:36<00:49,  2.63it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:37<00:48,  2.64it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:38<00:47,  2.66it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:39<00:46,  2.69it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:39<00:45,  2.72it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:40<00:44,  2.75it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:41<00:42,  2.77it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:41<00:41,  2.80it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:42<00:40,  2.82it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:43<00:39,  2.83it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:43<00:38,  2.86it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:44<00:37,  2.87it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:45<00:37,  2.89it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:46<00:36,  2.91it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:46<00:35,  2.93it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:47<00:34,  2.94it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:48<00:33,  2.96it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:48<00:32,  2.97it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:49<00:31,  2.99it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:50<00:30,  3.01it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:50<00:30,  3.02it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:51<00:29,  3.04it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:51<00:28,  3.05it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:52<00:27,  3.06it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:53<00:27,  3.06it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:53<00:26,  3.07it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:54<00:25,  3.08it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:55<00:24,  3.08it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:55<00:24,  3.09it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:56<00:23,  3.10it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:57<00:22,  3.10it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:57<00:22,  3.11it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:58<00:21,  3.13it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:59<00:20,  3.16it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:59<00:19,  3.18it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:00<00:19,  3.19it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:00<00:18,  3.21it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:01<00:17,  3.23it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:02<00:16,  3.25it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:02<00:16,  3.26it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:03<00:15,  3.27it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:03<00:14,  3.28it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:04<00:14,  3.29it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:05<00:13,  3.30it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:05<00:12,  3.31it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:06<00:12,  3.34it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:06<00:11,  3.36it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:07<00:10,  3.37it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:08<00:10,  3.38it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:08<00:09,  3.40it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:09<00:09,  3.42it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:09<00:08,  3.45it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:10<00:07,  3.47it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:10<00:07,  3.48it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:11<00:06,  3.50it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:12<00:05,  3.51it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:12<00:05,  3.52it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:13<00:04,  3.54it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:13<00:04,  3.55it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:14<00:03,  3.56it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:14<00:03,  3.57it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:15<00:02,  3.59it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:15<00:01,  3.61it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:16<00:01,  3.63it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:17<00:00,  3.71it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:17<00:00,  3.78it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:17<00:00,  2.58it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'rte': {'alias': 'rte', 'acc,none': 0.5, 'acc_stderr,none': 0.050251890762960605}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
0.5728915095234594
0.1682455054057436
0.93212414632396
0.9148362604533635
0.8268537756297094
0.7592245907029287
0.7256008379011685
0.7109756105942956
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
Total groups 73 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 7, 1, 6, 4, 3, 0]
tensor([5, 2, 7, 1, 6, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 6, 0, 7, 3, 4, 1]
tensor([5, 2, 6, 0, 7, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 7, 2, 5, 4, 3, 0]
tensor([6, 1, 7, 2, 5, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 2, 4, 1, 5, 0]
tensor([6, 3, 7, 2, 4, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 5, 6, 2, 3, 1, 4, 0]
tensor([7, 5, 6, 2, 3, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 5, 4, 1, 0, 1, 3]
tensor([0, 2, 5, 4, 1, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([0, 5])
tensor(0)
tensor([4, 6])
tensor(4)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 30
done!
Normal merging for layer 31
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 32 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 31 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

180
cuda:1
cb
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.44s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: cb] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646?recursive=False&expand=False HTTP/1.1" 307 138
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646?recursive=False&expand=False HTTP/1.1" 200 501
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/axb?recursive=False&expand=False HTTP/1.1" 307 142
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/axb?recursive=False&expand=False HTTP/1.1" 200 232
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/cb?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/cb?recursive=False&expand=False HTTP/1.1" 200 347
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:filelock:Attempting to acquire lock 139671873829104 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139671873829104 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671873829104 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139671873829104 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139671873829104 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139671873829104 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671873829104 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139671873829104 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cb from None to 0
INFO:lm_eval.api.task:Building contexts for cb on rank 0...
  0%|          | 0/56 [00:00<?, ?it/s]100%|██████████| 56/56 [00:00<00:00, 1698.71it/s]
DEBUG:lm_eval.evaluator:Task: cb; number of requests on this rank: 168
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/168 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/168 [00:02<07:29,  2.69s/it]Running loglikelihood requests:   1%|          | 2/168 [00:04<05:59,  2.17s/it]Running loglikelihood requests:   2%|▏         | 4/168 [00:06<03:38,  1.33s/it]Running loglikelihood requests:   3%|▎         | 5/168 [00:07<03:56,  1.45s/it]Running loglikelihood requests:   4%|▍         | 7/168 [00:09<03:01,  1.13s/it]Running loglikelihood requests:   5%|▍         | 8/168 [00:10<03:14,  1.22s/it]Running loglikelihood requests:   6%|▌         | 10/168 [00:12<02:33,  1.03it/s]Running loglikelihood requests:   7%|▋         | 11/168 [00:13<02:42,  1.03s/it]Running loglikelihood requests:   8%|▊         | 13/168 [00:14<02:13,  1.16it/s]Running loglikelihood requests:   8%|▊         | 14/168 [00:15<02:23,  1.07it/s]Running loglikelihood requests:  10%|▉         | 16/168 [00:16<02:02,  1.24it/s]Running loglikelihood requests:  10%|█         | 17/168 [00:18<02:15,  1.12it/s]Running loglikelihood requests:  11%|█▏        | 19/168 [00:19<01:53,  1.31it/s]Running loglikelihood requests:  12%|█▏        | 20/168 [00:20<02:04,  1.19it/s]Running loglikelihood requests:  13%|█▎        | 22/168 [00:21<01:44,  1.39it/s]Running loglikelihood requests:  14%|█▎        | 23/168 [00:22<01:54,  1.27it/s]Running loglikelihood requests:  15%|█▍        | 25/168 [00:23<01:37,  1.47it/s]Running loglikelihood requests:  15%|█▌        | 26/168 [00:24<01:46,  1.33it/s]Running loglikelihood requests:  17%|█▋        | 28/168 [00:25<01:32,  1.51it/s]Running loglikelihood requests:  17%|█▋        | 29/168 [00:26<01:42,  1.36it/s]Running loglikelihood requests:  18%|█▊        | 31/168 [00:27<01:28,  1.55it/s]Running loglikelihood requests:  19%|█▉        | 32/168 [00:28<01:37,  1.40it/s]Running loglikelihood requests:  20%|█▉        | 33/168 [00:29<01:45,  1.28it/s]Running loglikelihood requests:  21%|██        | 35/168 [00:30<01:28,  1.51it/s]Running loglikelihood requests:  22%|██▏       | 37/168 [00:31<01:18,  1.67it/s]Running loglikelihood requests:  23%|██▎       | 38/168 [00:32<01:27,  1.48it/s]Running loglikelihood requests:  24%|██▍       | 40/168 [00:33<01:17,  1.66it/s]Running loglikelihood requests:  24%|██▍       | 41/168 [00:34<01:25,  1.48it/s]Running loglikelihood requests:  26%|██▌       | 43/168 [00:35<01:14,  1.67it/s]Running loglikelihood requests:  26%|██▌       | 44/168 [00:36<01:23,  1.49it/s]Running loglikelihood requests:  27%|██▋       | 46/168 [00:37<01:11,  1.70it/s]Running loglikelihood requests:  28%|██▊       | 47/168 [00:38<01:19,  1.52it/s]Running loglikelihood requests:  29%|██▉       | 49/168 [00:38<01:08,  1.74it/s]Running loglikelihood requests:  30%|██▉       | 50/168 [00:39<01:15,  1.57it/s]Running loglikelihood requests:  30%|███       | 51/168 [00:40<01:21,  1.44it/s]Running loglikelihood requests:  31%|███       | 52/168 [00:41<01:25,  1.36it/s]Running loglikelihood requests:  32%|███▏      | 54/168 [00:42<01:09,  1.64it/s]Running loglikelihood requests:  33%|███▎      | 56/168 [00:43<01:00,  1.84it/s]Running loglikelihood requests:  35%|███▍      | 58/168 [00:44<00:55,  1.98it/s]Running loglikelihood requests:  35%|███▌      | 59/168 [00:44<01:02,  1.73it/s]Running loglikelihood requests:  36%|███▌      | 60/168 [00:45<01:09,  1.56it/s]Running loglikelihood requests:  37%|███▋      | 62/168 [00:46<00:59,  1.79it/s]Running loglikelihood requests:  38%|███▊      | 64/168 [00:47<00:53,  1.95it/s]Running loglikelihood requests:  39%|███▊      | 65/168 [00:48<00:59,  1.72it/s]Running loglikelihood requests:  40%|███▉      | 67/168 [00:49<00:52,  1.91it/s]Running loglikelihood requests:  40%|████      | 68/168 [00:50<00:59,  1.69it/s]Running loglikelihood requests:  42%|████▏     | 70/168 [00:50<00:51,  1.89it/s]Running loglikelihood requests:  42%|████▏     | 71/168 [00:51<00:57,  1.69it/s]Running loglikelihood requests:  43%|████▎     | 73/168 [00:52<00:50,  1.90it/s]Running loglikelihood requests:  44%|████▍     | 74/168 [00:53<00:55,  1.69it/s]Running loglikelihood requests:  45%|████▍     | 75/168 [00:54<01:00,  1.55it/s]Running loglikelihood requests:  45%|████▌     | 76/168 [00:55<01:03,  1.45it/s]Running loglikelihood requests:  46%|████▋     | 78/168 [00:55<00:51,  1.74it/s]Running loglikelihood requests:  48%|████▊     | 80/168 [00:56<00:45,  1.94it/s]Running loglikelihood requests:  49%|████▉     | 82/168 [00:57<00:41,  2.08it/s]Running loglikelihood requests:  49%|████▉     | 83/168 [00:58<00:46,  1.82it/s]Running loglikelihood requests:  51%|█████     | 85/168 [00:59<00:41,  2.01it/s]Running loglikelihood requests:  51%|█████     | 86/168 [01:00<00:45,  1.79it/s]Running loglikelihood requests:  52%|█████▏    | 88/168 [01:00<00:39,  2.00it/s]Running loglikelihood requests:  53%|█████▎    | 89/168 [01:01<00:44,  1.78it/s]Running loglikelihood requests:  54%|█████▎    | 90/168 [01:02<00:48,  1.60it/s]Running loglikelihood requests:  55%|█████▍    | 92/168 [01:03<00:40,  1.88it/s]Running loglikelihood requests:  56%|█████▌    | 94/168 [01:04<00:35,  2.09it/s]Running loglikelihood requests:  57%|█████▋    | 95/168 [01:04<00:39,  1.86it/s]Running loglikelihood requests:  58%|█████▊    | 97/168 [01:05<00:34,  2.07it/s]Running loglikelihood requests:  58%|█████▊    | 98/168 [01:06<00:37,  1.85it/s]Running loglikelihood requests:  60%|█████▉    | 100/168 [01:07<00:32,  2.09it/s]Running loglikelihood requests:  60%|██████    | 101/168 [01:07<00:35,  1.87it/s]Running loglikelihood requests:  61%|██████▏   | 103/168 [01:08<00:30,  2.11it/s]Running loglikelihood requests:  62%|██████▏   | 104/168 [01:09<00:33,  1.89it/s]Running loglikelihood requests:  62%|██████▎   | 105/168 [01:10<00:36,  1.73it/s]Running loglikelihood requests:  63%|██████▎   | 106/168 [01:10<00:38,  1.62it/s]Running loglikelihood requests:  64%|██████▍   | 108/168 [01:11<00:30,  1.95it/s]Running loglikelihood requests:  65%|██████▌   | 110/168 [01:12<00:26,  2.18it/s]Running loglikelihood requests:  66%|██████▌   | 111/168 [01:12<00:29,  1.94it/s]Running loglikelihood requests:  67%|██████▋   | 113/168 [01:13<00:25,  2.18it/s]Running loglikelihood requests:  68%|██████▊   | 114/168 [01:14<00:27,  1.94it/s]Running loglikelihood requests:  69%|██████▉   | 116/168 [01:15<00:23,  2.18it/s]Running loglikelihood requests:  70%|███████   | 118/168 [01:15<00:21,  2.34it/s]Running loglikelihood requests:  71%|███████   | 119/168 [01:16<00:23,  2.05it/s]Running loglikelihood requests:  71%|███████▏  | 120/168 [01:17<00:26,  1.84it/s]Running loglikelihood requests:  73%|███████▎  | 122/168 [01:18<00:22,  2.08it/s]Running loglikelihood requests:  74%|███████▍  | 124/168 [01:18<00:19,  2.25it/s]Running loglikelihood requests:  74%|███████▍  | 125/168 [01:19<00:21,  2.00it/s]Running loglikelihood requests:  76%|███████▌  | 127/168 [01:20<00:18,  2.23it/s]Running loglikelihood requests:  76%|███████▌  | 128/168 [01:21<00:20,  1.98it/s]Running loglikelihood requests:  77%|███████▋  | 129/168 [01:21<00:21,  1.81it/s]Running loglikelihood requests:  78%|███████▊  | 131/168 [01:22<00:17,  2.10it/s]Running loglikelihood requests:  79%|███████▉  | 133/168 [01:23<00:14,  2.35it/s]Running loglikelihood requests:  80%|███████▉  | 134/168 [01:23<00:16,  2.10it/s]Running loglikelihood requests:  81%|████████  | 136/168 [01:24<00:13,  2.36it/s]Running loglikelihood requests:  82%|████████▏ | 137/168 [01:25<00:14,  2.11it/s]Running loglikelihood requests:  82%|████████▏ | 138/168 [01:25<00:15,  1.93it/s]Running loglikelihood requests:  83%|████████▎ | 139/168 [01:26<00:16,  1.81it/s]Running loglikelihood requests:  83%|████████▎ | 140/168 [01:27<00:16,  1.72it/s]Running loglikelihood requests:  85%|████████▍ | 142/168 [01:27<00:12,  2.10it/s]Running loglikelihood requests:  86%|████████▌ | 144/168 [01:28<00:10,  2.38it/s]Running loglikelihood requests:  87%|████████▋ | 146/168 [01:29<00:08,  2.57it/s]Running loglikelihood requests:  88%|████████▊ | 148/168 [01:29<00:07,  2.72it/s]Running loglikelihood requests:  89%|████████▊ | 149/168 [01:30<00:07,  2.38it/s]Running loglikelihood requests:  89%|████████▉ | 150/168 [01:31<00:08,  2.13it/s]Running loglikelihood requests:  90%|█████████ | 152/168 [01:31<00:06,  2.43it/s]Running loglikelihood requests:  92%|█████████▏| 154/168 [01:32<00:05,  2.64it/s]Running loglikelihood requests:  92%|█████████▏| 155/168 [01:32<00:05,  2.33it/s]Running loglikelihood requests:  93%|█████████▎| 157/168 [01:33<00:04,  2.58it/s]Running loglikelihood requests:  94%|█████████▍| 158/168 [01:34<00:04,  2.25it/s]Running loglikelihood requests:  95%|█████████▌| 160/168 [01:34<00:03,  2.58it/s]Running loglikelihood requests:  96%|█████████▌| 161/168 [01:35<00:02,  2.34it/s]Running loglikelihood requests:  97%|█████████▋| 163/168 [01:35<00:01,  2.68it/s]Running loglikelihood requests:  98%|█████████▊| 164/168 [01:36<00:01,  2.42it/s]Running loglikelihood requests:  99%|█████████▉| 166/168 [01:37<00:00,  2.76it/s]Running loglikelihood requests:  99%|█████████▉| 167/168 [01:37<00:00,  2.49it/s]Running loglikelihood requests: 100%|██████████| 168/168 [01:37<00:00,  1.72it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'cb': {'alias': 'cb', 'acc,none': 0.44642857142857145, 'acc_stderr,none': 0.06703189227942397, 'f1,none': np.float64(0.2946127946127946), 'f1_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8754479021250823
0.8035282713865031
0.9500865550679058
0.9469110267801961
0.9212663689239236
0.9365178765256775
0.671589453090406
0.6744336218334667
0.8076345549626031
0.7976470386087894
0.807072393829993
0.6600400889592184
0.7484904863798857
0.9363063771008698
0.6357711114598822
0.9166089836828051
0.6715835426958833
0.7409884813902188
0.412428535140908
0.8747283305135303
0.8491219158212996
0.9125101690232402
0.8366676259845086
0.705936129020536
0.7920385356495101
0.9243830461584077
0.9274604399644588
0.7835428130351293
0.8119111717866335
Total groups 67 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 5, 2, 7, 1, 4, 0]
tensor([6, 3, 5, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 7, 3, 6, 1, 2, 0]
tensor([5, 4, 7, 3, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 1, 6, 3, 7, 2, 4, 0]
tensor([5, 1, 6, 3, 7, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 2, 0, 1, 5, 0, 1, 3]
tensor([4, 2, 0, 1, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 3, 0, 2, 1, 1, 5, 0]
tensor([4, 3, 0, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 2 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 12
done!
Normal merging for layer 13
tensor([2, 5])
tensor(2)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 14
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 15 to 18
done!
Normal merging for layer 19
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 20 to 23
done!
Normal merging for layer 24
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 31 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 30 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

83
cuda:2
qqp
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 35.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.69s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 307 140
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 200 355
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139666902017152 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139666902017152 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139666902017152 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139666902017152 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139671874478992 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671874478992 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671874478992 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671874478992 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qqp from None to 0
INFO:lm_eval.api.task:Building contexts for qqp on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2481.85it/s]
DEBUG:lm_eval.evaluator:Task: qqp; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:50,  1.76s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:30,  1.31it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:49,  1.78it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:32,  2.09it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:22,  2.32it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:15,  2.49it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:11,  2.60it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:08,  2.68it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:06,  2.75it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:08<01:04,  2.80it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:02,  2.85it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:01,  2.89it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<00:59,  2.94it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<00:57,  2.98it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<00:56,  3.01it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<00:55,  3.04it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:12<00:54,  3.06it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<00:53,  3.07it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:14<00:52,  3.09it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:14<00:52,  3.06it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:15<00:53,  2.97it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:16<00:53,  2.91it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:16<00:52,  2.97it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:17<00:50,  3.02it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:18<00:49,  3.06it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:18<00:47,  3.11it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:19<00:47,  3.13it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:19<00:46,  3.15it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:20<00:45,  3.18it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:21<00:44,  3.19it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:21<00:43,  3.21it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:22<00:42,  3.23it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:23<00:41,  3.25it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:23<00:40,  3.26it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:24<00:40,  3.27it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:24<00:39,  3.27it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:25<00:38,  3.28it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:26<00:38,  3.28it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:26<00:37,  3.29it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:27<00:36,  3.31it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:27<00:35,  3.31it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:28<00:35,  3.32it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:29<00:34,  3.33it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:29<00:33,  3.33it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:30<00:33,  3.34it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:30<00:32,  3.35it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:31<00:31,  3.36it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:32<00:31,  3.37it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:32<00:30,  3.38it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:33<00:29,  3.39it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:33<00:29,  3.39it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:34<00:28,  3.40it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:35<00:27,  3.41it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:35<00:27,  3.42it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:36<00:26,  3.43it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:36<00:25,  3.45it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:37<00:25,  3.46it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:37<00:24,  3.48it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:38<00:23,  3.48it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:39<00:23,  3.50it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:39<00:22,  3.50it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:40<00:21,  3.51it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:40<00:21,  3.52it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:41<00:20,  3.53it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:41<00:20,  3.54it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:42<00:19,  3.56it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:42<00:18,  3.56it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:43<00:18,  3.57it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:44<00:17,  3.58it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:44<00:17,  3.58it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:45<00:16,  3.59it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:45<00:15,  3.60it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:46<00:15,  3.60it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:46<00:14,  3.61it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:47<00:14,  3.62it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:47<00:13,  3.63it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:48<00:12,  3.64it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:49<00:12,  3.65it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:49<00:11,  3.65it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:50<00:11,  3.66it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:50<00:10,  3.67it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:51<00:10,  3.68it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:51<00:09,  3.68it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:52<00:08,  3.70it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:52<00:08,  3.71it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:53<00:07,  3.72it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:53<00:07,  3.72it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:54<00:06,  3.73it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:54<00:06,  3.74it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:55<00:05,  3.74it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:56<00:05,  3.75it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:56<00:04,  3.75it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:57<00:04,  3.75it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:57<00:03,  3.74it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:58<00:02,  3.76it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:58<00:02,  3.79it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [00:59<00:01,  3.81it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [00:59<00:01,  3.71it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:00<00:00,  3.77it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:00<00:00,  3.84it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:00<00:00,  3.29it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:58,  1.20s/it]  2%|▏         | 2/100 [00:02<01:57,  1.20s/it]  3%|▎         | 3/100 [00:03<01:56,  1.20s/it]  4%|▍         | 4/100 [00:04<01:54,  1.20s/it]  5%|▌         | 5/100 [00:05<01:53,  1.20s/it]  6%|▌         | 6/100 [00:07<01:52,  1.20s/it]  7%|▋         | 7/100 [00:08<01:51,  1.20s/it]  8%|▊         | 8/100 [00:09<01:50,  1.20s/it]  9%|▉         | 9/100 [00:10<01:49,  1.20s/it] 10%|█         | 10/100 [00:11<01:47,  1.20s/it] 11%|█         | 11/100 [00:13<01:46,  1.20s/it] 12%|█▏        | 12/100 [00:14<01:45,  1.20s/it] 13%|█▎        | 13/100 [00:15<01:44,  1.20s/it] 14%|█▍        | 14/100 [00:16<01:42,  1.20s/it] 15%|█▌        | 15/100 [00:17<01:41,  1.19s/it] 16%|█▌        | 16/100 [00:19<01:40,  1.20s/it] 17%|█▋        | 17/100 [00:20<01:39,  1.20s/it] 18%|█▊        | 18/100 [00:21<01:38,  1.20s/it] 19%|█▉        | 19/100 [00:22<01:36,  1.20s/it] 20%|██        | 20/100 [00:23<01:35,  1.20s/it] 21%|██        | 21/100 [00:25<01:34,  1.20s/it] 22%|██▏       | 22/100 [00:26<01:33,  1.20s/it] 23%|██▎       | 23/100 [00:27<01:32,  1.20s/it] 24%|██▍       | 24/100 [00:28<01:31,  1.20s/it] 25%|██▌       | 25/100 [00:29<01:29,  1.20s/it] 26%|██▌       | 26/100 [00:31<01:28,  1.20s/it] 27%|██▋       | 27/100 [00:32<01:27,  1.20s/it] 28%|██▊       | 28/100 [00:33<01:26,  1.20s/it] 29%|██▉       | 29/100 [00:34<01:25,  1.20s/it] 30%|███       | 30/100 [00:35<01:23,  1.20s/it] 31%|███       | 31/100 [00:37<01:22,  1.20s/it] 32%|███▏      | 32/100 [00:38<01:21,  1.20s/it] 33%|███▎      | 33/100 [00:39<01:20,  1.20s/it] 34%|███▍      | 34/100 [00:40<01:18,  1.20s/it] 35%|███▌      | 35/100 [00:41<01:17,  1.20s/it] 36%|███▌      | 36/100 [00:43<01:16,  1.20s/it] 37%|███▋      | 37/100 [00:44<01:15,  1.20s/it] 38%|███▊      | 38/100 [00:45<01:14,  1.20s/it] 39%|███▉      | 39/100 [00:46<01:13,  1.20s/it] 40%|████      | 40/100 [00:47<01:11,  1.20s/it] 41%|████      | 41/100 [00:49<01:10,  1.20s/it] 42%|████▏     | 42/100 [00:50<01:09,  1.20s/it] 43%|████▎     | 43/100 [00:51<01:08,  1.21s/it] 44%|████▍     | 44/100 [00:52<01:07,  1.21s/it] 45%|████▌     | 45/100 [00:53<01:06,  1.21s/it] 46%|████▌     | 46/100 [00:55<01:05,  1.21s/it] 47%|████▋     | 47/100 [00:56<01:03,  1.21s/it] 48%|████▊     | 48/100 [00:57<01:02,  1.21s/it] 49%|████▉     | 49/100 [00:58<01:01,  1.21s/it] 50%|█████     | 50/100 [00:59<01:00,  1.21s/it] 51%|█████     | 51/100 [01:01<00:59,  1.22s/it] 52%|█████▏    | 52/100 [01:02<00:58,  1.22s/it] 53%|█████▎    | 53/100 [01:03<00:57,  1.22s/it] 54%|█████▍    | 54/100 [01:04<00:55,  1.22s/it] 55%|█████▌    | 55/100 [01:06<00:54,  1.22s/it] 56%|█████▌    | 56/100 [01:07<00:53,  1.21s/it] 57%|█████▋    | 57/100 [01:08<00:52,  1.23s/it] 58%|█████▊    | 58/100 [01:09<00:51,  1.22s/it] 59%|█████▉    | 59/100 [01:10<00:49,  1.22s/it] 60%|██████    | 60/100 [01:12<00:49,  1.23s/it] 61%|██████    | 61/100 [01:13<00:48,  1.25s/it] 62%|██████▏   | 62/100 [01:14<00:46,  1.23s/it] 63%|██████▎   | 63/100 [01:15<00:45,  1.23s/it] 64%|██████▍   | 64/100 [01:17<00:43,  1.22s/it] 65%|██████▌   | 65/100 [01:18<00:42,  1.22s/it] 66%|██████▌   | 66/100 [01:19<00:41,  1.21s/it] 67%|██████▋   | 67/100 [01:20<00:39,  1.21s/it] 68%|██████▊   | 68/100 [01:21<00:38,  1.21s/it] 69%|██████▉   | 69/100 [01:23<00:37,  1.20s/it] 70%|███████   | 70/100 [01:24<00:36,  1.20s/it] 71%|███████   | 71/100 [01:25<00:34,  1.20s/it] 72%|███████▏  | 72/100 [01:26<00:33,  1.20s/it] 73%|███████▎  | 73/100 [01:27<00:32,  1.20s/it] 74%|███████▍  | 74/100 [01:29<00:31,  1.20s/it] 75%|███████▌  | 75/100 [01:30<00:29,  1.20s/it] 76%|███████▌  | 76/100 [01:31<00:28,  1.20s/it] 77%|███████▋  | 77/100 [01:32<00:27,  1.20s/it] 78%|███████▊  | 78/100 [01:33<00:26,  1.21s/it] 79%|███████▉  | 79/100 [01:35<00:25,  1.21s/it] 80%|████████  | 80/100 [01:36<00:24,  1.20s/it] 81%|████████  | 81/100 [01:37<00:22,  1.20s/it] 82%|████████▏ | 82/100 [01:38<00:21,  1.21s/it] 83%|████████▎ | 83/100 [01:39<00:20,  1.21s/it] 84%|████████▍ | 84/100 [01:41<00:19,  1.20s/it] 85%|████████▌ | 85/100 [01:42<00:18,  1.20s/it] 86%|████████▌ | 86/100 [01:43<00:16,  1.20s/it] 87%|████████▋ | 87/100 [01:44<00:15,  1.20s/it] 88%|████████▊ | 88/100 [01:45<00:14,  1.20s/it] 89%|████████▉ | 89/100 [01:47<00:13,  1.20s/it] 90%|█████████ | 90/100 [01:48<00:11,  1.20s/it] 91%|█████████ | 91/100 [01:49<00:10,  1.20s/it] 92%|█████████▏| 92/100 [01:50<00:09,  1.20s/it] 93%|█████████▎| 93/100 [01:51<00:08,  1.20s/it] 94%|█████████▍| 94/100 [01:53<00:07,  1.20s/it] 95%|█████████▌| 95/100 [01:54<00:06,  1.20s/it] 96%|█████████▌| 96/100 [01:55<00:04,  1.20s/it] 97%|█████████▋| 97/100 [01:56<00:03,  1.20s/it] 98%|█████████▊| 98/100 [01:58<00:02,  1.21s/it] 99%|█████████▉| 99/100 [01:59<00:01,  1.22s/it]100%|██████████| 100/100 [02:00<00:00,  1.21s/it]100%|██████████| 100/100 [02:00<00:00,  1.20s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'qqp': {'alias': 'qqp', 'acc,none': 0.3, 'acc_stderr,none': 0.04605661864718382, 'f1,none': np.float64(0.46153846153846156), 'f1_stderr,none': 0.05409397997448054}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
0.5983336442242687
0.5414593978662989
0.3299447012562784
0.4799857918750434
0.8524920468933548
0.713165518996795
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 5, 2, 6, 1, 3, 0]
tensor([7, 4, 5, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 4, 5, 2, 7, 3, 0, 1]
tensor([6, 4, 5, 2, 7, 3, 0, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 7, 4, 2, 5, 0, 1, 3]
tensor([6, 7, 4, 2, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 6, 4, 3, 7, 1, 0, 2]
tensor([5, 6, 4, 3, 7, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 30 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 29 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

113
cuda:3
openbookqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.66s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/openbookqa/openbookqa.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 117
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454?recursive=False&expand=False HTTP/1.1" 307 142
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454?recursive=False&expand=False HTTP/1.1" 200 390
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/additional?recursive=False&expand=False HTTP/1.1" 307 153
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/additional?recursive=False&expand=False HTTP/1.1" 200 363
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 117
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/revision/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/main?recursive=False&expand=False HTTP/1.1" 307 147
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa/tree/388097ea7776314e93a529163e0fea805b8a6454/main?recursive=False&expand=False HTTP/1.1" 200 359
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139669989284544 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 139669989284544 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669989284544 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 139669989284544 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Attempting to acquire lock 139669989128912 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 139669989128912 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669989128912 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 139669989128912 released on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of openbookqa from None to 0
INFO:lm_eval.api.task:Building contexts for openbookqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2858.15it/s]
DEBUG:lm_eval.evaluator:Task: openbookqa; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:01<10:55,  1.64s/it]Running loglikelihood requests:   0%|          | 2/400 [00:02<07:14,  1.09s/it]Running loglikelihood requests:   1%|          | 3/400 [00:03<06:01,  1.10it/s]Running loglikelihood requests:   1%|          | 4/400 [00:03<05:25,  1.22it/s]Running loglikelihood requests:   1%|▏         | 5/400 [00:04<04:48,  1.37it/s]Running loglikelihood requests:   2%|▏         | 6/400 [00:04<04:25,  1.49it/s]Running loglikelihood requests:   2%|▏         | 7/400 [00:05<04:09,  1.57it/s]Running loglikelihood requests:   2%|▏         | 8/400 [00:05<03:59,  1.64it/s]Running loglikelihood requests:   2%|▏         | 9/400 [00:06<03:50,  1.70it/s]Running loglikelihood requests:   2%|▎         | 10/400 [00:07<03:44,  1.74it/s]Running loglikelihood requests:   3%|▎         | 11/400 [00:07<03:40,  1.76it/s]Running loglikelihood requests:   3%|▎         | 12/400 [00:08<03:37,  1.78it/s]Running loglikelihood requests:   3%|▎         | 13/400 [00:08<03:35,  1.79it/s]Running loglikelihood requests:   4%|▍         | 15/400 [00:09<02:43,  2.35it/s]Running loglikelihood requests:   4%|▍         | 16/400 [00:09<02:54,  2.21it/s]Running loglikelihood requests:   4%|▍         | 17/400 [00:10<03:01,  2.11it/s]Running loglikelihood requests:   4%|▍         | 18/400 [00:10<03:12,  1.99it/s]Running loglikelihood requests:   5%|▍         | 19/400 [00:11<03:14,  1.96it/s]Running loglikelihood requests:   5%|▌         | 20/400 [00:11<03:14,  1.95it/s]Running loglikelihood requests:   5%|▌         | 21/400 [00:12<03:24,  1.85it/s]Running loglikelihood requests:   6%|▌         | 22/400 [00:13<03:21,  1.87it/s]Running loglikelihood requests:   6%|▌         | 23/400 [00:13<03:18,  1.90it/s]Running loglikelihood requests:   6%|▌         | 24/400 [00:14<03:16,  1.91it/s]Running loglikelihood requests:   6%|▋         | 25/400 [00:14<03:14,  1.92it/s]Running loglikelihood requests:   6%|▋         | 26/400 [00:15<03:13,  1.94it/s]Running loglikelihood requests:   7%|▋         | 27/400 [00:15<03:11,  1.95it/s]Running loglikelihood requests:   7%|▋         | 28/400 [00:16<03:09,  1.96it/s]Running loglikelihood requests:   7%|▋         | 29/400 [00:16<03:07,  1.98it/s]Running loglikelihood requests:   8%|▊         | 33/400 [00:17<01:36,  3.80it/s]Running loglikelihood requests:   8%|▊         | 34/400 [00:17<01:50,  3.30it/s]Running loglikelihood requests:   9%|▉         | 35/400 [00:18<02:03,  2.96it/s]Running loglikelihood requests:   9%|▉         | 36/400 [00:18<02:14,  2.71it/s]Running loglikelihood requests:   9%|▉         | 37/400 [00:19<02:23,  2.53it/s]Running loglikelihood requests:  10%|▉         | 38/400 [00:19<02:30,  2.41it/s]Running loglikelihood requests:  10%|▉         | 39/400 [00:19<02:35,  2.33it/s]Running loglikelihood requests:  10%|█         | 40/400 [00:20<02:39,  2.25it/s]Running loglikelihood requests:  10%|█         | 41/400 [00:20<02:41,  2.22it/s]Running loglikelihood requests:  10%|█         | 42/400 [00:21<02:49,  2.12it/s]Running loglikelihood requests:  11%|█         | 43/400 [00:21<02:47,  2.13it/s]Running loglikelihood requests:  11%|█         | 44/400 [00:22<02:46,  2.14it/s]Running loglikelihood requests:  11%|█▏        | 45/400 [00:22<02:45,  2.15it/s]Running loglikelihood requests:  12%|█▏        | 46/400 [00:23<02:44,  2.15it/s]Running loglikelihood requests:  12%|█▏        | 47/400 [00:23<02:43,  2.16it/s]Running loglikelihood requests:  12%|█▏        | 48/400 [00:24<02:42,  2.17it/s]Running loglikelihood requests:  12%|█▏        | 49/400 [00:24<02:41,  2.17it/s]Running loglikelihood requests:  12%|█▎        | 50/400 [00:25<02:40,  2.18it/s]Running loglikelihood requests:  13%|█▎        | 51/400 [00:25<02:40,  2.18it/s]Running loglikelihood requests:  13%|█▎        | 52/400 [00:26<02:39,  2.18it/s]Running loglikelihood requests:  13%|█▎        | 53/400 [00:26<02:38,  2.19it/s]Running loglikelihood requests:  14%|█▎        | 54/400 [00:26<02:37,  2.19it/s]Running loglikelihood requests:  14%|█▍        | 55/400 [00:27<02:36,  2.20it/s]Running loglikelihood requests:  14%|█▍        | 57/400 [00:27<01:59,  2.87it/s]Running loglikelihood requests:  15%|█▌        | 60/400 [00:28<01:25,  3.99it/s]Running loglikelihood requests:  15%|█▌        | 61/400 [00:28<01:37,  3.47it/s]Running loglikelihood requests:  16%|█▌        | 62/400 [00:29<01:49,  3.10it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [00:29<01:58,  2.84it/s]Running loglikelihood requests:  16%|█▌        | 64/400 [00:30<02:06,  2.65it/s]Running loglikelihood requests:  16%|█▋        | 65/400 [00:30<02:12,  2.53it/s]Running loglikelihood requests:  16%|█▋        | 66/400 [00:30<02:17,  2.42it/s]Running loglikelihood requests:  17%|█▋        | 67/400 [00:31<02:20,  2.37it/s]Running loglikelihood requests:  17%|█▋        | 68/400 [00:31<02:22,  2.34it/s]Running loglikelihood requests:  17%|█▋        | 69/400 [00:32<02:23,  2.31it/s]Running loglikelihood requests:  18%|█▊        | 70/400 [00:32<02:23,  2.30it/s]Running loglikelihood requests:  18%|█▊        | 71/400 [00:33<02:23,  2.29it/s]Running loglikelihood requests:  18%|█▊        | 72/400 [00:33<02:24,  2.28it/s]Running loglikelihood requests:  18%|█▊        | 73/400 [00:34<02:24,  2.27it/s]Running loglikelihood requests:  18%|█▊        | 74/400 [00:34<02:23,  2.27it/s]Running loglikelihood requests:  19%|█▉        | 75/400 [00:34<02:23,  2.26it/s]Running loglikelihood requests:  19%|█▉        | 76/400 [00:35<02:23,  2.26it/s]Running loglikelihood requests:  19%|█▉        | 77/400 [00:35<02:23,  2.26it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [00:36<02:22,  2.26it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [00:36<02:21,  2.26it/s]Running loglikelihood requests:  20%|██        | 81/400 [00:37<01:48,  2.94it/s]Running loglikelihood requests:  20%|██        | 82/400 [00:37<01:56,  2.74it/s]Running loglikelihood requests:  21%|██        | 83/400 [00:38<02:01,  2.60it/s]Running loglikelihood requests:  21%|██        | 84/400 [00:38<02:06,  2.50it/s]Running loglikelihood requests:  22%|██▏       | 86/400 [00:38<01:40,  3.12it/s]Running loglikelihood requests:  22%|██▏       | 87/400 [00:39<01:49,  2.87it/s]Running loglikelihood requests:  22%|██▏       | 88/400 [00:39<01:56,  2.69it/s]Running loglikelihood requests:  22%|██▏       | 89/400 [00:40<02:00,  2.57it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [00:40<02:04,  2.49it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [00:41<02:07,  2.43it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [00:41<02:09,  2.38it/s]Running loglikelihood requests:  23%|██▎       | 93/400 [00:42<02:10,  2.35it/s]Running loglikelihood requests:  24%|██▎       | 94/400 [00:42<02:10,  2.34it/s]Running loglikelihood requests:  24%|██▍       | 95/400 [00:42<02:11,  2.32it/s]Running loglikelihood requests:  24%|██▍       | 96/400 [00:43<02:11,  2.31it/s]Running loglikelihood requests:  24%|██▍       | 97/400 [00:43<02:11,  2.30it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [00:44<02:12,  2.28it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [00:44<02:12,  2.27it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [00:45<02:12,  2.26it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [00:45<02:11,  2.28it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [00:45<02:10,  2.28it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [00:46<02:09,  2.30it/s]Running loglikelihood requests:  26%|██▋       | 106/400 [00:46<01:19,  3.69it/s]Running loglikelihood requests:  27%|██▋       | 107/400 [00:47<01:29,  3.28it/s]Running loglikelihood requests:  27%|██▋       | 108/400 [00:47<01:37,  2.99it/s]Running loglikelihood requests:  27%|██▋       | 109/400 [00:48<01:46,  2.74it/s]Running loglikelihood requests:  28%|██▊       | 110/400 [00:48<01:51,  2.61it/s]Running loglikelihood requests:  28%|██▊       | 111/400 [00:49<01:54,  2.52it/s]Running loglikelihood requests:  28%|██▊       | 112/400 [00:49<01:57,  2.45it/s]Running loglikelihood requests:  28%|██▊       | 113/400 [00:49<01:59,  2.41it/s]Running loglikelihood requests:  28%|██▊       | 114/400 [00:50<02:00,  2.38it/s]Running loglikelihood requests:  29%|██▉       | 115/400 [00:50<02:00,  2.36it/s]Running loglikelihood requests:  29%|██▉       | 116/400 [00:51<02:00,  2.36it/s]Running loglikelihood requests:  29%|██▉       | 117/400 [00:51<01:59,  2.36it/s]Running loglikelihood requests:  30%|██▉       | 118/400 [00:52<01:59,  2.36it/s]Running loglikelihood requests:  30%|██▉       | 119/400 [00:52<01:59,  2.36it/s]Running loglikelihood requests:  30%|███       | 120/400 [00:52<01:59,  2.35it/s]Running loglikelihood requests:  30%|███       | 121/400 [00:53<01:58,  2.35it/s]Running loglikelihood requests:  30%|███       | 122/400 [00:53<01:58,  2.35it/s]Running loglikelihood requests:  31%|███       | 123/400 [00:54<01:58,  2.34it/s]Running loglikelihood requests:  31%|███       | 124/400 [00:54<01:57,  2.34it/s]Running loglikelihood requests:  31%|███▏      | 125/400 [00:55<01:57,  2.34it/s]Running loglikelihood requests:  32%|███▏      | 126/400 [00:55<01:57,  2.33it/s]Running loglikelihood requests:  32%|███▏      | 127/400 [00:55<01:56,  2.34it/s]Running loglikelihood requests:  32%|███▏      | 128/400 [00:56<01:56,  2.33it/s]Running loglikelihood requests:  32%|███▏      | 129/400 [00:56<01:57,  2.30it/s]Running loglikelihood requests:  32%|███▎      | 130/400 [00:57<01:56,  2.32it/s]Running loglikelihood requests:  33%|███▎      | 131/400 [00:57<01:55,  2.33it/s]Running loglikelihood requests:  33%|███▎      | 132/400 [00:58<01:54,  2.35it/s]Running loglikelihood requests:  33%|███▎      | 133/400 [00:58<01:53,  2.35it/s]Running loglikelihood requests:  34%|███▎      | 134/400 [00:58<01:53,  2.35it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [00:59<00:58,  4.46it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [00:59<01:08,  3.83it/s]Running loglikelihood requests:  35%|███▌      | 140/400 [01:00<01:16,  3.38it/s]Running loglikelihood requests:  35%|███▌      | 141/400 [01:00<01:24,  3.07it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [01:00<01:30,  2.85it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [01:01<01:34,  2.71it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [01:01<01:38,  2.61it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [01:02<01:40,  2.54it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [01:02<01:19,  3.19it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [01:03<01:25,  2.96it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [01:03<01:29,  2.79it/s]Running loglikelihood requests:  38%|███▊      | 151/400 [01:03<01:13,  3.39it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [01:04<01:20,  3.09it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [01:04<01:25,  2.88it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [01:05<01:29,  2.73it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [01:05<01:33,  2.63it/s]Running loglikelihood requests:  39%|███▉      | 156/400 [01:06<01:35,  2.56it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [01:06<01:36,  2.51it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [01:06<01:37,  2.48it/s]Running loglikelihood requests:  40%|███▉      | 159/400 [01:07<01:38,  2.46it/s]Running loglikelihood requests:  40%|████      | 160/400 [01:07<01:38,  2.44it/s]Running loglikelihood requests:  40%|████      | 161/400 [01:08<01:38,  2.42it/s]Running loglikelihood requests:  40%|████      | 162/400 [01:08<01:38,  2.41it/s]Running loglikelihood requests:  41%|████      | 163/400 [01:08<01:38,  2.41it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [01:09<01:00,  3.85it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [01:09<01:08,  3.39it/s]Running loglikelihood requests:  43%|████▎     | 171/400 [01:10<00:43,  5.24it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [01:10<00:51,  4.41it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [01:11<00:59,  3.81it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [01:11<01:06,  3.39it/s]Running loglikelihood requests:  44%|████▍     | 175/400 [01:11<01:12,  3.10it/s]Running loglikelihood requests:  44%|████▍     | 176/400 [01:12<01:17,  2.91it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [01:12<01:20,  2.77it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [01:13<01:22,  2.68it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [01:13<01:25,  2.60it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [01:13<01:26,  2.55it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [01:14<01:27,  2.51it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [01:14<01:27,  2.48it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [01:15<01:27,  2.47it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [01:15<01:27,  2.47it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [01:15<01:27,  2.46it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [01:16<01:27,  2.44it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [01:16<01:32,  2.29it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [01:17<01:30,  2.34it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [01:17<01:07,  3.09it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [01:18<00:57,  3.62it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [01:18<01:03,  3.28it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [01:18<01:07,  3.03it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [01:19<01:11,  2.86it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [01:19<01:14,  2.74it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [01:20<01:16,  2.65it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [01:20<01:19,  2.54it/s]Running loglikelihood requests:  50%|█████     | 202/400 [01:20<00:42,  4.70it/s]Running loglikelihood requests:  51%|█████     | 203/400 [01:21<00:48,  4.05it/s]Running loglikelihood requests:  51%|█████     | 204/400 [01:21<00:54,  3.61it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [01:22<00:59,  3.29it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [01:22<01:03,  3.06it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [01:22<01:06,  2.89it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [01:23<00:54,  3.53it/s]Running loglikelihood requests:  52%|█████▎    | 210/400 [01:23<00:58,  3.23it/s]Running loglikelihood requests:  53%|█████▎    | 211/400 [01:24<01:02,  3.01it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [01:24<01:06,  2.84it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [01:25<01:12,  2.57it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [01:25<01:13,  2.53it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [01:25<01:13,  2.51it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [01:26<01:13,  2.52it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [01:26<01:12,  2.52it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [01:27<01:12,  2.52it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [01:27<01:12,  2.51it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [01:27<01:11,  2.50it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [01:28<01:11,  2.51it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [01:28<01:11,  2.50it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [01:29<01:10,  2.49it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [01:29<01:09,  2.52it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [01:29<01:09,  2.52it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [01:30<01:09,  2.52it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [01:30<01:09,  2.48it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [01:31<01:08,  2.50it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [01:31<01:08,  2.51it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [01:31<01:07,  2.50it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [01:32<01:07,  2.50it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [01:32<01:06,  2.51it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [01:33<01:06,  2.51it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [01:33<01:06,  2.51it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [01:33<01:05,  2.52it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [01:34<00:49,  3.28it/s]Running loglikelihood requests:  60%|█████▉    | 239/400 [01:34<00:42,  3.82it/s]Running loglikelihood requests:  60%|██████    | 240/400 [01:35<00:46,  3.43it/s]Running loglikelihood requests:  60%|██████    | 241/400 [01:35<00:50,  3.16it/s]Running loglikelihood requests:  60%|██████    | 242/400 [01:35<00:53,  2.97it/s]Running loglikelihood requests:  61%|██████    | 243/400 [01:36<00:55,  2.83it/s]Running loglikelihood requests:  61%|██████    | 244/400 [01:36<00:57,  2.73it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [01:37<00:58,  2.66it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [01:37<00:58,  2.61it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [01:37<00:59,  2.57it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [01:38<00:59,  2.56it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [01:38<00:59,  2.54it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [01:39<00:59,  2.54it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [01:39<00:59,  2.52it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [01:39<00:59,  2.49it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [01:40<01:01,  2.40it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [01:40<01:02,  2.35it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [01:41<01:00,  2.41it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [01:41<00:58,  2.46it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [01:41<00:57,  2.49it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [01:42<01:00,  2.36it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [01:42<01:00,  2.32it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [01:43<01:00,  2.31it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [01:43<01:01,  2.25it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [01:44<00:59,  2.32it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [01:44<00:57,  2.40it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [01:44<00:42,  3.19it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [01:45<00:44,  3.00it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [01:45<00:46,  2.84it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [01:46<00:48,  2.74it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [01:46<00:48,  2.69it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [01:46<00:48,  2.68it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [01:47<00:48,  2.65it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [01:47<00:48,  2.63it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [01:48<00:48,  2.63it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [01:48<00:48,  2.60it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [01:48<00:48,  2.57it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [01:49<00:48,  2.56it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [01:49<00:48,  2.56it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [01:49<00:47,  2.57it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [01:50<00:47,  2.56it/s]Running loglikelihood requests:  70%|███████   | 280/400 [01:50<00:47,  2.55it/s]Running loglikelihood requests:  70%|███████   | 281/400 [01:51<00:46,  2.57it/s]Running loglikelihood requests:  70%|███████   | 282/400 [01:51<00:45,  2.57it/s]Running loglikelihood requests:  71%|███████   | 283/400 [01:51<00:45,  2.59it/s]Running loglikelihood requests:  71%|███████   | 284/400 [01:52<00:44,  2.60it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [01:52<00:44,  2.61it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [01:53<00:43,  2.62it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [01:53<00:43,  2.61it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [01:53<00:42,  2.62it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [01:54<00:42,  2.63it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [01:54<00:41,  2.65it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [01:54<00:40,  2.66it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [01:55<00:40,  2.65it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [01:55<00:40,  2.64it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [01:56<00:40,  2.63it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [01:56<00:24,  4.25it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [01:56<00:27,  3.73it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [01:57<00:29,  3.39it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [01:57<00:31,  3.16it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [01:57<00:33,  3.00it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [01:58<00:34,  2.88it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [01:58<00:34,  2.77it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [01:59<00:18,  5.06it/s]Running loglikelihood requests:  77%|███████▋  | 308/400 [01:59<00:21,  4.33it/s]Running loglikelihood requests:  77%|███████▋  | 309/400 [01:59<00:23,  3.82it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [02:00<00:26,  3.41it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [02:00<00:28,  3.16it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [02:01<00:29,  2.98it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [02:01<00:30,  2.84it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [02:01<00:31,  2.76it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [02:02<00:31,  2.70it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [02:02<00:31,  2.69it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [02:03<00:30,  2.69it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [02:03<00:30,  2.66it/s]Running loglikelihood requests:  80%|████████  | 321/400 [02:03<00:18,  4.24it/s]Running loglikelihood requests:  80%|████████  | 322/400 [02:04<00:20,  3.77it/s]Running loglikelihood requests:  81%|████████  | 323/400 [02:04<00:22,  3.45it/s]Running loglikelihood requests:  81%|████████  | 324/400 [02:04<00:23,  3.24it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [02:05<00:24,  3.07it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [02:05<00:25,  2.90it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [02:06<00:25,  2.83it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [02:06<00:25,  2.78it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [02:06<00:25,  2.73it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [02:07<00:25,  2.70it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [02:07<00:25,  2.73it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [02:07<00:25,  2.71it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [02:08<00:24,  2.75it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [02:08<00:24,  2.67it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [02:09<00:18,  3.49it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [02:09<00:19,  3.22it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [02:09<00:20,  3.08it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [02:10<00:20,  2.95it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [02:10<00:20,  2.87it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [02:10<00:20,  2.82it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [02:11<00:20,  2.77it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [02:11<00:20,  2.72it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [02:12<00:20,  2.72it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [02:12<00:20,  2.68it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [02:12<00:19,  2.76it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [02:13<00:19,  2.74it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [02:13<00:19,  2.72it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [02:13<00:18,  2.73it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [02:14<00:18,  2.72it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [02:14<00:18,  2.70it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [02:14<00:17,  2.77it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [02:15<00:16,  2.81it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [02:15<00:16,  2.77it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [02:16<00:16,  2.76it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [02:16<00:15,  2.79it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [02:16<00:15,  2.76it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [02:17<00:15,  2.76it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [02:17<00:14,  2.77it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [02:17<00:14,  2.81it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [02:18<00:08,  4.49it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [02:18<00:09,  3.96it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [02:18<00:09,  3.63it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [02:19<00:09,  3.42it/s]Running loglikelihood requests:  92%|█████████▏| 367/400 [02:19<00:10,  3.27it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [02:19<00:10,  3.13it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [02:20<00:10,  3.02it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [02:20<00:10,  2.96it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [02:20<00:09,  2.95it/s]Running loglikelihood requests:  93%|█████████▎| 372/400 [02:21<00:09,  2.95it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [02:21<00:09,  2.95it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [02:22<00:08,  2.93it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [02:22<00:04,  4.74it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [02:22<00:05,  4.22it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [02:23<00:05,  3.83it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [02:23<00:05,  3.61it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [02:23<00:05,  3.47it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [02:23<00:05,  3.35it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [02:24<00:05,  3.25it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [02:24<00:05,  3.18it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [02:24<00:02,  4.96it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [02:25<00:02,  4.39it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [02:25<00:02,  4.83it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [02:25<00:02,  4.34it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [02:26<00:01,  4.00it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [02:26<00:01,  3.84it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [02:26<00:01,  3.60it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [02:27<00:01,  3.48it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [02:27<00:01,  3.43it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [02:27<00:00,  4.40it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [02:28<00:00,  4.31it/s]Running loglikelihood requests: 100%|██████████| 400/400 [02:28<00:00,  2.70it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'openbookqa': {'alias': 'openbookqa', 'acc,none': 0.25, 'acc_stderr,none': 0.04351941398892446, 'acc_norm,none': 0.39, 'acc_norm_stderr,none': 0.04902071300001973}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7187319796021299
0.7542307644255121
0.9218102409329888
0.9507846064925026
0.9244473932111009
0.9697851265705995
0.9088369054586506
0.9555908644563589
0.6065244449438403
0.8380982140772407
0.9227293008726757
0.940339967265193
0.8763319017557598
0.8956221731459367
0.8537768995934096
0.9486125995141542
0.9673324054839537
0.9137514724447725
0.9379677722073356
0.9822722776537973
0.9198472199854921
0.886666948473494
0.9000260607563779
0.9759633945879138
0.9869744580755335
Total groups 76 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 5, 2, 4, 3, 7, 0]
tensor([6, 1, 5, 2, 4, 3, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 1, 3, 2, 5, 4, 6, 0]
tensor([7, 1, 3, 2, 5, 4, 6, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 1.0, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 6 to 29
done!
Normal merging for layer 30
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 29 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 28 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

231
cuda:4
openbookqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:21<00:00, 37.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:21<00:00, 40.60s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/openbookqa/openbookqa.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/openbookqa HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/openbookqa HTTP/1.1" 200 1409
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/openbookqa/resolve/388097ea7776314e93a529163e0fea805b8a6454/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 307 119
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/openbookqa/paths-info/388097ea7776314e93a529163e0fea805b8a6454 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139649117995952 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 139649117995952 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649117995952 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Lock 139649117995952 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_openbookqa_main_0.0.0_388097ea7776314e93a529163e0fea805b8a6454.lock
DEBUG:filelock:Attempting to acquire lock 139647241680464 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 139647241680464 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454/dataset_info.json
DEBUG:filelock:Attempting to release lock 139647241680464 on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:filelock:Lock 139647241680464 released on /public/home/zouyifei001/.cache/huggingface/datasets/openbookqa/main/0.0.0/388097ea7776314e93a529163e0fea805b8a6454_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of openbookqa from None to 0
INFO:lm_eval.api.task:Building contexts for openbookqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2883.91it/s]
DEBUG:lm_eval.evaluator:Task: openbookqa; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:01<09:57,  1.50s/it]Running loglikelihood requests:   0%|          | 2/400 [00:02<06:56,  1.05s/it]Running loglikelihood requests:   1%|          | 3/400 [00:02<05:53,  1.12it/s]Running loglikelihood requests:   1%|          | 4/400 [00:03<05:22,  1.23it/s]Running loglikelihood requests:   1%|▏         | 5/400 [00:04<04:46,  1.38it/s]Running loglikelihood requests:   2%|▏         | 6/400 [00:04<04:24,  1.49it/s]Running loglikelihood requests:   2%|▏         | 7/400 [00:05<04:09,  1.58it/s]Running loglikelihood requests:   2%|▏         | 8/400 [00:05<03:59,  1.64it/s]Running loglikelihood requests:   2%|▏         | 9/400 [00:06<03:50,  1.69it/s]Running loglikelihood requests:   2%|▎         | 10/400 [00:06<03:44,  1.74it/s]Running loglikelihood requests:   3%|▎         | 11/400 [00:07<03:40,  1.76it/s]Running loglikelihood requests:   3%|▎         | 12/400 [00:08<03:39,  1.76it/s]Running loglikelihood requests:   3%|▎         | 13/400 [00:08<03:39,  1.76it/s]Running loglikelihood requests:   4%|▍         | 15/400 [00:09<02:45,  2.32it/s]Running loglikelihood requests:   4%|▍         | 16/400 [00:09<02:55,  2.18it/s]Running loglikelihood requests:   4%|▍         | 17/400 [00:10<03:03,  2.09it/s]Running loglikelihood requests:   4%|▍         | 18/400 [00:10<03:07,  2.03it/s]Running loglikelihood requests:   5%|▍         | 19/400 [00:11<03:15,  1.95it/s]Running loglikelihood requests:   5%|▌         | 20/400 [00:12<03:38,  1.74it/s]Running loglikelihood requests:   5%|▌         | 21/400 [00:12<03:31,  1.79it/s]Running loglikelihood requests:   6%|▌         | 22/400 [00:13<03:26,  1.83it/s]Running loglikelihood requests:   6%|▌         | 23/400 [00:13<03:22,  1.86it/s]Running loglikelihood requests:   6%|▌         | 24/400 [00:14<03:19,  1.89it/s]Running loglikelihood requests:   6%|▋         | 25/400 [00:14<03:16,  1.91it/s]Running loglikelihood requests:   6%|▋         | 26/400 [00:15<03:14,  1.92it/s]Running loglikelihood requests:   7%|▋         | 27/400 [00:15<03:11,  1.94it/s]Running loglikelihood requests:   7%|▋         | 28/400 [00:16<03:12,  1.93it/s]Running loglikelihood requests:   7%|▋         | 29/400 [00:16<03:09,  1.96it/s]Running loglikelihood requests:   8%|▊         | 33/400 [00:17<01:37,  3.77it/s]Running loglikelihood requests:   8%|▊         | 34/400 [00:17<01:51,  3.28it/s]Running loglikelihood requests:   9%|▉         | 35/400 [00:18<02:04,  2.94it/s]Running loglikelihood requests:   9%|▉         | 36/400 [00:18<02:14,  2.70it/s]Running loglikelihood requests:   9%|▉         | 37/400 [00:19<02:23,  2.53it/s]Running loglikelihood requests:  10%|▉         | 38/400 [00:19<02:30,  2.41it/s]Running loglikelihood requests:  10%|▉         | 39/400 [00:20<02:35,  2.32it/s]Running loglikelihood requests:  10%|█         | 40/400 [00:20<02:38,  2.27it/s]Running loglikelihood requests:  10%|█         | 41/400 [00:20<02:40,  2.23it/s]Running loglikelihood requests:  10%|█         | 42/400 [00:21<02:41,  2.21it/s]Running loglikelihood requests:  11%|█         | 43/400 [00:21<02:42,  2.20it/s]Running loglikelihood requests:  11%|█         | 44/400 [00:22<02:42,  2.18it/s]Running loglikelihood requests:  11%|█▏        | 45/400 [00:22<02:43,  2.18it/s]Running loglikelihood requests:  12%|█▏        | 46/400 [00:23<02:42,  2.17it/s]Running loglikelihood requests:  12%|█▏        | 47/400 [00:23<02:42,  2.18it/s]Running loglikelihood requests:  12%|█▏        | 48/400 [00:24<02:41,  2.18it/s]Running loglikelihood requests:  12%|█▏        | 49/400 [00:24<02:40,  2.18it/s]Running loglikelihood requests:  12%|█▎        | 50/400 [00:25<02:40,  2.18it/s]Running loglikelihood requests:  13%|█▎        | 51/400 [00:25<02:41,  2.17it/s]Running loglikelihood requests:  13%|█▎        | 52/400 [00:26<02:40,  2.17it/s]Running loglikelihood requests:  13%|█▎        | 53/400 [00:26<02:40,  2.16it/s]Running loglikelihood requests:  14%|█▎        | 54/400 [00:26<02:39,  2.18it/s]Running loglikelihood requests:  14%|█▍        | 55/400 [00:27<02:38,  2.18it/s]Running loglikelihood requests:  14%|█▍        | 57/400 [00:27<02:00,  2.85it/s]Running loglikelihood requests:  15%|█▌        | 60/400 [00:28<01:25,  3.97it/s]Running loglikelihood requests:  15%|█▌        | 61/400 [00:28<01:39,  3.41it/s]Running loglikelihood requests:  16%|█▌        | 62/400 [00:29<01:50,  3.07it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [00:29<01:59,  2.83it/s]Running loglikelihood requests:  16%|█▌        | 64/400 [00:30<02:06,  2.65it/s]Running loglikelihood requests:  16%|█▋        | 65/400 [00:30<02:12,  2.53it/s]Running loglikelihood requests:  16%|█▋        | 66/400 [00:31<02:16,  2.44it/s]Running loglikelihood requests:  17%|█▋        | 67/400 [00:31<02:19,  2.39it/s]Running loglikelihood requests:  17%|█▋        | 68/400 [00:31<02:21,  2.34it/s]Running loglikelihood requests:  17%|█▋        | 69/400 [00:32<02:25,  2.28it/s]Running loglikelihood requests:  18%|█▊        | 70/400 [00:32<02:24,  2.28it/s]Running loglikelihood requests:  18%|█▊        | 71/400 [00:33<02:24,  2.27it/s]Running loglikelihood requests:  18%|█▊        | 72/400 [00:33<02:24,  2.27it/s]Running loglikelihood requests:  18%|█▊        | 73/400 [00:34<02:24,  2.26it/s]Running loglikelihood requests:  18%|█▊        | 74/400 [00:34<02:23,  2.27it/s]Running loglikelihood requests:  19%|█▉        | 75/400 [00:35<02:23,  2.26it/s]Running loglikelihood requests:  19%|█▉        | 76/400 [00:35<02:23,  2.26it/s]Running loglikelihood requests:  19%|█▉        | 77/400 [00:35<02:23,  2.26it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [00:36<02:22,  2.26it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [00:36<02:21,  2.26it/s]Running loglikelihood requests:  20%|██        | 81/400 [00:37<01:48,  2.95it/s]Running loglikelihood requests:  20%|██        | 82/400 [00:37<01:55,  2.75it/s]Running loglikelihood requests:  21%|██        | 83/400 [00:38<02:01,  2.61it/s]Running loglikelihood requests:  21%|██        | 84/400 [00:38<02:05,  2.51it/s]Running loglikelihood requests:  22%|██▏       | 86/400 [00:38<01:40,  3.12it/s]Running loglikelihood requests:  22%|██▏       | 87/400 [00:39<01:48,  2.87it/s]Running loglikelihood requests:  22%|██▏       | 88/400 [00:39<01:55,  2.69it/s]Running loglikelihood requests:  22%|██▏       | 89/400 [00:40<02:00,  2.57it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [00:40<02:04,  2.49it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [00:41<02:10,  2.37it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [00:41<02:13,  2.30it/s]Running loglikelihood requests:  23%|██▎       | 93/400 [00:42<02:15,  2.26it/s]Running loglikelihood requests:  24%|██▎       | 94/400 [00:42<02:16,  2.23it/s]Running loglikelihood requests:  24%|██▍       | 95/400 [00:43<02:17,  2.21it/s]Running loglikelihood requests:  24%|██▍       | 96/400 [00:43<02:18,  2.20it/s]Running loglikelihood requests:  24%|██▍       | 97/400 [00:43<02:18,  2.19it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [00:44<02:18,  2.18it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [00:44<02:16,  2.20it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [00:45<02:19,  2.16it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [00:45<02:20,  2.12it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [00:46<02:20,  2.12it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [00:46<02:19,  2.13it/s]Running loglikelihood requests:  26%|██▋       | 106/400 [00:47<01:24,  3.48it/s]Running loglikelihood requests:  27%|██▋       | 107/400 [00:47<01:32,  3.15it/s]Running loglikelihood requests:  27%|██▋       | 108/400 [00:48<01:40,  2.90it/s]Running loglikelihood requests:  27%|██▋       | 109/400 [00:48<01:46,  2.72it/s]Running loglikelihood requests:  28%|██▊       | 110/400 [00:48<01:51,  2.60it/s]Running loglikelihood requests:  28%|██▊       | 111/400 [00:49<01:55,  2.51it/s]Running loglikelihood requests:  28%|██▊       | 112/400 [00:49<01:57,  2.45it/s]Running loglikelihood requests:  28%|██▊       | 113/400 [00:50<01:59,  2.40it/s]Running loglikelihood requests:  28%|██▊       | 114/400 [00:50<02:01,  2.36it/s]Running loglikelihood requests:  29%|██▉       | 115/400 [00:51<02:01,  2.35it/s]Running loglikelihood requests:  29%|██▉       | 116/400 [00:51<02:00,  2.35it/s]Running loglikelihood requests:  29%|██▉       | 117/400 [00:52<02:08,  2.21it/s]Running loglikelihood requests:  30%|██▉       | 118/400 [00:52<02:13,  2.11it/s]Running loglikelihood requests:  30%|██▉       | 119/400 [00:53<02:14,  2.09it/s]Running loglikelihood requests:  30%|███       | 120/400 [00:53<02:13,  2.09it/s]Running loglikelihood requests:  30%|███       | 121/400 [00:54<02:09,  2.15it/s]Running loglikelihood requests:  30%|███       | 122/400 [00:54<02:06,  2.19it/s]Running loglikelihood requests:  31%|███       | 123/400 [00:54<02:04,  2.22it/s]Running loglikelihood requests:  31%|███       | 124/400 [00:55<02:03,  2.24it/s]Running loglikelihood requests:  31%|███▏      | 125/400 [00:55<02:01,  2.25it/s]Running loglikelihood requests:  32%|███▏      | 126/400 [00:56<02:01,  2.26it/s]Running loglikelihood requests:  32%|███▏      | 127/400 [00:56<01:59,  2.28it/s]Running loglikelihood requests:  32%|███▏      | 128/400 [00:57<01:59,  2.28it/s]Running loglikelihood requests:  32%|███▏      | 129/400 [00:57<01:59,  2.27it/s]Running loglikelihood requests:  32%|███▎      | 130/400 [00:57<01:58,  2.29it/s]Running loglikelihood requests:  33%|███▎      | 131/400 [00:58<01:57,  2.30it/s]Running loglikelihood requests:  33%|███▎      | 132/400 [00:58<01:56,  2.30it/s]Running loglikelihood requests:  33%|███▎      | 133/400 [00:59<01:55,  2.31it/s]Running loglikelihood requests:  34%|███▎      | 134/400 [00:59<01:55,  2.31it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [01:00<01:00,  4.36it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [01:00<01:09,  3.74it/s]Running loglikelihood requests:  35%|███▌      | 140/400 [01:00<01:18,  3.31it/s]Running loglikelihood requests:  35%|███▌      | 141/400 [01:01<01:26,  3.01it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [01:01<01:32,  2.80it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [01:02<01:36,  2.65it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [01:02<01:40,  2.55it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [01:03<01:42,  2.48it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [01:03<01:21,  3.12it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [01:04<01:27,  2.89it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [01:04<01:32,  2.72it/s]Running loglikelihood requests:  38%|███▊      | 151/400 [01:04<01:15,  3.31it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [01:05<01:22,  3.01it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [01:05<01:27,  2.81it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [01:06<01:31,  2.68it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [01:06<01:35,  2.57it/s]Running loglikelihood requests:  39%|███▉      | 156/400 [01:06<01:37,  2.51it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [01:07<01:40,  2.43it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [01:07<01:40,  2.42it/s]Running loglikelihood requests:  40%|███▉      | 159/400 [01:08<01:39,  2.41it/s]Running loglikelihood requests:  40%|████      | 160/400 [01:08<01:39,  2.40it/s]Running loglikelihood requests:  40%|████      | 161/400 [01:09<01:39,  2.39it/s]Running loglikelihood requests:  40%|████      | 162/400 [01:09<01:39,  2.39it/s]Running loglikelihood requests:  41%|████      | 163/400 [01:09<01:38,  2.40it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [01:10<01:01,  3.83it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [01:10<01:08,  3.41it/s]Running loglikelihood requests:  43%|████▎     | 171/400 [01:11<00:43,  5.26it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [01:11<00:51,  4.41it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [01:12<00:59,  3.81it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [01:12<01:06,  3.38it/s]Running loglikelihood requests:  44%|████▍     | 175/400 [01:12<01:12,  3.10it/s]Running loglikelihood requests:  44%|████▍     | 176/400 [01:13<01:17,  2.90it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [01:13<01:20,  2.76it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [01:14<01:23,  2.65it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [01:14<01:26,  2.57it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [01:14<01:27,  2.51it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [01:15<01:28,  2.47it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [01:15<01:28,  2.46it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [01:16<01:28,  2.45it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [01:16<01:27,  2.47it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [01:16<01:27,  2.47it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [01:17<01:26,  2.47it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [01:17<01:26,  2.47it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [01:18<01:25,  2.48it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [01:18<01:05,  3.22it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [01:19<00:55,  3.73it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [01:19<01:01,  3.35it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [01:19<01:06,  3.09it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [01:20<01:10,  2.90it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [01:20<01:13,  2.77it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [01:21<01:15,  2.68it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [01:21<01:17,  2.60it/s]Running loglikelihood requests:  50%|█████     | 202/400 [01:21<00:41,  4.78it/s]Running loglikelihood requests:  51%|█████     | 203/400 [01:22<00:48,  4.10it/s]Running loglikelihood requests:  51%|█████     | 204/400 [01:22<00:54,  3.60it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [01:23<00:59,  3.27it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [01:23<01:03,  3.04it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [01:23<01:07,  2.84it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [01:24<00:54,  3.48it/s]Running loglikelihood requests:  52%|█████▎    | 210/400 [01:24<00:59,  3.20it/s]Running loglikelihood requests:  53%|█████▎    | 211/400 [01:25<01:03,  2.99it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [01:25<01:08,  2.76it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [01:25<01:11,  2.63it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [01:26<01:12,  2.55it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [01:26<01:13,  2.52it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [01:27<01:13,  2.51it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [01:27<01:12,  2.51it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [01:27<01:12,  2.50it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [01:28<01:12,  2.50it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [01:28<01:12,  2.48it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [01:29<01:12,  2.49it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [01:29<01:11,  2.49it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [01:29<01:11,  2.48it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [01:30<01:10,  2.51it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [01:30<01:09,  2.51it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [01:31<01:09,  2.51it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [01:31<01:08,  2.51it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [01:31<01:08,  2.52it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [01:32<01:08,  2.48it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [01:32<01:08,  2.49it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [01:33<01:07,  2.50it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [01:33<01:06,  2.53it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [01:33<01:05,  2.54it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [01:34<01:05,  2.54it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [01:34<01:04,  2.56it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [01:35<00:49,  3.32it/s]Running loglikelihood requests:  60%|█████▉    | 239/400 [01:35<00:41,  3.88it/s]Running loglikelihood requests:  60%|██████    | 240/400 [01:35<00:45,  3.48it/s]Running loglikelihood requests:  60%|██████    | 241/400 [01:36<00:49,  3.21it/s]Running loglikelihood requests:  60%|██████    | 242/400 [01:36<00:52,  3.02it/s]Running loglikelihood requests:  61%|██████    | 243/400 [01:37<00:54,  2.88it/s]Running loglikelihood requests:  61%|██████    | 244/400 [01:37<00:56,  2.77it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [01:37<00:57,  2.70it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [01:38<00:58,  2.65it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [01:38<00:58,  2.61it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [01:39<00:58,  2.60it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [01:39<00:58,  2.59it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [01:39<00:58,  2.58it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [01:40<00:58,  2.56it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [01:40<00:57,  2.56it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [01:41<00:57,  2.56it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [01:41<00:56,  2.57it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [01:41<00:56,  2.57it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [01:42<00:55,  2.58it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [01:42<00:55,  2.57it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [01:42<00:55,  2.58it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [01:43<00:54,  2.58it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [01:43<00:54,  2.58it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [01:44<00:53,  2.58it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [01:44<00:53,  2.58it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [01:44<00:52,  2.61it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [01:45<00:39,  3.41it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [01:45<00:42,  3.19it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [01:46<00:44,  3.01it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [01:46<00:45,  2.89it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [01:46<00:46,  2.82it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [01:47<00:46,  2.79it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [01:47<00:47,  2.74it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [01:47<00:47,  2.71it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [01:48<00:46,  2.71it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [01:48<00:47,  2.67it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [01:49<00:47,  2.65it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [01:49<00:47,  2.63it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [01:49<00:46,  2.62it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [01:50<00:46,  2.62it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [01:50<00:46,  2.61it/s]Running loglikelihood requests:  70%|███████   | 280/400 [01:50<00:46,  2.60it/s]Running loglikelihood requests:  70%|███████   | 281/400 [01:51<00:45,  2.61it/s]Running loglikelihood requests:  70%|███████   | 282/400 [01:51<00:45,  2.59it/s]Running loglikelihood requests:  71%|███████   | 283/400 [01:52<00:44,  2.60it/s]Running loglikelihood requests:  71%|███████   | 284/400 [01:52<00:44,  2.59it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [01:52<00:43,  2.62it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [01:53<00:43,  2.64it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [01:53<00:42,  2.64it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [01:53<00:42,  2.66it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [01:54<00:41,  2.67it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [01:54<00:40,  2.70it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [01:55<00:40,  2.70it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [01:55<00:40,  2.69it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [01:55<00:39,  2.68it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [01:56<00:39,  2.68it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [01:56<00:23,  4.33it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [01:56<00:26,  3.80it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [01:57<00:29,  3.45it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [01:57<00:31,  3.22it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [01:58<00:32,  3.05it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [01:58<00:33,  2.93it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [01:58<00:34,  2.83it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [01:59<00:18,  5.15it/s]Running loglikelihood requests:  77%|███████▋  | 308/400 [01:59<00:20,  4.42it/s]Running loglikelihood requests:  77%|███████▋  | 309/400 [01:59<00:23,  3.91it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [02:00<00:26,  3.45it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [02:00<00:27,  3.19it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [02:01<00:29,  2.98it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [02:01<00:30,  2.84it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [02:01<00:31,  2.75it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [02:02<00:31,  2.70it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [02:02<00:31,  2.68it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [02:03<00:31,  2.62it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [02:03<00:31,  2.62it/s]Running loglikelihood requests:  80%|████████  | 321/400 [02:03<00:18,  4.22it/s]Running loglikelihood requests:  80%|████████  | 322/400 [02:04<00:20,  3.77it/s]Running loglikelihood requests:  81%|████████  | 323/400 [02:04<00:22,  3.46it/s]Running loglikelihood requests:  81%|████████  | 324/400 [02:04<00:23,  3.26it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [02:05<00:24,  3.07it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [02:05<00:25,  2.96it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [02:06<00:25,  2.86it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [02:06<00:25,  2.82it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [02:06<00:25,  2.77it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [02:07<00:25,  2.73it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [02:07<00:25,  2.74it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [02:07<00:25,  2.71it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [02:08<00:24,  2.76it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [02:08<00:24,  2.71it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [02:09<00:18,  3.53it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [02:09<00:19,  3.28it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [02:09<00:19,  3.13it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [02:10<00:20,  2.99it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [02:10<00:20,  2.90it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [02:10<00:20,  2.84it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [02:11<00:20,  2.79it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [02:11<00:20,  2.73it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [02:12<00:20,  2.72it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [02:12<00:20,  2.72it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [02:12<00:19,  2.80it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [02:13<00:19,  2.77it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [02:13<00:18,  2.75it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [02:13<00:18,  2.75it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [02:14<00:18,  2.74it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [02:14<00:17,  2.74it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [02:14<00:17,  2.80it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [02:15<00:16,  2.84it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [02:15<00:16,  2.80it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [02:15<00:16,  2.77it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [02:16<00:15,  2.80it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [02:16<00:15,  2.79it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [02:17<00:15,  2.78it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [02:17<00:14,  2.78it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [02:17<00:14,  2.81it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [02:18<00:08,  4.50it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [02:18<00:09,  3.98it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [02:18<00:09,  3.66it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [02:19<00:09,  3.45it/s]Running loglikelihood requests:  92%|█████████▏| 367/400 [02:19<00:10,  3.29it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [02:19<00:10,  3.14it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [02:20<00:10,  3.03it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [02:20<00:10,  2.98it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [02:20<00:09,  2.96it/s]Running loglikelihood requests:  93%|█████████▎| 372/400 [02:21<00:09,  2.98it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [02:21<00:09,  2.97it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [02:21<00:08,  2.94it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [02:22<00:04,  4.76it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [02:22<00:05,  4.24it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [02:22<00:05,  3.85it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [02:23<00:05,  3.62it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [02:23<00:05,  3.47it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [02:23<00:05,  3.35it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [02:24<00:05,  3.24it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [02:24<00:05,  3.18it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [02:24<00:02,  4.95it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [02:25<00:02,  4.38it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [02:25<00:02,  4.84it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [02:25<00:02,  4.34it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [02:26<00:02,  4.00it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [02:26<00:01,  3.84it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [02:26<00:01,  3.50it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [02:27<00:01,  3.33it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [02:27<00:01,  3.33it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [02:27<00:00,  4.32it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [02:28<00:00,  4.26it/s]Running loglikelihood requests: 100%|██████████| 400/400 [02:28<00:00,  2.70it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'openbookqa': {'alias': 'openbookqa', 'acc,none': 0.25, 'acc_stderr,none': 0.04351941398892446, 'acc_norm,none': 0.39, 'acc_norm_stderr,none': 0.04902071300001973}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7187319796021299
0.7542307644255121
0.9218102409329888
0.9507846064925026
0.9244473932111009
0.9697851265705995
0.9088369054586506
0.9555908644563589
0.6065244449438403
0.8380982140772407
0.9227293008726757
0.940339967265193
0.8763319017557598
0.8956221731459367
0.8537768995934096
0.9486125995141542
0.9673324054839537
0.9137514724447725
0.9379677722073356
0.9822722776537973
0.9198472199854921
0.886666948473494
0.9000260607563779
0.9759633945879138
0.9869744580755335
Total groups 76 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 4, 5, 7, 0]
tensor([6, 2, 3, 1, 4, 5, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 5, 2, 4, 3, 7, 0]
tensor([6, 1, 5, 2, 4, 3, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 1, 3, 2, 5, 4, 6, 0]
tensor([7, 1, 3, 2, 5, 4, 6, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 1.0, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 6 to 29
done!
Normal merging for layer 30
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 28 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 27 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

52
cuda:5
cb
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.21s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: cb] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:filelock:Attempting to acquire lock 139671873634912 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139671873634912 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671873634912 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139671873634912 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139670531667968 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139670531667968 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670531667968 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139670531667968 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cb from None to 0
INFO:lm_eval.api.task:Building contexts for cb on rank 0...
  0%|          | 0/56 [00:00<?, ?it/s]100%|██████████| 56/56 [00:00<00:00, 2353.21it/s]
DEBUG:lm_eval.evaluator:Task: cb; number of requests on this rank: 168
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/168 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/168 [00:02<06:55,  2.49s/it]Running loglikelihood requests:   1%|          | 2/168 [00:04<05:34,  2.01s/it]Running loglikelihood requests:   2%|▏         | 4/168 [00:05<03:26,  1.26s/it]Running loglikelihood requests:   3%|▎         | 5/168 [00:07<03:44,  1.38s/it]Running loglikelihood requests:   4%|▍         | 7/168 [00:08<02:53,  1.08s/it]Running loglikelihood requests:   5%|▍         | 8/168 [00:10<03:07,  1.17s/it]Running loglikelihood requests:   6%|▌         | 10/168 [00:11<02:28,  1.06it/s]Running loglikelihood requests:   7%|▋         | 11/168 [00:12<02:38,  1.01s/it]Running loglikelihood requests:   8%|▊         | 13/168 [00:14<02:11,  1.18it/s]Running loglikelihood requests:   8%|▊         | 14/168 [00:15<02:21,  1.09it/s]Running loglikelihood requests:  10%|▉         | 16/168 [00:16<02:00,  1.27it/s]Running loglikelihood requests:  10%|█         | 17/168 [00:17<02:12,  1.14it/s]Running loglikelihood requests:  11%|█▏        | 19/168 [00:18<01:51,  1.34it/s]Running loglikelihood requests:  12%|█▏        | 20/168 [00:19<02:01,  1.22it/s]Running loglikelihood requests:  13%|█▎        | 22/168 [00:20<01:42,  1.42it/s]Running loglikelihood requests:  14%|█▎        | 23/168 [00:21<01:51,  1.30it/s]Running loglikelihood requests:  15%|█▍        | 25/168 [00:22<01:35,  1.49it/s]Running loglikelihood requests:  15%|█▌        | 26/168 [00:23<01:45,  1.35it/s]Running loglikelihood requests:  17%|█▋        | 28/168 [00:24<01:30,  1.55it/s]Running loglikelihood requests:  17%|█▋        | 29/168 [00:25<01:39,  1.40it/s]Running loglikelihood requests:  18%|█▊        | 31/168 [00:26<01:26,  1.59it/s]Running loglikelihood requests:  19%|█▉        | 32/168 [00:27<01:35,  1.43it/s]Running loglikelihood requests:  20%|█▉        | 33/168 [00:28<01:43,  1.31it/s]Running loglikelihood requests:  21%|██        | 35/168 [00:29<01:26,  1.53it/s]Running loglikelihood requests:  22%|██▏       | 37/168 [00:30<01:17,  1.70it/s]Running loglikelihood requests:  23%|██▎       | 38/168 [00:31<01:26,  1.50it/s]Running loglikelihood requests:  24%|██▍       | 40/168 [00:32<01:16,  1.68it/s]Running loglikelihood requests:  24%|██▍       | 41/168 [00:33<01:24,  1.50it/s]Running loglikelihood requests:  26%|██▌       | 43/168 [00:34<01:13,  1.69it/s]Running loglikelihood requests:  26%|██▌       | 44/168 [00:35<01:21,  1.51it/s]Running loglikelihood requests:  27%|██▋       | 46/168 [00:36<01:11,  1.71it/s]Running loglikelihood requests:  28%|██▊       | 47/168 [00:37<01:18,  1.55it/s]Running loglikelihood requests:  29%|██▉       | 49/168 [00:37<01:07,  1.77it/s]Running loglikelihood requests:  30%|██▉       | 50/168 [00:38<01:13,  1.60it/s]Running loglikelihood requests:  30%|███       | 51/168 [00:39<01:19,  1.48it/s]Running loglikelihood requests:  31%|███       | 52/168 [00:40<01:23,  1.39it/s]Running loglikelihood requests:  32%|███▏      | 54/168 [00:41<01:08,  1.67it/s]Running loglikelihood requests:  33%|███▎      | 56/168 [00:42<00:59,  1.88it/s]Running loglikelihood requests:  35%|███▍      | 58/168 [00:43<00:54,  2.02it/s]Running loglikelihood requests:  35%|███▌      | 59/168 [00:43<01:01,  1.77it/s]Running loglikelihood requests:  36%|███▌      | 60/168 [00:44<01:07,  1.59it/s]Running loglikelihood requests:  37%|███▋      | 62/168 [00:45<00:58,  1.82it/s]Running loglikelihood requests:  38%|███▊      | 64/168 [00:46<00:52,  1.99it/s]Running loglikelihood requests:  39%|███▊      | 65/168 [00:47<01:00,  1.69it/s]Running loglikelihood requests:  40%|███▉      | 67/168 [00:48<00:55,  1.83it/s]Running loglikelihood requests:  40%|████      | 68/168 [00:49<01:00,  1.65it/s]Running loglikelihood requests:  42%|████▏     | 70/168 [00:49<00:52,  1.86it/s]Running loglikelihood requests:  42%|████▏     | 71/168 [00:50<00:58,  1.67it/s]Running loglikelihood requests:  43%|████▎     | 73/168 [00:51<00:50,  1.89it/s]Running loglikelihood requests:  44%|████▍     | 74/168 [00:52<00:55,  1.69it/s]Running loglikelihood requests:  45%|████▍     | 75/168 [00:53<01:00,  1.54it/s]Running loglikelihood requests:  45%|████▌     | 76/168 [00:54<01:03,  1.45it/s]Running loglikelihood requests:  46%|████▋     | 78/168 [00:54<00:51,  1.75it/s]Running loglikelihood requests:  48%|████▊     | 80/168 [00:55<00:44,  1.97it/s]Running loglikelihood requests:  49%|████▉     | 82/168 [00:56<00:40,  2.11it/s]Running loglikelihood requests:  49%|████▉     | 83/168 [00:57<00:46,  1.85it/s]Running loglikelihood requests:  51%|█████     | 85/168 [00:58<00:40,  2.05it/s]Running loglikelihood requests:  51%|█████     | 86/168 [00:58<00:45,  1.82it/s]Running loglikelihood requests:  52%|█████▏    | 88/168 [00:59<00:39,  2.04it/s]Running loglikelihood requests:  53%|█████▎    | 89/168 [01:00<00:43,  1.82it/s]Running loglikelihood requests:  54%|█████▎    | 90/168 [01:01<00:47,  1.66it/s]Running loglikelihood requests:  55%|█████▍    | 92/168 [01:02<00:40,  1.87it/s]Running loglikelihood requests:  56%|█████▌    | 94/168 [01:02<00:36,  2.02it/s]Running loglikelihood requests:  57%|█████▋    | 95/168 [01:03<00:41,  1.76it/s]Running loglikelihood requests:  58%|█████▊    | 97/168 [01:04<00:36,  1.94it/s]Running loglikelihood requests:  58%|█████▊    | 98/168 [01:05<00:40,  1.71it/s]Running loglikelihood requests:  60%|█████▉    | 100/168 [01:06<00:35,  1.92it/s]Running loglikelihood requests:  60%|██████    | 101/168 [01:07<00:39,  1.71it/s]Running loglikelihood requests:  61%|██████▏   | 103/168 [01:07<00:33,  1.93it/s]Running loglikelihood requests:  62%|██████▏   | 104/168 [01:08<00:38,  1.68it/s]Running loglikelihood requests:  62%|██████▎   | 105/168 [01:09<00:39,  1.59it/s]Running loglikelihood requests:  63%|██████▎   | 106/168 [01:10<00:40,  1.53it/s]Running loglikelihood requests:  64%|██████▍   | 108/168 [01:11<00:32,  1.87it/s]Running loglikelihood requests:  65%|██████▌   | 110/168 [01:11<00:27,  2.12it/s]Running loglikelihood requests:  66%|██████▌   | 111/168 [01:12<00:29,  1.90it/s]Running loglikelihood requests:  67%|██████▋   | 113/168 [01:13<00:25,  2.15it/s]Running loglikelihood requests:  68%|██████▊   | 114/168 [01:13<00:28,  1.93it/s]Running loglikelihood requests:  69%|██████▉   | 116/168 [01:14<00:23,  2.17it/s]Running loglikelihood requests:  70%|███████   | 118/168 [01:15<00:21,  2.35it/s]Running loglikelihood requests:  71%|███████   | 119/168 [01:16<00:24,  2.03it/s]Running loglikelihood requests:  71%|███████▏  | 120/168 [01:16<00:26,  1.84it/s]Running loglikelihood requests:  73%|███████▎  | 122/168 [01:17<00:22,  2.07it/s]Running loglikelihood requests:  74%|███████▍  | 124/168 [01:18<00:19,  2.22it/s]Running loglikelihood requests:  74%|███████▍  | 125/168 [01:19<00:22,  1.93it/s]Running loglikelihood requests:  76%|███████▌  | 127/168 [01:20<00:19,  2.11it/s]Running loglikelihood requests:  76%|███████▌  | 128/168 [01:20<00:21,  1.88it/s]Running loglikelihood requests:  77%|███████▋  | 129/168 [01:21<00:22,  1.74it/s]Running loglikelihood requests:  78%|███████▊  | 131/168 [01:22<00:18,  2.05it/s]Running loglikelihood requests:  79%|███████▉  | 133/168 [01:22<00:15,  2.31it/s]Running loglikelihood requests:  80%|███████▉  | 134/168 [01:23<00:16,  2.08it/s]Running loglikelihood requests:  81%|████████  | 136/168 [01:24<00:13,  2.36it/s]Running loglikelihood requests:  82%|████████▏ | 137/168 [01:24<00:14,  2.11it/s]Running loglikelihood requests:  82%|████████▏ | 138/168 [01:25<00:15,  1.94it/s]Running loglikelihood requests:  83%|████████▎ | 139/168 [01:26<00:15,  1.82it/s]Running loglikelihood requests:  83%|████████▎ | 140/168 [01:26<00:16,  1.73it/s]Running loglikelihood requests:  85%|████████▍ | 142/168 [01:27<00:12,  2.11it/s]Running loglikelihood requests:  86%|████████▌ | 144/168 [01:28<00:10,  2.39it/s]Running loglikelihood requests:  87%|████████▋ | 146/168 [01:28<00:08,  2.60it/s]Running loglikelihood requests:  88%|████████▊ | 148/168 [01:29<00:07,  2.76it/s]Running loglikelihood requests:  89%|████████▊ | 149/168 [01:30<00:07,  2.40it/s]Running loglikelihood requests:  89%|████████▉ | 150/168 [01:30<00:08,  2.13it/s]Running loglikelihood requests:  90%|█████████ | 152/168 [01:31<00:06,  2.44it/s]Running loglikelihood requests:  92%|█████████▏| 154/168 [01:31<00:05,  2.66it/s]Running loglikelihood requests:  92%|█████████▏| 155/168 [01:32<00:05,  2.34it/s]Running loglikelihood requests:  93%|█████████▎| 157/168 [01:33<00:04,  2.59it/s]Running loglikelihood requests:  94%|█████████▍| 158/168 [01:33<00:04,  2.30it/s]Running loglikelihood requests:  95%|█████████▌| 160/168 [01:34<00:03,  2.63it/s]Running loglikelihood requests:  96%|█████████▌| 161/168 [01:35<00:02,  2.38it/s]Running loglikelihood requests:  97%|█████████▋| 163/168 [01:35<00:01,  2.72it/s]Running loglikelihood requests:  98%|█████████▊| 164/168 [01:36<00:01,  2.45it/s]Running loglikelihood requests:  99%|█████████▉| 166/168 [01:36<00:00,  2.80it/s]Running loglikelihood requests:  99%|█████████▉| 167/168 [01:37<00:00,  2.53it/s]Running loglikelihood requests: 100%|██████████| 168/168 [01:37<00:00,  1.73it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'cb': {'alias': 'cb', 'acc,none': 0.44642857142857145, 'acc_stderr,none': 0.06703189227942397, 'f1,none': np.float64(0.2946127946127946), 'f1_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8754479021250823
0.8035282713865031
0.9500865550679058
0.9469110267801961
0.9212663689239236
0.9365178765256775
0.671589453090406
0.6744336218334667
0.8076345549626031
0.7976470386087894
0.807072393829993
0.6600400889592184
0.7484904863798857
0.9363063771008698
0.6357711114598822
0.9166089836828051
0.6715835426958833
0.7409884813902188
0.412428535140908
0.8747283305135303
0.8491219158212996
0.9125101690232402
0.8366676259845086
0.705936129020536
0.7920385356495101
0.9243830461584077
0.9274604399644588
0.7835428130351293
0.8119111717866335
Total groups 67 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 5, 2, 7, 1, 4, 0]
tensor([6, 3, 5, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 7, 3, 6, 1, 2, 0]
tensor([5, 4, 7, 3, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 1, 6, 3, 7, 2, 4, 0]
tensor([5, 1, 6, 3, 7, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 2, 0, 1, 5, 0, 1, 3]
tensor([4, 2, 0, 1, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 3, 0, 2, 1, 1, 5, 0]
tensor([4, 3, 0, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 2 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 12
done!
Normal merging for layer 13
tensor([2, 5])
tensor(2)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 14
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 15 to 18
done!
Normal merging for layer 19
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 20 to 23
done!
Normal merging for layer 24
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 27 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 26 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

228
cuda:6
qqp
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.16s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139670531316080 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139670531316080 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670531316080 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139670531316080 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139672002822416 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139672002822416 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139672002822416 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139672002822416 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qqp from None to 0
INFO:lm_eval.api.task:Building contexts for qqp on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2355.24it/s]
DEBUG:lm_eval.evaluator:Task: qqp; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:34,  1.68s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:26,  1.35it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:47,  1.81it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:31,  2.11it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:21,  2.34it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:15,  2.50it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:11,  2.62it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:08,  2.71it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:05,  2.78it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:08<01:03,  2.83it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:02,  2.87it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:00,  2.92it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<00:59,  2.97it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<00:57,  3.00it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<00:56,  3.03it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<00:55,  3.04it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:12<00:54,  3.07it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<00:53,  3.08it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:13<00:52,  3.10it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:14<00:51,  3.11it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:15<00:51,  3.11it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:15<00:51,  3.05it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:16<00:51,  3.01it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:17<00:50,  3.03it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:17<00:50,  3.02it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:18<00:49,  2.99it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:19<00:50,  2.94it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:19<00:49,  2.96it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:20<00:47,  2.98it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:21<00:46,  3.05it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:21<00:44,  3.09it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:22<00:43,  3.12it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:23<00:42,  3.16it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:23<00:41,  3.18it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:24<00:41,  3.19it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:24<00:40,  3.21it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:25<00:39,  3.21it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:26<00:38,  3.22it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:26<00:38,  3.23it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:27<00:37,  3.24it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:28<00:36,  3.25it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:28<00:35,  3.26it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:29<00:35,  3.27it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:29<00:34,  3.27it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:30<00:33,  3.28it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:31<00:33,  3.28it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:31<00:32,  3.29it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:32<00:31,  3.30it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:32<00:31,  3.31it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:33<00:30,  3.33it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:34<00:29,  3.34it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:34<00:28,  3.35it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:35<00:28,  3.36it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:35<00:27,  3.38it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:36<00:26,  3.38it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:37<00:26,  3.40it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:37<00:25,  3.42it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:38<00:24,  3.42it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:38<00:24,  3.43it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:39<00:23,  3.44it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:39<00:22,  3.45it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:40<00:22,  3.46it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:41<00:21,  3.46it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:41<00:21,  3.47it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:42<00:20,  3.48it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:42<00:19,  3.50it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:43<00:19,  3.51it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:43<00:18,  3.51it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:44<00:17,  3.52it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:45<00:17,  3.52it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:45<00:16,  3.53it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:46<00:16,  3.54it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:46<00:15,  3.55it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:47<00:14,  3.56it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:47<00:14,  3.56it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:48<00:13,  3.58it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:48<00:13,  3.58it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:49<00:12,  3.59it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:50<00:11,  3.61it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:50<00:11,  3.62it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:51<00:10,  3.57it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:51<00:10,  3.59it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:52<00:09,  3.62it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:52<00:09,  3.40it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:53<00:09,  3.38it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:54<00:08,  3.37it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:54<00:08,  3.37it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:55<00:07,  3.38it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:55<00:06,  3.47it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:56<00:05,  3.52it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:56<00:05,  3.58it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:57<00:04,  3.60it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:58<00:04,  3.64it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:58<00:03,  3.65it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:59<00:02,  3.69it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:59<00:02,  3.72it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:00<00:01,  3.74it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:00<00:01,  3.76it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:01<00:00,  3.69it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:01<00:00,  3.66it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:01<00:00,  3.23it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:59,  1.20s/it]  2%|▏         | 2/100 [00:02<01:57,  1.20s/it]  3%|▎         | 3/100 [00:03<01:56,  1.20s/it]  4%|▍         | 4/100 [00:04<01:55,  1.20s/it]  5%|▌         | 5/100 [00:06<01:54,  1.20s/it]  6%|▌         | 6/100 [00:07<01:53,  1.20s/it]  7%|▋         | 7/100 [00:08<01:52,  1.20s/it]  8%|▊         | 8/100 [00:09<01:50,  1.20s/it]  9%|▉         | 9/100 [00:10<01:49,  1.21s/it] 10%|█         | 10/100 [00:12<01:48,  1.20s/it] 11%|█         | 11/100 [00:13<01:47,  1.20s/it] 12%|█▏        | 12/100 [00:14<01:46,  1.21s/it] 13%|█▎        | 13/100 [00:15<01:45,  1.22s/it] 14%|█▍        | 14/100 [00:16<01:44,  1.21s/it] 15%|█▌        | 15/100 [00:18<01:42,  1.21s/it] 16%|█▌        | 16/100 [00:19<01:41,  1.21s/it] 17%|█▋        | 17/100 [00:20<01:40,  1.21s/it] 18%|█▊        | 18/100 [00:21<01:38,  1.20s/it] 19%|█▉        | 19/100 [00:22<01:37,  1.20s/it] 20%|██        | 20/100 [00:24<01:36,  1.20s/it] 21%|██        | 21/100 [00:25<01:35,  1.20s/it] 22%|██▏       | 22/100 [00:26<01:33,  1.20s/it] 23%|██▎       | 23/100 [00:27<01:32,  1.20s/it] 24%|██▍       | 24/100 [00:28<01:31,  1.20s/it] 25%|██▌       | 25/100 [00:30<01:30,  1.20s/it] 26%|██▌       | 26/100 [00:31<01:29,  1.20s/it] 27%|██▋       | 27/100 [00:32<01:27,  1.20s/it] 28%|██▊       | 28/100 [00:33<01:26,  1.20s/it] 29%|██▉       | 29/100 [00:34<01:25,  1.20s/it] 30%|███       | 30/100 [00:36<01:24,  1.20s/it] 31%|███       | 31/100 [00:37<01:23,  1.20s/it] 32%|███▏      | 32/100 [00:38<01:21,  1.20s/it] 33%|███▎      | 33/100 [00:39<01:20,  1.20s/it] 34%|███▍      | 34/100 [00:40<01:19,  1.20s/it] 35%|███▌      | 35/100 [00:42<01:18,  1.20s/it] 36%|███▌      | 36/100 [00:43<01:17,  1.20s/it] 37%|███▋      | 37/100 [00:44<01:15,  1.20s/it] 38%|███▊      | 38/100 [00:45<01:14,  1.20s/it] 39%|███▉      | 39/100 [00:46<01:13,  1.20s/it] 40%|████      | 40/100 [00:48<01:12,  1.21s/it] 41%|████      | 41/100 [00:49<01:11,  1.21s/it] 42%|████▏     | 42/100 [00:50<01:10,  1.21s/it] 43%|████▎     | 43/100 [00:51<01:08,  1.21s/it] 44%|████▍     | 44/100 [00:53<01:07,  1.21s/it] 45%|████▌     | 45/100 [00:54<01:06,  1.21s/it] 46%|████▌     | 46/100 [00:55<01:05,  1.20s/it] 47%|████▋     | 47/100 [00:56<01:03,  1.20s/it] 48%|████▊     | 48/100 [00:57<01:02,  1.21s/it] 49%|████▉     | 49/100 [00:59<01:01,  1.21s/it] 50%|█████     | 50/100 [01:00<01:00,  1.21s/it] 51%|█████     | 51/100 [01:01<00:59,  1.21s/it] 52%|█████▏    | 52/100 [01:02<00:57,  1.20s/it] 53%|█████▎    | 53/100 [01:03<00:56,  1.20s/it] 54%|█████▍    | 54/100 [01:05<00:55,  1.20s/it] 55%|█████▌    | 55/100 [01:06<00:54,  1.20s/it] 56%|█████▌    | 56/100 [01:07<00:53,  1.21s/it] 57%|█████▋    | 57/100 [01:08<00:52,  1.21s/it] 58%|█████▊    | 58/100 [01:09<00:51,  1.22s/it] 59%|█████▉    | 59/100 [01:11<00:49,  1.21s/it] 60%|██████    | 60/100 [01:12<00:48,  1.21s/it] 61%|██████    | 61/100 [01:13<00:47,  1.21s/it] 62%|██████▏   | 62/100 [01:14<00:46,  1.23s/it] 63%|██████▎   | 63/100 [01:16<00:45,  1.23s/it] 64%|██████▍   | 64/100 [01:17<00:44,  1.23s/it] 65%|██████▌   | 65/100 [01:18<00:42,  1.22s/it] 66%|██████▌   | 66/100 [01:19<00:41,  1.22s/it] 67%|██████▋   | 67/100 [01:20<00:39,  1.21s/it] 68%|██████▊   | 68/100 [01:22<00:38,  1.21s/it] 69%|██████▉   | 69/100 [01:23<00:37,  1.20s/it] 70%|███████   | 70/100 [01:24<00:36,  1.20s/it] 71%|███████   | 71/100 [01:25<00:34,  1.20s/it] 72%|███████▏  | 72/100 [01:26<00:33,  1.21s/it] 73%|███████▎  | 73/100 [01:28<00:32,  1.21s/it] 74%|███████▍  | 74/100 [01:29<00:31,  1.20s/it] 75%|███████▌  | 75/100 [01:30<00:30,  1.20s/it] 76%|███████▌  | 76/100 [01:31<00:29,  1.21s/it] 77%|███████▋  | 77/100 [01:32<00:27,  1.21s/it] 78%|███████▊  | 78/100 [01:34<00:26,  1.21s/it] 79%|███████▉  | 79/100 [01:35<00:25,  1.21s/it] 80%|████████  | 80/100 [01:36<00:24,  1.21s/it] 81%|████████  | 81/100 [01:37<00:22,  1.21s/it] 82%|████████▏ | 82/100 [01:38<00:21,  1.20s/it] 83%|████████▎ | 83/100 [01:40<00:20,  1.20s/it] 84%|████████▍ | 84/100 [01:41<00:19,  1.20s/it] 85%|████████▌ | 85/100 [01:42<00:18,  1.20s/it] 86%|████████▌ | 86/100 [01:43<00:16,  1.20s/it] 87%|████████▋ | 87/100 [01:44<00:15,  1.20s/it] 88%|████████▊ | 88/100 [01:46<00:14,  1.20s/it] 89%|████████▉ | 89/100 [01:47<00:13,  1.20s/it] 90%|█████████ | 90/100 [01:48<00:12,  1.20s/it] 91%|█████████ | 91/100 [01:49<00:10,  1.20s/it] 92%|█████████▏| 92/100 [01:50<00:09,  1.20s/it] 93%|█████████▎| 93/100 [01:52<00:08,  1.20s/it] 94%|█████████▍| 94/100 [01:53<00:07,  1.20s/it] 95%|█████████▌| 95/100 [01:54<00:06,  1.20s/it] 96%|█████████▌| 96/100 [01:55<00:04,  1.20s/it] 97%|█████████▋| 97/100 [01:57<00:03,  1.20s/it] 98%|█████████▊| 98/100 [01:58<00:02,  1.20s/it] 99%|█████████▉| 99/100 [01:59<00:01,  1.20s/it]100%|██████████| 100/100 [02:00<00:00,  1.20s/it]100%|██████████| 100/100 [02:00<00:00,  1.21s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'qqp': {'alias': 'qqp', 'acc,none': 0.3, 'acc_stderr,none': 0.04605661864718382, 'f1,none': np.float64(0.46153846153846156), 'f1_stderr,none': 0.05409397997448054}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
0.5983336442242687
0.5414593978662989
0.3299447012562784
0.4799857918750434
0.8524920468933548
0.713165518996795
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 5, 2, 6, 1, 3, 0]
tensor([7, 4, 5, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 4, 5, 2, 7, 3, 0, 1]
tensor([6, 4, 5, 2, 7, 3, 0, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 7, 4, 2, 5, 0, 1, 3]
tensor([6, 7, 4, 2, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 6, 4, 3, 7, 1, 0, 2]
tensor([5, 6, 4, 3, 7, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 26 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 25 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

69
cuda:7
rte
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:01<01:01, 61.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 36.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 40.41s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139670933042816 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139670933042816 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670933042816 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139670933042816 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139671869629280 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671869629280 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671869629280 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671869629280 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of rte from None to 0
INFO:lm_eval.api.task:Building contexts for rte on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2599.78it/s]
DEBUG:lm_eval.evaluator:Task: rte; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:02<07:18,  2.20s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:03<03:38,  1.11s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:05<02:53,  1.12it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:06<02:32,  1.27it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:07<02:18,  1.38it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:08<02:11,  1.43it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:10<02:08,  1.45it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:11<02:03,  1.50it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:12<01:58,  1.54it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:13<01:54,  1.57it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:15<01:51,  1.60it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:16<01:47,  1.65it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:17<01:45,  1.67it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:18<01:42,  1.69it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:19<01:38,  1.73it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:20<01:34,  1.79it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:21<01:31,  1.82it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:22<01:29,  1.84it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:23<01:29,  1.83it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:24<01:26,  1.86it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:25<01:25,  1.86it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:27<01:25,  1.84it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:28<01:24,  1.83it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:29<01:20,  1.91it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:30<01:18,  1.92it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:31<01:14,  2.00it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:31<01:10,  2.07it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:32<01:10,  2.05it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:33<01:08,  2.09it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:34<01:07,  2.07it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:35<01:06,  2.08it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:36<01:04,  2.13it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:37<01:03,  2.13it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:38<01:03,  2.10it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:39<01:00,  2.18it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:40<00:59,  2.18it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:41<00:57,  2.21it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:42<00:56,  2.23it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:42<00:54,  2.26it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:43<00:53,  2.26it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:44<00:49,  2.38it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:45<00:49,  2.36it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:46<00:47,  2.40it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:47<00:45,  2.48it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:47<00:45,  2.43it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:48<00:44,  2.45it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:49<00:42,  2.54it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:50<00:40,  2.60it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:51<00:42,  2.42it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:51<00:40,  2.46it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:52<00:42,  2.34it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:53<00:40,  2.42it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:54<00:40,  2.37it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:55<00:37,  2.46it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:56<00:37,  2.45it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:56<00:34,  2.56it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:57<00:35,  2.48it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:58<00:34,  2.46it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:59<00:33,  2.51it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:59<00:32,  2.53it/s]Running loglikelihood requests:  60%|██████    | 121/200 [01:00<00:30,  2.59it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [01:01<00:29,  2.60it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [01:02<00:28,  2.62it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [01:03<00:29,  2.47it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [01:03<00:28,  2.51it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [01:04<00:26,  2.59it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [01:05<00:26,  2.50it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [01:06<00:26,  2.50it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:06<00:23,  2.63it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:07<00:23,  2.57it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:08<00:22,  2.65it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:09<00:20,  2.73it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:09<00:19,  2.83it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:10<00:18,  2.90it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:11<00:20,  2.54it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:12<00:19,  2.49it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:12<00:17,  2.61it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:13<00:17,  2.64it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:14<00:15,  2.78it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:15<00:15,  2.63it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:16<00:16,  2.36it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:16<00:14,  2.47it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:17<00:13,  2.58it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:18<00:12,  2.68it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:18<00:10,  2.83it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:19<00:09,  2.95it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:20<00:09,  2.94it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:21<00:10,  2.45it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:22<00:09,  2.44it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:22<00:08,  2.62it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:23<00:06,  2.82it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:24<00:05,  2.93it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:24<00:05,  2.89it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:25<00:04,  2.87it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:26<00:03,  3.02it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:26<00:03,  2.90it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:27<00:02,  3.07it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:27<00:01,  3.18it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:28<00:01,  2.85it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:29<00:00,  3.06it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:29<00:00,  2.24it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'rte': {'alias': 'rte', 'acc,none': 0.5, 'acc_stderr,none': 0.050251890762960605}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
0.5728915095234594
0.1682455054057436
0.93212414632396
0.9148362604533635
0.8268537756297094
0.7592245907029287
0.7256008379011685
0.7109756105942956
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
Total groups 73 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 7, 1, 6, 4, 3, 0]
tensor([5, 2, 7, 1, 6, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 6, 0, 7, 3, 4, 1]
tensor([5, 2, 6, 0, 7, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 7, 2, 5, 4, 3, 0]
tensor([6, 1, 7, 2, 5, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 2, 4, 1, 5, 0]
tensor([6, 3, 7, 2, 4, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 5, 6, 2, 3, 1, 4, 0]
tensor([7, 5, 6, 2, 3, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 5, 4, 1, 0, 1, 3]
tensor([0, 2, 5, 4, 1, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([0, 5])
tensor(0)
tensor([4, 6])
tensor(4)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 30
done!
Normal merging for layer 31
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 25 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 24 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

216
cuda:0
eq_bench
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.34s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 35.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.81s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:eq_bench: No `until` specified in `generation_kwargs`! Defaulting to the fewshot_delimiter='\n\n'
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 787
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/pbevan11/EQ-Bench/pbevan11/EQ-Bench.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/revision/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3 HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3?recursive=False&expand=False HTTP/1.1" 200 301
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/revision/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3 HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_infos.json HTTP/1.1" 404 0
DEBUG:filelock:Attempting to acquire lock 139669989352000 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139669989352000 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669989352000 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139669989352000 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Attempting to acquire lock 139645835393984 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139645835393984 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645835393984 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139645835393984 released on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:eq_bench: Using gen_kwargs: {'do_sample': False, 'temperature': 0.0, 'max_gen_toks': 80, 'until': ['\n\n']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of eq_bench from None to 0
INFO:lm_eval.api.task:Building contexts for eq_bench on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 33096.38it/s]
DEBUG:lm_eval.evaluator:Task: eq_bench; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:08<14:15,  8.64s/it]Running generate_until requests:   2%|▏         | 2/100 [00:15<12:47,  7.84s/it]Running generate_until requests:   3%|▎         | 3/100 [00:22<11:56,  7.39s/it]Running generate_until requests:   4%|▍         | 4/100 [00:29<11:35,  7.25s/it]Running generate_until requests:   5%|▌         | 5/100 [00:36<11:20,  7.16s/it]Running generate_until requests:   6%|▌         | 6/100 [00:43<11:11,  7.15s/it]Running generate_until requests:   7%|▋         | 7/100 [00:50<10:48,  6.97s/it]Running generate_until requests:   8%|▊         | 8/100 [00:57<10:31,  6.86s/it]Running generate_until requests:   9%|▉         | 9/100 [01:04<10:41,  7.04s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<10:15,  6.84s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:58,  6.73s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:24<10:11,  6.95s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:31<10:02,  6.93s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:38<09:49,  6.85s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:45<09:39,  6.82s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:51<09:19,  6.66s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:57<09:04,  6.56s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:04<08:49,  6.45s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:10<08:41,  6.43s/it]Running generate_until requests:  20%|██        | 20/100 [02:16<08:29,  6.37s/it]Running generate_until requests:  21%|██        | 21/100 [02:23<08:29,  6.45s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:29<08:24,  6.46s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:36<08:18,  6.47s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:42<08:12,  6.48s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:49<08:15,  6.61s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:55<07:58,  6.47s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:01<07:44,  6.36s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:08<07:41,  6.41s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:14<07:34,  6.40s/it]Running generate_until requests:  30%|███       | 30/100 [03:21<07:28,  6.41s/it]Running generate_until requests:  31%|███       | 31/100 [03:27<07:16,  6.33s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:34<07:22,  6.51s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:40<07:10,  6.43s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:46<06:59,  6.36s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:53<06:51,  6.33s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:59<06:39,  6.24s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:05<06:32,  6.23s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:11<06:18,  6.11s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:17<06:16,  6.17s/it]Running generate_until requests:  40%|████      | 40/100 [04:23<06:07,  6.12s/it]Running generate_until requests:  41%|████      | 41/100 [04:30<06:16,  6.39s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:36<06:09,  6.37s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:42<05:54,  6.21s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:48<05:42,  6.11s/it]Running generate_until requests:  45%|████▌     | 45/100 [04:54<05:31,  6.03s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:00<05:28,  6.09s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:07<05:30,  6.24s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:12<05:18,  6.13s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:18<05:10,  6.08s/it]Running generate_until requests:  50%|█████     | 50/100 [05:25<05:06,  6.12s/it]Running generate_until requests:  51%|█████     | 51/100 [05:31<04:56,  6.06s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:36<04:48,  6.02s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:42<04:36,  5.88s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:48<04:30,  5.88s/it]Running generate_until requests:  55%|█████▌    | 55/100 [05:53<04:20,  5.78s/it]Running generate_until requests:  56%|█████▌    | 56/100 [05:59<04:12,  5.73s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:05<04:08,  5.78s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:11<04:00,  5.73s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:16<03:56,  5.78s/it]Running generate_until requests:  60%|██████    | 60/100 [06:22<03:53,  5.84s/it]Running generate_until requests:  61%|██████    | 61/100 [06:29<03:50,  5.91s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:35<03:47,  5.99s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:40<03:36,  5.84s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:46<03:27,  5.75s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:51<03:20,  5.73s/it]Running generate_until requests:  66%|██████▌   | 66/100 [06:54<02:38,  4.65s/it]Running generate_until requests:  67%|██████▋   | 67/100 [06:59<02:42,  4.92s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:05<02:48,  5.27s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:11<02:47,  5.40s/it]Running generate_until requests:  70%|███████   | 70/100 [07:16<02:43,  5.46s/it]Running generate_until requests:  71%|███████   | 71/100 [07:19<02:08,  4.44s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:25<02:18,  4.96s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:27<01:50,  4.09s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:32<01:56,  4.48s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:38<01:58,  4.74s/it]Running generate_until requests:  76%|███████▌  | 76/100 [07:43<01:57,  4.90s/it]Running generate_until requests:  77%|███████▋  | 77/100 [07:48<01:57,  5.10s/it]Running generate_until requests:  78%|███████▊  | 78/100 [07:54<01:53,  5.18s/it]Running generate_until requests:  79%|███████▉  | 79/100 [07:59<01:50,  5.28s/it]Running generate_until requests:  80%|████████  | 80/100 [08:05<01:46,  5.31s/it]Running generate_until requests:  81%|████████  | 81/100 [08:10<01:41,  5.33s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:15<01:35,  5.31s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:20<01:29,  5.27s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:26<01:25,  5.32s/it]Running generate_until requests:  85%|████████▌ | 85/100 [08:32<01:21,  5.42s/it]Running generate_until requests:  86%|████████▌ | 86/100 [08:37<01:15,  5.37s/it]Running generate_until requests:  87%|████████▋ | 87/100 [08:39<00:56,  4.32s/it]Running generate_until requests:  88%|████████▊ | 88/100 [08:44<00:56,  4.71s/it]Running generate_until requests:  89%|████████▉ | 89/100 [08:50<00:54,  4.96s/it]Running generate_until requests:  90%|█████████ | 90/100 [08:56<00:51,  5.19s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:01<00:46,  5.21s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:06<00:42,  5.28s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:11<00:36,  5.22s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:17<00:32,  5.39s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:22<00:26,  5.30s/it]Running generate_until requests:  96%|█████████▌| 96/100 [09:24<00:17,  4.26s/it]Running generate_until requests:  97%|█████████▋| 97/100 [09:26<00:10,  3.50s/it]Running generate_until requests:  98%|█████████▊| 98/100 [09:31<00:08,  4.02s/it]Running generate_until requests:  99%|█████████▉| 99/100 [09:36<00:04,  4.37s/it]Running generate_until requests: 100%|██████████| 100/100 [09:41<00:00,  4.58s/it]Running generate_until requests: 100%|██████████| 100/100 [09:41<00:00,  5.82s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'eq_bench': {'alias': 'eq_bench', 'eqbench,none': -9.075457665929516, 'eqbench_stderr,none': 3.722206958756126, 'percent_parseable,none': 94.0, 'percent_parseable_stderr,none': 2.3868325657594203}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6639018561214101
0.48429197946127234
0.9515491395508957
0.5799692129526803
0.8892832964569847
0.5583880670373075
0.6815933931575056
0.8296184325732159
0.8572432652494972
0.7515568516065031
0.7498285715344476
0.6640770908835784
0.7344737024966144
0.8863376660708159
0.7840365418395101
0.7895254515113318
0.915557892351788
0.8364869594903738
0.8262221986876632
0.8424210311799578
0.9059689119946415
0.938938460185247
0.9139805997979817
0.8791150946846779
0.9604433557463424
0.36429086085480555
0.6224935475213342
0.9367462541020114
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[2, 3, 7, 0, 6, 1, 5, 4]
tensor([2, 3, 7, 0, 6, 1, 5, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 2, 1, 6, 0, 3, 7]
tensor([4, 5, 2, 1, 6, 0, 3, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 7, 1, 2, 6]
tensor([5, 3, 4, 0, 7, 1, 2, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 6, 4, 0, 3, 1, 2, 7]
tensor([5, 6, 4, 0, 3, 1, 2, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 2, 3]
tensor([0, 1, 3, 0, 1, 2, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 0, 1, 1, 2, 3]
tensor([2, 3, 0, 0, 1, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 3, 1, 2, 3]
tensor([2, 0, 1, 0, 3, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 2, 1, 3, 3]
tensor([2, 0, 1, 0, 2, 1, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 6 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
tensor([2, 7])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 18
done!
Normal merging for layer 19
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
tensor([1, 7])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 6])
tensor(0)
tensor([4, 7])
tensor(4)
done!
Normal merging for layer 21
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 4])
tensor(0)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 22 to 24
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 29
done!
Normal merging for layer 30
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 24 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.7017 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 23 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

253
cuda:1
cb
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.26s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: cb] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:filelock:Attempting to acquire lock 139670532425440 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139670532425440 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670532425440 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139670532425440 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139649117772000 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139649117772000 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649117772000 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139649117772000 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cb from None to 0
INFO:lm_eval.api.task:Building contexts for cb on rank 0...
  0%|          | 0/56 [00:00<?, ?it/s]100%|██████████| 56/56 [00:00<00:00, 2184.43it/s]
DEBUG:lm_eval.evaluator:Task: cb; number of requests on this rank: 168
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/168 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/168 [00:02<06:15,  2.25s/it]Running loglikelihood requests:   1%|          | 2/168 [00:03<05:18,  1.92s/it]Running loglikelihood requests:   2%|▏         | 4/168 [00:05<03:23,  1.24s/it]Running loglikelihood requests:   3%|▎         | 5/168 [00:07<03:43,  1.37s/it]Running loglikelihood requests:   4%|▍         | 7/168 [00:08<02:52,  1.07s/it]Running loglikelihood requests:   5%|▍         | 8/168 [00:10<03:07,  1.17s/it]Running loglikelihood requests:   6%|▌         | 10/168 [00:11<02:32,  1.04it/s]Running loglikelihood requests:   7%|▋         | 11/168 [00:12<02:43,  1.04s/it]Running loglikelihood requests:   8%|▊         | 13/168 [00:14<02:16,  1.14it/s]Running loglikelihood requests:   8%|▊         | 14/168 [00:15<02:28,  1.04it/s]Running loglikelihood requests:  10%|▉         | 16/168 [00:16<02:06,  1.20it/s]Running loglikelihood requests:  10%|█         | 17/168 [00:17<02:19,  1.08it/s]Running loglikelihood requests:  11%|█▏        | 19/168 [00:19<01:56,  1.28it/s]Running loglikelihood requests:  12%|█▏        | 20/168 [00:20<02:06,  1.17it/s]Running loglikelihood requests:  13%|█▎        | 22/168 [00:21<01:46,  1.38it/s]Running loglikelihood requests:  14%|█▎        | 23/168 [00:22<01:55,  1.26it/s]Running loglikelihood requests:  15%|█▍        | 25/168 [00:23<01:37,  1.46it/s]Running loglikelihood requests:  15%|█▌        | 26/168 [00:24<01:47,  1.32it/s]Running loglikelihood requests:  17%|█▋        | 28/168 [00:25<01:32,  1.52it/s]Running loglikelihood requests:  17%|█▋        | 29/168 [00:26<01:41,  1.37it/s]Running loglikelihood requests:  18%|█▊        | 31/168 [00:27<01:28,  1.54it/s]Running loglikelihood requests:  19%|█▉        | 32/168 [00:28<01:37,  1.39it/s]Running loglikelihood requests:  20%|█▉        | 33/168 [00:29<01:45,  1.28it/s]Running loglikelihood requests:  21%|██        | 35/168 [00:30<01:28,  1.50it/s]Running loglikelihood requests:  22%|██▏       | 37/168 [00:31<01:18,  1.66it/s]Running loglikelihood requests:  23%|██▎       | 38/168 [00:32<01:28,  1.48it/s]Running loglikelihood requests:  24%|██▍       | 40/168 [00:33<01:17,  1.66it/s]Running loglikelihood requests:  24%|██▍       | 41/168 [00:34<01:25,  1.48it/s]Running loglikelihood requests:  26%|██▌       | 43/168 [00:34<01:15,  1.67it/s]Running loglikelihood requests:  26%|██▌       | 44/168 [00:36<01:25,  1.46it/s]Running loglikelihood requests:  27%|██▋       | 46/168 [00:36<01:14,  1.65it/s]Running loglikelihood requests:  28%|██▊       | 47/168 [00:37<01:21,  1.49it/s]Running loglikelihood requests:  29%|██▉       | 49/168 [00:38<01:10,  1.70it/s]Running loglikelihood requests:  30%|██▉       | 50/168 [00:39<01:17,  1.53it/s]Running loglikelihood requests:  30%|███       | 51/168 [00:40<01:23,  1.41it/s]Running loglikelihood requests:  31%|███       | 52/168 [00:41<01:27,  1.32it/s]Running loglikelihood requests:  32%|███▏      | 54/168 [00:42<01:11,  1.59it/s]Running loglikelihood requests:  33%|███▎      | 56/168 [00:43<01:03,  1.76it/s]Running loglikelihood requests:  35%|███▍      | 58/168 [00:44<00:57,  1.92it/s]Running loglikelihood requests:  35%|███▌      | 59/168 [00:45<01:04,  1.70it/s]Running loglikelihood requests:  36%|███▌      | 60/168 [00:45<01:10,  1.54it/s]Running loglikelihood requests:  37%|███▋      | 62/168 [00:46<00:59,  1.77it/s]Running loglikelihood requests:  38%|███▊      | 64/168 [00:47<00:53,  1.94it/s]Running loglikelihood requests:  39%|███▊      | 65/168 [00:48<01:00,  1.71it/s]Running loglikelihood requests:  40%|███▉      | 67/168 [00:49<00:53,  1.90it/s]Running loglikelihood requests:  40%|████      | 68/168 [00:50<00:59,  1.69it/s]Running loglikelihood requests:  42%|████▏     | 70/168 [00:50<00:51,  1.89it/s]Running loglikelihood requests:  42%|████▏     | 71/168 [00:51<00:57,  1.68it/s]Running loglikelihood requests:  43%|████▎     | 73/168 [00:52<00:50,  1.90it/s]Running loglikelihood requests:  44%|████▍     | 74/168 [00:53<00:55,  1.69it/s]Running loglikelihood requests:  45%|████▍     | 75/168 [00:54<01:00,  1.55it/s]Running loglikelihood requests:  45%|████▌     | 76/168 [00:55<01:03,  1.45it/s]Running loglikelihood requests:  46%|████▋     | 78/168 [00:55<00:51,  1.74it/s]Running loglikelihood requests:  48%|████▊     | 80/168 [00:56<00:45,  1.94it/s]Running loglikelihood requests:  49%|████▉     | 82/168 [00:57<00:41,  2.08it/s]Running loglikelihood requests:  49%|████▉     | 83/168 [00:58<00:46,  1.82it/s]Running loglikelihood requests:  51%|█████     | 85/168 [00:59<00:41,  2.01it/s]Running loglikelihood requests:  51%|█████     | 86/168 [01:00<00:46,  1.78it/s]Running loglikelihood requests:  52%|█████▏    | 88/168 [01:00<00:40,  1.99it/s]Running loglikelihood requests:  53%|█████▎    | 89/168 [01:01<00:44,  1.77it/s]Running loglikelihood requests:  54%|█████▎    | 90/168 [01:02<00:48,  1.62it/s]Running loglikelihood requests:  55%|█████▍    | 92/168 [01:03<00:40,  1.89it/s]Running loglikelihood requests:  56%|█████▌    | 94/168 [01:04<00:35,  2.08it/s]Running loglikelihood requests:  57%|█████▋    | 95/168 [01:04<00:39,  1.84it/s]Running loglikelihood requests:  58%|█████▊    | 97/168 [01:05<00:34,  2.06it/s]Running loglikelihood requests:  58%|█████▊    | 98/168 [01:06<00:38,  1.84it/s]Running loglikelihood requests:  60%|█████▉    | 100/168 [01:07<00:32,  2.07it/s]Running loglikelihood requests:  60%|██████    | 101/168 [01:07<00:36,  1.85it/s]Running loglikelihood requests:  61%|██████▏   | 103/168 [01:08<00:30,  2.10it/s]Running loglikelihood requests:  62%|██████▏   | 104/168 [01:09<00:34,  1.88it/s]Running loglikelihood requests:  62%|██████▎   | 105/168 [01:10<00:36,  1.72it/s]Running loglikelihood requests:  63%|██████▎   | 106/168 [01:10<00:38,  1.61it/s]Running loglikelihood requests:  64%|██████▍   | 108/168 [01:11<00:31,  1.93it/s]Running loglikelihood requests:  65%|██████▌   | 110/168 [01:12<00:26,  2.16it/s]Running loglikelihood requests:  66%|██████▌   | 111/168 [01:13<00:29,  1.92it/s]Running loglikelihood requests:  67%|██████▋   | 113/168 [01:13<00:25,  2.16it/s]Running loglikelihood requests:  68%|██████▊   | 114/168 [01:14<00:28,  1.92it/s]Running loglikelihood requests:  69%|██████▉   | 116/168 [01:15<00:24,  2.16it/s]Running loglikelihood requests:  70%|███████   | 118/168 [01:16<00:21,  2.33it/s]Running loglikelihood requests:  71%|███████   | 119/168 [01:16<00:23,  2.04it/s]Running loglikelihood requests:  71%|███████▏  | 120/168 [01:17<00:25,  1.85it/s]Running loglikelihood requests:  73%|███████▎  | 122/168 [01:18<00:21,  2.12it/s]Running loglikelihood requests:  74%|███████▍  | 124/168 [01:18<00:19,  2.31it/s]Running loglikelihood requests:  74%|███████▍  | 125/168 [01:19<00:21,  2.04it/s]Running loglikelihood requests:  76%|███████▌  | 127/168 [01:20<00:18,  2.26it/s]Running loglikelihood requests:  76%|███████▌  | 128/168 [01:21<00:19,  2.01it/s]Running loglikelihood requests:  77%|███████▋  | 129/168 [01:21<00:21,  1.83it/s]Running loglikelihood requests:  78%|███████▊  | 131/168 [01:22<00:17,  2.12it/s]Running loglikelihood requests:  79%|███████▉  | 133/168 [01:23<00:14,  2.36it/s]Running loglikelihood requests:  80%|███████▉  | 134/168 [01:23<00:16,  2.11it/s]Running loglikelihood requests:  81%|████████  | 136/168 [01:24<00:13,  2.37it/s]Running loglikelihood requests:  82%|████████▏ | 137/168 [01:25<00:14,  2.10it/s]Running loglikelihood requests:  82%|████████▏ | 138/168 [01:25<00:15,  1.91it/s]Running loglikelihood requests:  83%|████████▎ | 139/168 [01:26<00:16,  1.80it/s]Running loglikelihood requests:  83%|████████▎ | 140/168 [01:27<00:16,  1.72it/s]Running loglikelihood requests:  85%|████████▍ | 142/168 [01:27<00:12,  2.10it/s]Running loglikelihood requests:  86%|████████▌ | 144/168 [01:28<00:10,  2.39it/s]Running loglikelihood requests:  87%|████████▋ | 146/168 [01:29<00:08,  2.59it/s]Running loglikelihood requests:  88%|████████▊ | 148/168 [01:29<00:07,  2.74it/s]Running loglikelihood requests:  89%|████████▊ | 149/168 [01:30<00:08,  2.35it/s]Running loglikelihood requests:  89%|████████▉ | 150/168 [01:31<00:08,  2.10it/s]Running loglikelihood requests:  90%|█████████ | 152/168 [01:31<00:06,  2.37it/s]Running loglikelihood requests:  92%|█████████▏| 154/168 [01:32<00:05,  2.58it/s]Running loglikelihood requests:  92%|█████████▏| 155/168 [01:33<00:05,  2.28it/s]Running loglikelihood requests:  93%|█████████▎| 157/168 [01:33<00:04,  2.54it/s]Running loglikelihood requests:  94%|█████████▍| 158/168 [01:34<00:04,  2.26it/s]Running loglikelihood requests:  95%|█████████▌| 160/168 [01:34<00:03,  2.54it/s]Running loglikelihood requests:  96%|█████████▌| 161/168 [01:35<00:03,  2.30it/s]Running loglikelihood requests:  97%|█████████▋| 163/168 [01:36<00:01,  2.62it/s]Running loglikelihood requests:  98%|█████████▊| 164/168 [01:36<00:01,  2.39it/s]Running loglikelihood requests:  99%|█████████▉| 166/168 [01:37<00:00,  2.75it/s]Running loglikelihood requests:  99%|█████████▉| 167/168 [01:37<00:00,  2.49it/s]Running loglikelihood requests: 100%|██████████| 168/168 [01:37<00:00,  1.72it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'cb': {'alias': 'cb', 'acc,none': 0.44642857142857145, 'acc_stderr,none': 0.06703189227942397, 'f1,none': np.float64(0.2946127946127946), 'f1_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8754479021250823
0.8035282713865031
0.9500865550679058
0.9469110267801961
0.9212663689239236
0.9365178765256775
0.671589453090406
0.6744336218334667
0.8076345549626031
0.7976470386087894
0.807072393829993
0.6600400889592184
0.7484904863798857
0.9363063771008698
0.6357711114598822
0.9166089836828051
0.6715835426958833
0.7409884813902188
0.412428535140908
0.8747283305135303
0.8491219158212996
0.9125101690232402
0.8366676259845086
0.705936129020536
0.7920385356495101
0.9243830461584077
0.9274604399644588
0.7835428130351293
0.8119111717866335
Total groups 67 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 5, 2, 7, 1, 4, 0]
tensor([6, 3, 5, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 7, 3, 6, 1, 2, 0]
tensor([5, 4, 7, 3, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 1, 6, 3, 7, 2, 4, 0]
tensor([5, 1, 6, 3, 7, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 2, 0, 1, 5, 0, 1, 3]
tensor([4, 2, 0, 1, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 3, 0, 2, 1, 1, 5, 0]
tensor([4, 3, 0, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 2 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 12
done!
Normal merging for layer 13
tensor([2, 5])
tensor(2)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 14
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 15 to 18
done!
Normal merging for layer 19
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 20 to 23
done!
Normal merging for layer 24
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 23 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 22 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

55
cuda:2
qnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.10s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 200 361
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139649120521008 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139649120521008 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649120521008 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139649120521008 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139649118008144 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139649118008144 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649118008144 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139649118008144 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qnli from None to 0
INFO:lm_eval.api.task:Building contexts for qnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2574.33it/s]
DEBUG:lm_eval.evaluator:Task: qnli; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<06:08,  1.85s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:57,  1.11it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:04<02:16,  1.42it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:05<01:59,  1.61it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:06<01:49,  1.74it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:40,  1.87it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:34,  1.97it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:30,  2.05it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:25,  2.14it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:21,  2.23it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:11<01:18,  2.29it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:12<01:15,  2.33it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:12<01:13,  2.37it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:13<01:12,  2.40it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:14<01:10,  2.43it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:15<01:09,  2.44it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:16<01:08,  2.44it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:06,  2.47it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:05,  2.50it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:18<01:03,  2.53it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:19<01:06,  2.40it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:20<01:04,  2.45it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<01:01,  2.51it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:21<00:59,  2.56it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:22<00:58,  2.59it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:23<00:57,  2.61it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:23<00:55,  2.64it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:24<00:54,  2.66it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:25<00:53,  2.68it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:26<00:52,  2.69it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:26<00:51,  2.71it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:27<00:50,  2.71it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:28<00:49,  2.73it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:28<00:48,  2.76it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:29<00:47,  2.78it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:30<00:46,  2.80it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:31<00:45,  2.82it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:31<00:44,  2.84it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:32<00:42,  2.86it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:33<00:41,  2.88it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:33<00:41,  2.90it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:34<00:40,  2.90it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:35<00:39,  2.91it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:35<00:38,  2.93it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:36<00:37,  2.94it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:37<00:37,  2.95it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:37<00:36,  2.96it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:38<00:35,  2.97it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:39<00:34,  2.99it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:39<00:33,  3.00it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:40<00:32,  3.01it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:41<00:32,  3.02it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:41<00:31,  3.00it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:42<00:30,  3.02it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:43<00:30,  2.97it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:43<00:30,  2.97it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:44<00:29,  2.99it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:45<00:28,  3.03it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:45<00:27,  3.06it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:46<00:26,  3.09it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:47<00:25,  3.11it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:47<00:24,  3.13it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:48<00:23,  3.17it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:48<00:22,  3.19it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:49<00:22,  3.21it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:50<00:21,  3.22it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:50<00:20,  3.23it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:51<00:20,  3.24it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:52<00:19,  3.25it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:52<00:18,  3.26it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:53<00:17,  3.28it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:53<00:17,  3.30it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:54<00:16,  3.31it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:55<00:15,  3.32it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:55<00:15,  3.33it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:56<00:14,  3.28it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:56<00:14,  3.20it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:57<00:13,  3.23it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:58<00:13,  3.26it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:58<00:12,  3.27it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:59<00:11,  3.29it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:59<00:11,  3.30it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:00<00:10,  3.31it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:01<00:10,  3.30it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:01<00:09,  3.34it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:02<00:08,  3.40it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:02<00:07,  3.38it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:03<00:07,  3.40it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:04<00:06,  3.43it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:04<00:06,  3.45it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:05<00:05,  3.44it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:05<00:04,  3.45it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:06<00:04,  3.48it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:06<00:03,  3.54it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:07<00:03,  3.59it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:07<00:02,  3.61it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:08<00:01,  3.64it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:09<00:01,  3.68it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:09<00:00,  3.73it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:10<00:00,  3.78it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:10<00:00,  2.85it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'qnli': {'alias': 'qnli', 'acc,none': 0.46, 'acc_stderr,none': 0.05009082659620332}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
0.48800861061165646
0.4420522818267443
0.9519161971847797
0.7484302940574024
0.5133259423607681
0.5588784666822361
0.6658633104669237
0.7569182042181317
0.5308683195195316
0.8457203515884096
0.2160432078364904
0.9025653665852331
0.9196489243365332
0.6742217686289
0.8668007010904994
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 5, 4, 2, 6, 1, 3, 0]
tensor([7, 5, 4, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 1, 3, 6, 2, 7, 0]
tensor([4, 5, 1, 3, 6, 2, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 4, 1, 2, 5, 0]
tensor([0, 1, 3, 4, 1, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 5, 2, 4, 1, 3, 0]
tensor([0, 1, 5, 2, 4, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 4, 1, 2, 1, 3, 5, 0]
tensor([0, 4, 1, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[2, 4, 3, 0, 5, 1, 1, 0]
tensor([2, 4, 3, 0, 5, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 4, 2, 1, 1, 5, 0]
tensor([0, 3, 4, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 1, 3, 2, 0, 3, 1]
tensor([0, 2, 1, 3, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([0, 7])
tensor(0)
tensor([1, 5])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 11
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
done!
Normal merging for layer 12
tensor([3, 7])
tensor(3)
tensor([5, 6])
tensor(5)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 14 to 15
done!
Normal merging for layer 16
tensor([0, 5])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3, 6])
tensor(3)
done!
Cross-layer merge completed for layers 17 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 22 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 21 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

195
cuda:3
cola
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:54<00:54, 54.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.92s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cola] metric mcc is defined, but aggregation is not. using default aggregation=matthews_corrcoef
WARNING:lm_eval.api.task:[Task: cola] metric mcc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/cola?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/cola?recursive=False&expand=False HTTP/1.1" 200 358
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139645830545488 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645830545488 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645830545488 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645830545488 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139672002835904 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139672002835904 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139672002835904 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139672002835904 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cola from None to 0
INFO:lm_eval.api.task:Building contexts for cola on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 3271.05it/s]
DEBUG:lm_eval.evaluator:Task: cola; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<03:44,  1.13s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:01<01:36,  2.04it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:13,  2.66it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:02<01:03,  3.05it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:03<00:57,  3.32it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:03<00:54,  3.44it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:04<00:53,  3.48it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:04<00:51,  3.61it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:05<00:49,  3.68it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:05<00:48,  3.76it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:06<00:46,  3.83it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:06<00:45,  3.87it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:07<00:44,  3.90it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:07<00:44,  3.92it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:08<00:43,  3.95it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:08<00:42,  3.98it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:09<00:41,  3.99it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:09<00:41,  4.02it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:10<00:40,  3.98it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:10<00:40,  4.00it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:11<00:39,  4.02it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:11<00:38,  4.04it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:12<00:37,  4.08it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:12<00:37,  4.11it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:13<00:36,  4.12it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:13<00:36,  4.13it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:14<00:35,  4.15it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:14<00:34,  4.17it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:15<00:34,  4.18it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:15<00:33,  4.18it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:16<00:33,  4.21it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:16<00:32,  4.22it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:17<00:31,  4.23it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:17<00:31,  4.23it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:18<00:30,  4.25it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:18<00:30,  4.26it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:18<00:29,  4.27it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:19<00:29,  4.28it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:19<00:28,  4.27it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:20<00:28,  4.28it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:20<00:27,  4.27it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:21<00:27,  4.28it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:21<00:26,  4.30it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:22<00:26,  4.31it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:22<00:25,  4.32it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:23<00:25,  4.33it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:23<00:24,  4.33it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:24<00:24,  4.30it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:24<00:23,  4.31it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:24<00:23,  4.33it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:25<00:22,  4.35it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:25<00:22,  4.36it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:26<00:21,  4.37it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:26<00:21,  4.38it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:27<00:20,  4.37it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:27<00:20,  4.37it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:28<00:19,  4.37it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:28<00:19,  4.38it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:29<00:18,  4.39it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:29<00:18,  4.40it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:29<00:17,  4.42it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:30<00:17,  4.35it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:30<00:17,  4.28it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:31<00:16,  4.32it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:31<00:16,  4.34it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:32<00:15,  4.38it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:32<00:15,  4.41it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:33<00:14,  4.37it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:33<00:14,  4.37it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:34<00:14,  4.34it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:34<00:13,  4.37it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:35<00:12,  4.41it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:35<00:12,  4.30it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:35<00:12,  4.34it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:36<00:11,  4.39it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:36<00:11,  4.39it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:37<00:10,  4.41it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:37<00:10,  4.43it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:38<00:09,  4.47it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:38<00:09,  4.50it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:39<00:08,  4.51it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:39<00:08,  4.52it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:39<00:07,  4.52it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:40<00:07,  4.49it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:40<00:06,  4.43it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:41<00:06,  4.49it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:41<00:05,  4.54it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:42<00:05,  4.50it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:42<00:05,  4.55it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:43<00:04,  4.58it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:43<00:04,  4.59it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:43<00:03,  4.61it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:44<00:03,  4.55it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:44<00:02,  4.58it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:45<00:02,  4.61it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:45<00:01,  4.63it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [00:46<00:01,  4.66it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [00:46<00:01,  4.53it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [00:46<00:00,  4.58it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [00:47<00:00,  4.58it/s]Running loglikelihood requests: 100%|██████████| 200/200 [00:47<00:00,  4.22it/s]
bootstrapping for stddev (sequential): matthews_corrcoef
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<01:32,  1.07it/s]  2%|▏         | 2/100 [00:01<01:30,  1.09it/s]  3%|▎         | 3/100 [00:02<01:28,  1.09it/s]  4%|▍         | 4/100 [00:03<01:27,  1.09it/s]  5%|▌         | 5/100 [00:04<01:27,  1.09it/s]  6%|▌         | 6/100 [00:05<01:25,  1.09it/s]  7%|▋         | 7/100 [00:06<01:24,  1.10it/s]  8%|▊         | 8/100 [00:07<01:24,  1.09it/s]  9%|▉         | 9/100 [00:08<01:24,  1.08it/s] 10%|█         | 10/100 [00:09<01:23,  1.08it/s] 11%|█         | 11/100 [00:10<01:21,  1.09it/s] 12%|█▏        | 12/100 [00:11<01:20,  1.09it/s] 13%|█▎        | 13/100 [00:11<01:19,  1.09it/s] 14%|█▍        | 14/100 [00:12<01:18,  1.10it/s] 15%|█▌        | 15/100 [00:13<01:17,  1.09it/s] 16%|█▌        | 16/100 [00:14<01:16,  1.10it/s] 17%|█▋        | 17/100 [00:15<01:15,  1.10it/s] 18%|█▊        | 18/100 [00:16<01:14,  1.10it/s] 19%|█▉        | 19/100 [00:17<01:13,  1.10it/s] 20%|██        | 20/100 [00:18<01:13,  1.09it/s] 21%|██        | 21/100 [00:19<01:12,  1.09it/s] 22%|██▏       | 22/100 [00:20<01:11,  1.09it/s] 23%|██▎       | 23/100 [00:21<01:10,  1.09it/s] 24%|██▍       | 24/100 [00:21<01:09,  1.09it/s] 25%|██▌       | 25/100 [00:22<01:08,  1.09it/s] 26%|██▌       | 26/100 [00:23<01:07,  1.09it/s] 27%|██▋       | 27/100 [00:24<01:06,  1.09it/s] 28%|██▊       | 28/100 [00:25<01:05,  1.09it/s] 29%|██▉       | 29/100 [00:26<01:04,  1.09it/s] 30%|███       | 30/100 [00:27<01:03,  1.09it/s] 31%|███       | 31/100 [00:28<01:03,  1.09it/s] 32%|███▏      | 32/100 [00:29<01:02,  1.09it/s] 33%|███▎      | 33/100 [00:30<01:01,  1.09it/s] 34%|███▍      | 34/100 [00:31<01:00,  1.09it/s] 35%|███▌      | 35/100 [00:32<00:59,  1.09it/s] 36%|███▌      | 36/100 [00:32<00:58,  1.09it/s] 37%|███▋      | 37/100 [00:33<00:57,  1.09it/s] 38%|███▊      | 38/100 [00:34<00:56,  1.09it/s] 39%|███▉      | 39/100 [00:35<00:55,  1.09it/s] 40%|████      | 40/100 [00:36<00:55,  1.09it/s] 41%|████      | 41/100 [00:37<00:54,  1.09it/s] 42%|████▏     | 42/100 [00:38<00:53,  1.09it/s] 43%|████▎     | 43/100 [00:39<00:52,  1.09it/s] 44%|████▍     | 44/100 [00:40<00:51,  1.08it/s] 45%|████▌     | 45/100 [00:41<00:50,  1.09it/s] 46%|████▌     | 46/100 [00:42<00:49,  1.09it/s] 47%|████▋     | 47/100 [00:43<00:49,  1.07it/s] 48%|████▊     | 48/100 [00:44<00:48,  1.06it/s] 49%|████▉     | 49/100 [00:45<00:47,  1.07it/s] 50%|█████     | 50/100 [00:45<00:46,  1.07it/s] 51%|█████     | 51/100 [00:46<00:45,  1.08it/s] 52%|█████▏    | 52/100 [00:47<00:44,  1.08it/s] 53%|█████▎    | 53/100 [00:48<00:43,  1.08it/s] 54%|█████▍    | 54/100 [00:49<00:42,  1.08it/s] 55%|█████▌    | 55/100 [00:50<00:41,  1.08it/s] 56%|█████▌    | 56/100 [00:51<00:40,  1.08it/s] 57%|█████▋    | 57/100 [00:52<00:39,  1.09it/s] 58%|█████▊    | 58/100 [00:53<00:39,  1.07it/s] 59%|█████▉    | 59/100 [00:54<00:38,  1.08it/s] 60%|██████    | 60/100 [00:55<00:37,  1.08it/s] 61%|██████    | 61/100 [00:56<00:36,  1.07it/s] 62%|██████▏   | 62/100 [00:57<00:35,  1.08it/s] 63%|██████▎   | 63/100 [00:57<00:34,  1.08it/s] 64%|██████▍   | 64/100 [00:58<00:33,  1.08it/s] 65%|██████▌   | 65/100 [00:59<00:32,  1.08it/s] 66%|██████▌   | 66/100 [01:00<00:31,  1.09it/s] 67%|██████▋   | 67/100 [01:01<00:30,  1.09it/s] 68%|██████▊   | 68/100 [01:02<00:29,  1.09it/s] 69%|██████▉   | 69/100 [01:03<00:28,  1.08it/s] 70%|███████   | 70/100 [01:04<00:27,  1.08it/s] 71%|███████   | 71/100 [01:05<00:26,  1.09it/s] 72%|███████▏  | 72/100 [01:06<00:25,  1.09it/s] 73%|███████▎  | 73/100 [01:07<00:24,  1.09it/s] 74%|███████▍  | 74/100 [01:08<00:23,  1.09it/s] 75%|███████▌  | 75/100 [01:09<00:23,  1.09it/s] 76%|███████▌  | 76/100 [01:09<00:22,  1.09it/s] 77%|███████▋  | 77/100 [01:10<00:21,  1.09it/s] 78%|███████▊  | 78/100 [01:11<00:20,  1.09it/s] 79%|███████▉  | 79/100 [01:12<00:19,  1.09it/s] 80%|████████  | 80/100 [01:13<00:18,  1.08it/s] 81%|████████  | 81/100 [01:14<00:17,  1.09it/s] 82%|████████▏ | 82/100 [01:15<00:16,  1.09it/s] 83%|████████▎ | 83/100 [01:16<00:15,  1.09it/s] 84%|████████▍ | 84/100 [01:17<00:14,  1.09it/s] 85%|████████▌ | 85/100 [01:18<00:13,  1.09it/s] 86%|████████▌ | 86/100 [01:19<00:12,  1.09it/s] 87%|████████▋ | 87/100 [01:20<00:11,  1.09it/s] 88%|████████▊ | 88/100 [01:20<00:11,  1.09it/s] 89%|████████▉ | 89/100 [01:21<00:10,  1.08it/s] 90%|█████████ | 90/100 [01:22<00:09,  1.08it/s] 91%|█████████ | 91/100 [01:23<00:08,  1.08it/s] 92%|█████████▏| 92/100 [01:24<00:07,  1.09it/s] 93%|█████████▎| 93/100 [01:25<00:06,  1.08it/s] 94%|█████████▍| 94/100 [01:26<00:05,  1.07it/s] 95%|█████████▌| 95/100 [01:27<00:04,  1.08it/s] 96%|█████████▌| 96/100 [01:28<00:03,  1.08it/s] 97%|█████████▋| 97/100 [01:29<00:02,  1.08it/s] 98%|█████████▊| 98/100 [01:30<00:01,  1.08it/s] 99%|█████████▉| 99/100 [01:31<00:00,  1.08it/s]100%|██████████| 100/100 [01:32<00:00,  1.07it/s]100%|██████████| 100/100 [01:32<00:00,  1.09it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'cola': {'alias': 'cola', 'mcc,none': np.float64(-0.0234083603222329), 'mcc_stderr,none': 0.10027612985654218}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9827615088085355
0.9302188892609604
0.7011961870018854
0.5626926521241726
0.8487059565524276
0.8497526414658526
0.9054485200458864
0.7394951536076
0.6615723249956142
0.3790091735780837
0.7669438266452424
0.6500882643740805
0.6039759750877352
0.8611545876684488
0.9595791152744535
0.7624866897939796
0.8585278638499474
0.9654871578633694
0.8537985077125277
0.9276026122967783
0.938072418626947
0.8815459403167786
0.6241194219560614
0.901256729143793
0.7007049393842223
0.6541093728101413
0.9141945519271818
0.7667764647672246
0.8091089193013563
Total groups 69 exceeded the threshold, stopping comparison.
The group tensor is
[3, 2, 6, 7, 5, 1, 4, 0]
tensor([3, 2, 6, 7, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[2, 3, 6, 7, 5, 1, 4, 0]
tensor([2, 3, 6, 7, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 3, 5, 7, 6, 1, 2, 0]
tensor([4, 3, 5, 7, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 1, 2, 1, 3, 0]
tensor([2, 3, 0, 1, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[1, 0, 1, 2, 3, 2, 3, 0]
tensor([1, 0, 1, 2, 3, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 1, 2, 3, 1, 3, 0]
tensor([0, 2, 1, 2, 3, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[1, 0, 0, 1, 2, 3, 3, 2]
tensor([1, 0, 0, 1, 2, 3, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[3, 1, 0, 1, 2, 2, 3, 0]
tensor([3, 1, 0, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 1, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 2 to 5
done!
Normal merging for layer 6
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 18
done!
Normal merging for layer 19
tensor([2, 7])
tensor(2)
tensor([3, 5])
tensor(3)
tensor([0, 4])
tensor(0)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 7])
tensor(1)
tensor([0, 2])
tensor(0)
tensor([3, 5])
tensor(3)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([1, 3])
tensor(1)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 22
tensor([1, 2])
tensor(1)
tensor([0, 3])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([5, 6])
tensor(5)
done!
Normal merging for layer 23
tensor([2, 7])
tensor(2)
tensor([1, 3])
tensor(1)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
done!
Cross-layer merge completed for layers 24 to 27
done!
Normal merging for layer 28
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Cross-layer merge completed for layers 29 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 21 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 20 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

48
cuda:4
copa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.06s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/copa?recursive=False&expand=False HTTP/1.1" 307 143
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/copa?recursive=False&expand=False HTTP/1.1" 200 348
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139649118009728 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139649118009728 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649118009728 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139649118009728 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139669989642400 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139669989642400 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669989642400 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139669989642400 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " the toilet filled with water." have whitespace
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " water flowed from the spout." have whitespace
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of copa from None to 0
INFO:lm_eval.api.task:Building contexts for copa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 75901.27it/s]
DEBUG:lm_eval.evaluator:Task: copa; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<03:41,  1.12s/it]Running loglikelihood requests:   1%|          | 2/200 [00:01<02:25,  1.36it/s]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<01:59,  1.64it/s]Running loglikelihood requests:   2%|▏         | 4/200 [00:02<01:48,  1.81it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:41,  1.92it/s]Running loglikelihood requests:   3%|▎         | 6/200 [00:03<01:36,  2.00it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:35,  2.02it/s]Running loglikelihood requests:   4%|▍         | 8/200 [00:04<01:33,  2.06it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:30,  2.10it/s]Running loglikelihood requests:   5%|▌         | 10/200 [00:05<01:28,  2.14it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:26,  2.17it/s]Running loglikelihood requests:   6%|▌         | 12/200 [00:06<01:25,  2.20it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:24,  2.21it/s]Running loglikelihood requests:   7%|▋         | 14/200 [00:07<01:23,  2.22it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:07<01:22,  2.24it/s]Running loglikelihood requests:   8%|▊         | 16/200 [00:07<01:22,  2.23it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:08<01:22,  2.23it/s]Running loglikelihood requests:   9%|▉         | 18/200 [00:08<01:21,  2.24it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:09<01:20,  2.26it/s]Running loglikelihood requests:  10%|█         | 20/200 [00:09<01:19,  2.26it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:19,  2.26it/s]Running loglikelihood requests:  11%|█         | 22/200 [00:10<01:19,  2.25it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:18,  2.26it/s]Running loglikelihood requests:  12%|█▏        | 24/200 [00:11<01:17,  2.27it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:11<01:16,  2.28it/s]Running loglikelihood requests:  13%|█▎        | 26/200 [00:12<01:16,  2.28it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:12<01:16,  2.28it/s]Running loglikelihood requests:  14%|█▍        | 28/200 [00:13<01:16,  2.26it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:13<01:15,  2.27it/s]Running loglikelihood requests:  15%|█▌        | 30/200 [00:14<01:14,  2.29it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:13,  2.30it/s]Running loglikelihood requests:  16%|█▌        | 32/200 [00:14<01:12,  2.30it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:12,  2.31it/s]Running loglikelihood requests:  17%|█▋        | 34/200 [00:15<01:11,  2.31it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:11,  2.31it/s]Running loglikelihood requests:  18%|█▊        | 36/200 [00:16<01:11,  2.30it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:11,  2.28it/s]Running loglikelihood requests:  19%|█▉        | 38/200 [00:17<01:11,  2.25it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:18<01:12,  2.21it/s]Running loglikelihood requests:  20%|██        | 40/200 [00:18<01:11,  2.24it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:11,  2.23it/s]Running loglikelihood requests:  21%|██        | 42/200 [00:19<01:09,  2.26it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<01:08,  2.28it/s]Running loglikelihood requests:  22%|██▏       | 44/200 [00:20<01:08,  2.27it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<01:07,  2.29it/s]Running loglikelihood requests:  23%|██▎       | 46/200 [00:21<01:06,  2.30it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:21<01:06,  2.31it/s]Running loglikelihood requests:  24%|██▍       | 48/200 [00:21<01:05,  2.31it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:22<01:05,  2.31it/s]Running loglikelihood requests:  25%|██▌       | 50/200 [00:22<01:04,  2.31it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:23<01:04,  2.31it/s]Running loglikelihood requests:  26%|██▌       | 52/200 [00:23<01:04,  2.30it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:24<01:03,  2.30it/s]Running loglikelihood requests:  27%|██▋       | 54/200 [00:24<01:03,  2.32it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:25<01:03,  2.27it/s]Running loglikelihood requests:  28%|██▊       | 56/200 [00:25<01:03,  2.25it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:25<01:03,  2.24it/s]Running loglikelihood requests:  29%|██▉       | 58/200 [00:26<01:04,  2.22it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:26<01:03,  2.23it/s]Running loglikelihood requests:  30%|███       | 60/200 [00:27<01:01,  2.26it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:27<01:00,  2.29it/s]Running loglikelihood requests:  31%|███       | 62/200 [00:28<01:02,  2.21it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:28<01:00,  2.25it/s]Running loglikelihood requests:  32%|███▏      | 64/200 [00:29<00:59,  2.27it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:29<01:00,  2.24it/s]Running loglikelihood requests:  33%|███▎      | 66/200 [00:29<01:00,  2.23it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:30<00:59,  2.23it/s]Running loglikelihood requests:  34%|███▍      | 68/200 [00:30<00:58,  2.26it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:31<00:57,  2.28it/s]Running loglikelihood requests:  35%|███▌      | 70/200 [00:31<00:56,  2.29it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:32<00:56,  2.29it/s]Running loglikelihood requests:  36%|███▌      | 72/200 [00:32<00:55,  2.29it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:33<00:55,  2.29it/s]Running loglikelihood requests:  37%|███▋      | 74/200 [00:33<00:54,  2.29it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:33<00:54,  2.30it/s]Running loglikelihood requests:  38%|███▊      | 76/200 [00:34<00:54,  2.26it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:34<00:54,  2.25it/s]Running loglikelihood requests:  39%|███▉      | 78/200 [00:35<00:53,  2.28it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:35<00:52,  2.30it/s]Running loglikelihood requests:  40%|████      | 80/200 [00:36<00:51,  2.32it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:36<00:51,  2.32it/s]Running loglikelihood requests:  41%|████      | 82/200 [00:36<00:50,  2.33it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:37<00:50,  2.33it/s]Running loglikelihood requests:  42%|████▏     | 84/200 [00:37<00:49,  2.34it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:38<00:49,  2.34it/s]Running loglikelihood requests:  43%|████▎     | 86/200 [00:38<00:48,  2.34it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:39<00:48,  2.32it/s]Running loglikelihood requests:  44%|████▍     | 88/200 [00:39<00:48,  2.33it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:39<00:47,  2.34it/s]Running loglikelihood requests:  45%|████▌     | 90/200 [00:40<00:47,  2.34it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:40<00:46,  2.34it/s]Running loglikelihood requests:  46%|████▌     | 92/200 [00:41<00:46,  2.34it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:41<00:45,  2.34it/s]Running loglikelihood requests:  47%|████▋     | 94/200 [00:42<00:45,  2.34it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:42<00:44,  2.34it/s]Running loglikelihood requests:  48%|████▊     | 96/200 [00:42<00:44,  2.34it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:43<00:44,  2.34it/s]Running loglikelihood requests:  49%|████▉     | 98/200 [00:43<00:43,  2.35it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:44<00:42,  2.36it/s]Running loglikelihood requests:  50%|█████     | 100/200 [00:44<00:42,  2.37it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:45<00:41,  2.37it/s]Running loglikelihood requests:  51%|█████     | 102/200 [00:45<00:41,  2.37it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:45<00:40,  2.38it/s]Running loglikelihood requests:  52%|█████▏    | 104/200 [00:46<00:40,  2.39it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:46<00:39,  2.39it/s]Running loglikelihood requests:  53%|█████▎    | 106/200 [00:47<00:39,  2.39it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:47<00:38,  2.39it/s]Running loglikelihood requests:  54%|█████▍    | 108/200 [00:47<00:38,  2.38it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:48<00:38,  2.38it/s]Running loglikelihood requests:  55%|█████▌    | 110/200 [00:48<00:37,  2.38it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:49<00:37,  2.38it/s]Running loglikelihood requests:  56%|█████▌    | 112/200 [00:49<00:36,  2.38it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:50<00:36,  2.38it/s]Running loglikelihood requests:  57%|█████▋    | 114/200 [00:50<00:35,  2.40it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:50<00:35,  2.40it/s]Running loglikelihood requests:  58%|█████▊    | 116/200 [00:51<00:34,  2.41it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:51<00:34,  2.42it/s]Running loglikelihood requests:  59%|█████▉    | 118/200 [00:52<00:34,  2.36it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:52<00:34,  2.34it/s]Running loglikelihood requests:  60%|██████    | 120/200 [00:53<00:34,  2.32it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:53<00:34,  2.30it/s]Running loglikelihood requests:  61%|██████    | 122/200 [00:53<00:33,  2.30it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:54<00:33,  2.27it/s]Running loglikelihood requests:  62%|██████▏   | 124/200 [00:54<00:32,  2.32it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:55<00:32,  2.34it/s]Running loglikelihood requests:  63%|██████▎   | 126/200 [00:55<00:31,  2.35it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:56<00:30,  2.37it/s]Running loglikelihood requests:  64%|██████▍   | 128/200 [00:56<00:30,  2.37it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:56<00:29,  2.38it/s]Running loglikelihood requests:  65%|██████▌   | 130/200 [00:57<00:29,  2.39it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:57<00:29,  2.38it/s]Running loglikelihood requests:  66%|██████▌   | 132/200 [00:58<00:28,  2.35it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:58<00:28,  2.37it/s]Running loglikelihood requests:  67%|██████▋   | 134/200 [00:58<00:27,  2.39it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:59<00:26,  2.41it/s]Running loglikelihood requests:  68%|██████▊   | 136/200 [00:59<00:26,  2.42it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:00<00:25,  2.43it/s]Running loglikelihood requests:  69%|██████▉   | 138/200 [01:00<00:25,  2.44it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:01<00:24,  2.44it/s]Running loglikelihood requests:  70%|███████   | 140/200 [01:01<00:24,  2.43it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:01<00:24,  2.44it/s]Running loglikelihood requests:  71%|███████   | 142/200 [01:02<00:23,  2.44it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:02<00:23,  2.45it/s]Running loglikelihood requests:  72%|███████▏  | 144/200 [01:03<00:22,  2.46it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:03<00:22,  2.46it/s]Running loglikelihood requests:  73%|███████▎  | 146/200 [01:03<00:21,  2.47it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:04<00:21,  2.48it/s]Running loglikelihood requests:  74%|███████▍  | 148/200 [01:04<00:20,  2.48it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:05<00:20,  2.48it/s]Running loglikelihood requests:  75%|███████▌  | 150/200 [01:05<00:20,  2.48it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:05<00:19,  2.47it/s]Running loglikelihood requests:  76%|███████▌  | 152/200 [01:06<00:19,  2.47it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:06<00:19,  2.47it/s]Running loglikelihood requests:  77%|███████▋  | 154/200 [01:07<00:18,  2.48it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:07<00:18,  2.47it/s]Running loglikelihood requests:  78%|███████▊  | 156/200 [01:07<00:17,  2.48it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:08<00:17,  2.48it/s]Running loglikelihood requests:  79%|███████▉  | 158/200 [01:08<00:16,  2.48it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:09<00:16,  2.48it/s]Running loglikelihood requests:  80%|████████  | 160/200 [01:09<00:16,  2.49it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:09<00:15,  2.50it/s]Running loglikelihood requests:  81%|████████  | 162/200 [01:10<00:15,  2.50it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:10<00:14,  2.50it/s]Running loglikelihood requests:  82%|████████▏ | 164/200 [01:11<00:14,  2.50it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:11<00:14,  2.50it/s]Running loglikelihood requests:  83%|████████▎ | 166/200 [01:11<00:13,  2.49it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:12<00:13,  2.50it/s]Running loglikelihood requests:  84%|████████▍ | 168/200 [01:12<00:12,  2.48it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:13<00:12,  2.40it/s]Running loglikelihood requests:  85%|████████▌ | 170/200 [01:13<00:12,  2.38it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:13<00:12,  2.41it/s]Running loglikelihood requests:  86%|████████▌ | 172/200 [01:14<00:11,  2.44it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:14<00:10,  2.48it/s]Running loglikelihood requests:  87%|████████▋ | 174/200 [01:15<00:10,  2.49it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:15<00:09,  2.50it/s]Running loglikelihood requests:  88%|████████▊ | 176/200 [01:15<00:09,  2.51it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:16<00:09,  2.52it/s]Running loglikelihood requests:  89%|████████▉ | 178/200 [01:16<00:08,  2.53it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:17<00:08,  2.53it/s]Running loglikelihood requests:  90%|█████████ | 180/200 [01:17<00:07,  2.54it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:17<00:07,  2.53it/s]Running loglikelihood requests:  91%|█████████ | 182/200 [01:18<00:07,  2.52it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:18<00:06,  2.55it/s]Running loglikelihood requests:  92%|█████████▏| 184/200 [01:19<00:06,  2.55it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:19<00:05,  2.56it/s]Running loglikelihood requests:  93%|█████████▎| 186/200 [01:19<00:05,  2.56it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:20<00:05,  2.57it/s]Running loglikelihood requests:  94%|█████████▍| 188/200 [01:20<00:04,  2.57it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:21<00:04,  2.58it/s]Running loglikelihood requests:  95%|█████████▌| 190/200 [01:21<00:03,  2.60it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:21<00:03,  2.58it/s]Running loglikelihood requests:  96%|█████████▌| 192/200 [01:22<00:03,  2.58it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:22<00:02,  2.57it/s]Running loglikelihood requests:  97%|█████████▋| 194/200 [01:22<00:02,  2.58it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:23<00:01,  2.62it/s]Running loglikelihood requests:  98%|█████████▊| 196/200 [01:23<00:01,  2.62it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:24<00:01,  2.64it/s]Running loglikelihood requests:  99%|█████████▉| 198/200 [01:24<00:00,  2.65it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:24<00:00,  2.37it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:25<00:00,  2.45it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:25<00:00,  2.34it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'copa': {'alias': 'copa', 'acc,none': 0.82, 'acc_stderr,none': 0.03861229196653691}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7827148355678417
0.8244609672079803
0.649635438690672
0.6067147398962018
0.806517251330611
0.9304450428937726
0.9492767057467371
0.8146777207922447
0.5943920512469448
0.6904992046065734
0.898578027138337
0.9772061768478973
0.9053772479641496
0.8020143483317842
0.5125553000556808
0.7018400400551881
0.8957865573767195
0.6076519427757794
0.975563476608663
0.9639212062070597
0.9296418237714587
0.9150145595079396
0.9197448761365332
0.7066536936990038
0.6639302750778917
0.912306872752127
0.7698141900267782
0.6230420491138425
0.8289959673107662
Total groups 68 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 1, 2, 6, 5, 0]
tensor([7, 3, 4, 1, 2, 6, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 4, 1, 0, 5, 7, 2]
tensor([6, 3, 4, 1, 0, 5, 7, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 4, 3, 2, 0, 5, 6, 1]
tensor([7, 4, 3, 2, 0, 5, 6, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 6, 4, 2, 1, 3, 5, 0]
tensor([7, 6, 4, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 3, 2]
tensor([0, 1, 3, 0, 1, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 1, 0, 2, 3, 2]
tensor([0, 1, 3, 1, 0, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1.0, 1.0, 1]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 3
done!
Normal merging for layer 4
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 8 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 21
done!
Normal merging for layer 22
tensor([0, 4])
tensor(0)
tensor([1, 3])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 23 to 27
done!
Normal merging for layer 28
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 29 to 30
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 20 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 19 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

92
cuda:5
wsc
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:19<00:00, 36.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:19<00:00, 39.86s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wsc] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: wsc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/wsc.fixed?recursive=False&expand=False HTTP/1.1" 307 148
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/tree/3de24cf8022e94f4ee4b9d55a6f539891524d646/wsc.fixed?recursive=False&expand=False HTTP/1.1" 200 356
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 241
DEBUG:filelock:Attempting to acquire lock 139646845459712 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646845459712 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646845459712 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646845459712 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139649118009728 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139649118009728 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649118009728 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139649118009728 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wsc from None to 0
INFO:lm_eval.api.task:Building contexts for wsc on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 39647.45it/s]
DEBUG:lm_eval.evaluator:Task: wsc; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:38,  1.40s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:09,  1.53it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:02<01:06,  2.90it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:03<01:09,  2.75it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:04<01:10,  2.67it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:05<01:11,  2.61it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:11,  2.58it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:06<01:11,  2.58it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:07<01:10,  2.58it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:09,  2.58it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:08,  2.59it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<01:07,  2.59it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<01:06,  2.59it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<01:05,  2.59it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<01:05,  2.59it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:13<01:04,  2.60it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<01:03,  2.59it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:14<01:02,  2.59it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:15<01:02,  2.58it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:16<01:01,  2.59it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:16<01:00,  2.60it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:17<00:59,  2.61it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:18<00:58,  2.62it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:19<00:57,  2.62it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:20<00:57,  2.60it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:20<00:56,  2.62it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:21<00:54,  2.64it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:22<00:53,  2.67it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:23<00:55,  2.55it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:23<00:53,  2.60it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:24<00:51,  2.64it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:25<00:50,  2.66it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:26<00:50,  2.64it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:26<00:49,  2.65it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:27<00:48,  2.66it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:28<00:47,  2.69it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:29<00:45,  2.73it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:29<00:45,  2.73it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:30<00:43,  2.76it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:31<00:42,  2.78it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:31<00:41,  2.82it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:32<00:40,  2.86it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:33<00:39,  2.87it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:33<00:38,  2.89it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:34<00:37,  2.90it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:35<00:36,  2.92it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:35<00:35,  2.93it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:36<00:34,  2.96it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:37<00:33,  3.00it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:37<00:32,  3.02it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:38<00:31,  3.03it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:39<00:31,  3.04it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:39<00:30,  3.04it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:40<00:29,  3.06it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:41<00:29,  3.07it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:41<00:28,  3.10it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:42<00:20,  4.08it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:43<00:16,  4.78it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:43<00:17,  4.33it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:44<00:18,  4.00it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:44<00:19,  3.78it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:45<00:19,  3.64it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:46<00:19,  3.52it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:46<00:19,  3.47it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:47<00:18,  3.44it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:47<00:18,  3.42it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:48<00:17,  3.41it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:49<00:17,  3.40it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:49<00:16,  3.40it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:50<00:16,  3.41it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:50<00:15,  3.42it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:51<00:14,  3.43it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:51<00:14,  3.44it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:52<00:13,  3.45it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:53<00:12,  3.46it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:53<00:12,  3.47it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:54<00:11,  3.48it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:54<00:11,  3.49it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:55<00:10,  3.49it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:55<00:10,  3.50it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:56<00:09,  3.50it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:57<00:08,  3.46it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:57<00:08,  3.47it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:58<00:07,  3.46it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:58<00:07,  3.48it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:59<00:06,  3.51it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:59<00:05,  3.54it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:00<00:05,  3.57it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:01<00:04,  3.59it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:01<00:04,  3.61it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:02<00:03,  3.62it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:02<00:03,  3.65it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:03<00:02,  3.66it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:03<00:01,  3.68it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:04<00:01,  3.69it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:04<00:00,  3.71it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:05<00:00,  3.73it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:05<00:00,  3.06it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'wsc': {'alias': 'wsc', 'acc,none': 0.39, 'acc_stderr,none': 0.04902071300001973}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8279363410631274
0.19299873358047231
0.24697427628971416
0.9498246079459217
0.9208790959024347
0.5433529265767616
0.7541489406957872
0.8642404861438043
0.9451768410410958
0.6364904470004392
0.8605038470072015
0.8806563523485148
0.7320941418431636
0.7167995199876819
0.9558598958577776
0.7974395317006763
0.8001507378395173
0.8689133172877098
0.6142386786363212
0.6039861720637983
0.8068446902119512
0.6154342295548068
0.8415314242927469
0.42042589459680124
0.7443787948515065
0.7081725962998161
0.7223774755032815
0.9338202429729527
0.7700364698774241
0.8279363410631274
0.19299873358047231
0.24697427628971416
0.9498246079459217
0.9208790959024347
0.5433529265767616
0.7541489406957872
0.8642404861438043
0.9451768410410958
0.6364904470004392
0.8605038470072015
0.8806563523485148
0.7320941418431636
0.7167995199876819
0.9558598958577776
0.7974395317006763
0.8001507378395173
0.8689133172877098
0.6142386786363212
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[6, 7, 2, 4, 5, 1, 3, 0]
tensor([6, 7, 2, 4, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 7, 3, 6, 2, 5, 4, 0]
tensor([1, 7, 3, 6, 2, 5, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 5, 6, 3, 7, 4, 2, 0]
tensor([1, 5, 6, 3, 7, 4, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[1, 5, 3, 6, 7, 4, 2, 0]
tensor([1, 5, 3, 6, 7, 4, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 7, 5, 6, 1, 2, 3, 0]
tensor([4, 7, 5, 6, 1, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 7, 1, 5, 6, 3, 2, 0]
tensor([4, 7, 1, 5, 6, 3, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1, 1.0, 0, 1.0]
tensor([0, 1, 1, 1, 1, 1, 0, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
done!
Cross-layer merge completed for layers 8 to 28
done!
Normal merging for layer 29
tensor([0, 6])
tensor(0)
tensor([1, 2, 3, 4, 5, 7])
tensor(1)
done!
Cross-layer merge completed for layers 30 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 19 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 18 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

164
cuda:6
eq_bench
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.10s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:eq_bench: No `until` specified in `generation_kwargs`! Defaulting to the fewshot_delimiter='\n\n'
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/pbevan11/EQ-Bench/pbevan11/EQ-Bench.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_infos.json HTTP/1.1" 404 0
DEBUG:filelock:Attempting to acquire lock 139669586568800 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139669586568800 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669586568800 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139669586568800 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Attempting to acquire lock 139649117781360 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139649117781360 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139649117781360 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139649117781360 released on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:eq_bench: Using gen_kwargs: {'do_sample': False, 'temperature': 0.0, 'max_gen_toks': 80, 'until': ['\n\n']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of eq_bench from None to 0
INFO:lm_eval.api.task:Building contexts for eq_bench on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 75491.43it/s]
DEBUG:lm_eval.evaluator:Task: eq_bench; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:08<13:48,  8.37s/it]Running generate_until requests:   2%|▏         | 2/100 [00:16<13:02,  7.98s/it]Running generate_until requests:   3%|▎         | 3/100 [00:23<12:08,  7.51s/it]Running generate_until requests:   4%|▍         | 4/100 [00:30<11:40,  7.30s/it]Running generate_until requests:   5%|▌         | 5/100 [00:36<11:18,  7.15s/it]Running generate_until requests:   6%|▌         | 6/100 [00:43<10:58,  7.00s/it]Running generate_until requests:   7%|▋         | 7/100 [00:50<10:39,  6.87s/it]Running generate_until requests:   8%|▊         | 8/100 [00:56<10:23,  6.78s/it]Running generate_until requests:   9%|▉         | 9/100 [01:04<10:34,  6.97s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<10:14,  6.83s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:57,  6.72s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:24<10:06,  6.89s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:31<09:55,  6.85s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:37<09:42,  6.78s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:44<09:32,  6.73s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:50<09:18,  6.65s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:57<09:14,  6.68s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:03<08:57,  6.56s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:10<08:47,  6.51s/it]Running generate_until requests:  20%|██        | 20/100 [02:16<08:32,  6.41s/it]Running generate_until requests:  21%|██        | 21/100 [02:22<08:24,  6.39s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:29<08:18,  6.40s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:35<08:11,  6.38s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:41<08:04,  6.37s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:48<08:09,  6.53s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:54<07:53,  6.40s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:01<07:44,  6.36s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:07<07:38,  6.37s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:13<07:29,  6.33s/it]Running generate_until requests:  30%|███       | 30/100 [03:20<07:22,  6.32s/it]Running generate_until requests:  31%|███       | 31/100 [03:26<07:14,  6.30s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:33<07:21,  6.49s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:39<07:05,  6.35s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:45<06:51,  6.24s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:51<06:40,  6.16s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:57<06:26,  6.03s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:03<06:21,  6.06s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:08<06:09,  5.96s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:14<06:03,  5.96s/it]Running generate_until requests:  40%|████      | 40/100 [04:20<05:53,  5.90s/it]Running generate_until requests:  41%|████      | 41/100 [04:27<05:58,  6.07s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:33<05:57,  6.16s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:39<05:46,  6.08s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:45<05:34,  5.97s/it]Running generate_until requests:  45%|████▌     | 45/100 [04:51<05:30,  6.01s/it]Running generate_until requests:  46%|████▌     | 46/100 [04:57<05:29,  6.10s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:04<05:32,  6.28s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:10<05:20,  6.16s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:16<05:12,  6.12s/it]Running generate_until requests:  50%|█████     | 50/100 [05:22<05:06,  6.14s/it]Running generate_until requests:  51%|█████     | 51/100 [05:27<04:54,  6.00s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:33<04:44,  5.94s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:39<04:37,  5.90s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:45<04:30,  5.88s/it]Running generate_until requests:  55%|█████▌    | 55/100 [05:50<04:18,  5.76s/it]Running generate_until requests:  56%|█████▌    | 56/100 [05:56<04:10,  5.69s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:02<04:06,  5.72s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:07<03:59,  5.70s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:13<03:54,  5.72s/it]Running generate_until requests:  60%|██████    | 60/100 [06:19<03:49,  5.75s/it]Running generate_until requests:  61%|██████    | 61/100 [06:25<03:45,  5.77s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:31<03:40,  5.81s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:36<03:29,  5.68s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:41<03:22,  5.61s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:47<03:16,  5.61s/it]Running generate_until requests:  66%|██████▌   | 66/100 [06:49<02:34,  4.56s/it]Running generate_until requests:  67%|██████▋   | 67/100 [06:55<02:38,  4.82s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:00<02:44,  5.15s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:06<02:44,  5.29s/it]Running generate_until requests:  70%|███████   | 70/100 [07:12<02:42,  5.42s/it]Running generate_until requests:  71%|███████   | 71/100 [07:14<02:09,  4.47s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:20<02:17,  4.92s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:22<01:49,  4.06s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:27<01:54,  4.42s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:32<01:55,  4.62s/it]Running generate_until requests:  76%|███████▌  | 76/100 [07:38<01:55,  4.80s/it]Running generate_until requests:  77%|███████▋  | 77/100 [07:43<01:53,  4.94s/it]Running generate_until requests:  78%|███████▊  | 78/100 [07:48<01:51,  5.06s/it]Running generate_until requests:  79%|███████▉  | 79/100 [07:54<01:48,  5.16s/it]Running generate_until requests:  80%|████████  | 80/100 [07:59<01:44,  5.24s/it]Running generate_until requests:  81%|████████  | 81/100 [08:04<01:39,  5.26s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:10<01:34,  5.27s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:15<01:29,  5.26s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:20<01:24,  5.25s/it]Running generate_until requests:  85%|████████▌ | 85/100 [08:26<01:20,  5.34s/it]Running generate_until requests:  86%|████████▌ | 86/100 [08:31<01:14,  5.35s/it]Running generate_until requests:  87%|████████▋ | 87/100 [08:33<00:56,  4.31s/it]Running generate_until requests:  88%|████████▊ | 88/100 [08:39<00:58,  4.84s/it]Running generate_until requests:  89%|████████▉ | 89/100 [08:45<00:55,  5.05s/it]Running generate_until requests:  90%|█████████ | 90/100 [08:50<00:52,  5.20s/it]Running generate_until requests:  91%|█████████ | 91/100 [08:55<00:46,  5.20s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:01<00:42,  5.26s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:06<00:37,  5.33s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:12<00:31,  5.32s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:17<00:26,  5.24s/it]Running generate_until requests:  96%|█████████▌| 96/100 [09:18<00:16,  4.19s/it]Running generate_until requests:  97%|█████████▋| 97/100 [09:20<00:10,  3.46s/it]Running generate_until requests:  98%|█████████▊| 98/100 [09:25<00:08,  4.00s/it]Running generate_until requests:  99%|█████████▉| 99/100 [09:31<00:04,  4.35s/it]Running generate_until requests: 100%|██████████| 100/100 [09:35<00:00,  4.54s/it]Running generate_until requests: 100%|██████████| 100/100 [09:35<00:00,  5.76s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'eq_bench': {'alias': 'eq_bench', 'eqbench,none': -9.075457665929516, 'eqbench_stderr,none': 3.722206958756126, 'percent_parseable,none': 94.0, 'percent_parseable_stderr,none': 2.3868325657594203}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6639018561214101
0.48429197946127234
0.9515491395508957
0.5799692129526803
0.8892832964569847
0.5583880670373075
0.6815933931575056
0.8296184325732159
0.8572432652494972
0.7515568516065031
0.7498285715344476
0.6640770908835784
0.7344737024966144
0.8863376660708159
0.7840365418395101
0.7895254515113318
0.915557892351788
0.8364869594903738
0.8262221986876632
0.8424210311799578
0.9059689119946415
0.938938460185247
0.9139805997979817
0.8791150946846779
0.9604433557463424
0.36429086085480555
0.6224935475213342
0.9367462541020114
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[2, 3, 7, 0, 6, 1, 5, 4]
tensor([2, 3, 7, 0, 6, 1, 5, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 2, 1, 6, 0, 3, 7]
tensor([4, 5, 2, 1, 6, 0, 3, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 7, 1, 2, 6]
tensor([5, 3, 4, 0, 7, 1, 2, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 6, 4, 0, 3, 1, 2, 7]
tensor([5, 6, 4, 0, 3, 1, 2, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 2, 3]
tensor([0, 1, 3, 0, 1, 2, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 0, 1, 1, 2, 3]
tensor([2, 3, 0, 0, 1, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 3, 1, 2, 3]
tensor([2, 0, 1, 0, 3, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 2, 1, 3, 3]
tensor([2, 0, 1, 0, 2, 1, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 6 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
tensor([2, 7])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 18
done!
Normal merging for layer 19
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
tensor([1, 7])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 6])
tensor(0)
tensor([4, 7])
tensor(4)
done!
Normal merging for layer 21
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 4])
tensor(0)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 22 to 24
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 29
done!
Normal merging for layer 30
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 18 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.7017 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 17 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

191
cuda:7
winogrande
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.27s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/winogrande HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/winogrande HTTP/1.1" 200 1036
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=winogrande HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/winogrande.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 139681875517056 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 139681875517056 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 139681875517056 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 139681875517056 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Attempting to acquire lock 139647244387152 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 139647244387152 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 139647244387152 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 139647244387152 released on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:doc_to_text returned an int. Assuming multiple inputs.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of winogrande from None to 0
INFO:lm_eval.api.task:Building contexts for winogrande on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 139531.07it/s]
DEBUG:lm_eval.evaluator:Task: winogrande; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<03:53,  1.17s/it]Running loglikelihood requests:   1%|          | 2/200 [00:01<02:39,  1.24it/s]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:13,  1.48it/s]Running loglikelihood requests:   2%|▏         | 4/200 [00:02<02:02,  1.60it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:55,  1.69it/s]Running loglikelihood requests:   3%|▎         | 6/200 [00:03<01:50,  1.76it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:48,  1.79it/s]Running loglikelihood requests:   4%|▍         | 8/200 [00:04<01:46,  1.80it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:46,  1.80it/s]Running loglikelihood requests:   5%|▌         | 10/200 [00:06<01:45,  1.81it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:45,  1.79it/s]Running loglikelihood requests:   6%|▌         | 12/200 [00:07<01:44,  1.79it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:42,  1.82it/s]Running loglikelihood requests:   7%|▋         | 14/200 [00:08<01:41,  1.84it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:41,  1.82it/s]Running loglikelihood requests:   8%|▊         | 16/200 [00:09<01:39,  1.85it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:39,  1.84it/s]Running loglikelihood requests:   9%|▉         | 18/200 [00:10<01:39,  1.82it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:38,  1.84it/s]Running loglikelihood requests:  10%|█         | 20/200 [00:11<01:35,  1.88it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:11<01:33,  1.92it/s]Running loglikelihood requests:  11%|█         | 22/200 [00:12<01:31,  1.95it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:12<01:31,  1.93it/s]Running loglikelihood requests:  12%|█▏        | 24/200 [00:13<01:33,  1.88it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:14<01:36,  1.82it/s]Running loglikelihood requests:  13%|█▎        | 26/200 [00:14<01:38,  1.77it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:15<01:37,  1.77it/s]Running loglikelihood requests:  14%|█▍        | 28/200 [00:15<01:37,  1.77it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:16<01:36,  1.78it/s]Running loglikelihood requests:  15%|█▌        | 30/200 [00:16<01:34,  1.80it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:17<01:33,  1.81it/s]Running loglikelihood requests:  16%|█▌        | 32/200 [00:18<01:31,  1.84it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:18<01:29,  1.87it/s]Running loglikelihood requests:  17%|█▋        | 34/200 [00:19<01:27,  1.89it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:19<01:26,  1.91it/s]Running loglikelihood requests:  18%|█▊        | 36/200 [00:20<01:24,  1.94it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:20<01:22,  1.98it/s]Running loglikelihood requests:  19%|█▉        | 38/200 [00:21<01:20,  2.01it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:21<01:19,  2.01it/s]Running loglikelihood requests:  20%|██        | 40/200 [00:22<01:19,  2.02it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:22<01:20,  1.98it/s]Running loglikelihood requests:  21%|██        | 42/200 [00:23<01:20,  1.95it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:23<01:20,  1.96it/s]Running loglikelihood requests:  22%|██▏       | 44/200 [00:24<01:20,  1.93it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:24<01:20,  1.93it/s]Running loglikelihood requests:  23%|██▎       | 46/200 [00:25<01:21,  1.90it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:25<01:20,  1.90it/s]Running loglikelihood requests:  24%|██▍       | 48/200 [00:26<01:19,  1.91it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:26<01:18,  1.91it/s]Running loglikelihood requests:  25%|██▌       | 50/200 [00:27<01:18,  1.90it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:27<01:17,  1.92it/s]Running loglikelihood requests:  26%|██▌       | 52/200 [00:28<01:14,  1.97it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:28<01:13,  2.01it/s]Running loglikelihood requests:  27%|██▋       | 54/200 [00:29<01:12,  2.00it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:29<01:11,  2.02it/s]Running loglikelihood requests:  28%|██▊       | 56/200 [00:30<01:13,  1.97it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:30<01:12,  1.97it/s]Running loglikelihood requests:  29%|██▉       | 58/200 [00:31<01:13,  1.93it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:31<01:12,  1.95it/s]Running loglikelihood requests:  30%|███       | 60/200 [00:32<01:12,  1.94it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:32<01:11,  1.94it/s]Running loglikelihood requests:  31%|███       | 62/200 [00:33<01:10,  1.95it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:33<01:10,  1.94it/s]Running loglikelihood requests:  32%|███▏      | 64/200 [00:34<01:10,  1.94it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:34<01:08,  1.96it/s]Running loglikelihood requests:  33%|███▎      | 66/200 [00:35<01:06,  2.01it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:35<01:05,  2.04it/s]Running loglikelihood requests:  34%|███▍      | 68/200 [00:36<01:04,  2.05it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:36<01:04,  2.04it/s]Running loglikelihood requests:  35%|███▌      | 70/200 [00:37<01:04,  2.02it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:37<01:04,  1.99it/s]Running loglikelihood requests:  36%|███▌      | 72/200 [00:38<01:04,  1.97it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:38<01:06,  1.91it/s]Running loglikelihood requests:  37%|███▋      | 74/200 [00:39<01:06,  1.90it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:40<01:07,  1.85it/s]Running loglikelihood requests:  38%|███▊      | 76/200 [00:40<01:06,  1.85it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:41<01:05,  1.87it/s]Running loglikelihood requests:  39%|███▉      | 78/200 [00:41<01:05,  1.87it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:42<01:04,  1.87it/s]Running loglikelihood requests:  40%|████      | 80/200 [00:42<01:04,  1.86it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:43<01:02,  1.89it/s]Running loglikelihood requests:  41%|████      | 82/200 [00:43<01:02,  1.89it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:44<01:02,  1.88it/s]Running loglikelihood requests:  42%|████▏     | 84/200 [00:44<01:01,  1.90it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:45<01:01,  1.87it/s]Running loglikelihood requests:  43%|████▎     | 86/200 [00:45<01:00,  1.90it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:46<00:58,  1.92it/s]Running loglikelihood requests:  44%|████▍     | 88/200 [00:46<00:56,  1.98it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:47<00:54,  2.03it/s]Running loglikelihood requests:  45%|████▌     | 90/200 [00:47<00:53,  2.07it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:48<00:52,  2.09it/s]Running loglikelihood requests:  46%|████▌     | 92/200 [00:48<00:51,  2.10it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:49<00:53,  2.02it/s]Running loglikelihood requests:  47%|████▋     | 94/200 [00:49<00:53,  1.98it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:50<00:53,  1.95it/s]Running loglikelihood requests:  48%|████▊     | 96/200 [00:50<00:55,  1.89it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:51<00:54,  1.89it/s]Running loglikelihood requests:  49%|████▉     | 98/200 [00:51<00:53,  1.91it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:52<00:52,  1.93it/s]Running loglikelihood requests:  50%|█████     | 100/200 [00:52<00:51,  1.95it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:53<00:50,  1.95it/s]Running loglikelihood requests:  51%|█████     | 102/200 [00:53<00:50,  1.95it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:54<00:49,  1.94it/s]Running loglikelihood requests:  52%|█████▏    | 104/200 [00:54<00:48,  1.97it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:55<00:47,  2.00it/s]Running loglikelihood requests:  53%|█████▎    | 106/200 [00:55<00:45,  2.06it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:56<00:44,  2.11it/s]Running loglikelihood requests:  54%|█████▍    | 108/200 [00:56<00:43,  2.14it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:57<00:42,  2.13it/s]Running loglikelihood requests:  55%|█████▌    | 110/200 [00:57<00:43,  2.05it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:58<00:46,  1.90it/s]Running loglikelihood requests:  56%|█████▌    | 112/200 [00:58<00:45,  1.92it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:59<00:45,  1.90it/s]Running loglikelihood requests:  57%|█████▋    | 114/200 [00:59<00:45,  1.87it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [01:00<00:43,  1.96it/s]Running loglikelihood requests:  58%|█████▊    | 116/200 [01:00<00:41,  2.02it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [01:01<00:43,  1.93it/s]Running loglikelihood requests:  59%|█████▉    | 118/200 [01:02<00:43,  1.90it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [01:02<00:44,  1.84it/s]Running loglikelihood requests:  60%|██████    | 120/200 [01:03<00:43,  1.83it/s]Running loglikelihood requests:  60%|██████    | 121/200 [01:03<00:42,  1.87it/s]Running loglikelihood requests:  61%|██████    | 122/200 [01:04<00:41,  1.86it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [01:04<00:40,  1.91it/s]Running loglikelihood requests:  62%|██████▏   | 124/200 [01:05<00:38,  1.96it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [01:05<00:37,  1.99it/s]Running loglikelihood requests:  63%|██████▎   | 126/200 [01:06<00:37,  2.00it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [01:06<00:36,  2.00it/s]Running loglikelihood requests:  64%|██████▍   | 128/200 [01:07<00:35,  2.01it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [01:07<00:35,  2.02it/s]Running loglikelihood requests:  65%|██████▌   | 130/200 [01:08<00:34,  2.03it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [01:08<00:34,  2.02it/s]Running loglikelihood requests:  66%|██████▌   | 132/200 [01:09<00:33,  2.01it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [01:09<00:32,  2.04it/s]Running loglikelihood requests:  67%|██████▋   | 134/200 [01:10<00:33,  2.00it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [01:10<00:32,  1.99it/s]Running loglikelihood requests:  68%|██████▊   | 136/200 [01:11<00:32,  1.97it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:11<00:32,  1.93it/s]Running loglikelihood requests:  69%|██████▉   | 138/200 [01:12<00:32,  1.92it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:12<00:31,  1.95it/s]Running loglikelihood requests:  70%|███████   | 140/200 [01:13<00:31,  1.93it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:13<00:30,  1.92it/s]Running loglikelihood requests:  71%|███████   | 142/200 [01:14<00:30,  1.88it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:14<00:30,  1.88it/s]Running loglikelihood requests:  72%|███████▏  | 144/200 [01:15<00:29,  1.92it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:15<00:28,  1.93it/s]Running loglikelihood requests:  73%|███████▎  | 146/200 [01:16<00:27,  1.96it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:16<00:26,  2.00it/s]Running loglikelihood requests:  74%|███████▍  | 148/200 [01:17<00:25,  2.06it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:17<00:24,  2.11it/s]Running loglikelihood requests:  75%|███████▌  | 150/200 [01:18<00:23,  2.15it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:18<00:22,  2.14it/s]Running loglikelihood requests:  76%|███████▌  | 152/200 [01:19<00:24,  1.93it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:19<00:24,  1.93it/s]Running loglikelihood requests:  77%|███████▋  | 154/200 [01:20<00:23,  1.99it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:20<00:22,  1.99it/s]Running loglikelihood requests:  78%|███████▊  | 156/200 [01:21<00:22,  2.00it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:21<00:21,  2.01it/s]Running loglikelihood requests:  79%|███████▉  | 158/200 [01:22<00:20,  2.01it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:22<00:21,  1.92it/s]Running loglikelihood requests:  80%|████████  | 160/200 [01:23<00:21,  1.90it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:23<00:20,  1.92it/s]Running loglikelihood requests:  81%|████████  | 162/200 [01:24<00:19,  1.92it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:24<00:19,  1.94it/s]Running loglikelihood requests:  82%|████████▏ | 164/200 [01:25<00:18,  1.92it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:25<00:18,  1.94it/s]Running loglikelihood requests:  83%|████████▎ | 166/200 [01:26<00:17,  1.92it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:26<00:17,  1.93it/s]Running loglikelihood requests:  84%|████████▍ | 168/200 [01:27<00:16,  1.95it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:27<00:15,  1.96it/s]Running loglikelihood requests:  85%|████████▌ | 170/200 [01:28<00:15,  1.97it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:28<00:14,  1.98it/s]Running loglikelihood requests:  86%|████████▌ | 172/200 [01:29<00:13,  2.02it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:29<00:13,  2.04it/s]Running loglikelihood requests:  87%|████████▋ | 174/200 [01:30<00:12,  2.07it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:30<00:11,  2.14it/s]Running loglikelihood requests:  88%|████████▊ | 176/200 [01:31<00:10,  2.18it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:31<00:10,  2.22it/s]Running loglikelihood requests:  89%|████████▉ | 178/200 [01:32<00:10,  2.17it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:32<00:09,  2.12it/s]Running loglikelihood requests:  90%|█████████ | 180/200 [01:33<00:09,  2.06it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:33<00:10,  1.80it/s]Running loglikelihood requests:  91%|█████████ | 182/200 [01:34<00:09,  1.93it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:34<00:08,  2.02it/s]Running loglikelihood requests:  92%|█████████▏| 184/200 [01:35<00:07,  2.06it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:35<00:07,  2.09it/s]Running loglikelihood requests:  93%|█████████▎| 186/200 [01:36<00:06,  2.09it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:36<00:06,  2.10it/s]Running loglikelihood requests:  94%|█████████▍| 188/200 [01:37<00:05,  2.13it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:37<00:05,  2.15it/s]Running loglikelihood requests:  95%|█████████▌| 190/200 [01:38<00:04,  2.12it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:38<00:04,  2.07it/s]Running loglikelihood requests:  96%|█████████▌| 192/200 [01:39<00:03,  2.09it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:39<00:03,  2.05it/s]Running loglikelihood requests:  97%|█████████▋| 194/200 [01:40<00:03,  1.98it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:40<00:02,  1.97it/s]Running loglikelihood requests:  98%|█████████▊| 196/200 [01:41<00:02,  1.96it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:41<00:01,  1.97it/s]Running loglikelihood requests:  99%|█████████▉| 198/200 [01:42<00:00,  2.02it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:42<00:00,  2.07it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:42<00:00,  2.14it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:42<00:00,  1.94it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'winogrande': {'alias': 'winogrande', 'acc,none': 0.69, 'acc_stderr,none': 0.046482319871173176}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9565474555896152
0.9256436871263655
0.919777800952949
0.8502516827829548
0.9788217808920475
0.7842184683361061
0.5847175538207384
0.7741211354638314
0.8734705119073022
0.9731317123565076
0.9046875380381674
0.8858535931048256
0.9314298098713261
0.8442403312485581
0.7166029053748131
0.7061450250233585
0.7563059483803782
0.6877563559653158
0.8738989590810852
0.784285727893607
0.8409178900131131
0.8425380927376759
0.6782655591765769
0.7228968829640015
0.8418686487797186
0.9141168065903919
0.8562481461255738
0.6139553840231665
0.934088538459943
Total groups 66 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 4, 3, 5, 1, 7, 0]
tensor([6, 2, 4, 3, 5, 1, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 4, 1, 0, 3, 0, 1, 2]
tensor([5, 4, 1, 0, 3, 0, 1, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 3, 1, 4, 5, 1, 0]
tensor([0, 2, 3, 1, 4, 5, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[5, 1, 2, 3, 4, 0, 1, 0]
tensor([5, 1, 2, 3, 4, 0, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 2, 1, 1, 2, 3, 3, 0]
tensor([0, 2, 1, 1, 2, 3, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 1.0, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1.0, 1.0, 1]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 7
done!
Normal merging for layer 8
tensor([3, 5])
tensor(3)
tensor([2, 6])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 9 to 13
done!
Normal merging for layer 14
tensor([0, 7])
tensor(0)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
done!
Normal merging for layer 15
tensor([5, 7])
tensor(5)
tensor([1, 6])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 16
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
done!
Cross-layer merge completed for layers 17 to 23
done!
Normal merging for layer 24
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 17 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 16 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

15
cuda:0
mrpc
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.98s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mrpc] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mrpc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: mrpc] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: mrpc] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mrpc?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mrpc?recursive=False&expand=False HTTP/1.1" 200 356
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139681875514608 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139681875514608 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139681875514608 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139681875514608 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139670929329616 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139670929329616 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670929329616 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139670929329616 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mrpc from None to 0
INFO:lm_eval.api.task:Building contexts for mrpc on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2508.27it/s]
DEBUG:lm_eval.evaluator:Task: mrpc; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:14,  1.58s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:28,  1.33it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<02:00,  1.62it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:44,  1.84it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:37,  1.96it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:31,  2.07it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:26,  2.15it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:07<01:23,  2.21it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:08<01:21,  2.25it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:09<01:19,  2.27it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:18,  2.29it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:16,  2.32it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:12<01:14,  2.34it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:12<01:13,  2.35it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:13<01:12,  2.37it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:12,  2.33it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:10,  2.36it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:09,  2.39it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:07,  2.41it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:17<01:06,  2.42it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:05,  2.43it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<01:04,  2.45it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<01:03,  2.45it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:21<01:02,  2.47it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:21<01:00,  2.48it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:22<00:59,  2.49it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:23<00:58,  2.50it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:24<00:57,  2.51it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:25<00:56,  2.51it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:25<00:55,  2.53it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:26<00:54,  2.53it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:27<00:53,  2.54it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:28<00:52,  2.55it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:29<00:52,  2.56it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:29<00:51,  2.56it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:30<00:50,  2.58it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:31<00:49,  2.59it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:32<00:48,  2.60it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:32<00:47,  2.61it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:33<00:46,  2.62it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:34<00:45,  2.62it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:35<00:44,  2.63it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:35<00:43,  2.63it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:36<00:42,  2.64it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:37<00:41,  2.65it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:38<00:40,  2.66it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:38<00:40,  2.67it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:39<00:39,  2.67it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:40<00:38,  2.67it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:41<00:37,  2.69it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:41<00:36,  2.70it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:42<00:37,  2.57it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:43<00:36,  2.61it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:44<00:35,  2.64it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:44<00:34,  2.67it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:45<00:33,  2.69it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:46<00:32,  2.71it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:47<00:31,  2.72it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:47<00:30,  2.72it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:48<00:29,  2.73it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:49<00:28,  2.74it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:49<00:27,  2.75it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:50<00:27,  2.76it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:51<00:26,  2.77it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:52<00:25,  2.78it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:52<00:24,  2.79it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:53<00:23,  2.80it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:54<00:23,  2.81it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:54<00:22,  2.81it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:55<00:21,  2.82it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:56<00:20,  2.82it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:57<00:20,  2.84it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:57<00:19,  2.85it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:58<00:18,  2.86it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:59<00:17,  2.86it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:59<00:17,  2.86it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:00<00:16,  2.86it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:01<00:15,  2.86it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:01<00:14,  2.88it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:02<00:14,  2.89it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:03<00:13,  2.90it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:04<00:12,  2.92it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:04<00:11,  2.93it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:05<00:11,  2.95it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:06<00:10,  2.97it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:06<00:09,  2.99it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:07<00:08,  3.01it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:07<00:08,  3.02it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:08<00:07,  3.04it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:09<00:06,  3.07it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:09<00:06,  3.08it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:10<00:05,  3.11it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:11<00:04,  3.13it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:11<00:04,  3.11it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:12<00:03,  3.09it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:13<00:02,  3.12it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:13<00:02,  3.15it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:14<00:01,  3.17it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:14<00:00,  3.19it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:15<00:00,  3.25it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:15<00:00,  2.65it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:57,  1.19s/it]  2%|▏         | 2/100 [00:02<01:56,  1.19s/it]  3%|▎         | 3/100 [00:03<01:54,  1.19s/it]  4%|▍         | 4/100 [00:04<01:54,  1.20s/it]  5%|▌         | 5/100 [00:05<01:53,  1.19s/it]  6%|▌         | 6/100 [00:07<01:51,  1.19s/it]  7%|▋         | 7/100 [00:08<01:50,  1.19s/it]  8%|▊         | 8/100 [00:09<01:49,  1.19s/it]  9%|▉         | 9/100 [00:10<01:48,  1.19s/it] 10%|█         | 10/100 [00:11<01:47,  1.19s/it] 11%|█         | 11/100 [00:13<01:46,  1.19s/it] 12%|█▏        | 12/100 [00:14<01:45,  1.19s/it] 13%|█▎        | 13/100 [00:15<01:43,  1.19s/it] 14%|█▍        | 14/100 [00:16<01:42,  1.19s/it] 15%|█▌        | 15/100 [00:17<01:41,  1.19s/it] 16%|█▌        | 16/100 [00:19<01:40,  1.19s/it] 17%|█▋        | 17/100 [00:20<01:39,  1.20s/it] 18%|█▊        | 18/100 [00:21<01:38,  1.20s/it] 19%|█▉        | 19/100 [00:22<01:36,  1.19s/it] 20%|██        | 20/100 [00:23<01:35,  1.19s/it] 21%|██        | 21/100 [00:25<01:34,  1.19s/it] 22%|██▏       | 22/100 [00:26<01:32,  1.19s/it] 23%|██▎       | 23/100 [00:27<01:31,  1.19s/it] 24%|██▍       | 24/100 [00:28<01:30,  1.19s/it] 25%|██▌       | 25/100 [00:29<01:29,  1.19s/it] 26%|██▌       | 26/100 [00:30<01:27,  1.19s/it] 27%|██▋       | 27/100 [00:32<01:26,  1.19s/it] 28%|██▊       | 28/100 [00:33<01:25,  1.19s/it] 29%|██▉       | 29/100 [00:34<01:24,  1.19s/it] 30%|███       | 30/100 [00:35<01:23,  1.19s/it] 31%|███       | 31/100 [00:36<01:21,  1.19s/it] 32%|███▏      | 32/100 [00:38<01:20,  1.19s/it] 33%|███▎      | 33/100 [00:39<01:19,  1.19s/it] 34%|███▍      | 34/100 [00:40<01:18,  1.19s/it] 35%|███▌      | 35/100 [00:41<01:17,  1.19s/it] 36%|███▌      | 36/100 [00:42<01:15,  1.19s/it] 37%|███▋      | 37/100 [00:44<01:14,  1.19s/it] 38%|███▊      | 38/100 [00:45<01:13,  1.19s/it] 39%|███▉      | 39/100 [00:46<01:12,  1.19s/it] 40%|████      | 40/100 [00:47<01:11,  1.19s/it] 41%|████      | 41/100 [00:48<01:10,  1.19s/it] 42%|████▏     | 42/100 [00:49<01:09,  1.19s/it] 43%|████▎     | 43/100 [00:51<01:07,  1.19s/it] 44%|████▍     | 44/100 [00:52<01:06,  1.19s/it] 45%|████▌     | 45/100 [00:53<01:05,  1.19s/it] 46%|████▌     | 46/100 [00:54<01:04,  1.19s/it] 47%|████▋     | 47/100 [00:55<01:03,  1.19s/it] 48%|████▊     | 48/100 [00:57<01:01,  1.19s/it] 49%|████▉     | 49/100 [00:58<01:00,  1.19s/it] 50%|█████     | 50/100 [00:59<00:59,  1.19s/it] 51%|█████     | 51/100 [01:00<00:58,  1.19s/it] 52%|█████▏    | 52/100 [01:01<00:57,  1.19s/it] 53%|█████▎    | 53/100 [01:03<00:56,  1.19s/it] 54%|█████▍    | 54/100 [01:04<00:54,  1.19s/it] 55%|█████▌    | 55/100 [01:05<00:53,  1.19s/it] 56%|█████▌    | 56/100 [01:06<00:52,  1.19s/it] 57%|█████▋    | 57/100 [01:07<00:51,  1.19s/it] 58%|█████▊    | 58/100 [01:09<00:49,  1.19s/it] 59%|█████▉    | 59/100 [01:10<00:49,  1.20s/it] 60%|██████    | 60/100 [01:11<00:47,  1.20s/it] 61%|██████    | 61/100 [01:12<00:46,  1.19s/it] 62%|██████▏   | 62/100 [01:13<00:45,  1.19s/it] 63%|██████▎   | 63/100 [01:15<00:44,  1.19s/it] 64%|██████▍   | 64/100 [01:16<00:42,  1.19s/it] 65%|██████▌   | 65/100 [01:17<00:41,  1.19s/it] 66%|██████▌   | 66/100 [01:18<00:40,  1.19s/it] 67%|██████▋   | 67/100 [01:19<00:39,  1.19s/it] 68%|██████▊   | 68/100 [01:20<00:38,  1.19s/it] 69%|██████▉   | 69/100 [01:22<00:36,  1.19s/it] 70%|███████   | 70/100 [01:23<00:35,  1.19s/it] 71%|███████   | 71/100 [01:24<00:34,  1.19s/it] 72%|███████▏  | 72/100 [01:25<00:33,  1.19s/it] 73%|███████▎  | 73/100 [01:26<00:32,  1.20s/it] 74%|███████▍  | 74/100 [01:28<00:31,  1.20s/it] 75%|███████▌  | 75/100 [01:29<00:29,  1.20s/it] 76%|███████▌  | 76/100 [01:30<00:28,  1.20s/it] 77%|███████▋  | 77/100 [01:31<00:27,  1.20s/it] 78%|███████▊  | 78/100 [01:32<00:26,  1.20s/it] 79%|███████▉  | 79/100 [01:34<00:25,  1.20s/it] 80%|████████  | 80/100 [01:35<00:23,  1.20s/it] 81%|████████  | 81/100 [01:36<00:22,  1.20s/it] 82%|████████▏ | 82/100 [01:37<00:21,  1.20s/it] 83%|████████▎ | 83/100 [01:38<00:20,  1.20s/it] 84%|████████▍ | 84/100 [01:40<00:19,  1.20s/it] 85%|████████▌ | 85/100 [01:41<00:18,  1.20s/it] 86%|████████▌ | 86/100 [01:42<00:16,  1.20s/it] 87%|████████▋ | 87/100 [01:43<00:15,  1.19s/it] 88%|████████▊ | 88/100 [01:44<00:14,  1.19s/it] 89%|████████▉ | 89/100 [01:46<00:13,  1.19s/it] 90%|█████████ | 90/100 [01:47<00:11,  1.19s/it] 91%|█████████ | 91/100 [01:48<00:10,  1.19s/it] 92%|█████████▏| 92/100 [01:49<00:09,  1.19s/it] 93%|█████████▎| 93/100 [01:50<00:08,  1.19s/it] 94%|█████████▍| 94/100 [01:52<00:07,  1.19s/it] 95%|█████████▌| 95/100 [01:53<00:05,  1.19s/it] 96%|█████████▌| 96/100 [01:54<00:04,  1.19s/it] 97%|█████████▋| 97/100 [01:55<00:03,  1.19s/it] 98%|█████████▊| 98/100 [01:56<00:02,  1.19s/it] 99%|█████████▉| 99/100 [01:57<00:01,  1.19s/it]100%|██████████| 100/100 [01:59<00:00,  1.19s/it]100%|██████████| 100/100 [01:59<00:00,  1.19s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'mrpc': {'alias': 'mrpc', 'acc,none': 0.7, 'acc_stderr,none': 0.04605661864718383, 'f1,none': np.float64(0.8214285714285714), 'f1_stderr,none': 0.0323693653386572}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.32375514242269293
0.9664141198776434
0.4263233992087649
0.29258192731768157
0.3497718342079178
0.5968480671674146
0.7870107004084098
0.7068508532201193
0.7836897379939763
0.2579819071737284
0.5774144903645764
0.7819348699339372
0.7404680063618143
0.651835611327285
0.6832243011482585
0.34680079188801705
0.6033476505145444
0.6299526106979766
0.6468468631829007
0.8458578364778718
0.39447753640727073
0.5291234791393744
0.944540808938638
0.8460909093145242
0.4915397062049404
0.5314721523201049
0.8670806018560002
0.6451914961665037
0.7380077491787214
0.32375514242269293
0.9664141198776434
0.4263233992087649
0.29258192731768157
0.3497718342079178
0.5968480671674146
0.7870107004084098
0.7068508532201193
0.7836897379939763
0.2579819071737284
0.5774144903645764
0.7819348699339372
0.7404680063618143
0.651835611327285
0.6832243011482585
0.34680079188801705
0.6033476505145444
0.6299526106979766
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 7, 1, 6, 2, 3, 0]
tensor([4, 5, 7, 1, 6, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 4, 5, 0, 1, 2]
tensor([6, 3, 7, 4, 5, 0, 1, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 1, 7, 2, 6, 0, 3, 5]
tensor([4, 1, 7, 2, 6, 0, 3, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 5, 2, 7, 0, 4, 1]
tensor([6, 3, 5, 2, 7, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 5, 6, 7, 3, 1, 0, 2]
tensor([4, 5, 6, 7, 3, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 4, 1, 0, 5]
tensor([0, 3, 1, 2, 4, 1, 0, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1, 1.0]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 2
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 4 to 5
done!
Normal merging for layer 6
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 9
done!
Normal merging for layer 10
tensor([0, 6])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 11 to 26
done!
Normal merging for layer 27
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 28 to 30
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 16 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3867 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 15 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

186
cuda:1
copa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.63s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: copa] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139681875517392 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139681875517392 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139681875517392 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139681875517392 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_copa_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139671867876096 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139671867876096 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671867876096 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139671867876096 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/copa/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " the toilet filled with water." have whitespace
DEBUG:lm_eval.api.task:Both target_delimiter " " and target choice: " water flowed from the spout." have whitespace
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of copa from None to 0
INFO:lm_eval.api.task:Building contexts for copa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 141174.82it/s]
DEBUG:lm_eval.evaluator:Task: copa; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<03:44,  1.13s/it]Running loglikelihood requests:   1%|          | 2/200 [00:01<02:29,  1.33it/s]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:02,  1.61it/s]Running loglikelihood requests:   2%|▏         | 4/200 [00:02<01:48,  1.80it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:41,  1.92it/s]Running loglikelihood requests:   3%|▎         | 6/200 [00:03<01:36,  2.00it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:33,  2.06it/s]Running loglikelihood requests:   4%|▍         | 8/200 [00:04<01:30,  2.11it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:29,  2.14it/s]Running loglikelihood requests:   5%|▌         | 10/200 [00:05<01:27,  2.16it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:26,  2.18it/s]Running loglikelihood requests:   6%|▌         | 12/200 [00:06<01:25,  2.19it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:24,  2.20it/s]Running loglikelihood requests:   7%|▋         | 14/200 [00:07<01:24,  2.21it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:07<01:23,  2.22it/s]Running loglikelihood requests:   8%|▊         | 16/200 [00:07<01:22,  2.23it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:08<01:21,  2.24it/s]Running loglikelihood requests:   9%|▉         | 18/200 [00:08<01:21,  2.25it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:09<01:20,  2.25it/s]Running loglikelihood requests:  10%|█         | 20/200 [00:09<01:19,  2.25it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:19,  2.25it/s]Running loglikelihood requests:  11%|█         | 22/200 [00:10<01:18,  2.26it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:18,  2.26it/s]Running loglikelihood requests:  12%|█▏        | 24/200 [00:11<01:17,  2.26it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:11<01:17,  2.27it/s]Running loglikelihood requests:  13%|█▎        | 26/200 [00:12<01:16,  2.27it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:12<01:16,  2.27it/s]Running loglikelihood requests:  14%|█▍        | 28/200 [00:13<01:15,  2.26it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:13<01:15,  2.27it/s]Running loglikelihood requests:  15%|█▌        | 30/200 [00:14<01:14,  2.28it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:13,  2.28it/s]Running loglikelihood requests:  16%|█▌        | 32/200 [00:14<01:13,  2.29it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:12,  2.29it/s]Running loglikelihood requests:  17%|█▋        | 34/200 [00:15<01:12,  2.29it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:11,  2.30it/s]Running loglikelihood requests:  18%|█▊        | 36/200 [00:16<01:11,  2.29it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:17<01:10,  2.30it/s]Running loglikelihood requests:  19%|█▉        | 38/200 [00:17<01:10,  2.30it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:18<01:10,  2.30it/s]Running loglikelihood requests:  20%|██        | 40/200 [00:18<01:09,  2.31it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:08,  2.31it/s]Running loglikelihood requests:  21%|██        | 42/200 [00:19<01:08,  2.30it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<01:08,  2.30it/s]Running loglikelihood requests:  22%|██▏       | 44/200 [00:20<01:07,  2.30it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:20<01:07,  2.31it/s]Running loglikelihood requests:  23%|██▎       | 46/200 [00:21<01:06,  2.31it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:21<01:06,  2.31it/s]Running loglikelihood requests:  24%|██▍       | 48/200 [00:21<01:05,  2.30it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:22<01:05,  2.30it/s]Running loglikelihood requests:  25%|██▌       | 50/200 [00:22<01:05,  2.30it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:23<01:04,  2.30it/s]Running loglikelihood requests:  26%|██▌       | 52/200 [00:23<01:04,  2.30it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:24<01:05,  2.26it/s]Running loglikelihood requests:  27%|██▋       | 54/200 [00:24<01:04,  2.27it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:25<01:03,  2.27it/s]Running loglikelihood requests:  28%|██▊       | 56/200 [00:25<01:03,  2.28it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:25<01:02,  2.27it/s]Running loglikelihood requests:  29%|██▉       | 58/200 [00:26<01:03,  2.24it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:26<01:02,  2.26it/s]Running loglikelihood requests:  30%|███       | 60/200 [00:27<01:01,  2.26it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:27<01:02,  2.23it/s]Running loglikelihood requests:  31%|███       | 62/200 [00:28<01:02,  2.22it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:28<01:01,  2.24it/s]Running loglikelihood requests:  32%|███▏      | 64/200 [00:29<01:00,  2.27it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:29<00:59,  2.28it/s]Running loglikelihood requests:  33%|███▎      | 66/200 [00:29<00:58,  2.28it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:30<00:57,  2.30it/s]Running loglikelihood requests:  34%|███▍      | 68/200 [00:30<00:57,  2.31it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:31<00:56,  2.32it/s]Running loglikelihood requests:  35%|███▌      | 70/200 [00:31<00:56,  2.31it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:32<00:55,  2.31it/s]Running loglikelihood requests:  36%|███▌      | 72/200 [00:32<00:55,  2.32it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:32<00:54,  2.33it/s]Running loglikelihood requests:  37%|███▋      | 74/200 [00:33<00:53,  2.34it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:33<00:53,  2.34it/s]Running loglikelihood requests:  38%|███▊      | 76/200 [00:34<00:52,  2.35it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:34<00:52,  2.35it/s]Running loglikelihood requests:  39%|███▉      | 78/200 [00:35<00:51,  2.36it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:35<00:51,  2.37it/s]Running loglikelihood requests:  40%|████      | 80/200 [00:35<00:50,  2.36it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:36<00:50,  2.36it/s]Running loglikelihood requests:  41%|████      | 82/200 [00:36<00:50,  2.35it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:37<00:49,  2.35it/s]Running loglikelihood requests:  42%|████▏     | 84/200 [00:37<00:49,  2.36it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:37<00:48,  2.36it/s]Running loglikelihood requests:  43%|████▎     | 86/200 [00:38<00:48,  2.36it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:38<00:47,  2.36it/s]Running loglikelihood requests:  44%|████▍     | 88/200 [00:39<00:47,  2.36it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:39<00:47,  2.36it/s]Running loglikelihood requests:  45%|████▌     | 90/200 [00:40<00:46,  2.36it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:40<00:46,  2.36it/s]Running loglikelihood requests:  46%|████▌     | 92/200 [00:40<00:45,  2.35it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:41<00:45,  2.35it/s]Running loglikelihood requests:  47%|████▋     | 94/200 [00:41<00:45,  2.35it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:42<00:44,  2.35it/s]Running loglikelihood requests:  48%|████▊     | 96/200 [00:42<00:44,  2.35it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:43<00:43,  2.35it/s]Running loglikelihood requests:  49%|████▉     | 98/200 [00:43<00:43,  2.37it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:43<00:42,  2.38it/s]Running loglikelihood requests:  50%|█████     | 100/200 [00:44<00:42,  2.38it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:44<00:41,  2.38it/s]Running loglikelihood requests:  51%|█████     | 102/200 [00:45<00:41,  2.38it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:45<00:40,  2.38it/s]Running loglikelihood requests:  52%|█████▏    | 104/200 [00:46<00:40,  2.39it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:46<00:39,  2.39it/s]Running loglikelihood requests:  53%|█████▎    | 106/200 [00:46<00:39,  2.38it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:47<00:38,  2.39it/s]Running loglikelihood requests:  54%|█████▍    | 108/200 [00:47<00:38,  2.39it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:48<00:38,  2.39it/s]Running loglikelihood requests:  55%|█████▌    | 110/200 [00:48<00:37,  2.39it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:48<00:37,  2.39it/s]Running loglikelihood requests:  56%|█████▌    | 112/200 [00:49<00:36,  2.39it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:49<00:36,  2.39it/s]Running loglikelihood requests:  57%|█████▋    | 114/200 [00:50<00:35,  2.40it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:50<00:35,  2.41it/s]Running loglikelihood requests:  58%|█████▊    | 116/200 [00:51<00:34,  2.42it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:51<00:34,  2.43it/s]Running loglikelihood requests:  59%|█████▉    | 118/200 [00:51<00:33,  2.43it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:52<00:33,  2.43it/s]Running loglikelihood requests:  60%|██████    | 120/200 [00:52<00:33,  2.42it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:53<00:32,  2.42it/s]Running loglikelihood requests:  61%|██████    | 122/200 [00:53<00:32,  2.42it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:53<00:31,  2.42it/s]Running loglikelihood requests:  62%|██████▏   | 124/200 [00:54<00:31,  2.44it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:54<00:30,  2.43it/s]Running loglikelihood requests:  63%|██████▎   | 126/200 [00:55<00:30,  2.43it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:55<00:30,  2.43it/s]Running loglikelihood requests:  64%|██████▍   | 128/200 [00:55<00:29,  2.43it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:56<00:29,  2.42it/s]Running loglikelihood requests:  65%|██████▌   | 130/200 [00:56<00:28,  2.43it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:57<00:28,  2.43it/s]Running loglikelihood requests:  66%|██████▌   | 132/200 [00:57<00:28,  2.43it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:58<00:27,  2.42it/s]Running loglikelihood requests:  67%|██████▋   | 134/200 [00:58<00:27,  2.42it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:58<00:26,  2.42it/s]Running loglikelihood requests:  68%|██████▊   | 136/200 [00:59<00:26,  2.42it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:59<00:26,  2.42it/s]Running loglikelihood requests:  69%|██████▉   | 138/200 [01:00<00:25,  2.42it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:00<00:25,  2.42it/s]Running loglikelihood requests:  70%|███████   | 140/200 [01:00<00:24,  2.43it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:01<00:24,  2.43it/s]Running loglikelihood requests:  71%|███████   | 142/200 [01:01<00:23,  2.43it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:02<00:23,  2.41it/s]Running loglikelihood requests:  72%|███████▏  | 144/200 [01:02<00:23,  2.43it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:02<00:22,  2.43it/s]Running loglikelihood requests:  73%|███████▎  | 146/200 [01:03<00:22,  2.44it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:03<00:21,  2.46it/s]Running loglikelihood requests:  74%|███████▍  | 148/200 [01:04<00:21,  2.45it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:04<00:20,  2.44it/s]Running loglikelihood requests:  75%|███████▌  | 150/200 [01:05<00:20,  2.43it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:05<00:20,  2.44it/s]Running loglikelihood requests:  76%|███████▌  | 152/200 [01:05<00:19,  2.44it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:06<00:19,  2.44it/s]Running loglikelihood requests:  77%|███████▋  | 154/200 [01:06<00:18,  2.45it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:07<00:18,  2.45it/s]Running loglikelihood requests:  78%|███████▊  | 156/200 [01:07<00:17,  2.46it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:07<00:17,  2.46it/s]Running loglikelihood requests:  79%|███████▉  | 158/200 [01:08<00:17,  2.46it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:08<00:16,  2.46it/s]Running loglikelihood requests:  80%|████████  | 160/200 [01:09<00:16,  2.47it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:09<00:15,  2.48it/s]Running loglikelihood requests:  81%|████████  | 162/200 [01:09<00:15,  2.48it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:10<00:14,  2.49it/s]Running loglikelihood requests:  82%|████████▏ | 164/200 [01:10<00:14,  2.48it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:11<00:14,  2.48it/s]Running loglikelihood requests:  83%|████████▎ | 166/200 [01:11<00:13,  2.48it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:11<00:13,  2.49it/s]Running loglikelihood requests:  84%|████████▍ | 168/200 [01:12<00:12,  2.50it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:12<00:12,  2.49it/s]Running loglikelihood requests:  85%|████████▌ | 170/200 [01:13<00:12,  2.48it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:13<00:11,  2.48it/s]Running loglikelihood requests:  86%|████████▌ | 172/200 [01:13<00:11,  2.49it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:14<00:10,  2.50it/s]Running loglikelihood requests:  87%|████████▋ | 174/200 [01:14<00:10,  2.50it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:15<00:09,  2.51it/s]Running loglikelihood requests:  88%|████████▊ | 176/200 [01:15<00:09,  2.51it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:15<00:09,  2.51it/s]Running loglikelihood requests:  89%|████████▉ | 178/200 [01:16<00:08,  2.52it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:16<00:08,  2.52it/s]Running loglikelihood requests:  90%|█████████ | 180/200 [01:17<00:07,  2.52it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:17<00:07,  2.52it/s]Running loglikelihood requests:  91%|█████████ | 182/200 [01:17<00:07,  2.51it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:18<00:06,  2.54it/s]Running loglikelihood requests:  92%|█████████▏| 184/200 [01:18<00:06,  2.54it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:19<00:05,  2.55it/s]Running loglikelihood requests:  93%|█████████▎| 186/200 [01:19<00:05,  2.55it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:19<00:05,  2.55it/s]Running loglikelihood requests:  94%|█████████▍| 188/200 [01:20<00:04,  2.55it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:20<00:04,  2.56it/s]Running loglikelihood requests:  95%|█████████▌| 190/200 [01:20<00:03,  2.58it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:21<00:03,  2.54it/s]Running loglikelihood requests:  96%|█████████▌| 192/200 [01:21<00:03,  2.53it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:22<00:02,  2.55it/s]Running loglikelihood requests:  97%|█████████▋| 194/200 [01:22<00:02,  2.56it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:22<00:01,  2.56it/s]Running loglikelihood requests:  98%|█████████▊| 196/200 [01:23<00:01,  2.52it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:23<00:01,  2.56it/s]Running loglikelihood requests:  99%|█████████▉| 198/200 [01:24<00:00,  2.60it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:24<00:00,  2.54it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:24<00:00,  2.57it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:24<00:00,  2.36it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'copa': {'alias': 'copa', 'acc,none': 0.82, 'acc_stderr,none': 0.03861229196653691}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7827148355678417
0.8244609672079803
0.649635438690672
0.6067147398962018
0.806517251330611
0.9304450428937726
0.9492767057467371
0.8146777207922447
0.5943920512469448
0.6904992046065734
0.898578027138337
0.9772061768478973
0.9053772479641496
0.8020143483317842
0.5125553000556808
0.7018400400551881
0.8957865573767195
0.6076519427757794
0.975563476608663
0.9639212062070597
0.9296418237714587
0.9150145595079396
0.9197448761365332
0.7066536936990038
0.6639302750778917
0.912306872752127
0.7698141900267782
0.6230420491138425
0.8289959673107662
Total groups 68 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 1, 2, 6, 5, 0]
tensor([7, 3, 4, 1, 2, 6, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 4, 1, 0, 5, 7, 2]
tensor([6, 3, 4, 1, 0, 5, 7, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 4, 3, 2, 0, 5, 6, 1]
tensor([7, 4, 3, 2, 0, 5, 6, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 6, 4, 2, 1, 3, 5, 0]
tensor([7, 6, 4, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 3, 2]
tensor([0, 1, 3, 0, 1, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 1, 0, 2, 3, 2]
tensor([0, 1, 3, 1, 0, 2, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1.0, 1.0, 1]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 3
done!
Normal merging for layer 4
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 8 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 21
done!
Normal merging for layer 22
tensor([0, 4])
tensor(0)
tensor([1, 3])
tensor(1)
tensor([5, 7])
tensor(5)
tensor([2, 6])
tensor(2)
done!
Cross-layer merge completed for layers 23 to 27
done!
Normal merging for layer 28
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 29 to 30
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 15 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 14 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

63
cuda:2
mastermind_46_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.83s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 778
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_46_mcq_random/flair/mastermind_46_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/revision/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/tree/544d077942975b1664c0bc4fd54df026050329a4?recursive=False&expand=False HTTP/1.1" 200 290
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/tree/544d077942975b1664c0bc4fd54df026050329a4/data?recursive=False&expand=False HTTP/1.1" 200 361
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/revision/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139673669058976 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139673669058976 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139673669058976 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139673669058976 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Attempting to acquire lock 139646838837360 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139646838837360 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646838837360 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139646838837360 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_46_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_46_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1515.60it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_46_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:02<14:33,  2.19s/it]Running loglikelihood requests:   0%|          | 2/400 [00:03<11:56,  1.80s/it]Running loglikelihood requests:   1%|          | 3/400 [00:05<11:00,  1.66s/it]Running loglikelihood requests:   1%|          | 4/400 [00:06<10:32,  1.60s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:08<10:14,  1.56s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:09<10:05,  1.54s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:11<09:51,  1.51s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:12<09:41,  1.48s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:14<09:33,  1.47s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:15<09:41,  1.49s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:16<09:33,  1.48s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:18<09:28,  1.46s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:19<09:24,  1.46s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:21<09:28,  1.47s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:22<09:26,  1.47s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:24<09:23,  1.47s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:25<09:19,  1.46s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:27<09:14,  1.45s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:28<09:10,  1.44s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:30<09:06,  1.44s/it]Running loglikelihood requests:   5%|▌         | 21/400 [00:31<09:04,  1.44s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:32<09:01,  1.43s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:34<08:59,  1.43s/it]Running loglikelihood requests:   6%|▌         | 24/400 [00:35<08:57,  1.43s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:37<09:02,  1.45s/it]Running loglikelihood requests:   6%|▋         | 26/400 [00:38<08:58,  1.44s/it]Running loglikelihood requests:   7%|▋         | 27/400 [00:40<08:55,  1.43s/it]Running loglikelihood requests:   7%|▋         | 28/400 [00:41<08:51,  1.43s/it]Running loglikelihood requests:   7%|▋         | 29/400 [00:42<08:50,  1.43s/it]Running loglikelihood requests:   8%|▊         | 30/400 [00:44<08:47,  1.43s/it]Running loglikelihood requests:   8%|▊         | 31/400 [00:45<08:45,  1.42s/it]Running loglikelihood requests:   8%|▊         | 32/400 [00:47<08:51,  1.44s/it]Running loglikelihood requests:   8%|▊         | 33/400 [00:48<08:47,  1.44s/it]Running loglikelihood requests:   8%|▊         | 34/400 [00:50<08:44,  1.43s/it]Running loglikelihood requests:   9%|▉         | 35/400 [00:51<08:40,  1.43s/it]Running loglikelihood requests:   9%|▉         | 36/400 [00:52<08:44,  1.44s/it]Running loglikelihood requests:   9%|▉         | 37/400 [00:54<08:46,  1.45s/it]Running loglikelihood requests:  10%|▉         | 38/400 [00:55<08:44,  1.45s/it]Running loglikelihood requests:  10%|▉         | 39/400 [00:57<08:40,  1.44s/it]Running loglikelihood requests:  10%|█         | 40/400 [00:58<08:35,  1.43s/it]Running loglikelihood requests:  10%|█         | 41/400 [01:00<08:33,  1.43s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:01<08:34,  1.44s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:03<08:37,  1.45s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:04<08:39,  1.46s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:06<08:39,  1.46s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:07<08:39,  1.47s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:09<08:38,  1.47s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:10<08:37,  1.47s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:11<08:36,  1.47s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:13<08:35,  1.47s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [01:14<08:34,  1.47s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [01:16<08:33,  1.47s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [01:17<08:30,  1.47s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [01:19<08:24,  1.46s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [01:20<08:20,  1.45s/it]Running loglikelihood requests:  14%|█▍        | 56/400 [01:22<08:14,  1.44s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [01:23<08:11,  1.43s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [01:24<08:07,  1.42s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [01:26<08:03,  1.42s/it]Running loglikelihood requests:  15%|█▌        | 60/400 [01:27<08:08,  1.44s/it]Running loglikelihood requests:  15%|█▌        | 61/400 [01:29<08:10,  1.45s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [01:30<08:10,  1.45s/it]Running loglikelihood requests:  16%|█▌        | 63/400 [01:32<08:10,  1.46s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [01:33<08:05,  1.45s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [01:35<08:02,  1.44s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [01:36<07:58,  1.43s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [01:37<07:55,  1.43s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [01:39<07:53,  1.43s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [01:40<07:51,  1.42s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [01:42<05:58,  1.09s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [01:43<06:22,  1.17s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [01:44<06:42,  1.23s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [01:46<06:56,  1.28s/it]Running loglikelihood requests:  19%|█▉        | 75/400 [01:47<07:05,  1.31s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [01:49<07:12,  1.33s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [01:50<07:17,  1.36s/it]Running loglikelihood requests:  20%|█▉        | 78/400 [01:51<07:19,  1.36s/it]Running loglikelihood requests:  20%|█▉        | 79/400 [01:53<07:19,  1.37s/it]Running loglikelihood requests:  20%|██        | 80/400 [01:54<07:19,  1.37s/it]Running loglikelihood requests:  20%|██        | 81/400 [01:56<07:18,  1.37s/it]Running loglikelihood requests:  20%|██        | 82/400 [01:57<07:17,  1.37s/it]Running loglikelihood requests:  21%|██        | 83/400 [01:58<07:16,  1.38s/it]Running loglikelihood requests:  21%|██        | 84/400 [02:00<07:15,  1.38s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:01<07:13,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:02<07:12,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [02:04<07:12,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 88/400 [02:05<07:10,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:07<07:14,  1.40s/it]Running loglikelihood requests:  22%|██▎       | 90/400 [02:08<07:18,  1.41s/it]Running loglikelihood requests:  23%|██▎       | 91/400 [02:10<07:16,  1.41s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [02:11<07:11,  1.40s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:12<07:17,  1.43s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [02:14<07:13,  1.42s/it]Running loglikelihood requests:  24%|██▍       | 95/400 [02:15<07:08,  1.41s/it]Running loglikelihood requests:  24%|██▍       | 96/400 [02:17<07:04,  1.40s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:18<07:01,  1.39s/it]Running loglikelihood requests:  24%|██▍       | 98/400 [02:19<06:59,  1.39s/it]Running loglikelihood requests:  25%|██▍       | 99/400 [02:21<06:56,  1.38s/it]Running loglikelihood requests:  25%|██▌       | 100/400 [02:22<06:54,  1.38s/it]Running loglikelihood requests:  25%|██▌       | 101/400 [02:23<06:53,  1.38s/it]Running loglikelihood requests:  26%|██▌       | 102/400 [02:25<06:51,  1.38s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:26<06:49,  1.38s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:28<06:48,  1.38s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [02:29<06:47,  1.38s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [02:30<06:45,  1.38s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [02:32<06:43,  1.38s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [02:33<06:42,  1.38s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [02:34<06:43,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [02:36<06:41,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [02:37<06:40,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [02:39<06:39,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [02:40<06:37,  1.38s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [02:41<06:34,  1.38s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [02:43<06:33,  1.38s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [02:44<06:31,  1.38s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [02:46<06:30,  1.38s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [02:47<06:29,  1.38s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [02:48<06:27,  1.38s/it]Running loglikelihood requests:  30%|███       | 120/400 [02:50<06:26,  1.38s/it]Running loglikelihood requests:  30%|███       | 121/400 [02:51<06:24,  1.38s/it]Running loglikelihood requests:  30%|███       | 122/400 [02:52<06:23,  1.38s/it]Running loglikelihood requests:  31%|███       | 123/400 [02:54<06:21,  1.38s/it]Running loglikelihood requests:  31%|███       | 124/400 [02:55<06:20,  1.38s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [02:57<06:18,  1.38s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [02:58<06:16,  1.38s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [02:59<06:15,  1.38s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:01<06:14,  1.38s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:02<06:12,  1.38s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:03<06:10,  1.37s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:05<06:08,  1.37s/it]Running loglikelihood requests:  33%|███▎      | 132/400 [03:06<06:07,  1.37s/it]Running loglikelihood requests:  33%|███▎      | 133/400 [03:08<06:06,  1.37s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:09<06:04,  1.37s/it]Running loglikelihood requests:  34%|███▍      | 135/400 [03:10<06:03,  1.37s/it]Running loglikelihood requests:  34%|███▍      | 136/400 [03:12<06:02,  1.37s/it]Running loglikelihood requests:  34%|███▍      | 137/400 [03:13<06:02,  1.38s/it]Running loglikelihood requests:  34%|███▍      | 138/400 [03:14<06:01,  1.38s/it]Running loglikelihood requests:  35%|███▍      | 139/400 [03:16<05:59,  1.38s/it]Running loglikelihood requests:  35%|███▌      | 140/400 [03:17<05:57,  1.38s/it]Running loglikelihood requests:  35%|███▌      | 141/400 [03:19<05:55,  1.37s/it]Running loglikelihood requests:  36%|███▌      | 142/400 [03:20<05:54,  1.37s/it]Running loglikelihood requests:  36%|███▌      | 143/400 [03:21<05:56,  1.39s/it]Running loglikelihood requests:  36%|███▌      | 144/400 [03:23<05:56,  1.39s/it]Running loglikelihood requests:  36%|███▋      | 145/400 [03:24<05:52,  1.38s/it]Running loglikelihood requests:  36%|███▋      | 146/400 [03:25<05:50,  1.38s/it]Running loglikelihood requests:  37%|███▋      | 147/400 [03:27<05:47,  1.37s/it]Running loglikelihood requests:  37%|███▋      | 148/400 [03:28<05:44,  1.37s/it]Running loglikelihood requests:  37%|███▋      | 149/400 [03:30<05:42,  1.37s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [03:31<05:40,  1.36s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:32<05:38,  1.36s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:34<05:37,  1.36s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:35<05:35,  1.36s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:36<05:34,  1.36s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:38<05:32,  1.36s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:39<05:31,  1.36s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:40<05:29,  1.36s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:42<05:27,  1.36s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:43<05:26,  1.35s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:44<05:24,  1.35s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:46<05:23,  1.35s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:47<05:21,  1.35s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:49<05:21,  1.36s/it]Running loglikelihood requests:  41%|████      | 164/400 [03:50<05:18,  1.35s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [03:51<05:16,  1.35s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [03:53<05:14,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [03:54<05:12,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [03:55<05:10,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [03:57<05:12,  1.35s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [03:58<05:16,  1.38s/it]Running loglikelihood requests:  43%|████▎     | 171/400 [03:59<05:18,  1.39s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [04:01<05:19,  1.40s/it]Running loglikelihood requests:  43%|████▎     | 173/400 [04:02<05:20,  1.41s/it]Running loglikelihood requests:  44%|████▎     | 174/400 [04:04<05:19,  1.41s/it]Running loglikelihood requests:  44%|████▍     | 175/400 [04:05<05:19,  1.42s/it]Running loglikelihood requests:  44%|████▍     | 176/400 [04:07<05:18,  1.42s/it]Running loglikelihood requests:  44%|████▍     | 177/400 [04:08<05:17,  1.42s/it]Running loglikelihood requests:  44%|████▍     | 178/400 [04:09<05:16,  1.42s/it]Running loglikelihood requests:  45%|████▍     | 179/400 [04:11<05:19,  1.45s/it]Running loglikelihood requests:  45%|████▌     | 180/400 [04:12<05:16,  1.44s/it]Running loglikelihood requests:  45%|████▌     | 181/400 [04:14<05:11,  1.42s/it]Running loglikelihood requests:  46%|████▌     | 182/400 [04:15<05:06,  1.41s/it]Running loglikelihood requests:  46%|████▌     | 183/400 [04:16<05:02,  1.39s/it]Running loglikelihood requests:  46%|████▌     | 184/400 [04:18<04:59,  1.39s/it]Running loglikelihood requests:  46%|████▋     | 185/400 [04:19<04:56,  1.38s/it]Running loglikelihood requests:  46%|████▋     | 186/400 [04:21<04:54,  1.38s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [04:22<04:52,  1.37s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [04:23<04:50,  1.37s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [04:25<04:49,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 190/400 [04:26<04:47,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [04:27<04:45,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 192/400 [04:29<04:44,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 193/400 [04:30<04:42,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 194/400 [04:31<04:40,  1.36s/it]Running loglikelihood requests:  49%|████▉     | 195/400 [04:33<04:39,  1.36s/it]Running loglikelihood requests:  49%|████▉     | 196/400 [04:34<04:38,  1.36s/it]Running loglikelihood requests:  49%|████▉     | 197/400 [04:36<04:36,  1.36s/it]Running loglikelihood requests:  50%|████▉     | 198/400 [04:37<04:34,  1.36s/it]Running loglikelihood requests:  50%|████▉     | 199/400 [04:38<04:35,  1.37s/it]Running loglikelihood requests:  50%|█████     | 200/400 [04:40<04:35,  1.38s/it]Running loglikelihood requests:  50%|█████     | 201/400 [04:41<04:31,  1.36s/it]Running loglikelihood requests:  50%|█████     | 202/400 [04:42<04:27,  1.35s/it]Running loglikelihood requests:  51%|█████     | 203/400 [04:44<04:25,  1.35s/it]Running loglikelihood requests:  51%|█████     | 204/400 [04:45<04:24,  1.35s/it]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:46<04:22,  1.35s/it]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:48<04:21,  1.35s/it]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:49<04:19,  1.35s/it]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:50<04:18,  1.34s/it]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:52<04:16,  1.34s/it]Running loglikelihood requests:  52%|█████▎    | 210/400 [04:53<04:15,  1.34s/it]Running loglikelihood requests:  53%|█████▎    | 211/400 [04:54<04:14,  1.35s/it]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:56<04:12,  1.35s/it]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:57<04:11,  1.34s/it]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:58<04:09,  1.34s/it]Running loglikelihood requests:  54%|█████▍    | 215/400 [05:00<04:07,  1.34s/it]Running loglikelihood requests:  54%|█████▍    | 216/400 [05:01<04:05,  1.34s/it]Running loglikelihood requests:  54%|█████▍    | 217/400 [05:02<04:04,  1.33s/it]Running loglikelihood requests:  55%|█████▍    | 218/400 [05:04<04:02,  1.33s/it]Running loglikelihood requests:  55%|█████▍    | 219/400 [05:05<04:02,  1.34s/it]Running loglikelihood requests:  55%|█████▌    | 220/400 [05:06<04:00,  1.33s/it]Running loglikelihood requests:  55%|█████▌    | 221/400 [05:08<03:56,  1.32s/it]Running loglikelihood requests:  56%|█████▌    | 222/400 [05:09<03:54,  1.31s/it]Running loglikelihood requests:  56%|█████▌    | 223/400 [05:10<03:51,  1.31s/it]Running loglikelihood requests:  56%|█████▌    | 224/400 [05:12<03:49,  1.30s/it]Running loglikelihood requests:  56%|█████▋    | 225/400 [05:13<03:47,  1.30s/it]Running loglikelihood requests:  56%|█████▋    | 226/400 [05:14<03:45,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 227/400 [05:16<03:44,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 228/400 [05:17<03:42,  1.29s/it]Running loglikelihood requests:  57%|█████▋    | 229/400 [05:18<03:40,  1.29s/it]Running loglikelihood requests:  57%|█████▊    | 230/400 [05:19<03:38,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 231/400 [05:21<03:37,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 232/400 [05:22<03:35,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 233/400 [05:23<03:34,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 234/400 [05:25<03:32,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 235/400 [05:26<03:31,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 236/400 [05:27<03:30,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 237/400 [05:28<03:28,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 238/400 [05:30<03:27,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 239/400 [05:31<03:25,  1.28s/it]Running loglikelihood requests:  60%|██████    | 240/400 [05:32<03:24,  1.28s/it]Running loglikelihood requests:  60%|██████    | 241/400 [05:33<03:22,  1.27s/it]Running loglikelihood requests:  60%|██████    | 242/400 [05:35<03:26,  1.31s/it]Running loglikelihood requests:  61%|██████    | 243/400 [05:36<03:23,  1.30s/it]Running loglikelihood requests:  61%|██████    | 244/400 [05:37<03:20,  1.29s/it]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:39<03:18,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:40<03:16,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:41<03:14,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:42<03:13,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:44<03:11,  1.27s/it]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:45<03:10,  1.27s/it]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:46<03:11,  1.28s/it]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:48<03:09,  1.28s/it]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:49<03:07,  1.27s/it]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:50<03:05,  1.27s/it]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:51<03:03,  1.27s/it]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:53<03:01,  1.26s/it]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:54<03:00,  1.26s/it]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:55<02:58,  1.26s/it]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:56<02:56,  1.25s/it]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:58<02:55,  1.25s/it]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:59<02:54,  1.26s/it]Running loglikelihood requests:  66%|██████▌   | 262/400 [06:00<02:52,  1.25s/it]Running loglikelihood requests:  66%|██████▌   | 263/400 [06:01<02:51,  1.25s/it]Running loglikelihood requests:  66%|██████▌   | 264/400 [06:03<02:49,  1.25s/it]Running loglikelihood requests:  66%|██████▋   | 265/400 [06:04<02:48,  1.25s/it]Running loglikelihood requests:  66%|██████▋   | 266/400 [06:05<02:47,  1.25s/it]Running loglikelihood requests:  67%|██████▋   | 267/400 [06:06<02:45,  1.25s/it]Running loglikelihood requests:  67%|██████▋   | 268/400 [06:08<02:44,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 269/400 [06:09<02:42,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 270/400 [06:10<02:41,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 271/400 [06:11<02:40,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 272/400 [06:13<02:38,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 273/400 [06:14<02:37,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 274/400 [06:15<02:36,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 275/400 [06:16<02:35,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 276/400 [06:17<02:33,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 277/400 [06:19<02:32,  1.24s/it]Running loglikelihood requests:  70%|██████▉   | 278/400 [06:20<02:31,  1.24s/it]Running loglikelihood requests:  70%|██████▉   | 279/400 [06:21<02:29,  1.24s/it]Running loglikelihood requests:  70%|███████   | 280/400 [06:22<02:29,  1.24s/it]Running loglikelihood requests:  70%|███████   | 281/400 [06:24<02:28,  1.25s/it]Running loglikelihood requests:  70%|███████   | 282/400 [06:25<02:27,  1.25s/it]Running loglikelihood requests:  71%|███████   | 283/400 [06:26<02:25,  1.24s/it]Running loglikelihood requests:  71%|███████   | 284/400 [06:27<02:23,  1.24s/it]Running loglikelihood requests:  71%|███████▏  | 285/400 [06:29<02:22,  1.24s/it]Running loglikelihood requests:  72%|███████▏  | 286/400 [06:30<02:20,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 287/400 [06:31<02:19,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 288/400 [06:32<02:17,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 289/400 [06:34<02:17,  1.24s/it]Running loglikelihood requests:  72%|███████▎  | 290/400 [06:35<02:16,  1.24s/it]Running loglikelihood requests:  73%|███████▎  | 291/400 [06:36<02:15,  1.24s/it]Running loglikelihood requests:  73%|███████▎  | 292/400 [06:37<02:14,  1.25s/it]Running loglikelihood requests:  73%|███████▎  | 293/400 [06:39<02:12,  1.24s/it]Running loglikelihood requests:  74%|███████▎  | 294/400 [06:40<02:11,  1.24s/it]Running loglikelihood requests:  74%|███████▍  | 295/400 [06:41<02:09,  1.23s/it]Running loglikelihood requests:  74%|███████▍  | 296/400 [06:42<02:07,  1.23s/it]Running loglikelihood requests:  74%|███████▍  | 297/400 [06:43<02:06,  1.23s/it]Running loglikelihood requests:  74%|███████▍  | 298/400 [06:45<02:04,  1.22s/it]Running loglikelihood requests:  75%|███████▍  | 299/400 [06:46<02:03,  1.22s/it]Running loglikelihood requests:  75%|███████▌  | 300/400 [06:47<02:01,  1.22s/it]Running loglikelihood requests:  75%|███████▌  | 301/400 [06:48<02:00,  1.22s/it]Running loglikelihood requests:  76%|███████▌  | 302/400 [06:50<01:59,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 303/400 [06:51<01:57,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 304/400 [06:52<01:56,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 305/400 [06:53<01:55,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 306/400 [06:54<01:53,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 307/400 [06:56<01:52,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 308/400 [06:57<01:51,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 309/400 [06:58<01:50,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 310/400 [06:59<01:48,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 311/400 [07:00<01:47,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 312/400 [07:02<01:46,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 313/400 [07:03<01:44,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 314/400 [07:04<01:43,  1.20s/it]Running loglikelihood requests:  79%|███████▉  | 315/400 [07:05<01:43,  1.21s/it]Running loglikelihood requests:  79%|███████▉  | 316/400 [07:06<01:42,  1.22s/it]Running loglikelihood requests:  79%|███████▉  | 317/400 [07:08<01:41,  1.22s/it]Running loglikelihood requests:  80%|███████▉  | 318/400 [07:09<01:40,  1.22s/it]Running loglikelihood requests:  80%|███████▉  | 319/400 [07:10<01:39,  1.22s/it]Running loglikelihood requests:  80%|████████  | 320/400 [07:11<01:37,  1.22s/it]Running loglikelihood requests:  80%|████████  | 321/400 [07:13<01:36,  1.23s/it]Running loglikelihood requests:  80%|████████  | 322/400 [07:14<01:35,  1.23s/it]Running loglikelihood requests:  81%|████████  | 323/400 [07:15<01:34,  1.23s/it]Running loglikelihood requests:  81%|████████  | 324/400 [07:16<01:33,  1.23s/it]Running loglikelihood requests:  81%|████████▏ | 325/400 [07:18<01:32,  1.23s/it]Running loglikelihood requests:  82%|████████▏ | 326/400 [07:19<01:30,  1.23s/it]Running loglikelihood requests:  82%|████████▏ | 327/400 [07:20<01:29,  1.23s/it]Running loglikelihood requests:  82%|████████▏ | 328/400 [07:21<01:28,  1.23s/it]Running loglikelihood requests:  82%|████████▏ | 329/400 [07:22<01:26,  1.22s/it]Running loglikelihood requests:  82%|████████▎ | 330/400 [07:24<01:25,  1.22s/it]Running loglikelihood requests:  83%|████████▎ | 331/400 [07:25<01:24,  1.22s/it]Running loglikelihood requests:  83%|████████▎ | 332/400 [07:26<01:23,  1.22s/it]Running loglikelihood requests:  83%|████████▎ | 333/400 [07:27<01:21,  1.22s/it]Running loglikelihood requests:  84%|████████▎ | 334/400 [07:28<01:19,  1.21s/it]Running loglikelihood requests:  84%|████████▍ | 335/400 [07:30<01:19,  1.22s/it]Running loglikelihood requests:  84%|████████▍ | 336/400 [07:31<01:17,  1.22s/it]Running loglikelihood requests:  84%|████████▍ | 337/400 [07:32<01:17,  1.23s/it]Running loglikelihood requests:  84%|████████▍ | 338/400 [07:33<01:16,  1.23s/it]Running loglikelihood requests:  85%|████████▍ | 339/400 [07:35<01:14,  1.22s/it]Running loglikelihood requests:  85%|████████▌ | 340/400 [07:36<01:12,  1.21s/it]Running loglikelihood requests:  85%|████████▌ | 341/400 [07:37<01:10,  1.20s/it]Running loglikelihood requests:  86%|████████▌ | 342/400 [07:38<01:09,  1.20s/it]Running loglikelihood requests:  86%|████████▌ | 343/400 [07:39<01:08,  1.19s/it]Running loglikelihood requests:  86%|████████▌ | 344/400 [07:41<01:06,  1.19s/it]Running loglikelihood requests:  86%|████████▋ | 345/400 [07:42<01:05,  1.19s/it]Running loglikelihood requests:  86%|████████▋ | 346/400 [07:43<01:04,  1.19s/it]Running loglikelihood requests:  87%|████████▋ | 347/400 [07:44<01:03,  1.21s/it]Running loglikelihood requests:  87%|████████▋ | 348/400 [07:45<01:02,  1.21s/it]Running loglikelihood requests:  87%|████████▋ | 349/400 [07:47<01:01,  1.20s/it]Running loglikelihood requests:  88%|████████▊ | 350/400 [07:48<01:00,  1.20s/it]Running loglikelihood requests:  88%|████████▊ | 351/400 [07:49<00:59,  1.21s/it]Running loglikelihood requests:  88%|████████▊ | 352/400 [07:50<00:57,  1.20s/it]Running loglikelihood requests:  88%|████████▊ | 353/400 [07:51<00:56,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 354/400 [07:53<00:54,  1.19s/it]Running loglikelihood requests:  89%|████████▉ | 355/400 [07:54<00:53,  1.19s/it]Running loglikelihood requests:  89%|████████▉ | 356/400 [07:55<00:52,  1.18s/it]Running loglikelihood requests:  89%|████████▉ | 357/400 [07:56<00:50,  1.18s/it]Running loglikelihood requests:  90%|████████▉ | 358/400 [07:57<00:49,  1.18s/it]Running loglikelihood requests:  90%|████████▉ | 359/400 [07:58<00:48,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 360/400 [08:00<00:47,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 361/400 [08:01<00:45,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 362/400 [08:02<00:44,  1.18s/it]Running loglikelihood requests:  91%|█████████ | 363/400 [08:03<00:43,  1.18s/it]Running loglikelihood requests:  91%|█████████ | 364/400 [08:04<00:42,  1.18s/it]Running loglikelihood requests:  91%|█████████▏| 365/400 [08:05<00:41,  1.18s/it]Running loglikelihood requests:  92%|█████████▏| 366/400 [08:07<00:40,  1.18s/it]Running loglikelihood requests:  92%|█████████▏| 367/400 [08:08<00:38,  1.18s/it]Running loglikelihood requests:  92%|█████████▏| 368/400 [08:09<00:37,  1.18s/it]Running loglikelihood requests:  92%|█████████▏| 369/400 [08:10<00:36,  1.18s/it]Running loglikelihood requests:  92%|█████████▎| 370/400 [08:11<00:35,  1.18s/it]Running loglikelihood requests:  93%|█████████▎| 371/400 [08:13<00:34,  1.18s/it]Running loglikelihood requests:  93%|█████████▎| 372/400 [08:14<00:35,  1.27s/it]Running loglikelihood requests:  93%|█████████▎| 373/400 [08:15<00:33,  1.24s/it]Running loglikelihood requests:  94%|█████████▎| 374/400 [08:16<00:31,  1.22s/it]Running loglikelihood requests:  94%|█████████▍| 375/400 [08:18<00:30,  1.20s/it]Running loglikelihood requests:  94%|█████████▍| 376/400 [08:19<00:28,  1.21s/it]Running loglikelihood requests:  94%|█████████▍| 377/400 [08:20<00:27,  1.20s/it]Running loglikelihood requests:  94%|█████████▍| 378/400 [08:21<00:26,  1.18s/it]Running loglikelihood requests:  95%|█████████▍| 379/400 [08:22<00:24,  1.17s/it]Running loglikelihood requests:  95%|█████████▌| 380/400 [08:23<00:23,  1.17s/it]Running loglikelihood requests:  95%|█████████▌| 381/400 [08:25<00:22,  1.16s/it]Running loglikelihood requests:  96%|█████████▌| 382/400 [08:26<00:20,  1.16s/it]Running loglikelihood requests:  96%|█████████▌| 383/400 [08:27<00:19,  1.15s/it]Running loglikelihood requests:  96%|█████████▌| 384/400 [08:28<00:18,  1.15s/it]Running loglikelihood requests:  96%|█████████▋| 385/400 [08:29<00:17,  1.14s/it]Running loglikelihood requests:  96%|█████████▋| 386/400 [08:30<00:15,  1.13s/it]Running loglikelihood requests:  97%|█████████▋| 387/400 [08:31<00:14,  1.13s/it]Running loglikelihood requests:  97%|█████████▋| 388/400 [08:32<00:13,  1.12s/it]Running loglikelihood requests:  97%|█████████▋| 389/400 [08:33<00:12,  1.10s/it]Running loglikelihood requests:  98%|█████████▊| 390/400 [08:35<00:10,  1.08s/it]Running loglikelihood requests:  98%|█████████▊| 391/400 [08:36<00:09,  1.06s/it]Running loglikelihood requests:  98%|█████████▊| 392/400 [08:37<00:08,  1.05s/it]Running loglikelihood requests:  98%|█████████▊| 393/400 [08:38<00:07,  1.04s/it]Running loglikelihood requests:  98%|█████████▊| 394/400 [08:39<00:06,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 395/400 [08:40<00:05,  1.04s/it]Running loglikelihood requests:  99%|█████████▉| 396/400 [08:41<00:04,  1.05s/it]Running loglikelihood requests:  99%|█████████▉| 397/400 [08:42<00:03,  1.02s/it]Running loglikelihood requests: 100%|█████████▉| 398/400 [08:43<00:02,  1.01s/it]Running loglikelihood requests: 100%|█████████▉| 399/400 [08:44<00:00,  1.00it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:45<00:00,  1.01it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:45<00:00,  1.31s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'mastermind_46_easy': {'alias': 'mastermind_46_easy', 'acc,none': 0.75, 'acc_stderr,none': 0.04351941398892446}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9900730655060652
0.9975621416797388
0.9971758007187725
0.9980230222224056
0.9889479987910904
0.9764864248764976
0.9903944102306983
0.9944743493554844
0.9959595842537624
0.9872350810596702
0.9630442697748985
0.9836939129473328
0.9680042833072414
0.9739989664157891
0.9945965755000291
0.9874567967365809
0.9910190996776087
0.9888895436517939
0.9820307305549418
0.9881803990776891
0.9859944271811626
0.9931460182904469
0.984259193892523
0.99673879588459
0.9800909214289261
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 3
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 5
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 14 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 13 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

189
cuda:3
cola
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.17s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cola] metric mcc is defined, but aggregation is not. using default aggregation=matthews_corrcoef
WARNING:lm_eval.api.task:[Task: cola] metric mcc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139669049467984 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139669049467984 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139669049467984 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139669049467984 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_cola_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139645837217184 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139645837217184 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645837217184 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139645837217184 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/cola/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cola from None to 0
INFO:lm_eval.api.task:Building contexts for cola on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 3252.36it/s]
DEBUG:lm_eval.evaluator:Task: cola; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<03:57,  1.20s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:01<01:39,  1.97it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:02<01:14,  2.62it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:02<01:03,  3.02it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:03<00:57,  3.30it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:03<00:54,  3.49it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:04<00:52,  3.58it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:04<00:49,  3.71it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:05<00:48,  3.80it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:05<00:46,  3.88it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:06<00:45,  3.93it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:06<00:44,  3.96it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:07<00:43,  3.99it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:07<00:43,  4.02it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:08<00:42,  3.98it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:08<00:42,  4.00it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:09<00:41,  4.01it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:09<00:40,  4.03it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:10<00:41,  3.93it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:10<00:40,  3.94it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:11<00:39,  4.00it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:11<00:39,  3.97it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:12<00:38,  4.03it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:12<00:37,  4.07it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:13<00:36,  4.10it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:13<00:35,  4.14it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:14<00:35,  4.16it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:14<00:34,  4.17it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:15<00:34,  4.18it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:15<00:34,  4.08it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:16<00:33,  4.14it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:16<00:32,  4.18it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:17<00:32,  4.22it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:17<00:31,  4.24it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:18<00:30,  4.27it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:18<00:30,  4.29it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:18<00:29,  4.30it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:19<00:29,  4.30it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:19<00:28,  4.30it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:20<00:28,  4.30it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:20<00:27,  4.30it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:21<00:27,  4.31it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:21<00:26,  4.33it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:22<00:25,  4.35it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:22<00:25,  4.28it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:23<00:25,  4.24it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:23<00:25,  4.27it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:24<00:24,  4.29it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:24<00:23,  4.31it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:24<00:23,  4.33it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:25<00:22,  4.36it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:25<00:22,  4.37it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:26<00:21,  4.38it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:26<00:21,  4.33it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:27<00:20,  4.36it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:27<00:20,  4.38it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:28<00:19,  4.39it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:28<00:19,  4.41it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:29<00:18,  4.43it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:29<00:18,  4.45it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:29<00:17,  4.47it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:30<00:17,  4.47it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:30<00:16,  4.47it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:31<00:16,  4.46it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:31<00:16,  4.38it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:32<00:15,  4.41it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:32<00:15,  4.43it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:33<00:14,  4.44it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:33<00:14,  4.45it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:34<00:13,  4.47it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:34<00:13,  4.49it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:34<00:12,  4.50it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:35<00:12,  4.50it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:35<00:11,  4.51it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:36<00:11,  4.51it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:36<00:11,  4.39it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:37<00:10,  4.38it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:37<00:10,  4.40it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:38<00:09,  4.43it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:38<00:09,  4.45it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:38<00:08,  4.42it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:39<00:08,  4.44it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:39<00:07,  4.47it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:40<00:07,  4.49it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:40<00:06,  4.44it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:41<00:06,  4.48it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:41<00:05,  4.51it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:42<00:05,  4.54it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:42<00:05,  4.57it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:42<00:04,  4.58it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:43<00:04,  4.59it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:43<00:03,  4.60it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:44<00:03,  4.60it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:44<00:02,  4.55it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:45<00:02,  4.60it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:45<00:01,  4.64it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [00:45<00:01,  4.68it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [00:46<00:01,  4.70it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [00:46<00:00,  4.71it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [00:47<00:00,  4.74it/s]Running loglikelihood requests: 100%|██████████| 200/200 [00:47<00:00,  4.24it/s]
bootstrapping for stddev (sequential): matthews_corrcoef
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<01:33,  1.06it/s]  2%|▏         | 2/100 [00:01<01:31,  1.08it/s]  3%|▎         | 3/100 [00:02<01:29,  1.08it/s]  4%|▍         | 4/100 [00:03<01:28,  1.08it/s]  5%|▌         | 5/100 [00:04<01:27,  1.08it/s]  6%|▌         | 6/100 [00:05<01:26,  1.09it/s]  7%|▋         | 7/100 [00:06<01:25,  1.09it/s]  8%|▊         | 8/100 [00:07<01:24,  1.09it/s]  9%|▉         | 9/100 [00:08<01:23,  1.09it/s] 10%|█         | 10/100 [00:09<01:22,  1.09it/s] 11%|█         | 11/100 [00:10<01:21,  1.09it/s] 12%|█▏        | 12/100 [00:11<01:20,  1.09it/s] 13%|█▎        | 13/100 [00:11<01:19,  1.09it/s] 14%|█▍        | 14/100 [00:12<01:18,  1.09it/s] 15%|█▌        | 15/100 [00:13<01:18,  1.09it/s] 16%|█▌        | 16/100 [00:14<01:17,  1.09it/s] 17%|█▋        | 17/100 [00:15<01:16,  1.09it/s] 18%|█▊        | 18/100 [00:16<01:15,  1.09it/s] 19%|█▉        | 19/100 [00:17<01:14,  1.09it/s] 20%|██        | 20/100 [00:18<01:14,  1.08it/s] 21%|██        | 21/100 [00:19<01:13,  1.08it/s] 22%|██▏       | 22/100 [00:20<01:11,  1.09it/s] 23%|██▎       | 23/100 [00:21<01:10,  1.09it/s] 24%|██▍       | 24/100 [00:22<01:09,  1.09it/s] 25%|██▌       | 25/100 [00:23<01:08,  1.09it/s] 26%|██▌       | 26/100 [00:23<01:07,  1.09it/s] 27%|██▋       | 27/100 [00:24<01:06,  1.09it/s] 28%|██▊       | 28/100 [00:25<01:05,  1.09it/s] 29%|██▉       | 29/100 [00:26<01:04,  1.09it/s] 30%|███       | 30/100 [00:27<01:03,  1.09it/s] 31%|███       | 31/100 [00:28<01:03,  1.09it/s] 32%|███▏      | 32/100 [00:29<01:02,  1.09it/s] 33%|███▎      | 33/100 [00:30<01:01,  1.09it/s] 34%|███▍      | 34/100 [00:31<01:00,  1.09it/s] 35%|███▌      | 35/100 [00:32<00:59,  1.10it/s] 36%|███▌      | 36/100 [00:33<00:58,  1.09it/s] 37%|███▋      | 37/100 [00:33<00:57,  1.09it/s] 38%|███▊      | 38/100 [00:34<00:56,  1.09it/s] 39%|███▉      | 39/100 [00:35<00:55,  1.09it/s] 40%|████      | 40/100 [00:36<00:54,  1.09it/s] 41%|████      | 41/100 [00:37<00:53,  1.09it/s] 42%|████▏     | 42/100 [00:38<00:53,  1.09it/s] 43%|████▎     | 43/100 [00:39<00:52,  1.09it/s] 44%|████▍     | 44/100 [00:40<00:51,  1.09it/s] 45%|████▌     | 45/100 [00:41<00:50,  1.09it/s] 46%|████▌     | 46/100 [00:42<00:49,  1.08it/s] 47%|████▋     | 47/100 [00:43<00:48,  1.08it/s] 48%|████▊     | 48/100 [00:44<00:47,  1.09it/s] 49%|████▉     | 49/100 [00:44<00:47,  1.08it/s] 50%|█████     | 50/100 [00:45<00:46,  1.08it/s] 51%|█████     | 51/100 [00:46<00:45,  1.08it/s] 52%|█████▏    | 52/100 [00:47<00:44,  1.08it/s] 53%|█████▎    | 53/100 [00:48<00:43,  1.08it/s] 54%|█████▍    | 54/100 [00:49<00:42,  1.08it/s] 55%|█████▌    | 55/100 [00:50<00:41,  1.09it/s] 56%|█████▌    | 56/100 [00:51<00:40,  1.09it/s] 57%|█████▋    | 57/100 [00:52<00:40,  1.07it/s] 58%|█████▊    | 58/100 [00:53<00:39,  1.08it/s] 59%|█████▉    | 59/100 [00:54<00:38,  1.08it/s] 60%|██████    | 60/100 [00:55<00:36,  1.08it/s] 61%|██████    | 61/100 [00:56<00:35,  1.09it/s] 62%|██████▏   | 62/100 [00:56<00:34,  1.09it/s] 63%|██████▎   | 63/100 [00:57<00:33,  1.09it/s] 64%|██████▍   | 64/100 [00:58<00:33,  1.09it/s] 65%|██████▌   | 65/100 [00:59<00:32,  1.09it/s] 66%|██████▌   | 66/100 [01:00<00:31,  1.08it/s] 67%|██████▋   | 67/100 [01:01<00:30,  1.09it/s] 68%|██████▊   | 68/100 [01:02<00:29,  1.09it/s] 69%|██████▉   | 69/100 [01:03<00:28,  1.09it/s] 70%|███████   | 70/100 [01:04<00:27,  1.08it/s] 71%|███████   | 71/100 [01:05<00:26,  1.08it/s] 72%|███████▏  | 72/100 [01:06<00:25,  1.09it/s] 73%|███████▎  | 73/100 [01:07<00:24,  1.09it/s] 74%|███████▍  | 74/100 [01:08<00:23,  1.09it/s] 75%|███████▌  | 75/100 [01:08<00:22,  1.09it/s] 76%|███████▌  | 76/100 [01:09<00:22,  1.09it/s] 77%|███████▋  | 77/100 [01:10<00:21,  1.08it/s] 78%|███████▊  | 78/100 [01:11<00:20,  1.08it/s] 79%|███████▉  | 79/100 [01:12<00:19,  1.08it/s] 80%|████████  | 80/100 [01:13<00:18,  1.08it/s] 81%|████████  | 81/100 [01:14<00:17,  1.08it/s] 82%|████████▏ | 82/100 [01:15<00:16,  1.08it/s] 83%|████████▎ | 83/100 [01:16<00:15,  1.09it/s] 84%|████████▍ | 84/100 [01:17<00:14,  1.09it/s] 85%|████████▌ | 85/100 [01:18<00:13,  1.09it/s] 86%|████████▌ | 86/100 [01:19<00:12,  1.09it/s] 87%|████████▋ | 87/100 [01:20<00:11,  1.09it/s] 88%|████████▊ | 88/100 [01:20<00:11,  1.08it/s] 89%|████████▉ | 89/100 [01:21<00:10,  1.08it/s] 90%|█████████ | 90/100 [01:22<00:09,  1.08it/s] 91%|█████████ | 91/100 [01:23<00:08,  1.07it/s] 92%|█████████▏| 92/100 [01:24<00:07,  1.07it/s] 93%|█████████▎| 93/100 [01:25<00:06,  1.08it/s] 94%|█████████▍| 94/100 [01:26<00:05,  1.08it/s] 95%|█████████▌| 95/100 [01:27<00:04,  1.08it/s] 96%|█████████▌| 96/100 [01:28<00:03,  1.08it/s] 97%|█████████▋| 97/100 [01:29<00:02,  1.08it/s] 98%|█████████▊| 98/100 [01:30<00:01,  1.08it/s] 99%|█████████▉| 99/100 [01:31<00:00,  1.09it/s]100%|██████████| 100/100 [01:32<00:00,  1.09it/s]100%|██████████| 100/100 [01:32<00:00,  1.09it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'cola': {'alias': 'cola', 'mcc,none': np.float64(-0.0234083603222329), 'mcc_stderr,none': 0.10027612985654218}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9827615088085355
0.9302188892609604
0.7011961870018854
0.5626926521241726
0.8487059565524276
0.8497526414658526
0.9054485200458864
0.7394951536076
0.6615723249956142
0.3790091735780837
0.7669438266452424
0.6500882643740805
0.6039759750877352
0.8611545876684488
0.9595791152744535
0.7624866897939796
0.8585278638499474
0.9654871578633694
0.8537985077125277
0.9276026122967783
0.938072418626947
0.8815459403167786
0.6241194219560614
0.901256729143793
0.7007049393842223
0.6541093728101413
0.9141945519271818
0.7667764647672246
0.8091089193013563
Total groups 69 exceeded the threshold, stopping comparison.
The group tensor is
[3, 2, 6, 7, 5, 1, 4, 0]
tensor([3, 2, 6, 7, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[2, 3, 6, 7, 5, 1, 4, 0]
tensor([2, 3, 6, 7, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 3, 5, 7, 6, 1, 2, 0]
tensor([4, 3, 5, 7, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 1, 2, 1, 3, 0]
tensor([2, 3, 0, 1, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[1, 0, 1, 2, 3, 2, 3, 0]
tensor([1, 0, 1, 2, 3, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 1, 2, 3, 1, 3, 0]
tensor([0, 2, 1, 2, 3, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[1, 0, 0, 1, 2, 3, 3, 2]
tensor([1, 0, 0, 1, 2, 3, 3, 2], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[3, 1, 0, 1, 2, 2, 3, 0]
tensor([3, 1, 0, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 1, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 2 to 5
done!
Normal merging for layer 6
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 18
done!
Normal merging for layer 19
tensor([2, 7])
tensor(2)
tensor([3, 5])
tensor(3)
tensor([0, 4])
tensor(0)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 7])
tensor(1)
tensor([0, 2])
tensor(0)
tensor([3, 5])
tensor(3)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([1, 3])
tensor(1)
tensor([4, 6])
tensor(4)
done!
Normal merging for layer 22
tensor([1, 2])
tensor(1)
tensor([0, 3])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([5, 6])
tensor(5)
done!
Normal merging for layer 23
tensor([2, 7])
tensor(2)
tensor([1, 3])
tensor(1)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
done!
Cross-layer merge completed for layers 24 to 27
done!
Normal merging for layer 28
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Cross-layer merge completed for layers 29 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 13 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 12 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

202
cuda:4
coqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.26s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.65s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/coqa/EleutherAI/coqa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/coqa/resolve/82e11af842af6c1396f5e9a5c7de260107c50cf1/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/revision/82e11af842af6c1396f5e9a5c7de260107c50cf1 HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1?recursive=False&expand=False HTTP/1.1" 200 489
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/revision/82e11af842af6c1396f5e9a5c7de260107c50cf1 HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/coqa/resolve/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_infos.json HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 139646755872528 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Lock 139646755872528 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646755872528 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Lock 139646755872528 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Attempting to acquire lock 139645909159136 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:filelock:Lock 139645909159136 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645909159136 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:filelock:Lock 139645909159136 released on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:doc_to_target returned a list. Assuming multiple targets.
INFO:lm_eval.evaluator:coqa: Using gen_kwargs: {'until': ['\nQ:']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of coqa from None to 0
INFO:lm_eval.api.task:Building contexts for coqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 77485.76it/s]
DEBUG:lm_eval.evaluator:Task: coqa; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:06<09:59,  6.06s/it]Running generate_until requests:   2%|▏         | 2/100 [00:11<09:16,  5.68s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<09:29,  5.87s/it]Running generate_until requests:   4%|▍         | 4/100 [00:22<08:45,  5.47s/it]Running generate_until requests:   5%|▌         | 5/100 [00:27<08:28,  5.35s/it]Running generate_until requests:   6%|▌         | 6/100 [00:32<08:00,  5.11s/it]Running generate_until requests:   7%|▋         | 7/100 [00:38<08:16,  5.33s/it]Running generate_until requests:   8%|▊         | 8/100 [00:42<07:57,  5.19s/it]Running generate_until requests:   9%|▉         | 9/100 [00:48<07:51,  5.18s/it]Running generate_until requests:  10%|█         | 10/100 [00:53<07:59,  5.33s/it]Running generate_until requests:  11%|█         | 11/100 [00:58<07:48,  5.26s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:04<08:07,  5.53s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:09<07:32,  5.21s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:13<07:06,  4.96s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:18<06:53,  4.86s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:22<06:35,  4.71s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:27<06:26,  4.65s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:31<06:11,  4.53s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:36<06:04,  4.50s/it]Running generate_until requests:  20%|██        | 20/100 [01:40<06:01,  4.52s/it]Running generate_until requests:  21%|██        | 21/100 [01:44<05:53,  4.48s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:49<05:44,  4.42s/it]Running generate_until requests:  23%|██▎       | 23/100 [01:54<06:03,  4.73s/it]Running generate_until requests:  24%|██▍       | 24/100 [01:59<06:11,  4.89s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:04<05:51,  4.69s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:08<05:43,  4.65s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:13<05:36,  4.61s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:17<05:27,  4.55s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:22<05:20,  4.51s/it]Running generate_until requests:  30%|███       | 30/100 [02:26<05:16,  4.52s/it]Running generate_until requests:  31%|███       | 31/100 [02:30<05:06,  4.45s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:35<05:09,  4.55s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:40<05:02,  4.51s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:44<04:53,  4.44s/it]Running generate_until requests:  35%|███▌      | 35/100 [02:48<04:38,  4.29s/it]Running generate_until requests:  36%|███▌      | 36/100 [02:53<04:56,  4.63s/it]Running generate_until requests:  37%|███▋      | 37/100 [02:57<04:39,  4.44s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:01<04:26,  4.29s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:05<04:19,  4.26s/it]Running generate_until requests:  40%|████      | 40/100 [03:09<04:09,  4.15s/it]Running generate_until requests:  41%|████      | 41/100 [03:13<04:04,  4.15s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:19<04:20,  4.50s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:23<04:09,  4.39s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:27<04:05,  4.39s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:31<03:58,  4.34s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:35<03:46,  4.19s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:39<03:36,  4.08s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:44<03:36,  4.16s/it]Running generate_until requests:  49%|████▉     | 49/100 [03:48<03:42,  4.36s/it]Running generate_until requests:  50%|█████     | 50/100 [03:52<03:28,  4.18s/it]Running generate_until requests:  51%|█████     | 51/100 [03:57<03:33,  4.36s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:01<03:20,  4.17s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:05<03:20,  4.27s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:09<03:08,  4.11s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:13<03:04,  4.10s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:17<03:05,  4.21s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:22<03:04,  4.29s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:26<02:53,  4.13s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:31<02:59,  4.38s/it]Running generate_until requests:  60%|██████    | 60/100 [04:34<02:46,  4.16s/it]Running generate_until requests:  61%|██████    | 61/100 [04:39<02:48,  4.31s/it]Running generate_until requests:  62%|██████▏   | 62/100 [04:44<02:47,  4.41s/it]Running generate_until requests:  63%|██████▎   | 63/100 [04:48<02:39,  4.30s/it]Running generate_until requests:  64%|██████▍   | 64/100 [04:52<02:31,  4.21s/it]Running generate_until requests:  65%|██████▌   | 65/100 [04:56<02:24,  4.14s/it]Running generate_until requests:  66%|██████▌   | 66/100 [04:59<02:13,  3.94s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:02<02:05,  3.79s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:07<02:03,  3.87s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:12<02:15,  4.37s/it]Running generate_until requests:  70%|███████   | 70/100 [05:17<02:11,  4.39s/it]Running generate_until requests:  71%|███████   | 71/100 [05:25<02:42,  5.59s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:28<02:18,  4.94s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:32<02:02,  4.52s/it]Running generate_until requests:  74%|███████▍  | 74/100 [05:36<01:52,  4.34s/it]Running generate_until requests:  75%|███████▌  | 75/100 [05:39<01:42,  4.08s/it]Running generate_until requests:  76%|███████▌  | 76/100 [05:43<01:33,  3.89s/it]Running generate_until requests:  77%|███████▋  | 77/100 [05:47<01:32,  4.04s/it]Running generate_until requests:  78%|███████▊  | 78/100 [05:51<01:28,  4.02s/it]Running generate_until requests:  79%|███████▉  | 79/100 [05:54<01:20,  3.81s/it]Running generate_until requests:  80%|████████  | 80/100 [05:58<01:16,  3.80s/it]Running generate_until requests:  81%|████████  | 81/100 [06:04<01:23,  4.39s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:07<01:12,  4.04s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:11<01:06,  3.89s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:14<01:00,  3.79s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:18<00:55,  3.72s/it]Running generate_until requests:  86%|████████▌ | 86/100 [06:22<00:52,  3.74s/it]Running generate_until requests:  87%|████████▋ | 87/100 [06:26<00:52,  4.04s/it]Running generate_until requests:  88%|████████▊ | 88/100 [06:30<00:46,  3.86s/it]Running generate_until requests:  89%|████████▉ | 89/100 [06:33<00:39,  3.58s/it]Running generate_until requests:  90%|█████████ | 90/100 [06:35<00:33,  3.34s/it]Running generate_until requests:  91%|█████████ | 91/100 [06:38<00:28,  3.14s/it]Running generate_until requests:  92%|█████████▏| 92/100 [06:41<00:24,  3.02s/it]Running generate_until requests:  93%|█████████▎| 93/100 [06:44<00:20,  2.96s/it]Running generate_until requests:  94%|█████████▍| 94/100 [06:47<00:17,  2.95s/it]Running generate_until requests:  95%|█████████▌| 95/100 [06:50<00:15,  3.01s/it]Running generate_until requests:  96%|█████████▌| 96/100 [06:53<00:12,  3.01s/it]Running generate_until requests:  97%|█████████▋| 97/100 [06:55<00:08,  2.84s/it]Running generate_until requests:  98%|█████████▊| 98/100 [06:58<00:05,  2.73s/it]Running generate_until requests:  99%|█████████▉| 99/100 [07:00<00:02,  2.72s/it]Running generate_until requests: 100%|██████████| 100/100 [07:03<00:00,  2.74s/it]Running generate_until requests: 100%|██████████| 100/100 [07:03<00:00,  4.24s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'coqa': {'alias': 'coqa', 'em,none': 0.595, 'em_stderr,none': 0.044774970461162564, 'f1,none': 0.7211574141733987, 'f1_stderr,none': 0.037128235455690536}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6057853926542468
0.4195568875297668
0.5244744113321889
0.5202703028806769
0.6150870974034927
0.5299634576457063
0.9336763524510373
0.23649940737178063
0.388911200696845
0.6478041116722705
0.5517233675449297
0.6723258763091353
0.7175526480521238
0.8411089149883405
0.7404554224148189
0.26376935916880817
0.9373006475493478
0.5360566853939598
0.38729358133282565
0.4541602442018795
0.8623573205888978
0.7318340566806717
0.6643209906079897
0.8122565195147101
0.4707270481319977
0.9785001455445378
0.17075087907531752
0.489625917805058
0.7595051272431785
0.6057853926542468
0.4195568875297668
0.5244744113321889
0.5202703028806769
0.6150870974034927
0.5299634576457063
0.9336763524510373
0.23649940737178063
0.388911200696845
0.6478041116722705
0.5517233675449297
0.6723258763091353
0.7175526480521238
0.8411089149883405
0.7404554224148189
0.26376935916880817
0.9373006475493478
0.5360566853939598
0.38729358133282565
0.4541602442018795
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 3, 2, 0, 1, 7, 6]
tensor([5, 4, 3, 2, 0, 1, 7, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 2, 1, 7, 6]
tensor([5, 3, 4, 0, 2, 1, 7, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 1, 7, 0, 6, 2, 3, 4]
tensor([5, 1, 7, 0, 6, 2, 3, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 3, 6, 0, 5, 2, 4, 1]
tensor([7, 3, 6, 0, 5, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 5, 7, 2, 4, 0, 3, 1]
tensor([6, 5, 7, 2, 4, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 5, 0, 0, 1, 2, 1, 3]
tensor([4, 5, 0, 0, 1, 2, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 2, 2, 0, 3, 3]
tensor([0, 1, 1, 2, 2, 0, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([6])
tensor(6)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 4
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([2, 3])
tensor(2)
tensor([4, 6])
tensor(4)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Cross-layer merge completed for layers 10 to 22
done!
Normal merging for layer 23
tensor([0, 5])
tensor(0)
tensor([1, 2])
tensor(1)
tensor([3, 4])
tensor(3)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 24 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 12 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 11 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

4
cuda:5
eq_bench
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 32.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.32s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:eq_bench: No `until` specified in `generation_kwargs`! Defaulting to the fewshot_delimiter='\n\n'
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 787
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/pbevan11/EQ-Bench/pbevan11/EQ-Bench.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench HTTP/1.1" 200 796
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/pbevan11/EQ-Bench/tree/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/pbevan11/EQ-Bench/resolve/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_infos.json HTTP/1.1" 404 0
DEBUG:filelock:Attempting to acquire lock 139646838836256 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139646838836256 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646838836256 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Lock 139646838836256 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_pbevan11___eq-bench_default_0.0.0_9ce8e5ffc1a36be5f946b37610ec8c516871f0d3.lock
DEBUG:filelock:Attempting to acquire lock 139646846350160 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139646846350160 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646846350160 on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:filelock:Lock 139646846350160 released on /public/home/zouyifei001/.cache/huggingface/datasets/pbevan11___eq-bench/default/0.0.0/9ce8e5ffc1a36be5f946b37610ec8c516871f0d3_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:eq_bench: Using gen_kwargs: {'do_sample': False, 'temperature': 0.0, 'max_gen_toks': 80, 'until': ['\n\n']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of eq_bench from None to 0
INFO:lm_eval.api.task:Building contexts for eq_bench on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 96001.46it/s]
DEBUG:lm_eval.evaluator:Task: eq_bench; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:08<14:27,  8.76s/it]Running generate_until requests:   2%|▏         | 2/100 [00:16<12:59,  7.95s/it]Running generate_until requests:   3%|▎         | 3/100 [00:23<12:11,  7.54s/it]Running generate_until requests:   4%|▍         | 4/100 [00:30<11:50,  7.40s/it]Running generate_until requests:   5%|▌         | 5/100 [00:37<11:31,  7.28s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<11:13,  7.16s/it]Running generate_until requests:   7%|▋         | 7/100 [00:51<10:50,  6.99s/it]Running generate_until requests:   8%|▊         | 8/100 [00:57<10:33,  6.89s/it]Running generate_until requests:   9%|▉         | 9/100 [01:04<10:35,  6.98s/it]Running generate_until requests:  10%|█         | 10/100 [01:11<10:12,  6.80s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<10:00,  6.74s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:25<10:08,  6.91s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:32<10:01,  6.91s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:38<09:46,  6.82s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:45<09:35,  6.78s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:51<09:16,  6.62s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:58<09:11,  6.64s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:04<08:52,  6.50s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:10<08:40,  6.43s/it]Running generate_until requests:  20%|██        | 20/100 [02:16<08:27,  6.34s/it]Running generate_until requests:  21%|██        | 21/100 [02:23<08:22,  6.37s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:29<08:22,  6.44s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:36<08:16,  6.45s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:42<08:07,  6.42s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:49<08:12,  6.57s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:55<07:57,  6.46s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:02<07:45,  6.38s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:08<07:39,  6.38s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:14<07:29,  6.34s/it]Running generate_until requests:  30%|███       | 30/100 [03:20<07:20,  6.30s/it]Running generate_until requests:  31%|███       | 31/100 [03:26<07:07,  6.19s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:33<07:11,  6.34s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:39<06:57,  6.24s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:45<06:46,  6.16s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:51<06:36,  6.10s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:57<06:23,  5.99s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:03<06:22,  6.07s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:09<06:11,  6.00s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:15<06:07,  6.02s/it]Running generate_until requests:  40%|████      | 40/100 [04:21<06:02,  6.04s/it]Running generate_until requests:  41%|████      | 41/100 [04:28<06:11,  6.30s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:34<06:03,  6.27s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:40<05:50,  6.16s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:46<05:41,  6.09s/it]Running generate_until requests:  45%|████▌     | 45/100 [04:52<05:29,  5.99s/it]Running generate_until requests:  46%|████▌     | 46/100 [04:58<05:27,  6.06s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:04<05:27,  6.18s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:10<05:14,  6.04s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:16<05:05,  5.98s/it]Running generate_until requests:  50%|█████     | 50/100 [05:22<05:00,  6.01s/it]Running generate_until requests:  51%|█████     | 51/100 [05:28<04:52,  5.96s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:34<04:50,  6.06s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:40<04:41,  5.98s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:46<04:33,  5.94s/it]Running generate_until requests:  55%|█████▌    | 55/100 [05:51<04:20,  5.79s/it]Running generate_until requests:  56%|█████▌    | 56/100 [05:57<04:11,  5.71s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:03<04:08,  5.77s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:08<03:59,  5.70s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:14<03:53,  5.69s/it]Running generate_until requests:  60%|██████    | 60/100 [06:19<03:47,  5.68s/it]Running generate_until requests:  61%|██████    | 61/100 [06:25<03:42,  5.70s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:31<03:39,  5.78s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:37<03:30,  5.70s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:42<03:23,  5.65s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:48<03:20,  5.72s/it]Running generate_until requests:  66%|██████▌   | 66/100 [06:50<02:38,  4.65s/it]Running generate_until requests:  67%|██████▋   | 67/100 [06:56<02:42,  4.92s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:02<02:47,  5.24s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:07<02:45,  5.35s/it]Running generate_until requests:  70%|███████   | 70/100 [07:13<02:41,  5.37s/it]Running generate_until requests:  71%|███████   | 71/100 [07:15<02:06,  4.36s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:21<02:15,  4.83s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:23<01:48,  4.02s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:28<01:54,  4.39s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:33<01:54,  4.60s/it]Running generate_until requests:  76%|███████▌  | 76/100 [07:38<01:54,  4.77s/it]Running generate_until requests:  77%|███████▋  | 77/100 [07:44<01:53,  4.94s/it]Running generate_until requests:  78%|███████▊  | 78/100 [07:49<01:51,  5.06s/it]Running generate_until requests:  79%|███████▉  | 79/100 [07:55<01:50,  5.24s/it]Running generate_until requests:  80%|████████  | 80/100 [08:00<01:45,  5.26s/it]Running generate_until requests:  81%|████████  | 81/100 [08:06<01:42,  5.37s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:11<01:36,  5.36s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:16<01:30,  5.35s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:22<01:25,  5.34s/it]Running generate_until requests:  85%|████████▌ | 85/100 [08:27<01:21,  5.40s/it]Running generate_until requests:  86%|████████▌ | 86/100 [08:32<01:15,  5.37s/it]Running generate_until requests:  87%|████████▋ | 87/100 [08:34<00:56,  4.32s/it]Running generate_until requests:  88%|████████▊ | 88/100 [08:40<00:56,  4.72s/it]Running generate_until requests:  89%|████████▉ | 89/100 [08:46<00:54,  4.96s/it]Running generate_until requests:  90%|█████████ | 90/100 [08:51<00:51,  5.16s/it]Running generate_until requests:  91%|█████████ | 91/100 [08:56<00:46,  5.19s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:02<00:41,  5.25s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:07<00:36,  5.20s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:12<00:31,  5.23s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:17<00:25,  5.17s/it]Running generate_until requests:  96%|█████████▌| 96/100 [09:19<00:16,  4.15s/it]Running generate_until requests:  97%|█████████▋| 97/100 [09:21<00:10,  3.43s/it]Running generate_until requests:  98%|█████████▊| 98/100 [09:26<00:07,  3.95s/it]Running generate_until requests:  99%|█████████▉| 99/100 [09:31<00:04,  4.33s/it]Running generate_until requests: 100%|██████████| 100/100 [09:36<00:00,  4.54s/it]Running generate_until requests: 100%|██████████| 100/100 [09:36<00:00,  5.77s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'eq_bench': {'alias': 'eq_bench', 'eqbench,none': -9.075457665929516, 'eqbench_stderr,none': 3.722206958756126, 'percent_parseable,none': 94.0, 'percent_parseable_stderr,none': 2.3868325657594203}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6639018561214101
0.48429197946127234
0.9515491395508957
0.5799692129526803
0.8892832964569847
0.5583880670373075
0.6815933931575056
0.8296184325732159
0.8572432652494972
0.7515568516065031
0.7498285715344476
0.6640770908835784
0.7344737024966144
0.8863376660708159
0.7840365418395101
0.7895254515113318
0.915557892351788
0.8364869594903738
0.8262221986876632
0.8424210311799578
0.9059689119946415
0.938938460185247
0.9139805997979817
0.8791150946846779
0.9604433557463424
0.36429086085480555
0.6224935475213342
0.9367462541020114
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[2, 3, 7, 0, 6, 1, 5, 4]
tensor([2, 3, 7, 0, 6, 1, 5, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 2, 1, 6, 0, 3, 7]
tensor([4, 5, 2, 1, 6, 0, 3, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 7, 1, 2, 6]
tensor([5, 3, 4, 0, 7, 1, 2, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 6, 4, 0, 3, 1, 2, 7]
tensor([5, 6, 4, 0, 3, 1, 2, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 0, 1, 2, 2, 3]
tensor([0, 1, 3, 0, 1, 2, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[2, 3, 0, 0, 1, 1, 2, 3]
tensor([2, 3, 0, 0, 1, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 3, 1, 2, 3]
tensor([2, 0, 1, 0, 3, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[2, 0, 1, 0, 2, 1, 3, 3]
tensor([2, 0, 1, 0, 2, 1, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 6 to 15
done!
Normal merging for layer 16
tensor([0, 3])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
tensor([2, 7])
tensor(2)
done!
Cross-layer merge completed for layers 17 to 18
done!
Normal merging for layer 19
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([0, 6])
tensor(0)
tensor([1, 7])
tensor(1)
done!
Normal merging for layer 20
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 6])
tensor(0)
tensor([4, 7])
tensor(4)
done!
Normal merging for layer 21
tensor([1, 3])
tensor(1)
tensor([2, 5])
tensor(2)
tensor([0, 4])
tensor(0)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 22 to 24
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 29
done!
Normal merging for layer 30
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Normal merging for layer 31
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 11 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.7017 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 10 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

116
cuda:6
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.10s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 200 512
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139645830554752 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645830554752 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645830554752 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645830554752 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139646845457168 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139646845457168 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646845457168 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139646845457168 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 126563.19it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<09:20,  1.87s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<07:31,  1.51s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:21,  1.13it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:05<04:32,  1.08it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:06<03:29,  1.40it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:07<03:44,  1.30it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:07<03:03,  1.58it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:08<03:18,  1.46it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:09<02:46,  1.72it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:10<03:02,  1.57it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:11<02:34,  1.83it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:12<02:49,  1.67it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:12<03:01,  1.55it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:13<02:32,  1.84it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:14<02:46,  1.67it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:15<02:23,  1.93it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:16<02:09,  2.12it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:16<02:25,  1.88it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:17<02:09,  2.10it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:18<02:24,  1.87it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:19<02:39,  1.69it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:19<02:49,  1.59it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:20<02:57,  1.51it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:21<02:23,  1.85it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:22<02:03,  2.13it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:22<01:51,  2.34it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:23<01:43,  2.51it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:24<01:59,  2.16it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:24<02:14,  1.91it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:25<02:27,  1.75it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:26<02:04,  2.04it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:27<01:52,  2.25it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:27<02:07,  1.98it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:28<01:53,  2.21it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:29<01:44,  2.38it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:29<01:58,  2.08it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:30<02:08,  1.92it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:31<02:16,  1.80it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:31<01:53,  2.15it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:32<01:40,  2.40it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:33<01:32,  2.59it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:33<01:44,  2.28it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:34<01:34,  2.51it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:35<01:45,  2.22it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:35<01:55,  2.02it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:36<02:04,  1.88it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:37<01:43,  2.24it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:37<01:32,  2.48it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:38<01:43,  2.19it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:39<01:53,  2.00it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:39<01:36,  2.33it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:40<01:27,  2.56it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:41<01:21,  2.73it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:41<01:33,  2.35it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:42<01:43,  2.12it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:43<01:53,  1.92it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:43<02:01,  1.78it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:44<01:40,  2.14it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:45<01:48,  1.98it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:45<01:31,  2.32it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:46<01:40,  2.09it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:46<01:27,  2.40it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:47<01:18,  2.62it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:48<01:13,  2.78it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:48<01:24,  2.42it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:49<01:16,  2.65it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:50<01:26,  2.33it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:50<01:17,  2.58it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:51<01:26,  2.29it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:52<01:34,  2.08it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:52<01:41,  1.93it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:53<01:46,  1.83it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:53<01:26,  2.24it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:54<01:33,  2.05it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:55<01:39,  1.91it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:55<01:22,  2.30it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:56<01:12,  2.57it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:57<01:07,  2.76it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:57<01:03,  2.90it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:58<01:00,  2.99it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:58<00:58,  3.06it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:59<01:08,  2.60it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [01:00<01:02,  2.80it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [01:00<01:11,  2.46it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:01<01:18,  2.22it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:01<01:24,  2.05it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:02<01:10,  2.42it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:03<01:02,  2.69it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:03<00:57,  2.89it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:04<01:05,  2.53it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:04<01:12,  2.27it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:05<01:18,  2.10it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:06<01:22,  1.98it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:06<01:25,  1.90it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:07<01:10,  2.28it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:08<01:01,  2.56it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:08<01:09,  2.27it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:09<01:00,  2.57it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:09<01:07,  2.29it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:10<01:13,  2.09it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:11<01:17,  1.96it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:11<01:03,  2.35it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:12<00:56,  2.62it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:12<00:51,  2.82it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:13<00:58,  2.47it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:14<00:52,  2.70it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:14<00:49,  2.87it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:15<00:46,  2.99it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:15<00:53,  2.59it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:16<00:48,  2.78it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:17<00:55,  2.45it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:17<00:48,  2.71it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:18<00:45,  2.88it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:18<00:50,  2.57it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:19<00:54,  2.35it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:20<00:58,  2.19it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:20<01:01,  2.08it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:21<00:49,  2.51it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:21<00:43,  2.80it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:22<00:40,  2.98it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:22<00:46,  2.59it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:23<00:51,  2.32it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:24<00:44,  2.65it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:24<00:39,  2.89it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:25<00:44,  2.55it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:25<00:38,  2.87it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:26<00:36,  3.03it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:27<00:41,  2.62it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:27<00:45,  2.36it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:28<00:39,  2.68it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:28<00:43,  2.43it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:29<00:46,  2.26it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:29<00:38,  2.68it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:30<00:41,  2.44it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:30<00:44,  2.26it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:31<00:46,  2.14it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:31<00:37,  2.61it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:32<00:32,  2.95it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:33<00:35,  2.63it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:33<00:31,  2.96it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:34<00:28,  3.19it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:34<00:26,  3.36it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:35<00:29,  2.92it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:35<00:26,  3.17it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:36<00:30,  2.78it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:36<00:33,  2.51it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:37<00:28,  2.88it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:37<00:25,  3.16it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:38<00:28,  2.78it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:38<00:24,  3.08it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:39<00:27,  2.74it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:39<00:23,  3.07it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:40<00:26,  2.73it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:40<00:28,  2.49it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:41<00:23,  2.89it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:42<00:26,  2.60it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:42<00:27,  2.40it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:43<00:29,  2.27it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:43<00:29,  2.17it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:44<00:30,  2.10it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:44<00:30,  2.05it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:45<00:30,  2.02it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:45<00:23,  2.57it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:46<00:19,  2.96it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:46<00:17,  3.24it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:47<00:16,  3.37it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:47<00:14,  3.47it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:48<00:14,  3.55it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:48<00:13,  3.60it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:49<00:12,  3.63it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:49<00:12,  3.66it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:50<00:13,  3.09it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:50<00:15,  2.77it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:51<00:12,  3.13it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:51<00:13,  2.80it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:52<00:11,  3.16it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:52<00:12,  2.82it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:53<00:13,  2.59it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:53<00:14,  2.42it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:54<00:11,  2.91it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:54<00:09,  3.25it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:55<00:07,  3.50it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:55<00:07,  3.69it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:56<00:07,  3.22it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:56<00:06,  3.51it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:57<00:07,  3.08it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:57<00:07,  2.78it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:58<00:05,  3.20it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:58<00:06,  2.87it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:59<00:06,  2.65it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:59<00:06,  2.49it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [02:00<00:04,  3.01it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [02:00<00:03,  3.39it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [02:01<00:02,  3.66it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [02:01<00:02,  3.86it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [02:02<00:02,  3.37it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:02<00:01,  3.03it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:02<00:01,  3.44it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:03<00:00,  3.77it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:03<00:00,  3.35it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:03<00:00,  2.42it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 10 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.5127 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 9 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

19
cuda:7
mrpc
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.55s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mrpc] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mrpc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: mrpc] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: mrpc] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139645835807344 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645835807344 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645835807344 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139645835807344 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mrpc_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139646845466960 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139646845466960 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646845466960 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139646845466960 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mrpc/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mrpc from None to 0
INFO:lm_eval.api.task:Building contexts for mrpc on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2435.24it/s]
DEBUG:lm_eval.evaluator:Task: mrpc; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:43,  1.72s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:41,  1.22it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<02:09,  1.50it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:53,  1.70it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:45,  1.81it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:41,  1.86it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:37,  1.92it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:34,  1.96it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:32,  1.98it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:31,  1.99it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:11<01:30,  1.98it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:12<01:29,  1.98it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:13<01:29,  1.96it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:14<01:27,  1.98it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:15<01:24,  2.02it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:16<01:22,  2.05it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:17<01:20,  2.07it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:18<01:19,  2.08it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:19<01:17,  2.09it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:20<01:16,  2.12it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:21<01:14,  2.14it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:22<01:12,  2.15it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:23<01:11,  2.18it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:23<01:09,  2.20it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:24<01:08,  2.21it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:25<01:07,  2.22it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:26<01:05,  2.23it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:27<01:04,  2.24it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:28<01:04,  2.21it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:29<01:04,  2.19it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:30<01:03,  2.18it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:31<01:04,  2.14it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:32<01:03,  2.11it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:33<01:07,  1.98it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:34<01:05,  2.01it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:35<01:04,  2.02it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:36<01:01,  2.07it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:37<01:01,  2.04it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:38<00:59,  2.08it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:39<00:56,  2.12it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:40<00:55,  2.16it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:40<00:54,  2.16it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:41<00:52,  2.17it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:42<00:51,  2.17it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:43<00:50,  2.20it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:44<00:49,  2.21it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:45<00:47,  2.27it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:46<00:49,  2.14it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:47<00:48,  2.11it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:48<00:45,  2.21it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:49<00:49,  2.00it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:50<00:45,  2.14it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:51<00:51,  1.83it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:52<00:46,  2.00it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:53<00:51,  1.75it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:54<00:46,  1.91it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:55<00:45,  1.93it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:56<00:42,  2.02it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:57<00:38,  2.16it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:58<00:35,  2.25it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:59<00:34,  2.26it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:59<00:33,  2.29it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [01:00<00:32,  2.31it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [01:01<00:31,  2.32it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [01:02<00:30,  2.34it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [01:03<00:29,  2.35it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [01:04<00:28,  2.37it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [01:04<00:26,  2.43it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:05<00:25,  2.47it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:06<00:24,  2.45it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:07<00:23,  2.46it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:08<00:22,  2.49it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:08<00:21,  2.50it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:09<00:21,  2.51it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:10<00:20,  2.51it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:11<00:19,  2.50it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:12<00:18,  2.50it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:12<00:17,  2.53it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:13<00:16,  2.58it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:14<00:15,  2.63it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:15<00:15,  2.51it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:16<00:14,  2.49it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:16<00:14,  2.49it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:17<00:13,  2.54it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:18<00:11,  2.61it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:19<00:11,  2.47it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:20<00:12,  2.23it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:21<00:11,  2.19it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:22<00:10,  2.16it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:23<00:09,  2.19it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:24<00:08,  2.12it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:25<00:08,  2.03it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:25<00:06,  2.18it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:26<00:05,  2.30it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:27<00:04,  2.42it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:28<00:03,  2.51it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:28<00:02,  2.60it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:29<00:01,  2.69it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:30<00:01,  2.56it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:31<00:00,  2.41it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:31<00:00,  2.19it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:57,  1.19s/it]  2%|▏         | 2/100 [00:02<01:56,  1.19s/it]  3%|▎         | 3/100 [00:03<01:55,  1.19s/it]  4%|▍         | 4/100 [00:04<01:55,  1.20s/it]  5%|▌         | 5/100 [00:05<01:53,  1.20s/it]  6%|▌         | 6/100 [00:07<01:52,  1.19s/it]  7%|▋         | 7/100 [00:08<01:50,  1.19s/it]  8%|▊         | 8/100 [00:09<01:49,  1.19s/it]  9%|▉         | 9/100 [00:10<01:48,  1.19s/it] 10%|█         | 10/100 [00:11<01:47,  1.19s/it] 11%|█         | 11/100 [00:13<01:46,  1.19s/it] 12%|█▏        | 12/100 [00:14<01:44,  1.19s/it] 13%|█▎        | 13/100 [00:15<01:43,  1.19s/it] 14%|█▍        | 14/100 [00:16<01:42,  1.19s/it] 15%|█▌        | 15/100 [00:17<01:41,  1.19s/it] 16%|█▌        | 16/100 [00:19<01:39,  1.19s/it] 17%|█▋        | 17/100 [00:20<01:38,  1.19s/it] 18%|█▊        | 18/100 [00:21<01:37,  1.19s/it] 19%|█▉        | 19/100 [00:22<01:36,  1.19s/it] 20%|██        | 20/100 [00:23<01:35,  1.20s/it] 21%|██        | 21/100 [00:25<01:35,  1.21s/it] 22%|██▏       | 22/100 [00:26<01:34,  1.21s/it] 23%|██▎       | 23/100 [00:27<01:32,  1.20s/it] 24%|██▍       | 24/100 [00:28<01:31,  1.20s/it] 25%|██▌       | 25/100 [00:29<01:29,  1.20s/it] 26%|██▌       | 26/100 [00:31<01:28,  1.20s/it] 27%|██▋       | 27/100 [00:32<01:27,  1.20s/it] 28%|██▊       | 28/100 [00:33<01:26,  1.19s/it] 29%|██▉       | 29/100 [00:34<01:24,  1.19s/it] 30%|███       | 30/100 [00:35<01:23,  1.19s/it] 31%|███       | 31/100 [00:37<01:22,  1.19s/it] 32%|███▏      | 32/100 [00:38<01:21,  1.19s/it] 33%|███▎      | 33/100 [00:39<01:19,  1.19s/it] 34%|███▍      | 34/100 [00:40<01:18,  1.19s/it] 35%|███▌      | 35/100 [00:41<01:17,  1.19s/it] 36%|███▌      | 36/100 [00:42<01:16,  1.20s/it] 37%|███▋      | 37/100 [00:44<01:15,  1.20s/it] 38%|███▊      | 38/100 [00:45<01:14,  1.19s/it] 39%|███▉      | 39/100 [00:46<01:12,  1.19s/it] 40%|████      | 40/100 [00:47<01:11,  1.19s/it] 41%|████      | 41/100 [00:48<01:10,  1.19s/it] 42%|████▏     | 42/100 [00:50<01:08,  1.19s/it] 43%|████▎     | 43/100 [00:51<01:07,  1.19s/it] 44%|████▍     | 44/100 [00:52<01:06,  1.19s/it] 45%|████▌     | 45/100 [00:53<01:05,  1.19s/it] 46%|████▌     | 46/100 [00:54<01:04,  1.19s/it] 47%|████▋     | 47/100 [00:56<01:02,  1.19s/it] 48%|████▊     | 48/100 [00:57<01:01,  1.19s/it] 49%|████▉     | 49/100 [00:58<01:00,  1.19s/it] 50%|█████     | 50/100 [00:59<00:59,  1.19s/it] 51%|█████     | 51/100 [01:00<00:58,  1.19s/it] 52%|█████▏    | 52/100 [01:02<00:58,  1.22s/it] 53%|█████▎    | 53/100 [01:03<00:56,  1.21s/it] 54%|█████▍    | 54/100 [01:04<00:55,  1.20s/it] 55%|█████▌    | 55/100 [01:05<00:53,  1.20s/it] 56%|█████▌    | 56/100 [01:06<00:52,  1.19s/it] 57%|█████▋    | 57/100 [01:08<00:51,  1.19s/it] 58%|█████▊    | 58/100 [01:09<00:50,  1.19s/it] 59%|█████▉    | 59/100 [01:10<00:49,  1.21s/it] 60%|██████    | 60/100 [01:11<00:48,  1.20s/it] 61%|██████    | 61/100 [01:12<00:47,  1.22s/it] 62%|██████▏   | 62/100 [01:14<00:45,  1.21s/it] 63%|██████▎   | 63/100 [01:15<00:44,  1.20s/it] 64%|██████▍   | 64/100 [01:16<00:43,  1.21s/it] 65%|██████▌   | 65/100 [01:17<00:42,  1.21s/it] 66%|██████▌   | 66/100 [01:18<00:40,  1.20s/it] 67%|██████▋   | 67/100 [01:20<00:39,  1.20s/it] 68%|██████▊   | 68/100 [01:21<00:38,  1.20s/it] 69%|██████▉   | 69/100 [01:22<00:37,  1.20s/it] 70%|███████   | 70/100 [01:23<00:35,  1.20s/it] 71%|███████   | 71/100 [01:24<00:34,  1.21s/it] 72%|███████▏  | 72/100 [01:26<00:33,  1.21s/it] 73%|███████▎  | 73/100 [01:27<00:32,  1.20s/it] 74%|███████▍  | 74/100 [01:28<00:31,  1.20s/it] 75%|███████▌  | 75/100 [01:29<00:29,  1.20s/it] 76%|███████▌  | 76/100 [01:30<00:28,  1.19s/it] 77%|███████▋  | 77/100 [01:32<00:27,  1.19s/it] 78%|███████▊  | 78/100 [01:33<00:26,  1.21s/it] 79%|███████▉  | 79/100 [01:34<00:25,  1.20s/it] 80%|████████  | 80/100 [01:35<00:23,  1.20s/it] 81%|████████  | 81/100 [01:36<00:22,  1.19s/it] 82%|████████▏ | 82/100 [01:38<00:21,  1.19s/it] 83%|████████▎ | 83/100 [01:39<00:20,  1.19s/it] 84%|████████▍ | 84/100 [01:40<00:19,  1.19s/it] 85%|████████▌ | 85/100 [01:41<00:17,  1.19s/it] 86%|████████▌ | 86/100 [01:42<00:16,  1.19s/it] 87%|████████▋ | 87/100 [01:43<00:15,  1.19s/it] 88%|████████▊ | 88/100 [01:45<00:14,  1.19s/it] 89%|████████▉ | 89/100 [01:46<00:13,  1.19s/it] 90%|█████████ | 90/100 [01:47<00:11,  1.19s/it] 91%|█████████ | 91/100 [01:48<00:10,  1.20s/it] 92%|█████████▏| 92/100 [01:49<00:09,  1.20s/it] 93%|█████████▎| 93/100 [01:51<00:08,  1.21s/it] 94%|█████████▍| 94/100 [01:52<00:07,  1.20s/it] 95%|█████████▌| 95/100 [01:53<00:06,  1.21s/it] 96%|█████████▌| 96/100 [01:54<00:04,  1.21s/it] 97%|█████████▋| 97/100 [01:56<00:03,  1.21s/it] 98%|█████████▊| 98/100 [01:57<00:02,  1.20s/it] 99%|█████████▉| 99/100 [01:58<00:01,  1.20s/it]100%|██████████| 100/100 [01:59<00:00,  1.20s/it]100%|██████████| 100/100 [01:59<00:00,  1.20s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'mrpc': {'alias': 'mrpc', 'acc,none': 0.7, 'acc_stderr,none': 0.04605661864718383, 'f1,none': np.float64(0.8214285714285714), 'f1_stderr,none': 0.0323693653386572}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.32375514242269293
0.9664141198776434
0.4263233992087649
0.29258192731768157
0.3497718342079178
0.5968480671674146
0.7870107004084098
0.7068508532201193
0.7836897379939763
0.2579819071737284
0.5774144903645764
0.7819348699339372
0.7404680063618143
0.651835611327285
0.6832243011482585
0.34680079188801705
0.6033476505145444
0.6299526106979766
0.6468468631829007
0.8458578364778718
0.39447753640727073
0.5291234791393744
0.944540808938638
0.8460909093145242
0.4915397062049404
0.5314721523201049
0.8670806018560002
0.6451914961665037
0.7380077491787214
0.32375514242269293
0.9664141198776434
0.4263233992087649
0.29258192731768157
0.3497718342079178
0.5968480671674146
0.7870107004084098
0.7068508532201193
0.7836897379939763
0.2579819071737284
0.5774144903645764
0.7819348699339372
0.7404680063618143
0.651835611327285
0.6832243011482585
0.34680079188801705
0.6033476505145444
0.6299526106979766
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 7, 1, 6, 2, 3, 0]
tensor([4, 5, 7, 1, 6, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 4, 5, 0, 1, 2]
tensor([6, 3, 7, 4, 5, 0, 1, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 1, 7, 2, 6, 0, 3, 5]
tensor([4, 1, 7, 2, 6, 0, 3, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 5, 2, 7, 0, 4, 1]
tensor([6, 3, 5, 2, 7, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 5, 6, 7, 3, 1, 0, 2]
tensor([4, 5, 6, 7, 3, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 4, 1, 0, 5]
tensor([0, 3, 1, 2, 4, 1, 0, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1, 1.0]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 2
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 4 to 5
done!
Normal merging for layer 6
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
done!
Cross-layer merge completed for layers 7 to 9
done!
Normal merging for layer 10
tensor([0, 6])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
done!
Cross-layer merge completed for layers 11 to 26
done!
Normal merging for layer 27
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 28 to 30
done!
Normal merging for layer 31
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 9 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3867 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 8 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

170
cuda:0
fda
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.87s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:None: No `generation_kwargs` specified in task config, defaulting to {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1035
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/hazyresearch/based-fda/hazyresearch/based-fda.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1043
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/revision/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 1043
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/tree/42569d301e12fbcf8d5a69e04e892aa013e20314?recursive=False&expand=False HTTP/1.1" 200 291
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/tree/42569d301e12fbcf8d5a69e04e892aa013e20314/data?recursive=False&expand=False HTTP/1.1" 200 484
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/revision/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 1043
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139645937399232 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 139645937399232 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645937399232 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 139645937399232 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Attempting to acquire lock 139645833413120 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 139645833413120 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645833413120 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 139645833413120 released on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:fda: Using gen_kwargs: {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of fda from None to 0
INFO:lm_eval.api.task:Building contexts for fda on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 297257.55it/s]
DEBUG:lm_eval.evaluator:Task: fda; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:19<31:23, 19.03s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<25:29, 15.60s/it]Running generate_until requests:   3%|▎         | 3/100 [00:45<23:16, 14.40s/it]Running generate_until requests:   4%|▍         | 4/100 [01:02<24:52, 15.55s/it]Running generate_until requests:   5%|▌         | 5/100 [01:17<24:23, 15.41s/it]Running generate_until requests:   6%|▌         | 6/100 [01:31<23:22, 14.92s/it]Running generate_until requests:   7%|▋         | 7/100 [01:49<24:21, 15.72s/it]Running generate_until requests:   8%|▊         | 8/100 [02:06<24:46, 16.16s/it]Running generate_until requests:   9%|▉         | 9/100 [02:18<22:44, 15.00s/it]Running generate_until requests:  10%|█         | 10/100 [02:29<20:47, 13.87s/it]Running generate_until requests:  11%|█         | 11/100 [02:40<19:18, 13.02s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:57<20:48, 14.18s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:09<19:24, 13.38s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:26<20:46, 14.49s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:37<19:13, 13.57s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:50<18:24, 13.15s/it]Running generate_until requests:  17%|█▋        | 17/100 [04:01<17:37, 12.74s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:18<19:12, 14.05s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:30<17:57, 13.30s/it]Running generate_until requests:  20%|██        | 20/100 [04:47<19:12, 14.41s/it]Running generate_until requests:  21%|██        | 21/100 [05:04<20:02, 15.22s/it]Running generate_until requests:  22%|██▏       | 22/100 [05:18<19:12, 14.78s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:35<19:47, 15.42s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:47<18:19, 14.47s/it]Running generate_until requests:  25%|██▌       | 25/100 [06:04<18:56, 15.15s/it]Running generate_until requests:  26%|██▌       | 26/100 [06:21<19:18, 15.65s/it]Running generate_until requests:  27%|██▋       | 27/100 [06:37<19:27, 16.00s/it]Running generate_until requests:  28%|██▊       | 28/100 [06:50<17:51, 14.88s/it]Running generate_until requests:  29%|██▉       | 29/100 [07:07<18:24, 15.56s/it]Running generate_until requests:  30%|███       | 30/100 [07:20<17:26, 14.95s/it]Running generate_until requests:  31%|███       | 31/100 [07:37<17:57, 15.61s/it]Running generate_until requests:  32%|███▏      | 32/100 [07:50<16:37, 14.68s/it]Running generate_until requests:  33%|███▎      | 33/100 [08:07<17:06, 15.31s/it]Running generate_until requests:  34%|███▍      | 34/100 [08:23<17:17, 15.72s/it]Running generate_until requests:  35%|███▌      | 35/100 [08:36<16:06, 14.88s/it]Running generate_until requests:  36%|███▌      | 36/100 [08:48<14:56, 14.01s/it]Running generate_until requests:  37%|███▋      | 37/100 [09:00<13:57, 13.30s/it]Running generate_until requests:  38%|███▊      | 38/100 [09:13<13:41, 13.25s/it]Running generate_until requests:  39%|███▉      | 39/100 [09:30<14:38, 14.40s/it]Running generate_until requests:  40%|████      | 40/100 [09:42<13:46, 13.77s/it]Running generate_until requests:  41%|████      | 41/100 [09:59<14:27, 14.70s/it]Running generate_until requests:  42%|████▏     | 42/100 [10:11<13:18, 13.76s/it]Running generate_until requests:  43%|████▎     | 43/100 [10:23<12:32, 13.20s/it]Running generate_until requests:  44%|████▍     | 44/100 [10:35<11:55, 12.78s/it]Running generate_until requests:  45%|████▌     | 45/100 [10:46<11:14, 12.26s/it]Running generate_until requests:  46%|████▌     | 46/100 [11:03<12:20, 13.70s/it]Running generate_until requests:  47%|████▋     | 47/100 [11:20<12:55, 14.63s/it]Running generate_until requests:  48%|████▊     | 48/100 [11:32<12:00, 13.86s/it]Running generate_until requests:  49%|████▉     | 49/100 [11:43<11:05, 13.05s/it]Running generate_until requests:  50%|█████     | 50/100 [11:56<10:56, 13.13s/it]Running generate_until requests:  51%|█████     | 51/100 [12:08<10:22, 12.71s/it]Running generate_until requests:  52%|█████▏    | 52/100 [12:25<11:12, 14.01s/it]Running generate_until requests:  53%|█████▎    | 53/100 [12:37<10:29, 13.39s/it]Running generate_until requests:  54%|█████▍    | 54/100 [12:49<09:54, 12.91s/it]Running generate_until requests:  55%|█████▌    | 55/100 [13:05<10:32, 14.05s/it]Running generate_until requests:  56%|█████▌    | 56/100 [13:17<09:41, 13.22s/it]Running generate_until requests:  57%|█████▋    | 57/100 [13:32<10:01, 13.99s/it]Running generate_until requests:  58%|█████▊    | 58/100 [13:46<09:48, 14.01s/it]Running generate_until requests:  59%|█████▉    | 59/100 [14:03<10:11, 14.91s/it]Running generate_until requests:  60%|██████    | 60/100 [14:21<10:25, 15.63s/it]Running generate_until requests:  61%|██████    | 61/100 [14:37<10:17, 15.82s/it]Running generate_until requests:  62%|██████▏   | 62/100 [14:49<09:19, 14.72s/it]Running generate_until requests:  63%|██████▎   | 63/100 [15:01<08:29, 13.76s/it]Running generate_until requests:  64%|██████▍   | 64/100 [15:12<07:50, 13.07s/it]Running generate_until requests:  65%|██████▌   | 65/100 [15:29<08:19, 14.27s/it]Running generate_until requests:  66%|██████▌   | 66/100 [15:46<08:33, 15.11s/it]Running generate_until requests:  67%|██████▋   | 67/100 [16:03<08:39, 15.73s/it]Running generate_until requests:  68%|██████▊   | 68/100 [16:20<08:33, 16.05s/it]Running generate_until requests:  69%|██████▉   | 69/100 [16:37<08:22, 16.20s/it]Running generate_until requests:  70%|███████   | 70/100 [16:50<07:41, 15.37s/it]Running generate_until requests:  71%|███████   | 71/100 [17:07<07:41, 15.92s/it]Running generate_until requests:  72%|███████▏  | 72/100 [17:25<07:38, 16.39s/it]Running generate_until requests:  73%|███████▎  | 73/100 [17:36<06:43, 14.94s/it]Running generate_until requests:  74%|███████▍  | 74/100 [17:54<06:45, 15.60s/it]Running generate_until requests:  75%|███████▌  | 75/100 [18:06<06:02, 14.49s/it]Running generate_until requests:  76%|███████▌  | 76/100 [18:17<05:23, 13.47s/it]Running generate_until requests:  77%|███████▋  | 77/100 [18:28<04:55, 12.86s/it]Running generate_until requests:  78%|███████▊  | 78/100 [18:40<04:34, 12.50s/it]Running generate_until requests:  79%|███████▉  | 79/100 [18:56<04:48, 13.74s/it]Running generate_until requests:  80%|████████  | 80/100 [19:09<04:29, 13.47s/it]Running generate_until requests:  81%|████████  | 81/100 [19:26<04:33, 14.39s/it]Running generate_until requests:  82%|████████▏ | 82/100 [19:42<04:30, 15.05s/it]Running generate_until requests:  83%|████████▎ | 83/100 [19:55<04:04, 14.40s/it]Running generate_until requests:  84%|████████▍ | 84/100 [20:07<03:40, 13.75s/it]Running generate_until requests:  85%|████████▌ | 85/100 [20:19<03:16, 13.10s/it]Running generate_until requests:  86%|████████▌ | 86/100 [20:34<03:10, 13.64s/it]Running generate_until requests:  87%|████████▋ | 87/100 [20:45<02:49, 13.02s/it]Running generate_until requests:  88%|████████▊ | 88/100 [20:57<02:30, 12.55s/it]Running generate_until requests:  89%|████████▉ | 89/100 [21:11<02:23, 13.04s/it]Running generate_until requests:  90%|█████████ | 90/100 [21:21<02:01, 12.11s/it]Running generate_until requests:  91%|█████████ | 91/100 [21:27<01:32, 10.33s/it]Running generate_until requests:  92%|█████████▏| 92/100 [21:34<01:15,  9.40s/it]Running generate_until requests:  93%|█████████▎| 93/100 [21:45<01:07,  9.69s/it]Running generate_until requests:  94%|█████████▍| 94/100 [21:53<00:54,  9.13s/it]Running generate_until requests:  95%|█████████▌| 95/100 [21:59<00:41,  8.20s/it]Running generate_until requests:  96%|█████████▌| 96/100 [22:09<00:34,  8.69s/it]Running generate_until requests:  97%|█████████▋| 97/100 [22:13<00:21,  7.31s/it]Running generate_until requests:  98%|█████████▊| 98/100 [22:21<00:15,  7.55s/it]Running generate_until requests:  99%|█████████▉| 99/100 [22:29<00:07,  7.67s/it]Running generate_until requests: 100%|██████████| 100/100 [22:33<00:00,  6.60s/it]Running generate_until requests: 100%|██████████| 100/100 [22:33<00:00, 13.53s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'fda': {'alias': 'fda', 'contains,none': np.float64(0.87), 'contains_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 7, 0, 5, 1, 4, 3]
tensor([6, 2, 7, 0, 5, 1, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 0, 1, 5, 2, 7, 6, 3]
tensor([4, 0, 1, 5, 2, 7, 6, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 0, 4, 2, 6, 3, 7, 5]
tensor([1, 0, 4, 2, 6, 3, 7, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 6, 3, 5, 1, 4, 2]
tensor([7, 0, 6, 3, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 0, 2, 5, 1, 1, 4]
tensor([0, 3, 0, 2, 5, 1, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 1, 4, 1, 5, 2, 0]
tensor([0, 3, 1, 4, 1, 5, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 11
done!
Normal merging for layer 12
tensor([0, 2])
tensor(0)
tensor([5, 6])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 8 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 7 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

176
cuda:1
rte
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:04<01:04, 64.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:25<00:00, 39.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:25<00:00, 42.94s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 139672002165552 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139672002165552 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139672002165552 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139672002165552 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139671870911552 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671870911552 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671870911552 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139671870911552 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of rte from None to 0
INFO:lm_eval.api.task:Building contexts for rte on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1961.14it/s]
DEBUG:lm_eval.evaluator:Task: rte; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:02<06:54,  2.08s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:03<03:29,  1.06s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:04<02:43,  1.19it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:05<02:22,  1.35it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:07<02:11,  1.45it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:08<02:03,  1.53it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:09<01:58,  1.58it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:10<01:54,  1.62it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:11<01:50,  1.66it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:12<01:47,  1.69it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:14<01:43,  1.73it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:15<01:40,  1.76it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:16<01:38,  1.78it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:17<01:34,  1.83it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:18<01:33,  1.83it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:19<01:30,  1.87it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:20<01:28,  1.89it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:21<01:26,  1.92it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:22<01:24,  1.93it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:23<01:22,  1.96it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:24<01:19,  2.00it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:25<01:17,  2.04it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:26<01:14,  2.07it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:27<01:12,  2.11it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:28<01:10,  2.16it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:28<01:07,  2.21it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:29<01:04,  2.27it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:30<01:02,  2.32it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:31<01:00,  2.38it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:32<00:58,  2.43it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:32<00:56,  2.47it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:33<00:54,  2.50it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:34<00:53,  2.52it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:35<00:52,  2.55it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:35<00:50,  2.57it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:36<00:49,  2.59it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:37<00:49,  2.58it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:38<00:48,  2.57it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:39<00:47,  2.58it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:39<00:46,  2.62it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:40<00:44,  2.66it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:41<00:43,  2.69it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:41<00:42,  2.72it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:42<00:41,  2.74it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:43<00:40,  2.77it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:44<00:39,  2.79it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:44<00:37,  2.82it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:45<00:37,  2.83it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:46<00:36,  2.82it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:46<00:35,  2.82it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:47<00:34,  2.84it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:48<00:33,  2.87it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:48<00:32,  2.89it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:49<00:31,  2.91it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:50<00:31,  2.93it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:50<00:30,  2.95it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:51<00:29,  2.96it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:52<00:28,  2.97it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:52<00:27,  2.97it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:53<00:27,  2.97it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:54<00:26,  2.98it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:54<00:25,  2.99it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:55<00:24,  3.00it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:56<00:24,  3.01it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:56<00:23,  3.01it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:57<00:22,  3.02it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:58<00:22,  3.04it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:58<00:21,  3.07it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:59<00:20,  3.06it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:00<00:19,  3.09it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:00<00:18,  3.12it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:01<00:18,  3.15it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:02<00:17,  3.17it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:02<00:16,  3.18it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:03<00:15,  3.20it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:03<00:15,  3.21it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:04<00:14,  3.22it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:05<00:13,  3.23it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:05<00:13,  3.25it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:06<00:12,  3.28it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:06<00:11,  3.30it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:07<00:11,  3.31it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:08<00:10,  3.33it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:08<00:09,  3.35it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:09<00:09,  3.35it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:09<00:08,  3.39it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:10<00:07,  3.40it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:11<00:07,  3.41it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:11<00:06,  3.38it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:12<00:06,  3.41it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:12<00:05,  3.43it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:13<00:04,  3.45it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:13<00:04,  3.46it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:14<00:03,  3.48it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:15<00:03,  3.35it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:15<00:02,  3.41it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:16<00:02,  3.46it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:16<00:01,  3.46it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:17<00:00,  3.54it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:17<00:00,  3.61it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:17<00:00,  2.57it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'rte': {'alias': 'rte', 'acc,none': 0.5, 'acc_stderr,none': 0.050251890762960605}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
0.5728915095234594
0.1682455054057436
0.93212414632396
0.9148362604533635
0.8268537756297094
0.7592245907029287
0.7256008379011685
0.7109756105942956
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
Total groups 73 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 7, 1, 6, 4, 3, 0]
tensor([5, 2, 7, 1, 6, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 6, 0, 7, 3, 4, 1]
tensor([5, 2, 6, 0, 7, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 7, 2, 5, 4, 3, 0]
tensor([6, 1, 7, 2, 5, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 2, 4, 1, 5, 0]
tensor([6, 3, 7, 2, 4, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 5, 6, 2, 3, 1, 4, 0]
tensor([7, 5, 6, 2, 3, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 5, 4, 1, 0, 1, 3]
tensor([0, 2, 5, 4, 1, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([0, 5])
tensor(0)
tensor([4, 6])
tensor(4)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 30
done!
Normal merging for layer 31
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 7 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 6 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

139
cuda:2
mastermind_24_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.38s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random HTTP/1.1" 200 772
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_24_mcq_random/flair/mastermind_24_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random HTTP/1.1" 200 779
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_24_mcq_random/resolve/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random/revision/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 779
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random/tree/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5?recursive=False&expand=False HTTP/1.1" 200 290
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random/tree/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/data?recursive=False&expand=False HTTP/1.1" 200 358
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random/revision/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 779
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_24_mcq_random/resolve/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139646838838080 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Lock 139646838838080 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646838838080 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Lock 139646838838080 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Attempting to acquire lock 139645937386272 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:filelock:Lock 139645937386272 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645937386272 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:filelock:Lock 139645937386272 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_24_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_24_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1484.58it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_24_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:01<10:52,  1.64s/it]Running loglikelihood requests:   0%|          | 2/400 [00:02<08:42,  1.31s/it]Running loglikelihood requests:   1%|          | 3/400 [00:03<07:59,  1.21s/it]Running loglikelihood requests:   1%|          | 4/400 [00:04<07:38,  1.16s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:05<07:25,  1.13s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:07<07:16,  1.11s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:08<07:10,  1.09s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:09<07:05,  1.09s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:10<07:12,  1.11s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:11<07:08,  1.10s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:12<05:28,  1.18it/s]Running loglikelihood requests:   3%|▎         | 13/400 [00:13<05:48,  1.11it/s]Running loglikelihood requests:   4%|▎         | 14/400 [00:14<06:05,  1.06it/s]Running loglikelihood requests:   4%|▍         | 16/400 [00:15<05:05,  1.26it/s]Running loglikelihood requests:   4%|▍         | 17/400 [00:16<05:28,  1.17it/s]Running loglikelihood requests:   4%|▍         | 18/400 [00:17<05:47,  1.10it/s]Running loglikelihood requests:   5%|▍         | 19/400 [00:19<06:02,  1.05it/s]Running loglikelihood requests:   5%|▌         | 20/400 [00:20<06:12,  1.02it/s]Running loglikelihood requests:   5%|▌         | 21/400 [00:21<06:20,  1.00s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:22<06:25,  1.02s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:23<06:29,  1.03s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:24<05:01,  1.24it/s]Running loglikelihood requests:   6%|▋         | 26/400 [00:25<05:24,  1.15it/s]Running loglikelihood requests:   7%|▋         | 27/400 [00:26<05:41,  1.09it/s]Running loglikelihood requests:   7%|▋         | 29/400 [00:27<04:38,  1.33it/s]Running loglikelihood requests:   8%|▊         | 30/400 [00:28<05:06,  1.21it/s]Running loglikelihood requests:   8%|▊         | 31/400 [00:29<05:26,  1.13it/s]Running loglikelihood requests:   8%|▊         | 32/400 [00:30<05:42,  1.07it/s]Running loglikelihood requests:   8%|▊         | 34/400 [00:31<04:37,  1.32it/s]Running loglikelihood requests:   9%|▉         | 35/400 [00:32<05:03,  1.20it/s]Running loglikelihood requests:  10%|▉         | 38/400 [00:33<03:33,  1.70it/s]Running loglikelihood requests:  10%|▉         | 39/400 [00:34<04:04,  1.47it/s]Running loglikelihood requests:  10%|█         | 40/400 [00:35<04:32,  1.32it/s]Running loglikelihood requests:  10%|█         | 41/400 [00:37<04:57,  1.21it/s]Running loglikelihood requests:  10%|█         | 42/400 [00:38<05:17,  1.13it/s]Running loglikelihood requests:  11%|█         | 43/400 [00:39<05:31,  1.08it/s]Running loglikelihood requests:  11%|█         | 44/400 [00:40<05:42,  1.04it/s]Running loglikelihood requests:  11%|█▏        | 45/400 [00:41<05:50,  1.01it/s]Running loglikelihood requests:  12%|█▏        | 47/400 [00:42<04:34,  1.28it/s]Running loglikelihood requests:  12%|█▏        | 48/400 [00:43<04:56,  1.19it/s]Running loglikelihood requests:  12%|█▏        | 49/400 [00:44<05:13,  1.12it/s]Running loglikelihood requests:  12%|█▎        | 50/400 [00:45<05:26,  1.07it/s]Running loglikelihood requests:  13%|█▎        | 52/400 [00:46<04:22,  1.32it/s]Running loglikelihood requests:  13%|█▎        | 53/400 [00:47<04:45,  1.22it/s]Running loglikelihood requests:  14%|█▎        | 54/400 [00:48<05:03,  1.14it/s]Running loglikelihood requests:  14%|█▍        | 56/400 [00:49<04:10,  1.37it/s]Running loglikelihood requests:  14%|█▍        | 57/400 [00:50<04:34,  1.25it/s]Running loglikelihood requests:  14%|█▍        | 58/400 [00:51<04:53,  1.17it/s]Running loglikelihood requests:  15%|█▍        | 59/400 [00:52<05:08,  1.11it/s]Running loglikelihood requests:  15%|█▌        | 60/400 [00:53<05:19,  1.06it/s]Running loglikelihood requests:  15%|█▌        | 61/400 [00:54<05:27,  1.03it/s]Running loglikelihood requests:  16%|█▌        | 62/400 [00:55<05:33,  1.01it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [00:56<05:37,  1.00s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [00:57<05:39,  1.01s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [00:58<05:40,  1.02s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [00:59<05:40,  1.02s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [01:00<05:40,  1.02s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [01:01<05:40,  1.03s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [01:03<05:54,  1.07s/it]Running loglikelihood requests:  18%|█▊        | 70/400 [01:04<05:51,  1.06s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [01:05<05:47,  1.06s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [01:06<05:43,  1.05s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [01:07<05:40,  1.04s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [01:08<05:37,  1.04s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [01:09<04:35,  1.18it/s]Running loglikelihood requests:  19%|█▉        | 77/400 [01:10<04:50,  1.11it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [01:11<05:00,  1.07it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [01:12<05:07,  1.04it/s]Running loglikelihood requests:  20%|██        | 80/400 [01:13<05:12,  1.02it/s]Running loglikelihood requests:  20%|██        | 81/400 [01:14<05:15,  1.01it/s]Running loglikelihood requests:  20%|██        | 82/400 [01:15<05:17,  1.00it/s]Running loglikelihood requests:  21%|██        | 83/400 [01:16<05:19,  1.01s/it]Running loglikelihood requests:  21%|██        | 84/400 [01:17<05:19,  1.01s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [01:18<05:19,  1.02s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [01:19<04:05,  1.27it/s]Running loglikelihood requests:  22%|██▏       | 88/400 [01:20<04:27,  1.17it/s]Running loglikelihood requests:  22%|██▏       | 89/400 [01:22<04:48,  1.08it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [01:23<04:54,  1.05it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [01:24<05:11,  1.01s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [01:25<05:14,  1.02s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [01:26<04:02,  1.26it/s]Running loglikelihood requests:  24%|██▍       | 95/400 [01:27<04:25,  1.15it/s]Running loglikelihood requests:  24%|██▍       | 96/400 [01:28<04:39,  1.09it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [01:29<03:44,  1.34it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [01:30<03:17,  1.52it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [01:31<03:01,  1.64it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [01:32<03:25,  1.44it/s]Running loglikelihood requests:  26%|██▌       | 104/400 [01:33<03:45,  1.31it/s]Running loglikelihood requests:  27%|██▋       | 107/400 [01:34<02:42,  1.80it/s]Running loglikelihood requests:  27%|██▋       | 108/400 [01:35<03:07,  1.56it/s]Running loglikelihood requests:  27%|██▋       | 109/400 [01:36<03:29,  1.39it/s]Running loglikelihood requests:  28%|██▊       | 110/400 [01:37<03:48,  1.27it/s]Running loglikelihood requests:  28%|██▊       | 111/400 [01:38<04:03,  1.19it/s]Running loglikelihood requests:  28%|██▊       | 112/400 [01:39<04:15,  1.13it/s]Running loglikelihood requests:  28%|██▊       | 113/400 [01:40<04:24,  1.09it/s]Running loglikelihood requests:  28%|██▊       | 114/400 [01:41<04:30,  1.06it/s]Running loglikelihood requests:  29%|██▉       | 116/400 [01:42<03:32,  1.34it/s]Running loglikelihood requests:  29%|██▉       | 117/400 [01:43<03:51,  1.22it/s]Running loglikelihood requests:  30%|██▉       | 118/400 [01:44<04:10,  1.12it/s]Running loglikelihood requests:  30%|███       | 121/400 [01:45<02:47,  1.67it/s]Running loglikelihood requests:  30%|███       | 122/400 [01:46<03:09,  1.47it/s]Running loglikelihood requests:  31%|███       | 123/400 [01:47<03:28,  1.33it/s]Running loglikelihood requests:  31%|███       | 124/400 [01:48<03:45,  1.22it/s]Running loglikelihood requests:  31%|███▏      | 125/400 [01:49<03:56,  1.16it/s]Running loglikelihood requests:  32%|███▏      | 126/400 [01:50<04:04,  1.12it/s]Running loglikelihood requests:  32%|███▏      | 127/400 [01:51<04:10,  1.09it/s]Running loglikelihood requests:  32%|███▏      | 128/400 [01:52<04:14,  1.07it/s]Running loglikelihood requests:  32%|███▎      | 130/400 [01:53<03:19,  1.36it/s]Running loglikelihood requests:  33%|███▎      | 132/400 [01:54<02:51,  1.56it/s]Running loglikelihood requests:  33%|███▎      | 133/400 [01:55<03:11,  1.40it/s]Running loglikelihood requests:  34%|███▎      | 134/400 [01:56<03:29,  1.27it/s]Running loglikelihood requests:  34%|███▍      | 135/400 [01:57<03:41,  1.19it/s]Running loglikelihood requests:  34%|███▍      | 136/400 [01:58<03:50,  1.15it/s]Running loglikelihood requests:  34%|███▍      | 137/400 [01:59<03:56,  1.11it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [02:00<04:00,  1.09it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [02:01<04:03,  1.07it/s]Running loglikelihood requests:  35%|███▌      | 140/400 [02:02<04:05,  1.06it/s]Running loglikelihood requests:  35%|███▌      | 141/400 [02:03<04:06,  1.05it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [02:04<04:06,  1.05it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [02:05<04:06,  1.04it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [02:06<03:08,  1.35it/s]Running loglikelihood requests:  36%|███▋      | 146/400 [02:07<03:22,  1.26it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [02:08<03:32,  1.19it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [02:09<03:41,  1.14it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [02:10<03:47,  1.10it/s]Running loglikelihood requests:  38%|███▊      | 150/400 [02:11<03:55,  1.06it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [02:12<03:04,  1.35it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [02:13<03:18,  1.24it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [02:14<03:27,  1.18it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [02:15<03:35,  1.14it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [02:16<02:51,  1.41it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [02:17<03:05,  1.30it/s]Running loglikelihood requests:  40%|████      | 160/400 [02:18<02:36,  1.53it/s]Running loglikelihood requests:  40%|████      | 161/400 [02:19<02:52,  1.38it/s]Running loglikelihood requests:  40%|████      | 162/400 [02:20<03:06,  1.28it/s]Running loglikelihood requests:  41%|████      | 163/400 [02:21<03:18,  1.19it/s]Running loglikelihood requests:  41%|████▏     | 165/400 [02:22<02:41,  1.46it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [02:23<02:55,  1.33it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [02:24<03:07,  1.25it/s]Running loglikelihood requests:  42%|████▏     | 168/400 [02:24<03:15,  1.18it/s]Running loglikelihood requests:  42%|████▎     | 170/400 [02:25<02:38,  1.45it/s]Running loglikelihood requests:  43%|████▎     | 171/400 [02:26<02:52,  1.33it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [02:27<03:03,  1.24it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [02:28<03:11,  1.18it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [02:29<03:19,  1.13it/s]Running loglikelihood requests:  44%|████▍     | 175/400 [02:30<03:25,  1.10it/s]Running loglikelihood requests:  44%|████▍     | 176/400 [02:31<03:34,  1.04it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [02:32<02:48,  1.32it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [02:33<02:57,  1.25it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [02:34<03:04,  1.19it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [02:35<03:20,  1.09it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [02:36<02:37,  1.38it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [02:37<02:47,  1.29it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [02:38<01:56,  1.84it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [02:39<02:11,  1.61it/s]Running loglikelihood requests:  47%|████▋     | 189/400 [02:40<02:25,  1.45it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [02:41<02:36,  1.34it/s]Running loglikelihood requests:  48%|████▊     | 191/400 [02:42<02:45,  1.26it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [02:43<02:53,  1.20it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [02:44<02:59,  1.15it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [02:45<03:03,  1.13it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [02:46<02:31,  1.35it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [02:47<02:39,  1.27it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [02:48<02:46,  1.21it/s]Running loglikelihood requests:  50%|████▉     | 199/400 [02:49<02:56,  1.14it/s]Running loglikelihood requests:  50%|█████     | 200/400 [02:50<02:58,  1.12it/s]Running loglikelihood requests:  50%|█████     | 202/400 [02:51<02:19,  1.42it/s]Running loglikelihood requests:  51%|█████     | 203/400 [02:52<02:34,  1.27it/s]Running loglikelihood requests:  51%|█████     | 204/400 [02:53<02:42,  1.21it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [02:54<02:47,  1.16it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [02:55<02:50,  1.14it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [02:55<02:52,  1.12it/s]Running loglikelihood requests:  52%|█████▎    | 210/400 [02:56<01:49,  1.74it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [02:57<01:41,  1.85it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [02:58<01:55,  1.62it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [02:59<01:45,  1.75it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [03:00<01:58,  1.55it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [03:01<02:10,  1.40it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [03:02<01:51,  1.62it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [03:03<02:03,  1.46it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [03:04<02:14,  1.34it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [03:05<02:22,  1.25it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [03:06<02:28,  1.19it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [03:07<02:31,  1.16it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [03:08<02:38,  1.10it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [03:09<02:39,  1.09it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [03:10<02:39,  1.09it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [03:11<02:39,  1.08it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [03:12<02:39,  1.07it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [03:13<02:38,  1.07it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [03:13<02:37,  1.07it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [03:14<02:36,  1.07it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [03:15<02:35,  1.07it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [03:16<01:58,  1.39it/s]Running loglikelihood requests:  59%|█████▉    | 236/400 [03:17<02:07,  1.28it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [03:18<02:13,  1.22it/s]Running loglikelihood requests:  60%|█████▉    | 238/400 [03:19<02:17,  1.18it/s]Running loglikelihood requests:  60%|█████▉    | 239/400 [03:20<02:20,  1.15it/s]Running loglikelihood requests:  60%|██████    | 240/400 [03:21<02:21,  1.13it/s]Running loglikelihood requests:  60%|██████    | 242/400 [03:22<01:50,  1.43it/s]Running loglikelihood requests:  61%|██████    | 243/400 [03:23<01:59,  1.32it/s]Running loglikelihood requests:  61%|██████    | 244/400 [03:24<02:06,  1.24it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [03:25<02:11,  1.18it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [03:26<02:13,  1.15it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [03:27<02:16,  1.12it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [03:28<01:45,  1.43it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [03:28<01:52,  1.33it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [03:29<01:58,  1.26it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [03:30<02:02,  1.20it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [03:31<02:05,  1.17it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [03:32<02:07,  1.14it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [03:33<02:08,  1.12it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [03:34<02:09,  1.11it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [03:35<02:09,  1.10it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [03:36<02:09,  1.10it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [03:37<01:38,  1.42it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [03:38<01:45,  1.32it/s]Running loglikelihood requests:  66%|██████▌   | 264/400 [03:39<01:11,  1.90it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [03:40<01:21,  1.65it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [03:40<01:30,  1.48it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [03:41<01:37,  1.37it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [03:42<01:42,  1.28it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [03:43<01:46,  1.23it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [03:44<01:49,  1.19it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [03:45<01:51,  1.16it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [03:46<01:52,  1.14it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [03:47<01:53,  1.12it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [03:48<01:53,  1.11it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [03:49<01:09,  1.76it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [03:50<01:03,  1.89it/s]Running loglikelihood requests:  70%|███████   | 281/400 [03:50<01:00,  1.98it/s]Running loglikelihood requests:  71%|███████   | 284/400 [03:51<00:48,  2.37it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [03:52<00:57,  1.99it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [03:53<01:06,  1.72it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [03:54<01:13,  1.53it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [03:55<01:19,  1.40it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [03:56<01:24,  1.31it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [03:57<01:28,  1.25it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [03:58<01:34,  1.15it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [03:59<01:13,  1.45it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [04:00<01:18,  1.34it/s]Running loglikelihood requests:  74%|███████▍  | 295/400 [04:01<01:22,  1.27it/s]Running loglikelihood requests:  74%|███████▍  | 296/400 [04:02<01:25,  1.22it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [04:03<01:27,  1.18it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [04:03<01:09,  1.46it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [04:04<01:13,  1.35it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [04:05<01:17,  1.28it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [04:06<01:20,  1.22it/s]Running loglikelihood requests:  76%|███████▌  | 304/400 [04:07<01:03,  1.51it/s]Running loglikelihood requests:  76%|███████▋  | 305/400 [04:08<01:08,  1.39it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [04:09<00:57,  1.63it/s]Running loglikelihood requests:  77%|███████▋  | 309/400 [04:10<00:50,  1.80it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [04:11<00:56,  1.60it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [04:12<01:01,  1.45it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [04:13<01:05,  1.34it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [04:13<01:08,  1.27it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [04:14<00:55,  1.52it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [04:15<00:48,  1.72it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [04:16<00:53,  1.54it/s]Running loglikelihood requests:  80%|███████▉  | 319/400 [04:17<00:57,  1.41it/s]Running loglikelihood requests:  80%|████████  | 321/400 [04:18<00:48,  1.65it/s]Running loglikelihood requests:  81%|████████  | 323/400 [04:19<00:42,  1.81it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [04:20<00:32,  2.26it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [04:21<00:38,  1.92it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [04:22<00:43,  1.67it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [04:23<00:47,  1.50it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [04:23<00:50,  1.39it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [04:24<00:41,  1.64it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [04:25<00:45,  1.48it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [04:26<00:48,  1.37it/s]Running loglikelihood requests:  84%|████████▍ | 335/400 [04:27<00:50,  1.29it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [04:28<00:51,  1.24it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [04:29<00:52,  1.20it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [04:30<00:58,  1.06it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [04:31<00:56,  1.07it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [04:32<00:55,  1.08it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [04:33<00:53,  1.10it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [04:34<00:51,  1.13it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [04:34<00:49,  1.15it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [04:35<00:29,  1.86it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [04:36<00:25,  2.02it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [04:37<00:28,  1.78it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [04:38<00:31,  1.61it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [04:39<00:32,  1.49it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [04:39<00:34,  1.41it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [04:40<00:34,  1.35it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [04:41<00:35,  1.30it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [04:42<00:35,  1.26it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [04:43<00:35,  1.24it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [04:44<00:26,  1.59it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [04:44<00:27,  1.48it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [04:45<00:28,  1.40it/s]Running loglikelihood requests:  90%|█████████ | 361/400 [04:46<00:29,  1.34it/s]Running loglikelihood requests:  90%|█████████ | 362/400 [04:47<00:29,  1.30it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [04:48<00:22,  1.60it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [04:49<00:24,  1.45it/s]Running loglikelihood requests:  92%|█████████▏| 367/400 [04:50<00:19,  1.72it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [04:50<00:20,  1.57it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [04:51<00:21,  1.47it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [04:52<00:21,  1.39it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [04:53<00:21,  1.33it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [04:54<00:16,  1.66it/s]Running loglikelihood requests:  94%|█████████▍| 375/400 [04:55<00:13,  1.89it/s]Running loglikelihood requests:  94%|█████████▍| 376/400 [04:55<00:14,  1.69it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [04:56<00:09,  2.28it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [04:57<00:08,  2.33it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [04:58<00:09,  1.99it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [04:59<00:07,  2.12it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [04:59<00:06,  2.22it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [05:00<00:06,  1.92it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [05:01<00:05,  2.08it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [05:02<00:04,  2.18it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [05:03<00:03,  2.26it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [05:04<00:02,  2.32it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [05:04<00:01,  2.36it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [05:05<00:00,  2.02it/s]Running loglikelihood requests: 100%|██████████| 400/400 [05:06<00:00,  2.15it/s]Running loglikelihood requests: 100%|██████████| 400/400 [05:06<00:00,  1.31it/s]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'mastermind_24_easy': {'alias': 'mastermind_24_easy', 'acc,none': 0.33, 'acc_stderr,none': 0.04725815626252609}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9705388716727775
0.9880227828623074
0.982119607496995
0.9941469535767887
0.984917378949356
0.9883609317461776
0.9752442385272352
0.9858149677985593
0.9966001900863091
0.9954965780195978
0.9982374916142641
0.987839947084121
0.9740425263242771
0.9802324544963317
0.9965978314947238
0.9890806289155061
0.971808392501808
0.9767123038440666
0.9820534501654181
0.9672299205809463
0.9753579231968917
0.9973837437819523
0.9951994747100236
0.9465102818948206
0.9757933184251313
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 0, 1, 3, 7, 5, 4, 2]
tensor([6, 0, 1, 3, 7, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 0, 1, 3, 7, 5, 4, 2]
tensor([6, 0, 1, 3, 7, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 2, 3, 6, 5, 4, 1]
tensor([7, 0, 2, 3, 6, 5, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 5
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 6 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 5 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

101
cuda:3
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 35.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 39.18s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 139646748844032 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139646748844032 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646748844032 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 139646748844032 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 139645835387840 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139645835387840 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645835387840 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 139645835387840 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 131937.84it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<09:08,  1.83s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<07:18,  1.47s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:13,  1.17it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:04<04:21,  1.13it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:05<03:19,  1.47it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:06<03:33,  1.37it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:07<02:54,  1.66it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:08<03:11,  1.51it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:09<02:40,  1.79it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:10<02:55,  1.63it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:10<02:28,  1.92it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:11<02:41,  1.75it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:12<02:53,  1.63it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:13<02:25,  1.93it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:13<02:38,  1.76it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:14<02:16,  2.03it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:15<02:04,  2.21it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:16<02:19,  1.97it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:16<02:03,  2.19it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:17<02:18,  1.95it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:18<02:31,  1.78it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:18<02:41,  1.66it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:19<02:49,  1.58it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:20<02:17,  1.93it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:21<02:00,  2.19it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:21<01:50,  2.36it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:22<01:43,  2.50it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:23<01:58,  2.18it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:23<02:11,  1.96it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:24<02:23,  1.80it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:25<02:00,  2.11it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:26<01:48,  2.32it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:26<02:02,  2.06it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:27<01:48,  2.30it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:28<01:40,  2.48it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:28<01:57,  2.11it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:29<02:08,  1.92it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:30<02:17,  1.79it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:30<01:54,  2.12it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:31<01:42,  2.36it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:32<01:34,  2.53it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:33<01:47,  2.22it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:33<01:36,  2.44it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:34<01:48,  2.16it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:35<01:59,  1.96it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:35<02:07,  1.82it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:36<01:46,  2.17it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:37<01:34,  2.42it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:37<01:46,  2.15it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:38<01:56,  1.95it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:39<01:39,  2.27it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:39<01:29,  2.50it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:40<01:23,  2.66it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:41<01:34,  2.32it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:41<01:45,  2.08it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:42<01:53,  1.92it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:43<02:07,  1.70it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:43<01:43,  2.08it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:44<01:51,  1.92it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:45<01:33,  2.26it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:45<01:43,  2.04it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:46<01:28,  2.35it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:47<01:20,  2.57it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:47<01:15,  2.72it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:48<01:26,  2.37it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:48<01:18,  2.59it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:49<01:28,  2.28it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:50<01:18,  2.53it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:50<01:28,  2.24it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:51<01:36,  2.03it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:52<01:43,  1.90it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:52<01:48,  1.80it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:53<01:27,  2.20it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:54<01:35,  2.01it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:54<01:41,  1.88it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:55<01:23,  2.25it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:56<01:14,  2.52it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:56<01:08,  2.71it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:57<01:04,  2.85it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:57<01:01,  2.94it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:58<00:59,  3.01it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:59<01:08,  2.59it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [00:59<01:03,  2.77it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [01:00<01:12,  2.42it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:01<01:19,  2.18it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:01<01:25,  2.01it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:02<01:11,  2.38it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:02<01:04,  2.63it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:03<00:58,  2.83it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:04<01:11,  2.33it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:04<01:17,  2.13it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:05<01:22,  1.99it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:06<01:26,  1.88it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:07<01:43,  1.56it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:07<01:18,  2.03it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:08<01:06,  2.39it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:08<01:11,  2.20it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:09<01:01,  2.53it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:09<01:07,  2.29it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:10<01:13,  2.09it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:11<01:18,  1.94it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:11<01:03,  2.36it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:12<00:55,  2.67it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:12<00:50,  2.89it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:13<00:56,  2.55it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:14<00:50,  2.80it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:14<00:47,  2.99it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:15<00:44,  3.12it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:15<00:51,  2.70it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:16<00:46,  2.92it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:17<00:52,  2.57it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:17<00:46,  2.84it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:18<00:44,  2.95it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:18<00:50,  2.59it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:19<00:54,  2.35it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:19<00:58,  2.17it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:20<01:02,  2.05it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:21<00:50,  2.48it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:21<00:43,  2.80it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:22<00:40,  3.02it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:22<00:45,  2.65it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:23<00:49,  2.38it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:23<00:42,  2.73it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:24<00:38,  2.98it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:25<00:46,  2.43it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:25<00:40,  2.76it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:26<00:36,  2.99it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:26<00:41,  2.64it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:27<00:44,  2.40it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:27<00:38,  2.76it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:28<00:42,  2.48it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:29<00:45,  2.28it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:29<00:37,  2.69it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:30<00:41,  2.43it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:30<00:44,  2.25it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:31<00:46,  2.13it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:31<00:37,  2.59it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:32<00:32,  2.91it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:32<00:36,  2.60it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:33<00:31,  2.92it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:33<00:28,  3.15it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:34<00:26,  3.30it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:35<00:30,  2.88it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:35<00:27,  3.13it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:36<00:30,  2.75it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:36<00:33,  2.48it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:37<00:28,  2.86it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:37<00:25,  3.12it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:38<00:28,  2.75it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:38<00:24,  3.05it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:39<00:27,  2.71it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:39<00:24,  3.03it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:40<00:26,  2.70it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:40<00:28,  2.46it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:41<00:24,  2.86it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:41<00:26,  2.58it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:42<00:28,  2.38it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:43<00:30,  2.19it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:43<00:31,  2.04it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:44<00:32,  2.00it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:44<00:31,  1.97it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:45<00:31,  1.96it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:45<00:23,  2.51it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:46<00:20,  2.90it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:46<00:17,  3.18it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:47<00:15,  3.38it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:47<00:14,  3.53it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:48<00:13,  3.63it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:48<00:12,  3.69it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:49<00:12,  3.74it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:49<00:11,  3.79it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:50<00:13,  3.25it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:50<00:14,  2.87it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:51<00:12,  3.19it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:51<00:13,  2.84it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:52<00:11,  3.17it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:52<00:12,  2.82it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:53<00:13,  2.54it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:53<00:14,  2.36it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:54<00:11,  2.82it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:54<00:09,  3.15it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:55<00:08,  3.39it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:55<00:07,  3.57it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:56<00:08,  3.11it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:56<00:06,  3.35it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:57<00:07,  2.97it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:57<00:07,  2.71it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:58<00:06,  3.13it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:58<00:06,  2.82it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:59<00:06,  2.60it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:59<00:06,  2.44it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [02:00<00:04,  2.96it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [02:00<00:03,  3.33it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [02:01<00:02,  3.59it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [02:01<00:02,  3.80it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [02:02<00:02,  3.32it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:02<00:02,  2.98it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:03<00:01,  3.38it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:03<00:00,  3.70it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:04<00:00,  3.28it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:04<00:00,  2.42it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 5 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.5127 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 4 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

18
cuda:4
cb
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.02s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: cb] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:filelock:Attempting to acquire lock 139646763106128 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646763106128 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646763106128 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646763106128 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139645850120464 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139645850120464 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645850120464 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139645850120464 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cb from None to 0
INFO:lm_eval.api.task:Building contexts for cb on rank 0...
  0%|          | 0/56 [00:00<?, ?it/s]100%|██████████| 56/56 [00:00<00:00, 2160.72it/s]
DEBUG:lm_eval.evaluator:Task: cb; number of requests on this rank: 168
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/168 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/168 [00:02<06:20,  2.28s/it]Running loglikelihood requests:   1%|          | 2/168 [00:03<05:21,  1.94s/it]Running loglikelihood requests:   2%|▏         | 4/168 [00:05<03:24,  1.25s/it]Running loglikelihood requests:   3%|▎         | 5/168 [00:07<03:46,  1.39s/it]Running loglikelihood requests:   4%|▍         | 7/168 [00:08<02:54,  1.08s/it]Running loglikelihood requests:   5%|▍         | 8/168 [00:10<03:08,  1.18s/it]Running loglikelihood requests:   6%|▌         | 10/168 [00:11<02:28,  1.06it/s]Running loglikelihood requests:   7%|▋         | 11/168 [00:12<02:38,  1.01s/it]Running loglikelihood requests:   8%|▊         | 13/168 [00:13<02:10,  1.19it/s]Running loglikelihood requests:   8%|▊         | 14/168 [00:15<02:20,  1.09it/s]Running loglikelihood requests:  10%|▉         | 16/168 [00:16<01:59,  1.27it/s]Running loglikelihood requests:  10%|█         | 17/168 [00:17<02:11,  1.15it/s]Running loglikelihood requests:  11%|█▏        | 19/168 [00:18<01:51,  1.34it/s]Running loglikelihood requests:  12%|█▏        | 20/168 [00:19<02:01,  1.22it/s]Running loglikelihood requests:  13%|█▎        | 22/168 [00:20<01:43,  1.41it/s]Running loglikelihood requests:  14%|█▎        | 23/168 [00:21<01:52,  1.29it/s]Running loglikelihood requests:  15%|█▍        | 25/168 [00:22<01:36,  1.48it/s]Running loglikelihood requests:  15%|█▌        | 26/168 [00:23<01:46,  1.34it/s]Running loglikelihood requests:  17%|█▋        | 28/168 [00:24<01:31,  1.53it/s]Running loglikelihood requests:  17%|█▋        | 29/168 [00:25<01:40,  1.38it/s]Running loglikelihood requests:  18%|█▊        | 31/168 [00:26<01:27,  1.57it/s]Running loglikelihood requests:  19%|█▉        | 32/168 [00:27<01:36,  1.41it/s]Running loglikelihood requests:  20%|█▉        | 33/168 [00:28<01:44,  1.29it/s]Running loglikelihood requests:  21%|██        | 35/168 [00:29<01:27,  1.52it/s]Running loglikelihood requests:  22%|██▏       | 37/168 [00:30<01:18,  1.68it/s]Running loglikelihood requests:  23%|██▎       | 38/168 [00:31<01:27,  1.49it/s]Running loglikelihood requests:  24%|██▍       | 40/168 [00:32<01:16,  1.67it/s]Running loglikelihood requests:  24%|██▍       | 41/168 [00:33<01:25,  1.49it/s]Running loglikelihood requests:  26%|██▌       | 43/168 [00:34<01:14,  1.68it/s]Running loglikelihood requests:  26%|██▌       | 44/168 [00:35<01:22,  1.50it/s]Running loglikelihood requests:  27%|██▋       | 46/168 [00:36<01:11,  1.70it/s]Running loglikelihood requests:  28%|██▊       | 47/168 [00:37<01:22,  1.47it/s]Running loglikelihood requests:  29%|██▉       | 49/168 [00:38<01:10,  1.70it/s]Running loglikelihood requests:  30%|██▉       | 50/168 [00:39<01:16,  1.54it/s]Running loglikelihood requests:  30%|███       | 51/168 [00:39<01:21,  1.43it/s]Running loglikelihood requests:  31%|███       | 52/168 [00:40<01:26,  1.35it/s]Running loglikelihood requests:  32%|███▏      | 54/168 [00:41<01:09,  1.63it/s]Running loglikelihood requests:  33%|███▎      | 56/168 [00:42<01:01,  1.83it/s]Running loglikelihood requests:  35%|███▍      | 58/168 [00:43<00:55,  1.97it/s]Running loglikelihood requests:  35%|███▌      | 59/168 [00:44<01:02,  1.74it/s]Running loglikelihood requests:  36%|███▌      | 60/168 [00:45<01:09,  1.57it/s]Running loglikelihood requests:  37%|███▋      | 62/168 [00:45<00:59,  1.80it/s]Running loglikelihood requests:  38%|███▊      | 64/168 [00:46<00:53,  1.96it/s]Running loglikelihood requests:  39%|███▊      | 65/168 [00:47<00:59,  1.73it/s]Running loglikelihood requests:  40%|███▉      | 67/168 [00:48<00:52,  1.92it/s]Running loglikelihood requests:  40%|████      | 68/168 [00:49<00:58,  1.70it/s]Running loglikelihood requests:  42%|████▏     | 70/168 [00:50<00:51,  1.90it/s]Running loglikelihood requests:  42%|████▏     | 71/168 [00:51<00:57,  1.69it/s]Running loglikelihood requests:  43%|████▎     | 73/168 [00:51<00:49,  1.91it/s]Running loglikelihood requests:  44%|████▍     | 74/168 [00:52<00:55,  1.70it/s]Running loglikelihood requests:  45%|████▍     | 75/168 [00:53<01:00,  1.55it/s]Running loglikelihood requests:  45%|████▌     | 76/168 [00:54<01:03,  1.45it/s]Running loglikelihood requests:  46%|████▋     | 78/168 [00:55<00:51,  1.74it/s]Running loglikelihood requests:  48%|████▊     | 80/168 [00:55<00:45,  1.95it/s]Running loglikelihood requests:  49%|████▉     | 82/168 [00:56<00:41,  2.09it/s]Running loglikelihood requests:  49%|████▉     | 83/168 [00:57<00:46,  1.83it/s]Running loglikelihood requests:  51%|█████     | 85/168 [00:58<00:41,  2.02it/s]Running loglikelihood requests:  51%|█████     | 86/168 [00:59<00:45,  1.80it/s]Running loglikelihood requests:  52%|█████▏    | 88/168 [00:59<00:39,  2.01it/s]Running loglikelihood requests:  53%|█████▎    | 89/168 [01:00<00:44,  1.79it/s]Running loglikelihood requests:  54%|█████▎    | 90/168 [01:01<00:47,  1.64it/s]Running loglikelihood requests:  55%|█████▍    | 92/168 [01:02<00:39,  1.90it/s]Running loglikelihood requests:  56%|█████▌    | 94/168 [01:03<00:35,  2.10it/s]Running loglikelihood requests:  57%|█████▋    | 95/168 [01:03<00:39,  1.87it/s]Running loglikelihood requests:  58%|█████▊    | 97/168 [01:04<00:34,  2.08it/s]Running loglikelihood requests:  58%|█████▊    | 98/168 [01:05<00:37,  1.85it/s]Running loglikelihood requests:  60%|█████▉    | 100/168 [01:06<00:32,  2.08it/s]Running loglikelihood requests:  60%|██████    | 101/168 [01:06<00:36,  1.86it/s]Running loglikelihood requests:  61%|██████▏   | 103/168 [01:07<00:30,  2.10it/s]Running loglikelihood requests:  62%|██████▏   | 104/168 [01:08<00:34,  1.88it/s]Running loglikelihood requests:  62%|██████▎   | 105/168 [01:09<00:36,  1.72it/s]Running loglikelihood requests:  63%|██████▎   | 106/168 [01:09<00:38,  1.61it/s]Running loglikelihood requests:  64%|██████▍   | 108/168 [01:10<00:30,  1.94it/s]Running loglikelihood requests:  65%|██████▌   | 110/168 [01:11<00:26,  2.17it/s]Running loglikelihood requests:  66%|██████▌   | 111/168 [01:12<00:29,  1.93it/s]Running loglikelihood requests:  67%|██████▋   | 113/168 [01:12<00:25,  2.16it/s]Running loglikelihood requests:  68%|██████▊   | 114/168 [01:13<00:28,  1.92it/s]Running loglikelihood requests:  69%|██████▉   | 116/168 [01:14<00:24,  2.16it/s]Running loglikelihood requests:  70%|███████   | 118/168 [01:15<00:21,  2.34it/s]Running loglikelihood requests:  71%|███████   | 119/168 [01:15<00:23,  2.05it/s]Running loglikelihood requests:  71%|███████▏  | 120/168 [01:16<00:25,  1.85it/s]Running loglikelihood requests:  73%|███████▎  | 122/168 [01:17<00:21,  2.12it/s]Running loglikelihood requests:  74%|███████▍  | 124/168 [01:17<00:18,  2.32it/s]Running loglikelihood requests:  74%|███████▍  | 125/168 [01:18<00:21,  2.04it/s]Running loglikelihood requests:  76%|███████▌  | 127/168 [01:19<00:18,  2.27it/s]Running loglikelihood requests:  76%|███████▌  | 128/168 [01:20<00:19,  2.01it/s]Running loglikelihood requests:  77%|███████▋  | 129/168 [01:20<00:21,  1.84it/s]Running loglikelihood requests:  78%|███████▊  | 131/168 [01:21<00:17,  2.13it/s]Running loglikelihood requests:  79%|███████▉  | 133/168 [01:22<00:14,  2.38it/s]Running loglikelihood requests:  80%|███████▉  | 134/168 [01:22<00:16,  2.11it/s]Running loglikelihood requests:  81%|████████  | 136/168 [01:23<00:13,  2.38it/s]Running loglikelihood requests:  82%|████████▏ | 137/168 [01:24<00:14,  2.10it/s]Running loglikelihood requests:  82%|████████▏ | 138/168 [01:24<00:15,  1.93it/s]Running loglikelihood requests:  83%|████████▎ | 139/168 [01:25<00:16,  1.81it/s]Running loglikelihood requests:  83%|████████▎ | 140/168 [01:26<00:16,  1.73it/s]Running loglikelihood requests:  85%|████████▍ | 142/168 [01:26<00:12,  2.12it/s]Running loglikelihood requests:  86%|████████▌ | 144/168 [01:27<00:10,  2.40it/s]Running loglikelihood requests:  87%|████████▋ | 146/168 [01:28<00:08,  2.59it/s]Running loglikelihood requests:  88%|████████▊ | 148/168 [01:28<00:07,  2.74it/s]Running loglikelihood requests:  89%|████████▊ | 149/168 [01:29<00:07,  2.40it/s]Running loglikelihood requests:  89%|████████▉ | 150/168 [01:30<00:08,  2.15it/s]Running loglikelihood requests:  90%|█████████ | 152/168 [01:30<00:06,  2.44it/s]Running loglikelihood requests:  92%|█████████▏| 154/168 [01:31<00:05,  2.65it/s]Running loglikelihood requests:  92%|█████████▏| 155/168 [01:32<00:06,  2.14it/s]Running loglikelihood requests:  93%|█████████▎| 157/168 [01:32<00:04,  2.39it/s]Running loglikelihood requests:  94%|█████████▍| 158/168 [01:33<00:04,  2.17it/s]Running loglikelihood requests:  95%|█████████▌| 160/168 [01:34<00:03,  2.51it/s]Running loglikelihood requests:  96%|█████████▌| 161/168 [01:34<00:03,  2.30it/s]Running loglikelihood requests:  97%|█████████▋| 163/168 [01:35<00:01,  2.65it/s]Running loglikelihood requests:  98%|█████████▊| 164/168 [01:35<00:01,  2.41it/s]Running loglikelihood requests:  99%|█████████▉| 166/168 [01:36<00:00,  2.76it/s]Running loglikelihood requests:  99%|█████████▉| 167/168 [01:36<00:00,  2.48it/s]Running loglikelihood requests: 100%|██████████| 168/168 [01:36<00:00,  1.73it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'cb': {'alias': 'cb', 'acc,none': 0.44642857142857145, 'acc_stderr,none': 0.06703189227942397, 'f1,none': np.float64(0.2946127946127946), 'f1_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8754479021250823
0.8035282713865031
0.9500865550679058
0.9469110267801961
0.9212663689239236
0.9365178765256775
0.671589453090406
0.6744336218334667
0.8076345549626031
0.7976470386087894
0.807072393829993
0.6600400889592184
0.7484904863798857
0.9363063771008698
0.6357711114598822
0.9166089836828051
0.6715835426958833
0.7409884813902188
0.412428535140908
0.8747283305135303
0.8491219158212996
0.9125101690232402
0.8366676259845086
0.705936129020536
0.7920385356495101
0.9243830461584077
0.9274604399644588
0.7835428130351293
0.8119111717866335
Total groups 67 exceeded the threshold, stopping comparison.
The group tensor is
[6, 3, 5, 2, 7, 1, 4, 0]
tensor([6, 3, 5, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 7, 3, 6, 1, 2, 0]
tensor([5, 4, 7, 3, 6, 1, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 1, 6, 3, 7, 2, 4, 0]
tensor([5, 1, 6, 3, 7, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 2, 0, 1, 5, 0, 1, 3]
tensor([4, 2, 0, 1, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 3, 0, 2, 1, 1, 5, 0]
tensor([4, 3, 0, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 2 to 6
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 12
done!
Normal merging for layer 13
tensor([2, 5])
tensor(2)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 14
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 15 to 18
done!
Normal merging for layer 19
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 20 to 23
done!
Normal merging for layer 24
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 4 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 3 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

99
cuda:5
mastermind_46_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.73s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 778
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_46_mcq_random/flair/mastermind_46_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139646838841248 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139646838841248 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646838841248 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139646838841248 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Attempting to acquire lock 139646838841248 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139646838841248 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646838841248 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139646838841248 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_46_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_46_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1491.33it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_46_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:02<13:19,  2.00s/it]Running loglikelihood requests:   0%|          | 2/400 [00:03<11:11,  1.69s/it]Running loglikelihood requests:   1%|          | 3/400 [00:04<10:30,  1.59s/it]Running loglikelihood requests:   1%|          | 4/400 [00:06<10:09,  1.54s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:07<09:57,  1.51s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:09<09:48,  1.49s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:10<09:41,  1.48s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:12<09:37,  1.47s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:13<09:34,  1.47s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:15<09:40,  1.49s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:16<09:33,  1.47s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:18<09:29,  1.47s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:19<09:26,  1.46s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:21<09:23,  1.46s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:22<09:20,  1.45s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:23<09:17,  1.45s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:25<09:15,  1.45s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:26<09:13,  1.45s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:28<09:14,  1.45s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:29<09:11,  1.45s/it]Running loglikelihood requests:   5%|▌         | 21/400 [00:31<09:17,  1.47s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:32<09:12,  1.46s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:34<09:08,  1.46s/it]Running loglikelihood requests:   6%|▌         | 24/400 [00:35<09:05,  1.45s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:36<09:02,  1.45s/it]Running loglikelihood requests:   6%|▋         | 26/400 [00:38<09:00,  1.44s/it]Running loglikelihood requests:   7%|▋         | 27/400 [00:39<08:57,  1.44s/it]Running loglikelihood requests:   7%|▋         | 28/400 [00:41<08:55,  1.44s/it]Running loglikelihood requests:   7%|▋         | 29/400 [00:42<08:53,  1.44s/it]Running loglikelihood requests:   8%|▊         | 30/400 [00:44<08:51,  1.44s/it]Running loglikelihood requests:   8%|▊         | 31/400 [00:45<08:49,  1.44s/it]Running loglikelihood requests:   8%|▊         | 32/400 [00:47<08:49,  1.44s/it]Running loglikelihood requests:   8%|▊         | 33/400 [00:48<08:47,  1.44s/it]Running loglikelihood requests:   8%|▊         | 34/400 [00:49<08:45,  1.43s/it]Running loglikelihood requests:   9%|▉         | 35/400 [00:51<08:42,  1.43s/it]Running loglikelihood requests:   9%|▉         | 36/400 [00:52<08:41,  1.43s/it]Running loglikelihood requests:   9%|▉         | 37/400 [00:54<08:39,  1.43s/it]Running loglikelihood requests:  10%|▉         | 38/400 [00:55<08:37,  1.43s/it]Running loglikelihood requests:  10%|▉         | 39/400 [00:57<08:35,  1.43s/it]Running loglikelihood requests:  10%|█         | 40/400 [00:58<08:33,  1.43s/it]Running loglikelihood requests:  10%|█         | 41/400 [00:59<08:32,  1.43s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:01<08:30,  1.43s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:02<08:28,  1.42s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:04<08:26,  1.42s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:05<08:25,  1.42s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:07<08:23,  1.42s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:08<08:22,  1.42s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:09<08:20,  1.42s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:11<08:18,  1.42s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:12<08:17,  1.42s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [01:14<08:15,  1.42s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [01:15<08:14,  1.42s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [01:16<08:12,  1.42s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [01:18<08:10,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [01:19<08:08,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 56/400 [01:21<08:08,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [01:22<08:06,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [01:24<08:04,  1.42s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [01:25<08:02,  1.42s/it]Running loglikelihood requests:  15%|█▌        | 60/400 [01:26<08:01,  1.41s/it]Running loglikelihood requests:  15%|█▌        | 61/400 [01:28<07:59,  1.41s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [01:29<07:58,  1.41s/it]Running loglikelihood requests:  16%|█▌        | 63/400 [01:31<07:56,  1.41s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [01:32<07:55,  1.42s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [01:33<07:54,  1.42s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [01:35<07:58,  1.43s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [01:36<07:55,  1.43s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [01:38<07:52,  1.42s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [01:39<07:50,  1.42s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [01:41<05:59,  1.09s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [01:42<06:24,  1.17s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [01:43<06:45,  1.24s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [01:45<06:59,  1.29s/it]Running loglikelihood requests:  19%|█▉        | 75/400 [01:46<07:09,  1.32s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [01:48<07:16,  1.35s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [01:49<07:20,  1.36s/it]Running loglikelihood requests:  20%|█▉        | 78/400 [01:50<07:23,  1.38s/it]Running loglikelihood requests:  20%|█▉        | 79/400 [01:52<07:23,  1.38s/it]Running loglikelihood requests:  20%|██        | 80/400 [01:53<07:24,  1.39s/it]Running loglikelihood requests:  20%|██        | 81/400 [01:55<07:24,  1.39s/it]Running loglikelihood requests:  20%|██        | 82/400 [01:56<07:24,  1.40s/it]Running loglikelihood requests:  21%|██        | 83/400 [01:57<07:22,  1.40s/it]Running loglikelihood requests:  21%|██        | 84/400 [01:59<07:22,  1.40s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:00<07:20,  1.40s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:02<07:19,  1.40s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [02:03<07:18,  1.40s/it]Running loglikelihood requests:  22%|██▏       | 88/400 [02:04<07:16,  1.40s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:06<07:15,  1.40s/it]Running loglikelihood requests:  22%|██▎       | 90/400 [02:07<07:13,  1.40s/it]Running loglikelihood requests:  23%|██▎       | 91/400 [02:09<07:11,  1.40s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [02:10<07:09,  1.39s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:11<07:07,  1.39s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [02:13<07:05,  1.39s/it]Running loglikelihood requests:  24%|██▍       | 95/400 [02:14<07:04,  1.39s/it]Running loglikelihood requests:  24%|██▍       | 96/400 [02:16<07:03,  1.39s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:17<07:01,  1.39s/it]Running loglikelihood requests:  24%|██▍       | 98/400 [02:18<07:00,  1.39s/it]Running loglikelihood requests:  25%|██▍       | 99/400 [02:20<06:59,  1.39s/it]Running loglikelihood requests:  25%|██▌       | 100/400 [02:21<06:58,  1.40s/it]Running loglikelihood requests:  25%|██▌       | 101/400 [02:23<06:57,  1.40s/it]Running loglikelihood requests:  26%|██▌       | 102/400 [02:24<06:55,  1.39s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:25<06:53,  1.39s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:27<06:51,  1.39s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [02:28<06:50,  1.39s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [02:30<06:48,  1.39s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [02:31<07:04,  1.45s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [02:33<06:58,  1.43s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [02:34<06:52,  1.42s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [02:35<06:48,  1.41s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [02:37<06:44,  1.40s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [02:38<06:41,  1.40s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [02:39<06:39,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [02:41<06:37,  1.39s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [02:42<06:35,  1.39s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [02:44<06:33,  1.38s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [02:45<06:31,  1.38s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [02:46<06:30,  1.38s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [02:48<06:29,  1.38s/it]Running loglikelihood requests:  30%|███       | 120/400 [02:49<06:38,  1.42s/it]Running loglikelihood requests:  30%|███       | 121/400 [02:51<06:37,  1.42s/it]Running loglikelihood requests:  30%|███       | 122/400 [02:52<06:32,  1.41s/it]Running loglikelihood requests:  31%|███       | 123/400 [02:53<06:28,  1.40s/it]Running loglikelihood requests:  31%|███       | 124/400 [02:55<06:24,  1.39s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [02:56<06:22,  1.39s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [02:58<06:19,  1.39s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [02:59<06:18,  1.39s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:00<06:16,  1.38s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:02<06:14,  1.38s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:03<06:13,  1.38s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:04<06:12,  1.38s/it]Running loglikelihood requests:  33%|███▎      | 132/400 [03:06<06:11,  1.38s/it]Running loglikelihood requests:  33%|███▎      | 133/400 [03:07<06:09,  1.38s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:09<06:16,  1.41s/it]Running loglikelihood requests:  34%|███▍      | 135/400 [03:10<06:12,  1.41s/it]Running loglikelihood requests:  34%|███▍      | 136/400 [03:11<06:08,  1.40s/it]Running loglikelihood requests:  34%|███▍      | 137/400 [03:13<06:05,  1.39s/it]Running loglikelihood requests:  34%|███▍      | 138/400 [03:14<06:02,  1.38s/it]Running loglikelihood requests:  35%|███▍      | 139/400 [03:16<05:59,  1.38s/it]Running loglikelihood requests:  35%|███▌      | 140/400 [03:17<05:58,  1.38s/it]Running loglikelihood requests:  35%|███▌      | 141/400 [03:18<05:56,  1.38s/it]Running loglikelihood requests:  36%|███▌      | 142/400 [03:20<05:55,  1.38s/it]Running loglikelihood requests:  36%|███▌      | 143/400 [03:21<05:53,  1.38s/it]Running loglikelihood requests:  36%|███▌      | 144/400 [03:22<05:51,  1.37s/it]Running loglikelihood requests:  36%|███▋      | 145/400 [03:24<05:49,  1.37s/it]Running loglikelihood requests:  36%|███▋      | 146/400 [03:25<05:48,  1.37s/it]Running loglikelihood requests:  37%|███▋      | 147/400 [03:27<05:46,  1.37s/it]Running loglikelihood requests:  37%|███▋      | 148/400 [03:28<05:45,  1.37s/it]Running loglikelihood requests:  37%|███▋      | 149/400 [03:29<05:44,  1.37s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [03:31<05:49,  1.40s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:32<05:44,  1.38s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:33<05:41,  1.38s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:35<05:38,  1.37s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:36<05:36,  1.37s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:38<05:38,  1.38s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:39<05:35,  1.37s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:40<05:32,  1.37s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:42<05:29,  1.36s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:43<05:28,  1.36s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:44<05:25,  1.36s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:46<05:24,  1.36s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:47<05:23,  1.36s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:49<05:25,  1.37s/it]Running loglikelihood requests:  41%|████      | 164/400 [03:50<05:28,  1.39s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [03:51<05:24,  1.38s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [03:53<05:21,  1.37s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [03:54<05:21,  1.38s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [03:55<05:18,  1.37s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [03:57<05:15,  1.37s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [03:58<05:13,  1.36s/it]Running loglikelihood requests:  43%|████▎     | 171/400 [03:59<05:11,  1.36s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [04:01<05:08,  1.36s/it]Running loglikelihood requests:  43%|████▎     | 173/400 [04:02<05:07,  1.35s/it]Running loglikelihood requests:  44%|████▎     | 174/400 [04:04<05:06,  1.36s/it]Running loglikelihood requests:  44%|████▍     | 175/400 [04:05<05:04,  1.35s/it]Running loglikelihood requests:  44%|████▍     | 176/400 [04:06<05:12,  1.40s/it]Running loglikelihood requests:  44%|████▍     | 177/400 [04:08<05:10,  1.39s/it]Running loglikelihood requests:  44%|████▍     | 178/400 [04:09<05:06,  1.38s/it]Running loglikelihood requests:  45%|████▍     | 179/400 [04:10<05:02,  1.37s/it]Running loglikelihood requests:  45%|████▌     | 180/400 [04:12<05:00,  1.37s/it]Running loglikelihood requests:  45%|████▌     | 181/400 [04:13<04:57,  1.36s/it]Running loglikelihood requests:  46%|████▌     | 182/400 [04:15<04:56,  1.36s/it]Running loglikelihood requests:  46%|████▌     | 183/400 [04:16<04:54,  1.36s/it]Running loglikelihood requests:  46%|████▌     | 184/400 [04:17<04:52,  1.35s/it]Running loglikelihood requests:  46%|████▋     | 185/400 [04:19<04:50,  1.35s/it]Running loglikelihood requests:  46%|████▋     | 186/400 [04:20<04:48,  1.35s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [04:21<04:46,  1.35s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [04:23<04:53,  1.38s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [04:24<04:49,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 190/400 [04:25<04:45,  1.36s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [04:27<04:44,  1.36s/it]Running loglikelihood requests:  48%|████▊     | 192/400 [04:28<04:41,  1.35s/it]Running loglikelihood requests:  48%|████▊     | 193/400 [04:29<04:39,  1.35s/it]Running loglikelihood requests:  48%|████▊     | 194/400 [04:31<04:40,  1.36s/it]Running loglikelihood requests:  49%|████▉     | 195/400 [04:32<04:37,  1.35s/it]Running loglikelihood requests:  49%|████▉     | 196/400 [04:33<04:35,  1.35s/it]Running loglikelihood requests:  49%|████▉     | 197/400 [04:35<04:32,  1.34s/it]Running loglikelihood requests:  50%|████▉     | 198/400 [04:36<04:30,  1.34s/it]Running loglikelihood requests:  50%|████▉     | 199/400 [04:37<04:29,  1.34s/it]Running loglikelihood requests:  50%|█████     | 200/400 [04:39<04:27,  1.34s/it]Running loglikelihood requests:  50%|█████     | 201/400 [04:40<04:25,  1.34s/it]Running loglikelihood requests:  50%|█████     | 202/400 [04:41<04:24,  1.33s/it]Running loglikelihood requests:  51%|█████     | 203/400 [04:43<04:23,  1.34s/it]Running loglikelihood requests:  51%|█████     | 204/400 [04:44<04:21,  1.33s/it]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:45<04:20,  1.34s/it]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:47<04:18,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:48<04:16,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:49<04:15,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:51<04:13,  1.33s/it]Running loglikelihood requests:  52%|█████▎    | 210/400 [04:52<04:12,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 211/400 [04:53<04:11,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:55<04:11,  1.34s/it]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:56<04:08,  1.33s/it]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:57<04:07,  1.33s/it]Running loglikelihood requests:  54%|█████▍    | 215/400 [04:59<04:04,  1.32s/it]Running loglikelihood requests:  54%|█████▍    | 216/400 [05:00<04:02,  1.32s/it]Running loglikelihood requests:  54%|█████▍    | 217/400 [05:01<04:00,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 218/400 [05:03<03:58,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 219/400 [05:04<03:56,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 220/400 [05:05<03:54,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 221/400 [05:07<03:52,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 222/400 [05:08<03:51,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 223/400 [05:09<03:49,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 224/400 [05:10<03:48,  1.30s/it]Running loglikelihood requests:  56%|█████▋    | 225/400 [05:12<03:46,  1.29s/it]Running loglikelihood requests:  56%|█████▋    | 226/400 [05:13<03:45,  1.29s/it]Running loglikelihood requests:  57%|█████▋    | 227/400 [05:14<03:43,  1.29s/it]Running loglikelihood requests:  57%|█████▋    | 228/400 [05:16<03:42,  1.29s/it]Running loglikelihood requests:  57%|█████▋    | 229/400 [05:17<03:40,  1.29s/it]Running loglikelihood requests:  57%|█████▊    | 230/400 [05:18<03:38,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 231/400 [05:19<03:36,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 232/400 [05:21<03:35,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 233/400 [05:22<03:35,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 234/400 [05:23<03:34,  1.29s/it]Running loglikelihood requests:  59%|█████▉    | 235/400 [05:25<03:32,  1.29s/it]Running loglikelihood requests:  59%|█████▉    | 236/400 [05:26<03:31,  1.29s/it]Running loglikelihood requests:  59%|█████▉    | 237/400 [05:27<03:29,  1.29s/it]Running loglikelihood requests:  60%|█████▉    | 238/400 [05:29<03:30,  1.30s/it]Running loglikelihood requests:  60%|█████▉    | 239/400 [05:30<03:27,  1.29s/it]Running loglikelihood requests:  60%|██████    | 240/400 [05:31<03:24,  1.28s/it]Running loglikelihood requests:  60%|██████    | 241/400 [05:32<03:22,  1.27s/it]Running loglikelihood requests:  60%|██████    | 242/400 [05:34<03:20,  1.27s/it]Running loglikelihood requests:  61%|██████    | 243/400 [05:35<03:18,  1.27s/it]Running loglikelihood requests:  61%|██████    | 244/400 [05:36<03:17,  1.27s/it]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:37<03:18,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:39<03:16,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:40<03:13,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:41<03:11,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:42<03:10,  1.26s/it]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:44<03:08,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:45<03:07,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:46<03:05,  1.25s/it]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:47<03:03,  1.25s/it]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:49<03:02,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:50<03:00,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:51<02:59,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:52<02:57,  1.24s/it]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:54<02:56,  1.24s/it]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:55<02:54,  1.24s/it]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:56<02:54,  1.24s/it]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:57<02:52,  1.24s/it]Running loglikelihood requests:  66%|██████▌   | 262/400 [05:59<02:53,  1.26s/it]Running loglikelihood requests:  66%|██████▌   | 263/400 [06:00<02:51,  1.26s/it]Running loglikelihood requests:  66%|██████▌   | 264/400 [06:01<02:49,  1.25s/it]Running loglikelihood requests:  66%|██████▋   | 265/400 [06:02<02:48,  1.25s/it]Running loglikelihood requests:  66%|██████▋   | 266/400 [06:04<02:46,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 267/400 [06:05<02:44,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 268/400 [06:06<02:43,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 269/400 [06:07<02:42,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 270/400 [06:09<02:40,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 271/400 [06:10<02:39,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 272/400 [06:11<02:37,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 273/400 [06:12<02:36,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 274/400 [06:13<02:35,  1.23s/it]Running loglikelihood requests:  69%|██████▉   | 275/400 [06:15<02:34,  1.23s/it]Running loglikelihood requests:  69%|██████▉   | 276/400 [06:16<02:32,  1.23s/it]Running loglikelihood requests:  69%|██████▉   | 277/400 [06:17<02:32,  1.24s/it]Running loglikelihood requests:  70%|██████▉   | 278/400 [06:18<02:30,  1.24s/it]Running loglikelihood requests:  70%|██████▉   | 279/400 [06:20<02:29,  1.23s/it]Running loglikelihood requests:  70%|███████   | 280/400 [06:21<02:27,  1.23s/it]Running loglikelihood requests:  70%|███████   | 281/400 [06:22<02:26,  1.23s/it]Running loglikelihood requests:  70%|███████   | 282/400 [06:23<02:25,  1.23s/it]Running loglikelihood requests:  71%|███████   | 283/400 [06:25<02:23,  1.23s/it]Running loglikelihood requests:  71%|███████   | 284/400 [06:26<02:22,  1.23s/it]Running loglikelihood requests:  71%|███████▏  | 285/400 [06:27<02:21,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 286/400 [06:28<02:20,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 287/400 [06:29<02:18,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 288/400 [06:31<02:17,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 289/400 [06:32<02:16,  1.23s/it]Running loglikelihood requests:  72%|███████▎  | 290/400 [06:33<02:14,  1.23s/it]Running loglikelihood requests:  73%|███████▎  | 291/400 [06:34<02:13,  1.23s/it]Running loglikelihood requests:  73%|███████▎  | 292/400 [06:36<02:12,  1.22s/it]Running loglikelihood requests:  73%|███████▎  | 293/400 [06:37<02:10,  1.22s/it]Running loglikelihood requests:  74%|███████▎  | 294/400 [06:38<02:09,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 295/400 [06:39<02:08,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 296/400 [06:40<02:06,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 297/400 [06:42<02:05,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 298/400 [06:43<02:03,  1.22s/it]Running loglikelihood requests:  75%|███████▍  | 299/400 [06:44<02:02,  1.21s/it]Running loglikelihood requests:  75%|███████▌  | 300/400 [06:45<02:01,  1.21s/it]Running loglikelihood requests:  75%|███████▌  | 301/400 [06:46<01:59,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 302/400 [06:48<02:01,  1.24s/it]Running loglikelihood requests:  76%|███████▌  | 303/400 [06:49<01:59,  1.23s/it]Running loglikelihood requests:  76%|███████▌  | 304/400 [06:50<01:57,  1.22s/it]Running loglikelihood requests:  76%|███████▋  | 305/400 [06:51<01:55,  1.22s/it]Running loglikelihood requests:  76%|███████▋  | 306/400 [06:53<02:00,  1.29s/it]Running loglikelihood requests:  77%|███████▋  | 307/400 [06:54<01:57,  1.26s/it]Running loglikelihood requests:  77%|███████▋  | 308/400 [06:55<01:54,  1.25s/it]Running loglikelihood requests:  77%|███████▋  | 309/400 [06:57<01:55,  1.27s/it]Running loglikelihood requests:  78%|███████▊  | 310/400 [06:58<01:53,  1.26s/it]Running loglikelihood requests:  78%|███████▊  | 311/400 [06:59<01:57,  1.33s/it]Running loglikelihood requests:  78%|███████▊  | 312/400 [07:01<01:53,  1.29s/it]Running loglikelihood requests:  78%|███████▊  | 313/400 [07:02<01:49,  1.26s/it]Running loglikelihood requests:  78%|███████▊  | 314/400 [07:03<01:47,  1.24s/it]Running loglikelihood requests:  79%|███████▉  | 315/400 [07:04<01:44,  1.23s/it]Running loglikelihood requests:  79%|███████▉  | 316/400 [07:05<01:42,  1.22s/it]Running loglikelihood requests:  79%|███████▉  | 317/400 [07:07<01:41,  1.22s/it]Running loglikelihood requests:  80%|███████▉  | 318/400 [07:08<01:41,  1.24s/it]Running loglikelihood requests:  80%|███████▉  | 319/400 [07:09<01:39,  1.23s/it]Running loglikelihood requests:  80%|████████  | 320/400 [07:10<01:37,  1.22s/it]Running loglikelihood requests:  80%|████████  | 321/400 [07:11<01:35,  1.21s/it]Running loglikelihood requests:  80%|████████  | 322/400 [07:13<01:34,  1.21s/it]Running loglikelihood requests:  81%|████████  | 323/400 [07:14<01:32,  1.21s/it]Running loglikelihood requests:  81%|████████  | 324/400 [07:15<01:31,  1.20s/it]Running loglikelihood requests:  81%|████████▏ | 325/400 [07:16<01:30,  1.20s/it]Running loglikelihood requests:  82%|████████▏ | 326/400 [07:17<01:29,  1.21s/it]Running loglikelihood requests:  82%|████████▏ | 327/400 [07:19<01:28,  1.21s/it]Running loglikelihood requests:  82%|████████▏ | 328/400 [07:20<01:26,  1.20s/it]Running loglikelihood requests:  82%|████████▏ | 329/400 [07:21<01:25,  1.20s/it]Running loglikelihood requests:  82%|████████▎ | 330/400 [07:22<01:23,  1.20s/it]Running loglikelihood requests:  83%|████████▎ | 331/400 [07:23<01:22,  1.20s/it]Running loglikelihood requests:  83%|████████▎ | 332/400 [07:25<01:21,  1.20s/it]Running loglikelihood requests:  83%|████████▎ | 333/400 [07:26<01:28,  1.31s/it]Running loglikelihood requests:  84%|████████▎ | 334/400 [07:27<01:24,  1.28s/it]Running loglikelihood requests:  84%|████████▍ | 335/400 [07:29<01:21,  1.26s/it]Running loglikelihood requests:  84%|████████▍ | 336/400 [07:30<01:19,  1.24s/it]Running loglikelihood requests:  84%|████████▍ | 337/400 [07:31<01:16,  1.22s/it]Running loglikelihood requests:  84%|████████▍ | 338/400 [07:32<01:15,  1.21s/it]Running loglikelihood requests:  85%|████████▍ | 339/400 [07:33<01:13,  1.20s/it]Running loglikelihood requests:  85%|████████▌ | 340/400 [07:35<01:12,  1.20s/it]Running loglikelihood requests:  85%|████████▌ | 341/400 [07:36<01:10,  1.20s/it]Running loglikelihood requests:  86%|████████▌ | 342/400 [07:37<01:09,  1.19s/it]Running loglikelihood requests:  86%|████████▌ | 343/400 [07:38<01:07,  1.19s/it]Running loglikelihood requests:  86%|████████▌ | 344/400 [07:39<01:06,  1.19s/it]Running loglikelihood requests:  86%|████████▋ | 345/400 [07:40<01:05,  1.18s/it]Running loglikelihood requests:  86%|████████▋ | 346/400 [07:42<01:03,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 347/400 [07:43<01:04,  1.21s/it]Running loglikelihood requests:  87%|████████▋ | 348/400 [07:44<01:02,  1.20s/it]Running loglikelihood requests:  87%|████████▋ | 349/400 [07:45<01:01,  1.20s/it]Running loglikelihood requests:  88%|████████▊ | 350/400 [07:46<00:59,  1.20s/it]Running loglikelihood requests:  88%|████████▊ | 351/400 [07:48<00:58,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 352/400 [07:49<00:56,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 353/400 [07:50<00:55,  1.18s/it]Running loglikelihood requests:  88%|████████▊ | 354/400 [07:51<00:54,  1.18s/it]Running loglikelihood requests:  89%|████████▉ | 355/400 [07:52<00:53,  1.18s/it]Running loglikelihood requests:  89%|████████▉ | 356/400 [07:54<00:51,  1.18s/it]Running loglikelihood requests:  89%|████████▉ | 357/400 [07:55<00:50,  1.18s/it]Running loglikelihood requests:  90%|████████▉ | 358/400 [07:56<00:49,  1.18s/it]Running loglikelihood requests:  90%|████████▉ | 359/400 [07:57<00:48,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 360/400 [07:58<00:46,  1.17s/it]Running loglikelihood requests:  90%|█████████ | 361/400 [07:59<00:45,  1.17s/it]Running loglikelihood requests:  90%|█████████ | 362/400 [08:01<00:44,  1.17s/it]Running loglikelihood requests:  91%|█████████ | 363/400 [08:02<00:43,  1.17s/it]Running loglikelihood requests:  91%|█████████ | 364/400 [08:03<00:42,  1.17s/it]Running loglikelihood requests:  91%|█████████▏| 365/400 [08:04<00:41,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 366/400 [08:05<00:39,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 367/400 [08:06<00:38,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 368/400 [08:08<00:37,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 369/400 [08:09<00:36,  1.17s/it]Running loglikelihood requests:  92%|█████████▎| 370/400 [08:10<00:35,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 371/400 [08:11<00:33,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 372/400 [08:12<00:32,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 373/400 [08:13<00:31,  1.16s/it]Running loglikelihood requests:  94%|█████████▎| 374/400 [08:15<00:30,  1.18s/it]Running loglikelihood requests:  94%|█████████▍| 375/400 [08:16<00:29,  1.18s/it]Running loglikelihood requests:  94%|█████████▍| 376/400 [08:17<00:28,  1.18s/it]Running loglikelihood requests:  94%|█████████▍| 377/400 [08:18<00:26,  1.17s/it]Running loglikelihood requests:  94%|█████████▍| 378/400 [08:19<00:25,  1.17s/it]Running loglikelihood requests:  95%|█████████▍| 379/400 [08:21<00:24,  1.17s/it]Running loglikelihood requests:  95%|█████████▌| 380/400 [08:23<00:28,  1.42s/it]Running loglikelihood requests:  95%|█████████▌| 381/400 [08:24<00:25,  1.34s/it]Running loglikelihood requests:  96%|█████████▌| 382/400 [08:25<00:23,  1.28s/it]Running loglikelihood requests:  96%|█████████▌| 383/400 [08:26<00:21,  1.24s/it]Running loglikelihood requests:  96%|█████████▌| 384/400 [08:27<00:19,  1.21s/it]Running loglikelihood requests:  96%|█████████▋| 385/400 [08:28<00:17,  1.18s/it]Running loglikelihood requests:  96%|█████████▋| 386/400 [08:29<00:16,  1.16s/it]Running loglikelihood requests:  97%|█████████▋| 387/400 [08:30<00:15,  1.15s/it]Running loglikelihood requests:  97%|█████████▋| 388/400 [08:32<00:13,  1.14s/it]Running loglikelihood requests:  97%|█████████▋| 389/400 [08:33<00:12,  1.11s/it]Running loglikelihood requests:  98%|█████████▊| 390/400 [08:34<00:10,  1.09s/it]Running loglikelihood requests:  98%|█████████▊| 391/400 [08:35<00:09,  1.07s/it]Running loglikelihood requests:  98%|█████████▊| 392/400 [08:36<00:08,  1.06s/it]Running loglikelihood requests:  98%|█████████▊| 393/400 [08:37<00:07,  1.04s/it]Running loglikelihood requests:  98%|█████████▊| 394/400 [08:38<00:06,  1.04s/it]Running loglikelihood requests:  99%|█████████▉| 395/400 [08:39<00:05,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 396/400 [08:40<00:04,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 397/400 [08:41<00:03,  1.00s/it]Running loglikelihood requests: 100%|█████████▉| 398/400 [08:42<00:01,  1.01it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [08:43<00:00,  1.02it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:44<00:00,  1.03it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:44<00:00,  1.31s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'mastermind_46_easy': {'alias': 'mastermind_46_easy', 'acc,none': 0.75, 'acc_stderr,none': 0.04351941398892446}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9900730655060652
0.9975621416797388
0.9971758007187725
0.9980230222224056
0.9889479987910904
0.9764864248764976
0.9903944102306983
0.9944743493554844
0.9959595842537624
0.9872350810596702
0.9630442697748985
0.9836939129473328
0.9680042833072414
0.9739989664157891
0.9945965755000291
0.9874567967365809
0.9910190996776087
0.9888895436517939
0.9820307305549418
0.9881803990776891
0.9859944271811626
0.9931460182904469
0.984259193892523
0.99673879588459
0.9800909214289261
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 3
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 5
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 3 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 2 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

132
cuda:6
mastermind_46_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:22<00:00, 37.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:22<00:00, 41.26s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_46_mcq_random/flair/mastermind_46_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139671465016064 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139671465016064 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139671465016064 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 139671465016064 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Attempting to acquire lock 139670532600896 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139670532600896 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 139670532600896 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 139670532600896 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_46_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_46_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1507.24it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_46_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:02<13:43,  2.06s/it]Running loglikelihood requests:   0%|          | 2/400 [00:03<11:15,  1.70s/it]Running loglikelihood requests:   1%|          | 3/400 [00:04<10:27,  1.58s/it]Running loglikelihood requests:   1%|          | 4/400 [00:06<10:03,  1.52s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:07<09:49,  1.49s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:09<09:40,  1.47s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:10<09:35,  1.46s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:12<09:30,  1.45s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:13<09:25,  1.45s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:14<09:22,  1.44s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:16<09:18,  1.44s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:17<09:16,  1.43s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:19<09:13,  1.43s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:20<09:13,  1.43s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:22<09:10,  1.43s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:23<09:08,  1.43s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:24<09:08,  1.43s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:26<09:06,  1.43s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:27<09:03,  1.43s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:29<09:01,  1.42s/it]Running loglikelihood requests:   5%|▌         | 21/400 [00:30<08:58,  1.42s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:32<08:56,  1.42s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:33<08:56,  1.42s/it]Running loglikelihood requests:   6%|▌         | 24/400 [00:34<08:54,  1.42s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:36<08:53,  1.42s/it]Running loglikelihood requests:   6%|▋         | 26/400 [00:37<08:50,  1.42s/it]Running loglikelihood requests:   7%|▋         | 27/400 [00:39<08:48,  1.42s/it]Running loglikelihood requests:   7%|▋         | 28/400 [00:40<08:46,  1.42s/it]Running loglikelihood requests:   7%|▋         | 29/400 [00:42<08:45,  1.42s/it]Running loglikelihood requests:   8%|▊         | 30/400 [00:43<08:47,  1.42s/it]Running loglikelihood requests:   8%|▊         | 31/400 [00:44<08:44,  1.42s/it]Running loglikelihood requests:   8%|▊         | 32/400 [00:46<08:41,  1.42s/it]Running loglikelihood requests:   8%|▊         | 33/400 [00:47<08:38,  1.41s/it]Running loglikelihood requests:   8%|▊         | 34/400 [00:49<08:35,  1.41s/it]Running loglikelihood requests:   9%|▉         | 35/400 [00:50<08:35,  1.41s/it]Running loglikelihood requests:   9%|▉         | 36/400 [00:51<08:33,  1.41s/it]Running loglikelihood requests:   9%|▉         | 37/400 [00:53<08:36,  1.42s/it]Running loglikelihood requests:  10%|▉         | 38/400 [00:54<08:33,  1.42s/it]Running loglikelihood requests:  10%|▉         | 39/400 [00:56<08:39,  1.44s/it]Running loglikelihood requests:  10%|█         | 40/400 [00:57<08:34,  1.43s/it]Running loglikelihood requests:  10%|█         | 41/400 [00:59<08:34,  1.43s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:00<08:31,  1.43s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:01<08:28,  1.43s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:03<08:27,  1.43s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:04<08:35,  1.45s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:06<08:28,  1.44s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:07<08:24,  1.43s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:09<08:19,  1.42s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:10<08:16,  1.41s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:11<08:14,  1.41s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [01:13<08:12,  1.41s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [01:14<08:09,  1.41s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [01:16<08:07,  1.41s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [01:17<08:05,  1.40s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [01:18<08:06,  1.41s/it]Running loglikelihood requests:  14%|█▍        | 56/400 [01:20<08:08,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [01:21<08:07,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [01:23<08:07,  1.43s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [01:24<08:36,  1.51s/it]Running loglikelihood requests:  15%|█▌        | 60/400 [01:26<08:26,  1.49s/it]Running loglikelihood requests:  15%|█▌        | 61/400 [01:27<08:18,  1.47s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [01:29<08:13,  1.46s/it]Running loglikelihood requests:  16%|█▌        | 63/400 [01:30<08:09,  1.45s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [01:32<08:06,  1.45s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [01:33<08:04,  1.45s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [01:35<08:14,  1.48s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [01:36<08:08,  1.47s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [01:37<08:03,  1.46s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [01:39<07:59,  1.45s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [01:40<06:05,  1.11s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [01:42<06:30,  1.19s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [01:43<06:50,  1.25s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [01:45<07:04,  1.30s/it]Running loglikelihood requests:  19%|█▉        | 75/400 [01:46<07:17,  1.35s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [01:48<07:24,  1.37s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [01:49<07:29,  1.39s/it]Running loglikelihood requests:  20%|█▉        | 78/400 [01:50<07:31,  1.40s/it]Running loglikelihood requests:  20%|█▉        | 79/400 [01:52<07:31,  1.41s/it]Running loglikelihood requests:  20%|██        | 80/400 [01:53<07:33,  1.42s/it]Running loglikelihood requests:  20%|██        | 81/400 [01:55<07:37,  1.43s/it]Running loglikelihood requests:  20%|██        | 82/400 [01:56<07:34,  1.43s/it]Running loglikelihood requests:  21%|██        | 83/400 [01:58<07:31,  1.42s/it]Running loglikelihood requests:  21%|██        | 84/400 [01:59<07:29,  1.42s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:00<07:27,  1.42s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:02<07:32,  1.44s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [02:03<07:29,  1.43s/it]Running loglikelihood requests:  22%|██▏       | 88/400 [02:05<07:25,  1.43s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:06<07:24,  1.43s/it]Running loglikelihood requests:  22%|██▎       | 90/400 [02:08<07:21,  1.42s/it]Running loglikelihood requests:  23%|██▎       | 91/400 [02:09<07:18,  1.42s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [02:10<07:15,  1.41s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:12<07:21,  1.44s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [02:13<07:19,  1.44s/it]Running loglikelihood requests:  24%|██▍       | 95/400 [02:15<07:15,  1.43s/it]Running loglikelihood requests:  24%|██▍       | 96/400 [02:16<07:12,  1.42s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:18<07:18,  1.45s/it]Running loglikelihood requests:  24%|██▍       | 98/400 [02:19<07:16,  1.45s/it]Running loglikelihood requests:  25%|██▍       | 99/400 [02:21<07:18,  1.46s/it]Running loglikelihood requests:  25%|██▌       | 100/400 [02:22<07:14,  1.45s/it]Running loglikelihood requests:  25%|██▌       | 101/400 [02:23<07:12,  1.45s/it]Running loglikelihood requests:  26%|██▌       | 102/400 [02:25<07:17,  1.47s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:26<07:10,  1.45s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:28<07:06,  1.44s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [02:29<07:01,  1.43s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [02:31<06:58,  1.42s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [02:32<06:57,  1.43s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [02:34<06:59,  1.44s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [02:35<07:12,  1.48s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [02:37<07:11,  1.49s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [02:38<07:04,  1.47s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [02:40<07:05,  1.48s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [02:41<07:05,  1.48s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [02:43<07:27,  1.57s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [02:44<07:38,  1.61s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [02:46<07:45,  1.64s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [02:48<07:23,  1.57s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [02:49<07:43,  1.65s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [02:51<07:22,  1.57s/it]Running loglikelihood requests:  30%|███       | 120/400 [02:53<07:37,  1.63s/it]Running loglikelihood requests:  30%|███       | 121/400 [02:54<07:25,  1.60s/it]Running loglikelihood requests:  30%|███       | 122/400 [02:55<07:04,  1.53s/it]Running loglikelihood requests:  31%|███       | 123/400 [02:57<06:51,  1.49s/it]Running loglikelihood requests:  31%|███       | 124/400 [02:58<06:56,  1.51s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [03:00<06:44,  1.47s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [03:01<06:34,  1.44s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [03:03<06:27,  1.42s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:04<06:21,  1.40s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:05<06:22,  1.41s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:07<06:18,  1.40s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:08<06:15,  1.40s/it]Running loglikelihood requests:  33%|███▎      | 132/400 [03:09<06:11,  1.39s/it]Running loglikelihood requests:  33%|███▎      | 133/400 [03:11<06:06,  1.37s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:12<06:02,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 135/400 [03:13<06:00,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 136/400 [03:15<05:58,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 137/400 [03:16<05:55,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 138/400 [03:18<05:52,  1.35s/it]Running loglikelihood requests:  35%|███▍      | 139/400 [03:19<05:50,  1.34s/it]Running loglikelihood requests:  35%|███▌      | 140/400 [03:20<05:48,  1.34s/it]Running loglikelihood requests:  35%|███▌      | 141/400 [03:22<05:48,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 142/400 [03:23<05:47,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 143/400 [03:24<05:45,  1.34s/it]Running loglikelihood requests:  36%|███▌      | 144/400 [03:26<05:44,  1.34s/it]Running loglikelihood requests:  36%|███▋      | 145/400 [03:27<05:42,  1.34s/it]Running loglikelihood requests:  36%|███▋      | 146/400 [03:28<05:42,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 147/400 [03:30<05:41,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 148/400 [03:31<05:39,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 149/400 [03:32<05:37,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [03:34<05:35,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:35<05:34,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:36<05:32,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:38<05:30,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:39<05:28,  1.34s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:40<05:27,  1.34s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:42<05:25,  1.34s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:43<05:24,  1.33s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:44<05:22,  1.33s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:46<05:21,  1.33s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:47<05:19,  1.33s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:48<05:17,  1.33s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:50<05:16,  1.33s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:51<05:14,  1.33s/it]Running loglikelihood requests:  41%|████      | 164/400 [03:52<05:13,  1.33s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [03:54<05:11,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [03:55<05:10,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [03:56<05:09,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [03:58<05:07,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [03:59<05:06,  1.33s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [04:00<05:04,  1.33s/it]Running loglikelihood requests:  43%|████▎     | 171/400 [04:02<05:03,  1.33s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [04:03<05:02,  1.33s/it]Running loglikelihood requests:  43%|████▎     | 173/400 [04:04<05:01,  1.33s/it]Running loglikelihood requests:  44%|████▎     | 174/400 [04:06<04:59,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 175/400 [04:07<04:57,  1.32s/it]Running loglikelihood requests:  44%|████▍     | 176/400 [04:08<04:58,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 177/400 [04:10<04:56,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 178/400 [04:11<04:54,  1.33s/it]Running loglikelihood requests:  45%|████▍     | 179/400 [04:12<04:53,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 180/400 [04:14<04:52,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 181/400 [04:15<04:50,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 182/400 [04:16<04:49,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 183/400 [04:17<04:47,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 184/400 [04:19<04:45,  1.32s/it]Running loglikelihood requests:  46%|████▋     | 185/400 [04:20<04:44,  1.32s/it]Running loglikelihood requests:  46%|████▋     | 186/400 [04:21<04:43,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [04:23<04:41,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [04:24<04:40,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [04:25<04:38,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 190/400 [04:27<04:37,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [04:28<04:36,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 192/400 [04:29<04:35,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 193/400 [04:31<04:34,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 194/400 [04:32<04:32,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 195/400 [04:33<04:31,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 196/400 [04:35<04:29,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 197/400 [04:36<04:28,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 198/400 [04:37<04:27,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 199/400 [04:39<04:25,  1.32s/it]Running loglikelihood requests:  50%|█████     | 200/400 [04:40<04:23,  1.32s/it]Running loglikelihood requests:  50%|█████     | 201/400 [04:41<04:21,  1.32s/it]Running loglikelihood requests:  50%|█████     | 202/400 [04:43<04:20,  1.31s/it]Running loglikelihood requests:  51%|█████     | 203/400 [04:44<04:18,  1.31s/it]Running loglikelihood requests:  51%|█████     | 204/400 [04:45<04:17,  1.31s/it]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:47<04:15,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:48<04:14,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:49<04:13,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:50<04:11,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:52<04:10,  1.31s/it]Running loglikelihood requests:  52%|█████▎    | 210/400 [04:53<04:09,  1.31s/it]Running loglikelihood requests:  53%|█████▎    | 211/400 [04:54<04:08,  1.31s/it]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:56<04:06,  1.31s/it]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:57<04:04,  1.31s/it]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:58<04:02,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 215/400 [05:00<04:01,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 216/400 [05:01<04:00,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 217/400 [05:02<03:59,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 218/400 [05:04<03:57,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 219/400 [05:05<03:56,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 220/400 [05:06<03:54,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 221/400 [05:07<03:53,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 222/400 [05:09<03:51,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 223/400 [05:10<03:54,  1.32s/it]Running loglikelihood requests:  56%|█████▌    | 224/400 [05:11<03:54,  1.33s/it]Running loglikelihood requests:  56%|█████▋    | 225/400 [05:13<03:51,  1.32s/it]Running loglikelihood requests:  56%|█████▋    | 226/400 [05:14<03:48,  1.31s/it]Running loglikelihood requests:  57%|█████▋    | 227/400 [05:15<03:46,  1.31s/it]Running loglikelihood requests:  57%|█████▋    | 228/400 [05:17<03:43,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 229/400 [05:18<03:41,  1.30s/it]Running loglikelihood requests:  57%|█████▊    | 230/400 [05:19<03:39,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 231/400 [05:20<03:38,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 232/400 [05:22<03:36,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 233/400 [05:23<03:34,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 234/400 [05:24<03:32,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 235/400 [05:26<03:31,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 236/400 [05:27<03:29,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 237/400 [05:28<03:29,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 238/400 [05:29<03:27,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 239/400 [05:31<03:25,  1.28s/it]Running loglikelihood requests:  60%|██████    | 240/400 [05:32<03:23,  1.27s/it]Running loglikelihood requests:  60%|██████    | 241/400 [05:33<03:22,  1.27s/it]Running loglikelihood requests:  60%|██████    | 242/400 [05:35<03:20,  1.27s/it]Running loglikelihood requests:  61%|██████    | 243/400 [05:36<03:19,  1.27s/it]Running loglikelihood requests:  61%|██████    | 244/400 [05:37<03:17,  1.27s/it]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:38<03:16,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:40<03:14,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:41<03:12,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:42<03:11,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:43<03:10,  1.26s/it]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:45<03:08,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:46<03:07,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:47<03:05,  1.25s/it]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:48<03:03,  1.25s/it]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:50<03:02,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:51<03:01,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:52<02:59,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:53<02:58,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:55<02:57,  1.25s/it]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:56<02:56,  1.25s/it]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:57<02:54,  1.25s/it]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:58<02:52,  1.24s/it]Running loglikelihood requests:  66%|██████▌   | 262/400 [06:00<02:51,  1.24s/it]Running loglikelihood requests:  66%|██████▌   | 263/400 [06:01<02:49,  1.24s/it]Running loglikelihood requests:  66%|██████▌   | 264/400 [06:02<02:48,  1.24s/it]Running loglikelihood requests:  66%|██████▋   | 265/400 [06:03<02:47,  1.24s/it]Running loglikelihood requests:  66%|██████▋   | 266/400 [06:04<02:45,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 267/400 [06:06<02:44,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 268/400 [06:07<02:43,  1.24s/it]Running loglikelihood requests:  67%|██████▋   | 269/400 [06:08<02:41,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 270/400 [06:09<02:40,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 271/400 [06:11<02:39,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 272/400 [06:12<02:37,  1.23s/it]Running loglikelihood requests:  68%|██████▊   | 273/400 [06:13<02:36,  1.24s/it]Running loglikelihood requests:  68%|██████▊   | 274/400 [06:14<02:35,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 275/400 [06:16<02:34,  1.23s/it]Running loglikelihood requests:  69%|██████▉   | 276/400 [06:17<02:32,  1.23s/it]Running loglikelihood requests:  69%|██████▉   | 277/400 [06:18<02:31,  1.23s/it]Running loglikelihood requests:  70%|██████▉   | 278/400 [06:19<02:30,  1.23s/it]Running loglikelihood requests:  70%|██████▉   | 279/400 [06:20<02:28,  1.23s/it]Running loglikelihood requests:  70%|███████   | 280/400 [06:22<02:27,  1.23s/it]Running loglikelihood requests:  70%|███████   | 281/400 [06:23<02:26,  1.23s/it]Running loglikelihood requests:  70%|███████   | 282/400 [06:24<02:24,  1.23s/it]Running loglikelihood requests:  71%|███████   | 283/400 [06:25<02:23,  1.23s/it]Running loglikelihood requests:  71%|███████   | 284/400 [06:27<02:22,  1.23s/it]Running loglikelihood requests:  71%|███████▏  | 285/400 [06:28<02:20,  1.22s/it]Running loglikelihood requests:  72%|███████▏  | 286/400 [06:29<02:19,  1.22s/it]Running loglikelihood requests:  72%|███████▏  | 287/400 [06:30<02:18,  1.22s/it]Running loglikelihood requests:  72%|███████▏  | 288/400 [06:32<02:16,  1.22s/it]Running loglikelihood requests:  72%|███████▏  | 289/400 [06:33<02:15,  1.22s/it]Running loglikelihood requests:  72%|███████▎  | 290/400 [06:34<02:14,  1.22s/it]Running loglikelihood requests:  73%|███████▎  | 291/400 [06:35<02:13,  1.22s/it]Running loglikelihood requests:  73%|███████▎  | 292/400 [06:36<02:12,  1.22s/it]Running loglikelihood requests:  73%|███████▎  | 293/400 [06:38<02:10,  1.22s/it]Running loglikelihood requests:  74%|███████▎  | 294/400 [06:39<02:09,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 295/400 [06:40<02:07,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 296/400 [06:41<02:06,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 297/400 [06:42<02:05,  1.22s/it]Running loglikelihood requests:  74%|███████▍  | 298/400 [06:44<02:04,  1.22s/it]Running loglikelihood requests:  75%|███████▍  | 299/400 [06:45<02:02,  1.22s/it]Running loglikelihood requests:  75%|███████▌  | 300/400 [06:46<02:01,  1.21s/it]Running loglikelihood requests:  75%|███████▌  | 301/400 [06:47<01:59,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 302/400 [06:49<01:58,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 303/400 [06:50<01:57,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 304/400 [06:51<01:56,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 305/400 [06:52<01:54,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 306/400 [06:53<01:53,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 307/400 [06:55<01:52,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 308/400 [06:56<01:50,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 309/400 [06:57<01:49,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 310/400 [06:58<01:48,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 311/400 [06:59<01:47,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 312/400 [07:01<01:46,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 313/400 [07:02<01:44,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 314/400 [07:03<01:43,  1.20s/it]Running loglikelihood requests:  79%|███████▉  | 315/400 [07:04<01:42,  1.20s/it]Running loglikelihood requests:  79%|███████▉  | 316/400 [07:05<01:40,  1.20s/it]Running loglikelihood requests:  79%|███████▉  | 317/400 [07:07<01:39,  1.20s/it]Running loglikelihood requests:  80%|███████▉  | 318/400 [07:08<01:38,  1.20s/it]Running loglikelihood requests:  80%|███████▉  | 319/400 [07:09<01:37,  1.20s/it]Running loglikelihood requests:  80%|████████  | 320/400 [07:10<01:36,  1.20s/it]Running loglikelihood requests:  80%|████████  | 321/400 [07:11<01:34,  1.20s/it]Running loglikelihood requests:  80%|████████  | 322/400 [07:13<01:33,  1.20s/it]Running loglikelihood requests:  81%|████████  | 323/400 [07:14<01:32,  1.20s/it]Running loglikelihood requests:  81%|████████  | 324/400 [07:15<01:30,  1.20s/it]Running loglikelihood requests:  81%|████████▏ | 325/400 [07:16<01:29,  1.20s/it]Running loglikelihood requests:  82%|████████▏ | 326/400 [07:17<01:28,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 327/400 [07:19<01:27,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 328/400 [07:20<01:25,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 329/400 [07:21<01:24,  1.19s/it]Running loglikelihood requests:  82%|████████▎ | 330/400 [07:22<01:23,  1.20s/it]Running loglikelihood requests:  83%|████████▎ | 331/400 [07:23<01:22,  1.20s/it]Running loglikelihood requests:  83%|████████▎ | 332/400 [07:25<01:21,  1.19s/it]Running loglikelihood requests:  83%|████████▎ | 333/400 [07:26<01:19,  1.19s/it]Running loglikelihood requests:  84%|████████▎ | 334/400 [07:27<01:18,  1.19s/it]Running loglikelihood requests:  84%|████████▍ | 335/400 [07:28<01:17,  1.19s/it]Running loglikelihood requests:  84%|████████▍ | 336/400 [07:29<01:16,  1.19s/it]Running loglikelihood requests:  84%|████████▍ | 337/400 [07:30<01:14,  1.19s/it]Running loglikelihood requests:  84%|████████▍ | 338/400 [07:32<01:13,  1.19s/it]Running loglikelihood requests:  85%|████████▍ | 339/400 [07:33<01:12,  1.19s/it]Running loglikelihood requests:  85%|████████▌ | 340/400 [07:34<01:11,  1.18s/it]Running loglikelihood requests:  85%|████████▌ | 341/400 [07:35<01:09,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 342/400 [07:36<01:08,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 343/400 [07:38<01:07,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 344/400 [07:39<01:06,  1.18s/it]Running loglikelihood requests:  86%|████████▋ | 345/400 [07:40<01:04,  1.18s/it]Running loglikelihood requests:  86%|████████▋ | 346/400 [07:41<01:03,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 347/400 [07:42<01:02,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 348/400 [07:43<01:01,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 349/400 [07:45<01:00,  1.18s/it]Running loglikelihood requests:  88%|████████▊ | 350/400 [07:46<00:59,  1.18s/it]Running loglikelihood requests:  88%|████████▊ | 351/400 [07:47<00:58,  1.18s/it]Running loglikelihood requests:  88%|████████▊ | 352/400 [07:48<00:56,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 353/400 [07:49<00:55,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 354/400 [07:51<00:54,  1.19s/it]Running loglikelihood requests:  89%|████████▉ | 355/400 [07:52<00:53,  1.19s/it]Running loglikelihood requests:  89%|████████▉ | 356/400 [07:53<00:52,  1.19s/it]Running loglikelihood requests:  89%|████████▉ | 357/400 [07:54<00:51,  1.19s/it]Running loglikelihood requests:  90%|████████▉ | 358/400 [07:55<00:49,  1.18s/it]Running loglikelihood requests:  90%|████████▉ | 359/400 [07:57<00:48,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 360/400 [07:58<00:47,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 361/400 [07:59<00:45,  1.18s/it]Running loglikelihood requests:  90%|█████████ | 362/400 [08:00<00:44,  1.18s/it]Running loglikelihood requests:  91%|█████████ | 363/400 [08:01<00:43,  1.18s/it]Running loglikelihood requests:  91%|█████████ | 364/400 [08:02<00:42,  1.18s/it]Running loglikelihood requests:  91%|█████████▏| 365/400 [08:04<00:41,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 366/400 [08:05<00:39,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 367/400 [08:06<00:38,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 368/400 [08:07<00:37,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 369/400 [08:08<00:36,  1.17s/it]Running loglikelihood requests:  92%|█████████▎| 370/400 [08:09<00:35,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 371/400 [08:11<00:33,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 372/400 [08:12<00:32,  1.17s/it]Running loglikelihood requests:  93%|█████████▎| 373/400 [08:13<00:31,  1.17s/it]Running loglikelihood requests:  94%|█████████▎| 374/400 [08:14<00:30,  1.16s/it]Running loglikelihood requests:  94%|█████████▍| 375/400 [08:15<00:29,  1.16s/it]Running loglikelihood requests:  94%|█████████▍| 376/400 [08:16<00:27,  1.16s/it]Running loglikelihood requests:  94%|█████████▍| 377/400 [08:18<00:26,  1.16s/it]Running loglikelihood requests:  94%|█████████▍| 378/400 [08:19<00:25,  1.16s/it]Running loglikelihood requests:  95%|█████████▍| 379/400 [08:20<00:24,  1.16s/it]Running loglikelihood requests:  95%|█████████▌| 380/400 [08:21<00:23,  1.15s/it]Running loglikelihood requests:  95%|█████████▌| 381/400 [08:22<00:21,  1.15s/it]Running loglikelihood requests:  96%|█████████▌| 382/400 [08:23<00:20,  1.15s/it]Running loglikelihood requests:  96%|█████████▌| 383/400 [08:24<00:19,  1.15s/it]Running loglikelihood requests:  96%|█████████▌| 384/400 [08:26<00:18,  1.14s/it]Running loglikelihood requests:  96%|█████████▋| 385/400 [08:27<00:16,  1.13s/it]Running loglikelihood requests:  96%|█████████▋| 386/400 [08:28<00:15,  1.12s/it]Running loglikelihood requests:  97%|█████████▋| 387/400 [08:29<00:14,  1.12s/it]Running loglikelihood requests:  97%|█████████▋| 388/400 [08:30<00:13,  1.11s/it]Running loglikelihood requests:  97%|█████████▋| 389/400 [08:31<00:12,  1.09s/it]Running loglikelihood requests:  98%|█████████▊| 390/400 [08:32<00:10,  1.07s/it]Running loglikelihood requests:  98%|█████████▊| 391/400 [08:33<00:09,  1.06s/it]Running loglikelihood requests:  98%|█████████▊| 392/400 [08:34<00:08,  1.05s/it]Running loglikelihood requests:  98%|█████████▊| 393/400 [08:35<00:07,  1.04s/it]Running loglikelihood requests:  98%|█████████▊| 394/400 [08:36<00:06,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 395/400 [08:37<00:05,  1.02s/it]Running loglikelihood requests:  99%|█████████▉| 396/400 [08:38<00:04,  1.02s/it]Running loglikelihood requests:  99%|█████████▉| 397/400 [08:39<00:02,  1.00it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [08:40<00:01,  1.02it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [08:41<00:00,  1.03it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:42<00:00,  1.03it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:42<00:00,  1.31s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'mastermind_46_easy': {'alias': 'mastermind_46_easy', 'acc,none': 0.75, 'acc_stderr,none': 0.04351941398892446}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9900730655060652
0.9975621416797388
0.9971758007187725
0.9980230222224056
0.9889479987910904
0.9764864248764976
0.9903944102306983
0.9944743493554844
0.9959595842537624
0.9872350810596702
0.9630442697748985
0.9836939129473328
0.9680042833072414
0.9739989664157891
0.9945965755000291
0.9874567967365809
0.9910190996776087
0.9888895436517939
0.9820307305549418
0.9881803990776891
0.9859944271811626
0.9931460182904469
0.984259193892523
0.99673879588459
0.9800909214289261
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 3
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 5
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 2 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 1 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

227
cuda:7
mastermind_24_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 36.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 40.36s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random HTTP/1.1" 200 779
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_24_mcq_random/flair/mastermind_24_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_24_mcq_random HTTP/1.1" 200 779
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_24_mcq_random/resolve/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_24_mcq_random/resolve/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_24_mcq_random/paths-info/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 139645833413648 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Lock 139645833413648 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645833413648 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Lock 139645833413648 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_24_mcq_random_default_0.0.0_cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5.lock
DEBUG:filelock:Attempting to acquire lock 139645837213968 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:filelock:Lock 139645837213968 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5/dataset_info.json
DEBUG:filelock:Attempting to release lock 139645837213968 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:filelock:Lock 139645837213968 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_24_mcq_random/default/0.0.0/cdc1332d34ece1ecdd2453e227ebdc3837b4a0c5_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_24_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_24_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1509.96it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_24_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:01<10:50,  1.63s/it]Running loglikelihood requests:   0%|          | 2/400 [00:02<08:32,  1.29s/it]Running loglikelihood requests:   1%|          | 3/400 [00:03<07:47,  1.18s/it]Running loglikelihood requests:   1%|          | 4/400 [00:04<07:25,  1.12s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:05<07:11,  1.09s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:06<07:02,  1.07s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:07<06:56,  1.06s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:08<06:51,  1.05s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:09<06:49,  1.05s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:10<06:49,  1.05s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:12<05:10,  1.25it/s]Running loglikelihood requests:   3%|▎         | 13/400 [00:13<05:32,  1.17it/s]Running loglikelihood requests:   4%|▎         | 14/400 [00:14<05:48,  1.11it/s]Running loglikelihood requests:   4%|▍         | 16/400 [00:15<04:42,  1.36it/s]Running loglikelihood requests:   4%|▍         | 17/400 [00:16<05:08,  1.24it/s]Running loglikelihood requests:   4%|▍         | 18/400 [00:17<05:28,  1.16it/s]Running loglikelihood requests:   5%|▍         | 19/400 [00:18<05:44,  1.10it/s]Running loglikelihood requests:   5%|▌         | 20/400 [00:19<05:57,  1.06it/s]Running loglikelihood requests:   5%|▌         | 21/400 [00:20<06:18,  1.00it/s]Running loglikelihood requests:   6%|▌         | 22/400 [00:21<06:32,  1.04s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:22<06:40,  1.06s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:23<05:08,  1.21it/s]Running loglikelihood requests:   6%|▋         | 26/400 [00:24<05:24,  1.15it/s]Running loglikelihood requests:   7%|▋         | 27/400 [00:25<05:37,  1.10it/s]Running loglikelihood requests:   7%|▋         | 29/400 [00:26<04:32,  1.36it/s]Running loglikelihood requests:   8%|▊         | 30/400 [00:27<04:55,  1.25it/s]Running loglikelihood requests:   8%|▊         | 31/400 [00:28<05:19,  1.15it/s]Running loglikelihood requests:   8%|▊         | 32/400 [00:29<05:32,  1.11it/s]Running loglikelihood requests:   8%|▊         | 34/400 [00:30<04:28,  1.36it/s]Running loglikelihood requests:   9%|▉         | 35/400 [00:31<04:52,  1.25it/s]Running loglikelihood requests:  10%|▉         | 38/400 [00:32<03:25,  1.76it/s]Running loglikelihood requests:  10%|▉         | 39/400 [00:33<03:55,  1.53it/s]Running loglikelihood requests:  10%|█         | 40/400 [00:34<04:22,  1.37it/s]Running loglikelihood requests:  10%|█         | 41/400 [00:35<04:45,  1.26it/s]Running loglikelihood requests:  10%|█         | 42/400 [00:36<05:03,  1.18it/s]Running loglikelihood requests:  11%|█         | 43/400 [00:37<05:17,  1.13it/s]Running loglikelihood requests:  11%|█         | 44/400 [00:38<05:27,  1.09it/s]Running loglikelihood requests:  11%|█▏        | 45/400 [00:39<05:34,  1.06it/s]Running loglikelihood requests:  12%|█▏        | 47/400 [00:40<04:23,  1.34it/s]Running loglikelihood requests:  12%|█▏        | 48/400 [00:41<04:44,  1.24it/s]Running loglikelihood requests:  12%|█▏        | 49/400 [00:42<05:01,  1.17it/s]Running loglikelihood requests:  12%|█▎        | 50/400 [00:43<05:14,  1.11it/s]Running loglikelihood requests:  13%|█▎        | 52/400 [00:44<04:12,  1.38it/s]Running loglikelihood requests:  13%|█▎        | 53/400 [00:45<04:34,  1.26it/s]Running loglikelihood requests:  14%|█▎        | 54/400 [00:46<04:51,  1.19it/s]Running loglikelihood requests:  14%|█▍        | 56/400 [00:47<04:00,  1.43it/s]Running loglikelihood requests:  14%|█▍        | 57/400 [00:48<04:23,  1.30it/s]Running loglikelihood requests:  14%|█▍        | 58/400 [00:49<04:41,  1.21it/s]Running loglikelihood requests:  15%|█▍        | 59/400 [00:50<04:55,  1.15it/s]Running loglikelihood requests:  15%|█▌        | 60/400 [00:51<05:06,  1.11it/s]Running loglikelihood requests:  15%|█▌        | 61/400 [00:52<05:14,  1.08it/s]Running loglikelihood requests:  16%|█▌        | 62/400 [00:53<05:20,  1.06it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [00:54<05:23,  1.04it/s]Running loglikelihood requests:  16%|█▌        | 64/400 [00:55<05:25,  1.03it/s]Running loglikelihood requests:  16%|█▋        | 65/400 [00:56<05:26,  1.03it/s]Running loglikelihood requests:  16%|█▋        | 66/400 [00:57<05:27,  1.02it/s]Running loglikelihood requests:  17%|█▋        | 67/400 [00:58<05:27,  1.02it/s]Running loglikelihood requests:  17%|█▋        | 68/400 [00:59<05:26,  1.02it/s]Running loglikelihood requests:  17%|█▋        | 69/400 [01:00<05:25,  1.02it/s]Running loglikelihood requests:  18%|█▊        | 70/400 [01:01<05:25,  1.02it/s]Running loglikelihood requests:  18%|█▊        | 71/400 [01:02<05:24,  1.02it/s]Running loglikelihood requests:  18%|█▊        | 72/400 [01:03<05:22,  1.02it/s]Running loglikelihood requests:  18%|█▊        | 73/400 [01:04<05:21,  1.02it/s]Running loglikelihood requests:  18%|█▊        | 74/400 [01:05<05:19,  1.02it/s]Running loglikelihood requests:  19%|█▉        | 76/400 [01:06<04:04,  1.32it/s]Running loglikelihood requests:  19%|█▉        | 77/400 [01:07<04:21,  1.23it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [01:08<04:34,  1.17it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [01:09<04:44,  1.13it/s]Running loglikelihood requests:  20%|██        | 80/400 [01:10<04:52,  1.10it/s]Running loglikelihood requests:  20%|██        | 81/400 [01:11<04:56,  1.07it/s]Running loglikelihood requests:  20%|██        | 82/400 [01:12<04:59,  1.06it/s]Running loglikelihood requests:  21%|██        | 83/400 [01:13<05:01,  1.05it/s]Running loglikelihood requests:  21%|██        | 84/400 [01:14<05:03,  1.04it/s]Running loglikelihood requests:  21%|██▏       | 85/400 [01:15<05:03,  1.04it/s]Running loglikelihood requests:  22%|██▏       | 87/400 [01:16<03:53,  1.34it/s]Running loglikelihood requests:  22%|██▏       | 88/400 [01:17<04:10,  1.25it/s]Running loglikelihood requests:  22%|██▏       | 89/400 [01:18<04:22,  1.18it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [01:19<04:32,  1.14it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [01:20<04:39,  1.11it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [01:21<04:44,  1.08it/s]Running loglikelihood requests:  24%|██▎       | 94/400 [01:22<03:42,  1.38it/s]Running loglikelihood requests:  24%|██▍       | 95/400 [01:23<03:59,  1.27it/s]Running loglikelihood requests:  24%|██▍       | 96/400 [01:24<04:13,  1.20it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [01:25<03:26,  1.46it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [01:26<03:02,  1.64it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [01:27<02:48,  1.77it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [01:28<03:12,  1.55it/s]Running loglikelihood requests:  26%|██▌       | 104/400 [01:29<03:33,  1.39it/s]Running loglikelihood requests:  27%|██▋       | 107/400 [01:30<02:35,  1.89it/s]Running loglikelihood requests:  27%|██▋       | 108/400 [01:31<02:58,  1.63it/s]Running loglikelihood requests:  27%|██▋       | 109/400 [01:32<03:20,  1.45it/s]Running loglikelihood requests:  28%|██▊       | 110/400 [01:32<03:38,  1.33it/s]Running loglikelihood requests:  28%|██▊       | 111/400 [01:33<03:53,  1.24it/s]Running loglikelihood requests:  28%|██▊       | 112/400 [01:34<04:04,  1.18it/s]Running loglikelihood requests:  28%|██▊       | 113/400 [01:35<04:13,  1.13it/s]Running loglikelihood requests:  28%|██▊       | 114/400 [01:36<04:18,  1.10it/s]Running loglikelihood requests:  29%|██▉       | 116/400 [01:37<03:23,  1.39it/s]Running loglikelihood requests:  29%|██▉       | 117/400 [01:38<03:39,  1.29it/s]Running loglikelihood requests:  30%|██▉       | 118/400 [01:39<03:51,  1.22it/s]Running loglikelihood requests:  30%|███       | 121/400 [01:40<02:35,  1.79it/s]Running loglikelihood requests:  30%|███       | 122/400 [01:41<02:57,  1.57it/s]Running loglikelihood requests:  31%|███       | 123/400 [01:42<03:16,  1.41it/s]Running loglikelihood requests:  31%|███       | 124/400 [01:43<03:32,  1.30it/s]Running loglikelihood requests:  31%|███▏      | 125/400 [01:44<03:43,  1.23it/s]Running loglikelihood requests:  32%|███▏      | 126/400 [01:45<03:51,  1.18it/s]Running loglikelihood requests:  32%|███▏      | 127/400 [01:46<03:57,  1.15it/s]Running loglikelihood requests:  32%|███▏      | 128/400 [01:47<04:01,  1.12it/s]Running loglikelihood requests:  32%|███▎      | 130/400 [01:48<03:09,  1.43it/s]Running loglikelihood requests:  33%|███▎      | 132/400 [01:49<02:43,  1.64it/s]Running loglikelihood requests:  33%|███▎      | 133/400 [01:50<03:01,  1.47it/s]Running loglikelihood requests:  34%|███▎      | 134/400 [01:51<03:16,  1.35it/s]Running loglikelihood requests:  34%|███▍      | 135/400 [01:51<03:28,  1.27it/s]Running loglikelihood requests:  34%|███▍      | 136/400 [01:52<03:38,  1.21it/s]Running loglikelihood requests:  34%|███▍      | 137/400 [01:53<03:44,  1.17it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [01:54<03:49,  1.14it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [01:55<03:53,  1.12it/s]Running loglikelihood requests:  35%|███▌      | 140/400 [01:56<03:54,  1.11it/s]Running loglikelihood requests:  35%|███▌      | 141/400 [01:57<03:55,  1.10it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [01:58<03:56,  1.09it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [01:59<03:56,  1.09it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [02:00<03:01,  1.41it/s]Running loglikelihood requests:  36%|███▋      | 146/400 [02:01<03:14,  1.31it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [02:02<03:24,  1.24it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [02:03<03:31,  1.19it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [02:04<03:36,  1.16it/s]Running loglikelihood requests:  38%|███▊      | 150/400 [02:04<03:40,  1.13it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [02:05<02:52,  1.44it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [02:06<03:05,  1.33it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [02:07<03:16,  1.25it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [02:08<03:24,  1.20it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [02:09<02:43,  1.49it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [02:10<02:57,  1.36it/s]Running loglikelihood requests:  40%|████      | 160/400 [02:11<02:30,  1.60it/s]Running loglikelihood requests:  40%|████      | 161/400 [02:12<02:45,  1.44it/s]Running loglikelihood requests:  40%|████      | 162/400 [02:13<02:58,  1.34it/s]Running loglikelihood requests:  41%|████      | 163/400 [02:14<03:07,  1.26it/s]Running loglikelihood requests:  41%|████▏     | 165/400 [02:15<02:33,  1.53it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [02:16<02:47,  1.40it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [02:17<02:58,  1.30it/s]Running loglikelihood requests:  42%|████▏     | 168/400 [02:17<03:07,  1.24it/s]Running loglikelihood requests:  42%|████▎     | 170/400 [02:18<02:31,  1.51it/s]Running loglikelihood requests:  43%|████▎     | 171/400 [02:19<02:45,  1.38it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [02:20<02:56,  1.29it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [02:21<03:04,  1.23it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [02:22<03:10,  1.18it/s]Running loglikelihood requests:  44%|████▍     | 175/400 [02:23<03:14,  1.15it/s]Running loglikelihood requests:  44%|████▍     | 176/400 [02:24<03:17,  1.13it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [02:25<02:33,  1.44it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [02:26<02:45,  1.34it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [02:27<02:54,  1.26it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [02:28<03:00,  1.21it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [02:29<02:24,  1.50it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [02:29<02:36,  1.38it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [02:30<01:50,  1.92it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [02:31<02:06,  1.68it/s]Running loglikelihood requests:  47%|████▋     | 189/400 [02:32<02:20,  1.50it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [02:33<02:32,  1.38it/s]Running loglikelihood requests:  48%|████▊     | 191/400 [02:34<02:41,  1.29it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [02:35<02:48,  1.23it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [02:36<02:53,  1.19it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [02:37<02:57,  1.16it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [02:38<02:28,  1.38it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [02:39<02:36,  1.30it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [02:40<02:43,  1.24it/s]Running loglikelihood requests:  50%|████▉     | 199/400 [02:41<02:48,  1.19it/s]Running loglikelihood requests:  50%|█████     | 200/400 [02:42<02:51,  1.16it/s]Running loglikelihood requests:  50%|█████     | 202/400 [02:43<02:15,  1.46it/s]Running loglikelihood requests:  51%|█████     | 203/400 [02:43<02:26,  1.35it/s]Running loglikelihood requests:  51%|█████     | 204/400 [02:44<02:34,  1.27it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [02:45<02:40,  1.21it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [02:46<02:45,  1.18it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [02:47<02:47,  1.15it/s]Running loglikelihood requests:  52%|█████▎    | 210/400 [02:48<01:46,  1.78it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [02:49<01:38,  1.90it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [02:50<01:52,  1.66it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [02:51<01:42,  1.81it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [02:52<01:55,  1.59it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [02:53<02:07,  1.44it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [02:54<01:48,  1.66it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [02:54<02:00,  1.49it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [02:55<02:10,  1.37it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [02:56<02:18,  1.29it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [02:57<02:23,  1.23it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [02:58<02:27,  1.19it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [02:59<02:30,  1.16it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [03:00<02:32,  1.14it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [03:01<02:33,  1.13it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [03:02<02:33,  1.12it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [03:03<02:33,  1.11it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [03:04<02:33,  1.11it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [03:05<02:33,  1.10it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [03:05<02:32,  1.10it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [03:06<02:31,  1.10it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [03:07<01:55,  1.43it/s]Running loglikelihood requests:  59%|█████▉    | 236/400 [03:08<02:03,  1.33it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [03:09<02:09,  1.26it/s]Running loglikelihood requests:  60%|█████▉    | 238/400 [03:10<02:14,  1.21it/s]Running loglikelihood requests:  60%|█████▉    | 239/400 [03:11<02:17,  1.17it/s]Running loglikelihood requests:  60%|██████    | 240/400 [03:12<02:18,  1.15it/s]Running loglikelihood requests:  60%|██████    | 242/400 [03:13<01:47,  1.46it/s]Running loglikelihood requests:  61%|██████    | 243/400 [03:14<01:55,  1.35it/s]Running loglikelihood requests:  61%|██████    | 244/400 [03:15<02:02,  1.28it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [03:15<02:06,  1.22it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [03:16<02:09,  1.19it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [03:17<02:11,  1.16it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [03:18<01:42,  1.47it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [03:19<01:50,  1.36it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [03:20<01:56,  1.28it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [03:21<02:00,  1.23it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [03:22<02:03,  1.19it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [03:23<02:05,  1.16it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [03:24<02:06,  1.15it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [03:25<02:07,  1.13it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [03:25<02:07,  1.12it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [03:26<02:07,  1.12it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [03:27<01:37,  1.44it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [03:28<01:43,  1.34it/s]Running loglikelihood requests:  66%|██████▌   | 264/400 [03:29<01:10,  1.93it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [03:30<01:20,  1.68it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [03:31<01:28,  1.51it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [03:32<01:35,  1.39it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [03:33<01:41,  1.30it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [03:34<01:45,  1.24it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [03:35<01:48,  1.20it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [03:35<01:50,  1.17it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [03:36<01:51,  1.15it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [03:37<01:52,  1.13it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [03:38<01:52,  1.12it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [03:39<01:09,  1.78it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [03:40<01:03,  1.91it/s]Running loglikelihood requests:  70%|███████   | 281/400 [03:41<00:59,  2.00it/s]Running loglikelihood requests:  71%|███████   | 284/400 [03:42<00:48,  2.40it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [03:43<00:57,  2.01it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [03:44<01:05,  1.74it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [03:44<01:12,  1.55it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [03:45<01:18,  1.42it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [03:46<01:23,  1.32it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [03:47<01:27,  1.26it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [03:48<01:29,  1.21it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [03:49<01:10,  1.52it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [03:50<01:15,  1.40it/s]Running loglikelihood requests:  74%|███████▍  | 295/400 [03:51<01:20,  1.31it/s]Running loglikelihood requests:  74%|███████▍  | 296/400 [03:52<01:22,  1.25it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [03:53<01:24,  1.21it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [03:53<01:06,  1.52it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [03:54<01:11,  1.39it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [03:55<01:15,  1.31it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [03:56<01:18,  1.25it/s]Running loglikelihood requests:  76%|███████▌  | 304/400 [03:57<01:02,  1.54it/s]Running loglikelihood requests:  76%|███████▋  | 305/400 [03:58<01:07,  1.41it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [03:59<00:56,  1.64it/s]Running loglikelihood requests:  77%|███████▋  | 309/400 [04:00<00:50,  1.82it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [04:01<00:55,  1.61it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [04:02<01:00,  1.46it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [04:02<01:04,  1.36it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [04:03<01:07,  1.29it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [04:04<00:54,  1.57it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [04:05<00:47,  1.77it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [04:06<00:52,  1.57it/s]Running loglikelihood requests:  80%|███████▉  | 319/400 [04:07<00:56,  1.43it/s]Running loglikelihood requests:  80%|████████  | 321/400 [04:08<00:47,  1.67it/s]Running loglikelihood requests:  81%|████████  | 323/400 [04:09<00:41,  1.84it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [04:10<00:32,  2.29it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [04:11<00:37,  1.94it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [04:11<00:42,  1.70it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [04:12<00:46,  1.53it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [04:13<00:49,  1.41it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [04:14<00:40,  1.66it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [04:15<00:44,  1.50it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [04:16<00:47,  1.39it/s]Running loglikelihood requests:  84%|████████▍ | 335/400 [04:17<00:49,  1.31it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [04:18<00:50,  1.26it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [04:19<00:51,  1.22it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [04:19<00:52,  1.19it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [04:20<00:52,  1.17it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [04:21<00:51,  1.16it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [04:22<00:50,  1.18it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [04:23<00:48,  1.19it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [04:24<00:47,  1.21it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [04:24<00:27,  1.94it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [04:25<00:24,  2.10it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [04:26<00:27,  1.84it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [04:27<00:30,  1.67it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [04:28<00:31,  1.54it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [04:28<00:33,  1.45it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [04:29<00:33,  1.39it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [04:30<00:34,  1.35it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [04:31<00:34,  1.31it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [04:32<00:34,  1.29it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [04:32<00:25,  1.65it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [04:33<00:26,  1.53it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [04:34<00:27,  1.44it/s]Running loglikelihood requests:  90%|█████████ | 361/400 [04:35<00:28,  1.38it/s]Running loglikelihood requests:  90%|█████████ | 362/400 [04:36<00:28,  1.34it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [04:37<00:21,  1.69it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [04:37<00:22,  1.56it/s]Running loglikelihood requests:  92%|█████████▏| 367/400 [04:38<00:17,  1.84it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [04:39<00:19,  1.66it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [04:40<00:20,  1.53it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [04:41<00:20,  1.45it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [04:41<00:20,  1.39it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [04:42<00:15,  1.72it/s]Running loglikelihood requests:  94%|█████████▍| 375/400 [04:43<00:12,  1.95it/s]Running loglikelihood requests:  94%|█████████▍| 376/400 [04:44<00:13,  1.74it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [04:45<00:08,  2.34it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [04:45<00:07,  2.39it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [04:46<00:08,  2.05it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [04:47<00:07,  2.19it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [04:48<00:06,  2.28it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [04:49<00:06,  1.97it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [04:49<00:05,  2.13it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [04:50<00:04,  2.24it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [04:51<00:03,  2.32it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [04:52<00:02,  2.38it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [04:53<00:01,  2.42it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [04:53<00:00,  2.07it/s]Running loglikelihood requests: 100%|██████████| 400/400 [04:54<00:00,  2.21it/s]Running loglikelihood requests: 100%|██████████| 400/400 [04:54<00:00,  1.36it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
full model:
{'mastermind_24_easy': {'alias': 'mastermind_24_easy', 'acc,none': 0.33, 'acc_stderr,none': 0.04725815626252609}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9705388716727775
0.9880227828623074
0.982119607496995
0.9941469535767887
0.984917378949356
0.9883609317461776
0.9752442385272352
0.9858149677985593
0.9966001900863091
0.9954965780195978
0.9982374916142641
0.987839947084121
0.9740425263242771
0.9802324544963317
0.9965978314947238
0.9890806289155061
0.971808392501808
0.9767123038440666
0.9820534501654181
0.9672299205809463
0.9753579231968917
0.9973837437819523
0.9951994747100236
0.9465102818948206
0.9757933184251313
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 0, 1, 3, 7, 5, 4, 2]
tensor([6, 0, 1, 3, 7, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 0, 1, 3, 7, 5, 4, 2]
tensor([6, 0, 1, 3, 7, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 1, 3, 6, 5, 4, 2]
tensor([7, 0, 1, 3, 6, 5, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 2, 3, 6, 5, 4, 1]
tensor([7, 0, 2, 3, 6, 5, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 5
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 1 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
✅ 没有发现任何驻留在 CUDA 上的张量，显存清理成功。
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

Node 220 Flask server is running on port 5220...
Node 180 Flask server is running on port 5180...
Node 83 Flask server is running on port 5083...
Node 113 Flask server is running on port 5113...
Node 231 Flask server is running on port 5231...
Node 52 Flask server is running on port 5052...
Node 228 Flask server is running on port 5228...
Node 69 Flask server is running on port 5069...
Node 216 Flask server is running on port 5216...
Node 253 Flask server is running on port 5253...
Node 55 Flask server is running on port 5055...
Node 195 Flask server is running on port 5195...
Node 48 Flask server is running on port 5048...
Node 92 Flask server is running on port 5092...
 * Serving Flask app 'Node_llama_test'
Node 164 Flask server is running on port 5164...
Node 191 Flask server is running on port 5191...
 * Debug mode: off
Node 15 Flask server is running on port 5015...
 * Serving Flask app 'Node_llama_test'
Node 186 Flask server is running on port 5186...
Node 63 Flask server is running on port 5063...
 * Debug mode: off
Node 189 Flask server is running on port 5189...
Node 202 Flask server is running on port 5202...
Node 4 Flask server is running on port 5004...
Node 116 Flask server is running on port 5116...
Node 19 Flask server is running on port 5019...
Node 170 Flask server is running on port 5170...
Node 176 Flask server is running on port 5176...
 * Serving Flask app 'Node_llama_test'
Node 139 Flask server is running on port 5139...
 * Debug mode: off
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
Node 101 Flask server is running on port 5101...
Node 18 Flask server is running on port 5018...
Node 99 Flask server is running on port 5099...
Node 132 Flask server is running on port 5132...
Node 227 Flask server is running on port 5227...
[220] Inference Step Starting
 * Serving Flask app 'Node_llama_test'
INFO:lm_eval.evaluator:Using pre-initialized model
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Serving Flask app 'Node_llama_test'
 * Serving Flask app 'Node_llama_test'
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: cb] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
 * Debug mode: off
WARNING:lm_eval.api.task:[Task: cb] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Debug mode: off
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
 * Serving Flask app 'Node_llama_test'
 * Debug mode: off
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5139
 * Running on http://173.0.64.7:5139
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5220
 * Running on http://173.0.64.7:5220
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5113
 * Running on http://173.0.64.7:5113
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5202
 * Running on http://173.0.64.7:5202
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5231
 * Running on http://173.0.64.7:5231
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5186
 * Running on http://173.0.64.7:5186
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5055
 * Running on http://173.0.64.7:5055
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5170
 * Running on http://173.0.64.7:5170
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5164
 * Running on http://173.0.64.7:5164
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5116
 * Running on http://173.0.64.7:5116
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5019
 * Running on http://173.0.64.7:5019
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5228
 * Running on http://173.0.64.7:5228
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5176
 * Running on http://173.0.64.7:5176
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5015
 * Running on http://173.0.64.7:5015
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5227
 * Running on http://173.0.64.7:5227
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5132
 * Running on http://173.0.64.7:5132
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5052
 * Running on http://173.0.64.7:5052
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5189
 * Running on http://173.0.64.7:5189
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5063
 * Running on http://173.0.64.7:5063
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5180
 * Running on http://173.0.64.7:5180
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5101
 * Running on http://173.0.64.7:5101
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5253
 * Running on http://173.0.64.7:5253
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5099
 * Running on http://173.0.64.7:5099
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5216
 * Running on http://173.0.64.7:5216
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5048
 * Running on http://173.0.64.7:5048
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5195
 * Running on http://173.0.64.7:5195
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5004
 * Running on http://173.0.64.7:5004
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5083
 * Running on http://173.0.64.7:5083
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5191
 * Running on http://173.0.64.7:5191
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5092
 * Running on http://173.0.64.7:5092
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5018
 * Running on http://173.0.64.7:5018
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5069
 * Running on http://173.0.64.7:5069
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue/revision/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 307 115
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/aps/super_glue/paths-info/3de24cf8022e94f4ee4b9d55a6f539891524d646 HTTP/1.1" 200 234
DEBUG:filelock:Attempting to acquire lock 139646703104320 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646703104320 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646703104320 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Lock 139646703104320 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_cb_0.0.0_3de24cf8022e94f4ee4b9d55a6f539891524d646.lock
DEBUG:filelock:Attempting to acquire lock 139646703102688 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139646703102688 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646/dataset_info.json
DEBUG:filelock:Attempting to release lock 139646703102688 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:filelock:Lock 139646703102688 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/cb/0.0.0/3de24cf8022e94f4ee4b9d55a6f539891524d646_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of cb from None to 0
INFO:lm_eval.api.task:Building contexts for cb on rank 0...
  0%|          | 0/56 [00:00<?, ?it/s]100%|██████████| 56/56 [00:00<00:00, 2389.92it/s]
DEBUG:lm_eval.evaluator:Task: cb; number of requests on this rank: 168
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/168 [00:00<?, ?it/s]Running loglikelihood requests:   1%|          | 1/168 [02:11<6:06:18, 131.61s/it]Running loglikelihood requests:   1%|          | 2/168 [04:13<5:48:56, 126.12s/it]Running loglikelihood requests:   2%|▏         | 4/168 [06:24<4:00:09, 87.86s/it] Running loglikelihood requests:   3%|▎         | 5/168 [08:36<4:35:42, 101.49s/it]Running loglikelihood requests:   4%|▍         | 7/168 [10:39<3:42:21, 82.87s/it] Running loglikelihood requests:   5%|▍         | 8/168 [12:44<4:09:09, 93.44s/it]Running loglikelihood requests:   6%|▌         | 10/168 [14:52<3:33:49, 81.20s/it]Running loglikelihood requests:   7%|▋         | 11/168 [16:52<3:55:21, 89.95s/it]Running loglikelihood requests:   8%|▊         | 13/168 [19:10<3:31:13, 81.77s/it]Running loglikelihood requests:   8%|▊         | 14/168 [21:12<3:52:44, 90.68s/it]Running loglikelihood requests:  10%|▉         | 16/168 [23:15<3:20:59, 79.34s/it]Running loglikelihood requests:  10%|█         | 17/168 [25:30<3:50:09, 91.45s/it]Running loglikelihood requests:  11%|█▏        | 19/168 [27:27<3:15:50, 78.86s/it]Running loglikelihood requests:  12%|█▏        | 20/168 [29:24<3:34:31, 86.97s/it]Running loglikelihood requests:  13%|█▎        | 22/168 [31:33<3:10:51, 78.43s/it]Running loglikelihood requests:  14%|█▎        | 23/168 [33:44<3:36:42, 89.68s/it]Running loglikelihood requests:  15%|█▍        | 25/168 [35:34<3:02:18, 76.49s/it]Running loglikelihood requests:  15%|█▌        | 26/168 [37:30<3:21:11, 85.01s/it]Running loglikelihood requests:  17%|█▋        | 28/168 [39:11<2:47:53, 71.95s/it]Running loglikelihood requests:  17%|█▋        | 29/168 [41:05<3:07:05, 80.76s/it]Running loglikelihood requests:  18%|█▊        | 31/168 [42:42<2:36:36, 68.58s/it]Running loglikelihood requests:  19%|█▉        | 32/168 [44:35<2:57:09, 78.16s/it]Running loglikelihood requests:  20%|█▉        | 33/168 [46:36<3:17:49, 87.92s/it]Running loglikelihood requests:  21%|██        | 35/168 [48:43<2:53:26, 78.24s/it]Running loglikelihood requests:  22%|██▏       | 37/168 [50:52<2:39:58, 73.27s/it]Running loglikelihood requests:  23%|██▎       | 38/168 [53:06<3:05:38, 85.68s/it]Running loglikelihood requests:  24%|██▍       | 40/168 [54:50<2:36:30, 73.37s/it]Running loglikelihood requests:  24%|██▍       | 41/168 [56:44<2:53:01, 81.75s/it]Running loglikelihood requests:  26%|██▌       | 43/168 [58:53<2:37:02, 75.38s/it]Running loglikelihood requests:  26%|██▌       | 44/168 [1:00:53<2:55:04, 84.71s/it]Running loglikelihood requests:  27%|██▋       | 46/168 [1:02:29<2:24:10, 70.90s/it]Running loglikelihood requests:  28%|██▊       | 47/168 [1:04:19<2:39:34, 79.13s/it]Running loglikelihood requests:  29%|██▉       | 49/168 [1:06:39<2:30:19, 75.79s/it]Running loglikelihood requests:  30%|██▉       | 50/168 [1:08:47<2:50:38, 86.76s/it]Running loglikelihood requests:  30%|███       | 51/168 [1:10:28<2:55:34, 90.04s/it]Running loglikelihood requests:  31%|███       | 52/168 [1:12:16<3:02:48, 94.56s/it]Running loglikelihood requests:  32%|███▏      | 54/168 [1:14:06<2:28:19, 78.06s/it]