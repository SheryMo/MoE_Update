nohup: ignoring input
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
网络架构：{'245': ['113', '96', '17', '132', '18', '55', '153', '202', '228', '92'], '227': ['118', '132', '153', '253', '18', '195', '55', '13'], '26': ['115', '228', '13', '17', '195', '153', '43', '168'], '114': ['202', '132', '43', '159', '195', '78', '13'], '113': ['195', '110', '153', '115', '245', '159', '96'], '18': ['245', '227', '253', '115', '55', '43', '17', '13', '159'], '132': ['253', '118', '159', '115', '245', '227', '114', '55', '153'], '195': ['114', '227', '26', '115', '113', '253', '17', '96'], '55': ['227', '132', '18', '245', '228', '115', '92'], '153': ['132', '26', '227', '245', '113', '202', '228'], '253': ['118', '132', '78', '195', '227', '18', '43', '17'], '43': ['253', '92', '18', '26', '114', '13'], '118': ['96', '168', '253', '132', '227', '115', '78', '92'], '202': ['153', '96', '245', '78', '114'], '168': ['26', '92', '228', '13', '118', '159'], '228': ['245', '92', '55', '153', '26', '168', '78', '110'], '115': ['55', '17', '118', '159', '26', '113', '18', '132', '195'], '78': ['118', '114', '228', '110', '253', '202', '92', '159', '96'], '17': ['253', '18', '195', '26', '245', '115'], '92': ['245', '118', '78', '55', '43', '168', '228'], '110': ['96', '113', '13', '228', '78'], '13': ['114', '18', '43', '227', '26', '168', '110'], '159': ['18', '78', '113', '168', '114', '132', '115'], '96': ['195', '113', '78', '202', '245', '118', '110']}
245
cuda:0
anli_r2
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:19<00:00, 36.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:19<00:00, 40.00s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/anli/anli.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 112
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli/tree/8e4813d81f46d313dac7892e1c28076917cfcdf9?recursive=False&expand=False HTTP/1.1" 307 137
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli/tree/8e4813d81f46d313dac7892e1c28076917cfcdf9?recursive=False&expand=False HTTP/1.1" 200 297
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli/tree/8e4813d81f46d313dac7892e1c28076917cfcdf9/plain_text?recursive=False&expand=False HTTP/1.1" 307 148
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli/tree/8e4813d81f46d313dac7892e1c28076917cfcdf9/plain_text?recursive=False&expand=False HTTP/1.1" 200 785
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 112
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:filelock:Attempting to acquire lock 140378596639664 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140378596639664 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378596639664 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140378596639664 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Attempting to acquire lock 140378595872112 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140378595872112 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378595872112 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140378595872112 released on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of anli_r2 from None to 0
INFO:lm_eval.api.task:Building contexts for anli_r2 on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2607.20it/s]
DEBUG:lm_eval.evaluator:Task: anli_r2; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:04<20:23,  4.09s/it]Running loglikelihood requests:   1%|          | 2/300 [00:05<11:40,  2.35s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:06<06:02,  1.22s/it]Running loglikelihood requests:   2%|▏         | 5/300 [00:07<05:49,  1.18s/it]Running loglikelihood requests:   2%|▏         | 7/300 [00:08<04:18,  1.13it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:09<04:36,  1.06it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:10<03:44,  1.29it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:11<04:01,  1.20it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:12<03:25,  1.39it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:13<03:43,  1.28it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:14<03:10,  1.49it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:15<03:29,  1.35it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:16<03:45,  1.25it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:17<03:09,  1.48it/s]Running loglikelihood requests:   7%|▋         | 22/300 [00:18<02:49,  1.64it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:19<03:09,  1.46it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:20<02:48,  1.64it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:21<03:08,  1.46it/s]Running loglikelihood requests:   9%|▉         | 27/300 [00:22<03:25,  1.33it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:23<03:38,  1.24it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:24<03:01,  1.49it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:25<03:21,  1.34it/s]Running loglikelihood requests:  11%|█         | 33/300 [00:26<02:53,  1.54it/s]Running loglikelihood requests:  12%|█▏        | 35/300 [00:27<02:37,  1.69it/s]Running loglikelihood requests:  12%|█▏        | 37/300 [00:28<02:27,  1.79it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:29<02:47,  1.57it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:30<02:31,  1.72it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:31<02:50,  1.52it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:32<02:31,  1.70it/s]Running loglikelihood requests:  15%|█▍        | 44/300 [00:33<02:49,  1.51it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:34<03:04,  1.38it/s]Running loglikelihood requests:  15%|█▌        | 46/300 [00:35<03:19,  1.27it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:36<02:46,  1.52it/s]Running loglikelihood requests:  16%|█▋        | 49/300 [00:37<03:02,  1.38it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:38<03:14,  1.28it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:39<02:41,  1.54it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:39<02:56,  1.40it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:40<02:31,  1.62it/s]Running loglikelihood requests:  19%|█▊        | 56/300 [00:41<02:47,  1.46it/s]Running loglikelihood requests:  19%|█▉        | 58/300 [00:42<02:25,  1.66it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:43<02:42,  1.49it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:44<02:21,  1.69it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:45<02:38,  1.50it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:46<02:19,  1.69it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:47<02:07,  1.83it/s]Running loglikelihood requests:  23%|██▎       | 68/300 [00:48<02:00,  1.93it/s]Running loglikelihood requests:  23%|██▎       | 70/300 [00:49<01:55,  2.00it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:50<02:12,  1.72it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:51<02:28,  1.53it/s]Running loglikelihood requests:  25%|██▍       | 74/300 [00:52<02:11,  1.72it/s]Running loglikelihood requests:  25%|██▌       | 76/300 [00:52<02:00,  1.86it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:53<02:16,  1.63it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:54<02:02,  1.80it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:55<02:17,  1.60it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:56<02:31,  1.45it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:57<02:09,  1.68it/s]Running loglikelihood requests:  28%|██▊       | 84/300 [00:58<02:24,  1.49it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:59<02:05,  1.70it/s]Running loglikelihood requests:  29%|██▉       | 87/300 [01:00<02:21,  1.50it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [01:01<02:33,  1.39it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [01:02<02:41,  1.30it/s]Running loglikelihood requests:  30%|███       | 91/300 [01:02<02:12,  1.58it/s]Running loglikelihood requests:  31%|███       | 92/300 [01:03<02:24,  1.44it/s]Running loglikelihood requests:  31%|███▏      | 94/300 [01:04<02:02,  1.67it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [01:05<02:15,  1.51it/s]Running loglikelihood requests:  32%|███▏      | 97/300 [01:06<02:04,  1.64it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [01:07<01:51,  1.80it/s]Running loglikelihood requests:  33%|███▎      | 100/300 [01:08<02:04,  1.60it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [01:09<02:16,  1.46it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [01:10<01:56,  1.69it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [01:11<01:45,  1.85it/s]Running loglikelihood requests:  35%|███▌      | 106/300 [01:12<01:58,  1.64it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [01:13<01:45,  1.81it/s]Running loglikelihood requests:  37%|███▋      | 110/300 [01:13<01:37,  1.94it/s]Running loglikelihood requests:  37%|███▋      | 112/300 [01:14<01:32,  2.03it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [01:15<01:46,  1.76it/s]Running loglikelihood requests:  38%|███▊      | 114/300 [01:16<01:58,  1.57it/s]Running loglikelihood requests:  39%|███▊      | 116/300 [01:17<01:43,  1.78it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [01:18<01:55,  1.59it/s]Running loglikelihood requests:  39%|███▉      | 118/300 [01:19<02:05,  1.45it/s]Running loglikelihood requests:  40%|████      | 120/300 [01:20<01:46,  1.70it/s]Running loglikelihood requests:  40%|████      | 121/300 [01:20<01:56,  1.53it/s]Running loglikelihood requests:  41%|████      | 123/300 [01:21<01:40,  1.75it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [01:22<01:31,  1.91it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:23<01:43,  1.68it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:24<01:54,  1.52it/s]Running loglikelihood requests:  43%|████▎     | 128/300 [01:25<02:02,  1.40it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:26<02:09,  1.32it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:27<01:45,  1.61it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:28<01:32,  1.81it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:28<01:24,  1.95it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:29<01:19,  2.05it/s]Running loglikelihood requests:  46%|████▋     | 139/300 [01:30<01:15,  2.12it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:31<01:27,  1.83it/s]Running loglikelihood requests:  47%|████▋     | 141/300 [01:32<01:37,  1.63it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:33<01:25,  1.83it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:34<01:18,  1.97it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:34<01:29,  1.73it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:35<01:38,  1.56it/s]Running loglikelihood requests:  50%|████▉     | 149/300 [01:36<01:24,  1.78it/s]Running loglikelihood requests:  50%|█████     | 151/300 [01:37<01:16,  1.95it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:38<01:26,  1.72it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:39<01:16,  1.90it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:40<01:26,  1.68it/s]Running loglikelihood requests:  52%|█████▏    | 156/300 [01:40<01:34,  1.53it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:41<01:40,  1.42it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:42<01:22,  1.70it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:43<01:13,  1.90it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:44<01:22,  1.68it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:45<01:12,  1.88it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:46<01:20,  1.67it/s]Running loglikelihood requests:  55%|█████▌    | 166/300 [01:46<01:27,  1.53it/s]Running loglikelihood requests:  56%|█████▌    | 168/300 [01:47<01:14,  1.78it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:48<01:21,  1.61it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:49<01:10,  1.84it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:50<01:03,  2.00it/s]Running loglikelihood requests:  58%|█████▊    | 174/300 [01:51<01:11,  1.75it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:51<01:18,  1.59it/s]Running loglikelihood requests:  59%|█████▊    | 176/300 [01:52<01:24,  1.47it/s]Running loglikelihood requests:  59%|█████▉    | 178/300 [01:53<01:10,  1.74it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:54<01:01,  1.94it/s]Running loglikelihood requests:  61%|██████    | 182/300 [01:55<00:56,  2.07it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:56<01:05,  1.80it/s]Running loglikelihood requests:  61%|██████▏   | 184/300 [01:57<01:11,  1.61it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:57<01:01,  1.84it/s]Running loglikelihood requests:  62%|██████▏   | 187/300 [01:58<01:08,  1.64it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:59<01:14,  1.50it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [02:00<01:02,  1.77it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [02:01<00:55,  1.95it/s]Running loglikelihood requests:  64%|██████▍   | 193/300 [02:02<01:02,  1.72it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [02:02<00:54,  1.92it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [02:03<01:01,  1.70it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [02:04<00:53,  1.91it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [02:05<00:48,  2.05it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [02:06<00:55,  1.80it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [02:07<00:49,  1.98it/s]Running loglikelihood requests:  68%|██████▊   | 204/300 [02:07<00:55,  1.74it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [02:08<01:00,  1.58it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [02:09<01:04,  1.47it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [02:10<00:53,  1.73it/s]Running loglikelihood requests:  70%|██████▉   | 209/300 [02:11<00:58,  1.57it/s]Running loglikelihood requests:  70%|███████   | 210/300 [02:12<01:01,  1.46it/s]Running loglikelihood requests:  71%|███████   | 212/300 [02:12<00:50,  1.73it/s]Running loglikelihood requests:  71%|███████   | 213/300 [02:13<00:55,  1.57it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [02:14<00:46,  1.82it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [02:15<00:41,  2.00it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [02:16<00:38,  2.12it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [02:17<00:36,  2.18it/s]Running loglikelihood requests:  74%|███████▍  | 223/300 [02:17<00:34,  2.26it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [02:18<00:38,  1.96it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [02:19<00:43,  1.74it/s]Running loglikelihood requests:  75%|███████▌  | 226/300 [02:20<00:46,  1.59it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [02:21<00:49,  1.49it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [02:22<00:50,  1.41it/s]Running loglikelihood requests:  77%|███████▋  | 230/300 [02:22<00:40,  1.73it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [02:23<00:34,  1.96it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [02:24<00:38,  1.74it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [02:25<00:33,  1.97it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [02:26<00:29,  2.12it/s]Running loglikelihood requests:  80%|███████▉  | 239/300 [02:26<00:27,  2.23it/s]Running loglikelihood requests:  80%|████████  | 240/300 [02:27<00:30,  1.94it/s]Running loglikelihood requests:  80%|████████  | 241/300 [02:28<00:34,  1.73it/s]Running loglikelihood requests:  81%|████████  | 242/300 [02:29<00:36,  1.59it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [02:30<00:30,  1.86it/s]Running loglikelihood requests:  82%|████████▏ | 245/300 [02:30<00:32,  1.68it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [02:31<00:34,  1.55it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [02:32<00:28,  1.84it/s]Running loglikelihood requests:  83%|████████▎ | 249/300 [02:33<00:30,  1.66it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [02:34<00:32,  1.54it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [02:34<00:26,  1.83it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [02:35<00:22,  2.04it/s]Running loglikelihood requests:  85%|████████▌ | 255/300 [02:36<00:24,  1.80it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [02:37<00:21,  2.01it/s]Running loglikelihood requests:  86%|████████▋ | 259/300 [02:38<00:18,  2.16it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [02:38<00:17,  2.27it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [02:39<00:15,  2.34it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [02:40<00:14,  2.40it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [02:41<00:16,  2.07it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [02:41<00:14,  2.21it/s]Running loglikelihood requests:  90%|████████▉ | 269/300 [02:42<00:16,  1.93it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [02:43<00:17,  1.74it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [02:44<00:14,  1.97it/s]Running loglikelihood requests:  91%|█████████ | 273/300 [02:45<00:15,  1.76it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [02:45<00:12,  1.99it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [02:46<00:10,  2.16it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [02:47<00:11,  1.90it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [02:48<00:12,  1.71it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [02:49<00:09,  1.98it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [02:49<00:07,  2.16it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [02:50<00:08,  1.91it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [02:51<00:06,  2.13it/s]Running loglikelihood requests:  96%|█████████▌| 287/300 [02:52<00:06,  1.89it/s]Running loglikelihood requests:  96%|█████████▋| 289/300 [02:52<00:05,  2.12it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [02:53<00:05,  1.89it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [02:54<00:03,  2.16it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [02:54<00:03,  1.94it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:55<00:03,  1.76it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:56<00:01,  2.04it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:57<00:00,  2.28it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:57<00:00,  2.05it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:57<00:00,  1.69it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'anli_r2': {'alias': 'anli_r2', 'acc,none': 0.37, 'acc_stderr,none': 0.048523658709390974}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9244540984883116
0.6900634246033951
0.6134543380435296
0.8689565152016014
0.5290243051877711
0.7748268733440488
0.7132980094248668
0.845368865582677
0.7053618777073042
0.6889888656720503
0.9230723594921337
0.4684089585032466
0.5839945995145656
0.7845879028041718
0.9669809976680984
0.8909865725318488
0.8707549857768956
0.8761905659343966
0.9352559118245083
0.8979872032046015
0.47865782275043
0.7992206780601334
0.7024602165948844
0.7606289964270208
0.7242167732145116
0.8657453170519599
0.4497158131255318
0.8558369825493786
0.7206718639663227
0.9244540984883116
0.6900634246033951
0.6134543380435296
0.8689565152016014
0.5290243051877711
0.7748268733440488
0.7132980094248668
0.845368865582677
0.7053618777073042
0.6889888656720503
0.9230723594921337
0.4684089585032466
0.5839945995145656
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[5, 3, 6, 0, 7, 2, 4, 1]
tensor([5, 3, 6, 0, 7, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 4, 5, 2, 7, 1, 3, 0]
tensor([6, 4, 5, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 3, 5, 1, 7, 0, 6, 2]
tensor([4, 3, 5, 1, 7, 0, 6, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 6, 0, 7, 2, 4, 1]
tensor([5, 3, 6, 0, 7, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[0, 3, 5, 2, 1, 0, 4, 1]
tensor([0, 3, 5, 2, 1, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 1, 0, 2, 1, 0, 5, 3]
tensor([4, 1, 0, 2, 1, 0, 5, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[5, 1, 0, 0, 1, 3, 4, 2]
tensor([5, 1, 0, 0, 1, 3, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 6
done!
Normal merging for layer 7
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 8
tensor([0, 5])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Normal merging for layer 9
tensor([2, 5])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([2, 3])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 11 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 24 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.2608 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 23 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

227
cuda:1
fda
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.00s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:None: No `generation_kwargs` specified in task config, defaulting to {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/hazyresearch/based-fda/hazyresearch/based-fda.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/revision/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/tree/42569d301e12fbcf8d5a69e04e892aa013e20314?recursive=False&expand=False HTTP/1.1" 200 291
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/tree/42569d301e12fbcf8d5a69e04e892aa013e20314/data?recursive=False&expand=False HTTP/1.1" 200 484
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda/revision/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 140374900741984 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140374900741984 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140374900741984 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140374900741984 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Attempting to acquire lock 140377317392512 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140377317392512 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377317392512 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140377317392512 released on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:fda: Using gen_kwargs: {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of fda from None to 0
INFO:lm_eval.api.task:Building contexts for fda on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 289862.06it/s]
DEBUG:lm_eval.evaluator:Task: fda; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:19<31:36, 19.16s/it]Running generate_until requests:   2%|▏         | 2/100 [00:31<24:45, 15.16s/it]Running generate_until requests:   3%|▎         | 3/100 [00:43<22:12, 13.73s/it]Running generate_until requests:   4%|▍         | 4/100 [01:00<23:47, 14.87s/it]Running generate_until requests:   5%|▌         | 5/100 [01:14<23:11, 14.65s/it]Running generate_until requests:   6%|▌         | 6/100 [01:27<22:10, 14.15s/it]Running generate_until requests:   7%|▋         | 7/100 [01:44<23:11, 14.96s/it]Running generate_until requests:   8%|▊         | 8/100 [02:00<23:42, 15.46s/it]Running generate_until requests:   9%|▉         | 9/100 [02:12<21:40, 14.30s/it]Running generate_until requests:  10%|█         | 10/100 [02:23<19:45, 13.17s/it]Running generate_until requests:  11%|█         | 11/100 [02:33<18:23, 12.40s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:50<20:02, 13.66s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:01<18:42, 12.90s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:18<20:08, 14.05s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:29<18:41, 13.19s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:41<17:51, 12.76s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:52<17:05, 12.36s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:09<18:39, 13.65s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:20<17:38, 13.07s/it]Running generate_until requests:  20%|██        | 20/100 [04:37<18:51, 14.14s/it]Running generate_until requests:  21%|██        | 21/100 [04:54<19:39, 14.93s/it]Running generate_until requests:  22%|██▏       | 22/100 [05:07<18:50, 14.49s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:24<19:25, 15.14s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:36<17:49, 14.07s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:52<18:31, 14.82s/it]Running generate_until requests:  26%|██▌       | 26/100 [06:09<19:00, 15.41s/it]Running generate_until requests:  27%|██▋       | 27/100 [06:26<19:16, 15.85s/it]Running generate_until requests:  28%|██▊       | 28/100 [06:38<17:39, 14.72s/it]Running generate_until requests:  29%|██▉       | 29/100 [06:55<18:10, 15.36s/it]Running generate_until requests:  30%|███       | 30/100 [07:08<17:02, 14.61s/it]Running generate_until requests:  31%|███       | 31/100 [07:24<17:27, 15.18s/it]Running generate_until requests:  32%|███▏      | 32/100 [07:36<16:13, 14.32s/it]Running generate_until requests:  33%|███▎      | 33/100 [07:53<16:42, 14.97s/it]Running generate_until requests:  34%|███▍      | 34/100 [08:09<16:57, 15.42s/it]Running generate_until requests:  35%|███▌      | 35/100 [08:22<15:46, 14.56s/it]Running generate_until requests:  36%|███▌      | 36/100 [08:34<14:35, 13.68s/it]Running generate_until requests:  37%|███▋      | 37/100 [08:45<13:33, 12.91s/it]Running generate_until requests:  38%|███▊      | 38/100 [08:57<13:14, 12.82s/it]Running generate_until requests:  39%|███▉      | 39/100 [09:15<14:26, 14.21s/it]Running generate_until requests:  40%|████      | 40/100 [09:27<13:38, 13.63s/it]Running generate_until requests:  41%|████      | 41/100 [09:44<14:21, 14.59s/it]Running generate_until requests:  42%|████▏     | 42/100 [09:55<13:09, 13.61s/it]Running generate_until requests:  43%|████▎     | 43/100 [10:07<12:17, 12.94s/it]Running generate_until requests:  44%|████▍     | 44/100 [10:18<11:40, 12.51s/it]Running generate_until requests:  45%|████▌     | 45/100 [10:29<10:56, 11.94s/it]Running generate_until requests:  46%|████▌     | 46/100 [10:45<12:01, 13.36s/it]Running generate_until requests:  47%|████▋     | 47/100 [11:02<12:41, 14.38s/it]Running generate_until requests:  48%|████▊     | 48/100 [11:14<11:48, 13.63s/it]Running generate_until requests:  49%|████▉     | 49/100 [11:25<10:53, 12.82s/it]Running generate_until requests:  50%|█████     | 50/100 [11:37<10:37, 12.75s/it]Running generate_until requests:  51%|█████     | 51/100 [11:49<10:07, 12.39s/it]Running generate_until requests:  52%|█████▏    | 52/100 [12:06<10:54, 13.64s/it]Running generate_until requests:  53%|█████▎    | 53/100 [12:17<10:13, 13.04s/it]Running generate_until requests:  54%|█████▍    | 54/100 [12:29<09:43, 12.68s/it]Running generate_until requests:  55%|█████▌    | 55/100 [12:46<10:24, 13.88s/it]Running generate_until requests:  56%|█████▌    | 56/100 [12:57<09:33, 13.04s/it]Running generate_until requests:  57%|█████▋    | 57/100 [13:12<09:44, 13.59s/it]Running generate_until requests:  58%|█████▊    | 58/100 [13:25<09:31, 13.60s/it]Running generate_until requests:  59%|█████▉    | 59/100 [13:42<09:54, 14.50s/it]Running generate_until requests:  60%|██████    | 60/100 [13:59<10:05, 15.13s/it]Running generate_until requests:  61%|██████    | 61/100 [14:15<10:00, 15.39s/it]Running generate_until requests:  62%|██████▏   | 62/100 [14:26<09:05, 14.34s/it]Running generate_until requests:  63%|██████▎   | 63/100 [14:37<08:12, 13.32s/it]Running generate_until requests:  64%|██████▍   | 64/100 [14:48<07:35, 12.65s/it]Running generate_until requests:  65%|██████▌   | 65/100 [15:05<08:04, 13.83s/it]Running generate_until requests:  66%|██████▌   | 66/100 [15:22<08:18, 14.67s/it]Running generate_until requests:  67%|██████▋   | 67/100 [15:38<08:24, 15.30s/it]Running generate_until requests:  68%|██████▊   | 68/100 [15:56<08:32, 16.00s/it]Running generate_until requests:  69%|██████▉   | 69/100 [16:13<08:22, 16.21s/it]Running generate_until requests:  70%|███████   | 70/100 [16:26<07:40, 15.36s/it]Running generate_until requests:  71%|███████   | 71/100 [16:43<07:41, 15.91s/it]Running generate_until requests:  72%|███████▏  | 72/100 [17:00<07:31, 16.13s/it]Running generate_until requests:  73%|███████▎  | 73/100 [17:11<06:37, 14.72s/it]Running generate_until requests:  74%|███████▍  | 74/100 [17:28<06:37, 15.29s/it]Running generate_until requests:  75%|███████▌  | 75/100 [17:40<05:54, 14.17s/it]Running generate_until requests:  76%|███████▌  | 76/100 [17:51<05:16, 13.19s/it]Running generate_until requests:  77%|███████▋  | 77/100 [18:01<04:47, 12.50s/it]Running generate_until requests:  78%|███████▊  | 78/100 [18:12<04:24, 12.02s/it]Running generate_until requests:  79%|███████▉  | 79/100 [18:29<04:39, 13.33s/it]Running generate_until requests:  80%|████████  | 80/100 [18:42<04:23, 13.20s/it]Running generate_until requests:  81%|████████  | 81/100 [18:58<04:28, 14.13s/it]Running generate_until requests:  82%|████████▏ | 82/100 [19:14<04:25, 14.77s/it]Running generate_until requests:  83%|████████▎ | 83/100 [19:27<03:59, 14.10s/it]Running generate_until requests:  84%|████████▍ | 84/100 [19:38<03:32, 13.31s/it]Running generate_until requests:  85%|████████▌ | 85/100 [19:49<03:08, 12.54s/it]Running generate_until requests:  86%|████████▌ | 86/100 [20:04<03:04, 13.19s/it]Running generate_until requests:  87%|████████▋ | 87/100 [20:15<02:43, 12.59s/it]Running generate_until requests:  88%|████████▊ | 88/100 [20:26<02:25, 12.15s/it]Running generate_until requests:  89%|████████▉ | 89/100 [20:40<02:19, 12.67s/it]Running generate_until requests:  90%|█████████ | 90/100 [20:50<01:58, 11.82s/it]Running generate_until requests:  91%|█████████ | 91/100 [20:56<01:30, 10.08s/it]Running generate_until requests:  92%|█████████▏| 92/100 [21:03<01:13,  9.20s/it]Running generate_until requests:  93%|█████████▎| 93/100 [21:13<01:06,  9.44s/it]Running generate_until requests:  94%|█████████▍| 94/100 [21:20<00:53,  8.90s/it]Running generate_until requests:  95%|█████████▌| 95/100 [21:26<00:40,  8.00s/it]Running generate_until requests:  96%|█████████▌| 96/100 [21:36<00:34,  8.56s/it]Running generate_until requests:  97%|█████████▋| 97/100 [21:40<00:21,  7.22s/it]Running generate_until requests:  98%|█████████▊| 98/100 [21:48<00:14,  7.45s/it]Running generate_until requests:  99%|█████████▉| 99/100 [21:56<00:07,  7.55s/it]Running generate_until requests: 100%|██████████| 100/100 [22:00<00:00,  6.48s/it]Running generate_until requests: 100%|██████████| 100/100 [22:00<00:00, 13.21s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'fda': {'alias': 'fda', 'contains,none': np.float64(0.87), 'contains_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 7, 0, 5, 1, 4, 3]
tensor([6, 2, 7, 0, 5, 1, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 0, 1, 5, 2, 7, 6, 3]
tensor([4, 0, 1, 5, 2, 7, 6, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 0, 4, 2, 6, 3, 7, 5]
tensor([1, 0, 4, 2, 6, 3, 7, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 6, 3, 5, 1, 4, 2]
tensor([7, 0, 6, 3, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 0, 2, 5, 1, 1, 4]
tensor([0, 3, 0, 2, 5, 1, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 1, 4, 1, 5, 2, 0]
tensor([0, 3, 1, 4, 1, 5, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 11
done!
Normal merging for layer 12
tensor([0, 2])
tensor(0)
tensor([5, 6])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 23 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 22 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

26
cuda:2
wsc
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 35.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.70s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: wsc] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: wsc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=super_glue HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/datasets/load.py:1429: FutureWarning: The repository for super_glue contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/super_glue
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/super_glue.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140376918633280 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140376918633280 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140376918633280 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140376918633280 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_wsc.fixed_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Attempting to acquire lock 140377316688384 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140377316688384 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377316688384 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140377316688384 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/wsc.fixed/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of wsc from None to 0
INFO:lm_eval.api.task:Building contexts for wsc on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 54791.69it/s]
DEBUG:lm_eval.evaluator:Task: wsc; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:42,  1.42s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:10,  1.51it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:03<01:07,  2.88it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:03<01:10,  2.71it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:04<01:11,  2.63it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:05<01:11,  2.60it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:11,  2.57it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:13,  2.50it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:07<01:11,  2.52it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:08<01:11,  2.49it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:10,  2.52it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<01:08,  2.54it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<01:07,  2.56it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<01:06,  2.58it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<01:05,  2.58it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:13<01:04,  2.60it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:14<01:03,  2.61it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:14<01:02,  2.61it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:15<01:01,  2.61it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:16<01:00,  2.62it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:17<01:00,  2.61it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:17<00:59,  2.62it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:18<00:58,  2.63it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:19<00:57,  2.65it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:20<00:56,  2.66it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:20<00:55,  2.66it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:21<00:54,  2.67it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:22<00:53,  2.69it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:23<00:52,  2.70it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:23<00:51,  2.71it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:24<00:50,  2.72it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:25<00:49,  2.73it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:25<00:48,  2.74it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:26<00:47,  2.75it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:27<00:46,  2.76it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:28<00:45,  2.76it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:28<00:45,  2.76it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:29<00:44,  2.76it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:30<00:43,  2.77it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:31<00:42,  2.79it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:31<00:41,  2.83it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:32<00:40,  2.86it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:33<00:40,  2.82it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:33<00:39,  2.82it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:34<00:38,  2.80it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:35<00:38,  2.81it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:35<00:36,  2.85it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:36<00:35,  2.90it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:37<00:34,  2.95it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:37<00:33,  2.98it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:38<00:32,  3.01it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:39<00:31,  3.02it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:39<00:30,  3.03it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:40<00:29,  3.05it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:41<00:29,  3.06it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:41<00:28,  3.09it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:42<00:20,  3.98it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:43<00:16,  4.65it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:43<00:18,  4.20it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:44<00:19,  3.87it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:45<00:19,  3.65it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:45<00:20,  3.51it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:46<00:20,  3.41it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:46<00:20,  3.32it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:47<00:19,  3.30it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:48<00:19,  3.30it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:48<00:18,  3.30it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:49<00:17,  3.29it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:49<00:17,  3.30it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:50<00:16,  3.31it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:51<00:15,  3.32it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:51<00:15,  3.33it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:52<00:14,  3.34it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:52<00:14,  3.33it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:53<00:13,  3.36it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:54<00:12,  3.39it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:54<00:12,  3.41it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:55<00:11,  3.43it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:55<00:10,  3.44it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:56<00:10,  3.46it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:57<00:09,  3.42it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:57<00:09,  3.42it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:58<00:08,  3.43it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:58<00:07,  3.44it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:59<00:07,  3.46it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:59<00:06,  3.43it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:00<00:06,  3.47it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:01<00:05,  3.50it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:01<00:04,  3.53it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:02<00:04,  3.55it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:02<00:03,  3.56it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:03<00:03,  3.58it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:03<00:02,  3.60it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:04<00:01,  3.61it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:04<00:01,  3.59it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:05<00:00,  3.63it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:06<00:00,  3.66it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:06<00:00,  3.03it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'wsc': {'alias': 'wsc', 'acc,none': 0.39, 'acc_stderr,none': 0.04902071300001973}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8279363410631274
0.19299873358047231
0.24697427628971416
0.9498246079459217
0.9208790959024347
0.5433529265767616
0.7541489406957872
0.8642404861438043
0.9451768410410958
0.6364904470004392
0.8605038470072015
0.8806563523485148
0.7320941418431636
0.7167995199876819
0.9558598958577776
0.7974395317006763
0.8001507378395173
0.8689133172877098
0.6142386786363212
0.6039861720637983
0.8068446902119512
0.6154342295548068
0.8415314242927469
0.42042589459680124
0.7443787948515065
0.7081725962998161
0.7223774755032815
0.9338202429729527
0.7700364698774241
0.8279363410631274
0.19299873358047231
0.24697427628971416
0.9498246079459217
0.9208790959024347
0.5433529265767616
0.7541489406957872
0.8642404861438043
0.9451768410410958
0.6364904470004392
0.8605038470072015
0.8806563523485148
0.7320941418431636
0.7167995199876819
0.9558598958577776
0.7974395317006763
0.8001507378395173
0.8689133172877098
0.6142386786363212
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[6, 7, 2, 4, 5, 1, 3, 0]
tensor([6, 7, 2, 4, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 7, 3, 6, 2, 5, 4, 0]
tensor([1, 7, 3, 6, 2, 5, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 5, 6, 3, 7, 4, 2, 0]
tensor([1, 5, 6, 3, 7, 4, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[1, 5, 3, 6, 7, 4, 2, 0]
tensor([1, 5, 3, 6, 7, 4, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 7, 5, 6, 1, 2, 3, 0]
tensor([4, 7, 5, 6, 1, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 7, 1, 5, 6, 3, 2, 0]
tensor([4, 7, 1, 5, 6, 3, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1, 1.0, 0, 1.0]
tensor([0, 1, 1, 1, 1, 1, 0, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
done!
Cross-layer merge completed for layers 8 to 28
done!
Normal merging for layer 29
tensor([0, 6])
tensor(0)
tensor([1, 2, 3, 4, 5, 7])
tensor(1)
done!
Cross-layer merge completed for layers 30 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 22 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 21 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

114
cuda:3
coqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.06s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa HTTP/1.1" 200 847
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/coqa/EleutherAI/coqa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/coqa/resolve/82e11af842af6c1396f5e9a5c7de260107c50cf1/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/revision/82e11af842af6c1396f5e9a5c7de260107c50cf1 HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1?recursive=False&expand=False HTTP/1.1" 200 489
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/tree/82e11af842af6c1396f5e9a5c7de260107c50cf1/data?recursive=False&expand=False HTTP/1.1" 404 79
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/coqa/revision/82e11af842af6c1396f5e9a5c7de260107c50cf1 HTTP/1.1" 200 857
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/coqa/resolve/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_infos.json HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140375979893216 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Lock 140375979893216 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375979893216 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Lock 140375979893216 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___coqa_default_0.0.0_82e11af842af6c1396f5e9a5c7de260107c50cf1.lock
DEBUG:filelock:Attempting to acquire lock 140377321220304 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:filelock:Lock 140377321220304 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377321220304 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:filelock:Lock 140377321220304 released on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___coqa/default/0.0.0/82e11af842af6c1396f5e9a5c7de260107c50cf1_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:doc_to_target returned a list. Assuming multiple targets.
INFO:lm_eval.evaluator:coqa: Using gen_kwargs: {'until': ['\nQ:']}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of coqa from None to 0
INFO:lm_eval.api.task:Building contexts for coqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 77087.01it/s]
DEBUG:lm_eval.evaluator:Task: coqa; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:05<09:47,  5.93s/it]Running generate_until requests:   2%|▏         | 2/100 [00:10<08:43,  5.35s/it]Running generate_until requests:   3%|▎         | 3/100 [00:16<09:07,  5.64s/it]Running generate_until requests:   4%|▍         | 4/100 [00:21<08:29,  5.31s/it]Running generate_until requests:   5%|▌         | 5/100 [00:26<08:16,  5.22s/it]Running generate_until requests:   6%|▌         | 6/100 [00:31<07:53,  5.04s/it]Running generate_until requests:   7%|▋         | 7/100 [00:37<08:11,  5.29s/it]Running generate_until requests:   8%|▊         | 8/100 [00:42<08:02,  5.25s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<08:04,  5.32s/it]Running generate_until requests:  10%|█         | 10/100 [00:53<08:02,  5.36s/it]Running generate_until requests:  11%|█         | 11/100 [00:58<07:48,  5.26s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:04<08:08,  5.55s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:09<07:45,  5.35s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:14<07:28,  5.21s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:18<07:07,  5.03s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:23<06:44,  4.81s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:27<06:30,  4.70s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:31<06:11,  4.53s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:36<06:05,  4.51s/it]Running generate_until requests:  20%|██        | 20/100 [01:40<05:55,  4.44s/it]Running generate_until requests:  21%|██        | 21/100 [01:45<05:55,  4.50s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:49<05:45,  4.43s/it]Running generate_until requests:  23%|██▎       | 23/100 [01:54<06:01,  4.69s/it]Running generate_until requests:  24%|██▍       | 24/100 [01:59<06:07,  4.83s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:04<05:48,  4.64s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:08<05:42,  4.62s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:13<05:36,  4.61s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:17<05:28,  4.57s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:22<05:21,  4.53s/it]Running generate_until requests:  30%|███       | 30/100 [02:27<05:23,  4.62s/it]Running generate_until requests:  31%|███       | 31/100 [02:31<05:12,  4.53s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:36<05:13,  4.61s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:40<05:09,  4.62s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:45<04:59,  4.54s/it]Running generate_until requests:  35%|███▌      | 35/100 [02:49<04:43,  4.37s/it]Running generate_until requests:  36%|███▌      | 36/100 [02:54<05:01,  4.71s/it]Running generate_until requests:  37%|███▋      | 37/100 [02:58<04:41,  4.47s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:02<04:26,  4.30s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:06<04:19,  4.25s/it]Running generate_until requests:  40%|████      | 40/100 [03:10<04:07,  4.13s/it]Running generate_until requests:  41%|████      | 41/100 [03:14<04:02,  4.12s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:19<04:18,  4.46s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:23<04:08,  4.36s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:28<04:04,  4.37s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:32<03:58,  4.34s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:36<03:46,  4.19s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:40<03:36,  4.09s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:44<03:36,  4.16s/it]Running generate_until requests:  49%|████▉     | 49/100 [03:49<03:43,  4.37s/it]Running generate_until requests:  50%|█████     | 50/100 [03:53<03:30,  4.21s/it]Running generate_until requests:  51%|█████     | 51/100 [03:58<03:36,  4.41s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:02<03:28,  4.34s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:07<03:30,  4.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:11<03:21,  4.38s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:15<03:13,  4.30s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:19<03:11,  4.36s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:24<03:05,  4.32s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:27<02:53,  4.13s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:32<02:59,  4.38s/it]Running generate_until requests:  60%|██████    | 60/100 [04:36<02:46,  4.16s/it]Running generate_until requests:  61%|██████    | 61/100 [04:41<02:48,  4.32s/it]Running generate_until requests:  62%|██████▏   | 62/100 [04:45<02:47,  4.42s/it]Running generate_until requests:  63%|██████▎   | 63/100 [04:49<02:34,  4.19s/it]Running generate_until requests:  64%|██████▍   | 64/100 [04:53<02:24,  4.02s/it]Running generate_until requests:  65%|██████▌   | 65/100 [04:56<02:15,  3.88s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:00<02:08,  3.79s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:03<02:02,  3.71s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:07<02:04,  3.88s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:14<02:20,  4.52s/it]Running generate_until requests:  70%|███████   | 70/100 [05:18<02:11,  4.38s/it]Running generate_until requests:  71%|███████   | 71/100 [05:26<02:41,  5.58s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:30<02:21,  5.06s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:34<02:07,  4.71s/it]Running generate_until requests:  74%|███████▍  | 74/100 [05:38<01:56,  4.49s/it]Running generate_until requests:  75%|███████▌  | 75/100 [05:41<01:44,  4.20s/it]Running generate_until requests:  76%|███████▌  | 76/100 [05:45<01:35,  3.98s/it]Running generate_until requests:  77%|███████▋  | 77/100 [05:49<01:34,  4.11s/it]Running generate_until requests:  78%|███████▊  | 78/100 [05:53<01:26,  3.95s/it]Running generate_until requests:  79%|███████▉  | 79/100 [05:56<01:18,  3.75s/it]Running generate_until requests:  80%|████████  | 80/100 [06:00<01:15,  3.77s/it]Running generate_until requests:  81%|████████  | 81/100 [06:06<01:23,  4.39s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:09<01:13,  4.06s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:13<01:06,  3.93s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:16<00:59,  3.72s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:19<00:53,  3.56s/it]Running generate_until requests:  86%|████████▌ | 86/100 [06:22<00:49,  3.51s/it]Running generate_until requests:  87%|████████▋ | 87/100 [06:27<00:48,  3.75s/it]Running generate_until requests:  88%|████████▊ | 88/100 [06:30<00:43,  3.66s/it]Running generate_until requests:  89%|████████▉ | 89/100 [06:33<00:37,  3.45s/it]Running generate_until requests:  90%|█████████ | 90/100 [06:36<00:32,  3.27s/it]Running generate_until requests:  91%|█████████ | 91/100 [06:39<00:27,  3.11s/it]Running generate_until requests:  92%|█████████▏| 92/100 [06:41<00:24,  3.02s/it]Running generate_until requests:  93%|█████████▎| 93/100 [06:44<00:20,  2.99s/it]Running generate_until requests:  94%|█████████▍| 94/100 [06:47<00:17,  2.99s/it]Running generate_until requests:  95%|█████████▌| 95/100 [06:51<00:15,  3.07s/it]Running generate_until requests:  96%|█████████▌| 96/100 [06:54<00:12,  3.09s/it]Running generate_until requests:  97%|█████████▋| 97/100 [06:56<00:08,  2.98s/it]Running generate_until requests:  98%|█████████▊| 98/100 [06:59<00:05,  2.84s/it]Running generate_until requests:  99%|█████████▉| 99/100 [07:02<00:02,  2.81s/it]Running generate_until requests: 100%|██████████| 100/100 [07:05<00:00,  2.81s/it]Running generate_until requests: 100%|██████████| 100/100 [07:05<00:00,  4.25s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'coqa': {'alias': 'coqa', 'em,none': 0.595, 'em_stderr,none': 0.044774970461162564, 'f1,none': 0.7211574141733987, 'f1_stderr,none': 0.037128235455690536}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6057853926542468
0.4195568875297668
0.5244744113321889
0.5202703028806769
0.6150870974034927
0.5299634576457063
0.9336763524510373
0.23649940737178063
0.388911200696845
0.6478041116722705
0.5517233675449297
0.6723258763091353
0.7175526480521238
0.8411089149883405
0.7404554224148189
0.26376935916880817
0.9373006475493478
0.5360566853939598
0.38729358133282565
0.4541602442018795
0.8623573205888978
0.7318340566806717
0.6643209906079897
0.8122565195147101
0.4707270481319977
0.9785001455445378
0.17075087907531752
0.489625917805058
0.7595051272431785
0.6057853926542468
0.4195568875297668
0.5244744113321889
0.5202703028806769
0.6150870974034927
0.5299634576457063
0.9336763524510373
0.23649940737178063
0.388911200696845
0.6478041116722705
0.5517233675449297
0.6723258763091353
0.7175526480521238
0.8411089149883405
0.7404554224148189
0.26376935916880817
0.9373006475493478
0.5360566853939598
0.38729358133282565
0.4541602442018795
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 3, 2, 0, 1, 7, 6]
tensor([5, 4, 3, 2, 0, 1, 7, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 4, 0, 2, 1, 7, 6]
tensor([5, 3, 4, 0, 2, 1, 7, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 1, 7, 0, 6, 2, 3, 4]
tensor([5, 1, 7, 0, 6, 2, 3, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 3, 6, 0, 5, 2, 4, 1]
tensor([7, 3, 6, 0, 5, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 5, 7, 2, 4, 0, 3, 1]
tensor([6, 5, 7, 2, 4, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 5, 0, 0, 1, 2, 1, 3]
tensor([4, 5, 0, 0, 1, 2, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 2, 2, 0, 3, 3]
tensor([0, 1, 1, 2, 2, 0, 3, 3], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([6])
tensor(6)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 4
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([2, 3])
tensor(2)
tensor([4, 6])
tensor(4)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Cross-layer merge completed for layers 10 to 22
done!
Normal merging for layer 23
tensor([0, 5])
tensor(0)
tensor([1, 2])
tensor(1)
tensor([3, 4])
tensor(3)
tensor([6, 7])
tensor(6)
done!
Cross-layer merge completed for layers 24 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 21 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 20 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

113
cuda:4
sciq
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:54<00:54, 54.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.63s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/sciq/sciq.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815?recursive=False&expand=False HTTP/1.1" 307 136
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815?recursive=False&expand=False HTTP/1.1" 200 291
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815/data?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/tree/2c94ad3e1aafab77146f384e23536f97a4849815/data?recursive=False&expand=False HTTP/1.1" 200 358
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq/revision/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140375980186304 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140375980186304 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375980186304 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140375980186304 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Attempting to acquire lock 140377321211856 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140377321211856 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377321211856 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140377321211856 released on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of sciq from None to 0
INFO:lm_eval.api.task:Building contexts for sciq on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1024.83it/s]
DEBUG:lm_eval.evaluator:Task: sciq; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:04<29:06,  4.38s/it]Running loglikelihood requests:   0%|          | 2/400 [00:07<25:17,  3.81s/it]Running loglikelihood requests:   1%|          | 3/400 [00:11<24:00,  3.63s/it]Running loglikelihood requests:   1%|          | 4/400 [00:14<23:33,  3.57s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:17<22:43,  3.45s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:21<22:22,  3.41s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:24<21:53,  3.34s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:27<21:33,  3.30s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:30<20:29,  3.15s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:33<19:45,  3.04s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:36<19:13,  2.96s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:38<19:00,  2.94s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:41<18:18,  2.84s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:44<17:48,  2.77s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:46<17:25,  2.72s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:49<17:18,  2.70s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:52<17:16,  2.71s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:54<17:07,  2.69s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:57<16:41,  2.63s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:59<16:29,  2.61s/it]Running loglikelihood requests:   5%|▌         | 21/400 [01:02<16:12,  2.57s/it]Running loglikelihood requests:   6%|▌         | 22/400 [01:04<16:14,  2.58s/it]Running loglikelihood requests:   6%|▌         | 23/400 [01:07<16:01,  2.55s/it]Running loglikelihood requests:   6%|▌         | 24/400 [01:09<15:50,  2.53s/it]Running loglikelihood requests:   6%|▋         | 25/400 [01:12<15:23,  2.46s/it]Running loglikelihood requests:   6%|▋         | 26/400 [01:14<15:02,  2.41s/it]Running loglikelihood requests:   7%|▋         | 27/400 [01:16<14:59,  2.41s/it]Running loglikelihood requests:   7%|▋         | 28/400 [01:19<14:43,  2.38s/it]Running loglikelihood requests:   7%|▋         | 29/400 [01:21<14:07,  2.29s/it]Running loglikelihood requests:   8%|▊         | 30/400 [01:23<13:43,  2.22s/it]Running loglikelihood requests:   8%|▊         | 31/400 [01:25<13:25,  2.18s/it]Running loglikelihood requests:   8%|▊         | 32/400 [01:27<13:15,  2.16s/it]Running loglikelihood requests:   8%|▊         | 33/400 [01:29<12:50,  2.10s/it]Running loglikelihood requests:   8%|▊         | 34/400 [01:31<12:31,  2.05s/it]Running loglikelihood requests:   9%|▉         | 35/400 [01:33<12:18,  2.02s/it]Running loglikelihood requests:   9%|▉         | 36/400 [01:35<12:09,  2.00s/it]Running loglikelihood requests:   9%|▉         | 37/400 [01:37<12:01,  1.99s/it]Running loglikelihood requests:  10%|▉         | 38/400 [01:39<11:54,  1.97s/it]Running loglikelihood requests:  10%|█         | 40/400 [01:41<09:03,  1.51s/it]Running loglikelihood requests:  10%|█         | 41/400 [01:42<09:27,  1.58s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:44<09:46,  1.64s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:46<10:12,  1.71s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:48<10:27,  1.76s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:50<10:18,  1.74s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:51<10:11,  1.73s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:53<10:06,  1.72s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:55<10:12,  1.74s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:57<10:14,  1.75s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:58<10:11,  1.75s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [02:00<10:14,  1.76s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [02:02<10:15,  1.77s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [02:04<09:50,  1.70s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [02:05<09:31,  1.65s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [02:07<09:19,  1.62s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [02:08<06:54,  1.21s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [02:10<07:13,  1.27s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [02:11<07:28,  1.32s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [02:12<04:55,  1.14it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [02:14<05:33,  1.01it/s]Running loglikelihood requests:  16%|█▌        | 64/400 [02:15<06:06,  1.09s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [02:17<06:29,  1.16s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [02:18<06:47,  1.22s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [02:20<07:01,  1.26s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [02:21<07:13,  1.31s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [02:22<07:17,  1.32s/it]Running loglikelihood requests:  18%|█▊        | 70/400 [02:24<07:19,  1.33s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [02:25<07:20,  1.34s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [02:26<07:20,  1.34s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [02:28<07:19,  1.34s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [02:29<07:17,  1.34s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [02:30<04:29,  1.20it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [02:32<05:01,  1.07it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [02:33<05:27,  1.02s/it]Running loglikelihood requests:  20%|██        | 81/400 [02:34<04:31,  1.17it/s]Running loglikelihood requests:  20%|██        | 82/400 [02:35<04:54,  1.08it/s]Running loglikelihood requests:  21%|██        | 83/400 [02:37<05:15,  1.00it/s]Running loglikelihood requests:  21%|██        | 84/400 [02:38<05:31,  1.05s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:39<05:43,  1.09s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:40<05:51,  1.12s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:41<03:46,  1.37it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [02:43<04:15,  1.21it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [02:44<04:38,  1.11it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [02:45<04:56,  1.04it/s]Running loglikelihood requests:  23%|██▎       | 93/400 [02:46<05:10,  1.01s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:47<02:55,  1.73it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [02:48<03:24,  1.48it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [02:49<03:51,  1.30it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [02:51<04:14,  1.18it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [02:52<04:34,  1.09it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [02:53<04:53,  1.02it/s]Running loglikelihood requests:  26%|██▌       | 103/400 [02:54<05:05,  1.03s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:55<05:12,  1.06s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [02:56<05:16,  1.07s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [02:57<05:18,  1.08s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [02:58<05:20,  1.09s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [03:00<05:20,  1.10s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [03:01<05:19,  1.10s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [03:02<05:17,  1.10s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [03:03<05:16,  1.09s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [03:04<05:23,  1.12s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [03:05<05:23,  1.13s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [03:06<05:22,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [03:07<05:22,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [03:09<05:17,  1.12s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [03:10<05:12,  1.10s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [03:11<05:07,  1.09s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [03:12<05:08,  1.10s/it]Running loglikelihood requests:  30%|███       | 120/400 [03:13<05:08,  1.10s/it]Running loglikelihood requests:  30%|███       | 121/400 [03:14<05:07,  1.10s/it]Running loglikelihood requests:  30%|███       | 122/400 [03:15<05:07,  1.10s/it]Running loglikelihood requests:  31%|███       | 123/400 [03:16<05:10,  1.12s/it]Running loglikelihood requests:  31%|███       | 124/400 [03:17<05:07,  1.12s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [03:18<05:03,  1.11s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [03:20<04:59,  1.09s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [03:21<04:53,  1.07s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:22<04:48,  1.06s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:23<04:44,  1.05s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:24<04:41,  1.04s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:25<04:38,  1.04s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:26<02:51,  1.55it/s]Running loglikelihood requests:  34%|███▍      | 135/400 [03:27<03:11,  1.38it/s]Running loglikelihood requests:  34%|███▍      | 136/400 [03:28<03:28,  1.27it/s]Running loglikelihood requests:  34%|███▍      | 137/400 [03:29<03:41,  1.19it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [03:30<03:54,  1.12it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [03:31<04:06,  1.06it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [03:32<02:41,  1.60it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [03:33<03:01,  1.42it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [03:34<03:18,  1.29it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [03:35<03:32,  1.20it/s]Running loglikelihood requests:  36%|███▋      | 146/400 [03:36<03:43,  1.14it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [03:37<03:51,  1.09it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [03:38<03:57,  1.06it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [03:39<04:02,  1.03it/s]Running loglikelihood requests:  38%|███▊      | 150/400 [03:40<04:06,  1.01it/s]Running loglikelihood requests:  38%|███▊      | 151/400 [03:41<04:06,  1.01it/s]Running loglikelihood requests:  38%|███▊      | 152/400 [03:42<04:05,  1.01it/s]Running loglikelihood requests:  38%|███▊      | 153/400 [03:43<04:04,  1.01it/s]Running loglikelihood requests:  38%|███▊      | 154/400 [03:44<04:03,  1.01it/s]Running loglikelihood requests:  39%|███▉      | 155/400 [03:45<04:02,  1.01it/s]Running loglikelihood requests:  39%|███▉      | 156/400 [03:46<04:01,  1.01it/s]Running loglikelihood requests:  39%|███▉      | 157/400 [03:47<03:59,  1.01it/s]Running loglikelihood requests:  40%|███▉      | 158/400 [03:48<03:58,  1.02it/s]Running loglikelihood requests:  40%|███▉      | 159/400 [03:49<03:57,  1.02it/s]Running loglikelihood requests:  40%|████      | 160/400 [03:50<03:55,  1.02it/s]Running loglikelihood requests:  40%|████      | 161/400 [03:51<03:55,  1.01it/s]Running loglikelihood requests:  40%|████      | 162/400 [03:52<03:53,  1.02it/s]Running loglikelihood requests:  41%|████      | 163/400 [03:53<03:52,  1.02it/s]Running loglikelihood requests:  41%|████      | 164/400 [03:54<03:50,  1.02it/s]Running loglikelihood requests:  41%|████▏     | 165/400 [03:55<03:47,  1.03it/s]Running loglikelihood requests:  42%|████▏     | 166/400 [03:56<03:45,  1.04it/s]Running loglikelihood requests:  42%|████▏     | 167/400 [03:57<03:45,  1.04it/s]Running loglikelihood requests:  42%|████▏     | 168/400 [03:58<03:44,  1.03it/s]Running loglikelihood requests:  42%|████▏     | 169/400 [03:59<03:42,  1.04it/s]Running loglikelihood requests:  42%|████▎     | 170/400 [04:00<03:40,  1.04it/s]Running loglikelihood requests:  43%|████▎     | 172/400 [04:01<02:47,  1.36it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [04:01<02:57,  1.28it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [04:02<03:04,  1.23it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [04:03<02:01,  1.83it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [04:04<02:17,  1.61it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [04:05<02:31,  1.46it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [04:06<02:42,  1.36it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [04:07<02:50,  1.28it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [04:08<02:55,  1.24it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [04:09<02:58,  1.22it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [04:10<03:00,  1.20it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [04:10<03:01,  1.18it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [04:11<03:02,  1.18it/s]Running loglikelihood requests:  47%|████▋     | 187/400 [04:12<03:02,  1.17it/s]Running loglikelihood requests:  47%|████▋     | 188/400 [04:13<03:01,  1.17it/s]Running loglikelihood requests:  47%|████▋     | 189/400 [04:14<03:00,  1.17it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [04:15<03:00,  1.17it/s]Running loglikelihood requests:  48%|████▊     | 191/400 [04:16<02:58,  1.17it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [04:16<02:57,  1.17it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [04:17<02:55,  1.18it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [04:18<02:54,  1.18it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [04:19<02:52,  1.19it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [04:20<02:51,  1.19it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [04:21<02:49,  1.20it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [04:21<02:48,  1.20it/s]Running loglikelihood requests:  50%|████▉     | 199/400 [04:22<02:46,  1.21it/s]Running loglikelihood requests:  50%|█████     | 200/400 [04:23<02:45,  1.21it/s]Running loglikelihood requests:  50%|█████     | 201/400 [04:24<02:44,  1.21it/s]Running loglikelihood requests:  50%|█████     | 202/400 [04:25<02:42,  1.22it/s]Running loglikelihood requests:  51%|█████     | 203/400 [04:25<02:41,  1.22it/s]Running loglikelihood requests:  51%|█████     | 204/400 [04:26<02:42,  1.20it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:27<02:43,  1.19it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:28<02:44,  1.18it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:29<02:43,  1.18it/s]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:30<02:44,  1.16it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:31<02:44,  1.16it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:32<01:41,  1.85it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:32<01:53,  1.65it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:33<02:02,  1.51it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [04:34<02:10,  1.42it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [04:35<02:16,  1.35it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [04:36<02:20,  1.30it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [04:37<02:26,  1.24it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [04:37<02:27,  1.23it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [04:38<02:29,  1.20it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [04:39<02:30,  1.19it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [04:40<02:29,  1.19it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [04:41<02:28,  1.19it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [04:42<02:26,  1.21it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [04:42<02:23,  1.22it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [04:43<02:21,  1.23it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [04:44<02:20,  1.23it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [04:45<02:18,  1.24it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [04:46<02:18,  1.23it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [04:47<02:18,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [04:47<02:16,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [04:48<02:15,  1.24it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [04:49<02:15,  1.23it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [04:50<02:14,  1.23it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [04:51<02:25,  1.14it/s]Running loglikelihood requests:  59%|█████▉    | 236/400 [04:52<02:21,  1.16it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [04:52<02:17,  1.18it/s]Running loglikelihood requests:  60%|██████    | 240/400 [04:53<01:23,  1.92it/s]Running loglikelihood requests:  60%|██████    | 241/400 [04:54<01:31,  1.73it/s]Running loglikelihood requests:  60%|██████    | 242/400 [04:55<01:38,  1.60it/s]Running loglikelihood requests:  61%|██████    | 243/400 [04:56<01:44,  1.51it/s]Running loglikelihood requests:  61%|██████    | 244/400 [04:56<01:48,  1.44it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [04:57<01:50,  1.40it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [04:58<01:52,  1.37it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [04:59<01:53,  1.35it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [04:59<01:53,  1.34it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:00<01:53,  1.33it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:01<01:52,  1.33it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:02<01:52,  1.33it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:02<01:51,  1.33it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:03<01:50,  1.33it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:04<01:49,  1.33it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:05<01:49,  1.33it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:05<01:49,  1.32it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:06<01:49,  1.30it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:07<01:49,  1.30it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:08<01:49,  1.28it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:09<01:49,  1.28it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:09<01:46,  1.31it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [05:10<01:43,  1.34it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [05:11<01:40,  1.36it/s]Running loglikelihood requests:  66%|██████▌   | 264/400 [05:12<01:39,  1.37it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [05:12<01:36,  1.41it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [05:13<01:33,  1.43it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [05:14<01:31,  1.45it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [05:14<01:32,  1.42it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [05:15<01:33,  1.40it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [05:16<01:30,  1.44it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [05:16<01:27,  1.47it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [05:17<01:25,  1.49it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [05:18<01:23,  1.52it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [05:18<01:20,  1.56it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [05:19<01:19,  1.57it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [05:19<01:18,  1.59it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [05:20<01:16,  1.60it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [05:21<01:15,  1.61it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [05:21<01:15,  1.61it/s]Running loglikelihood requests:  70%|███████   | 280/400 [05:22<01:13,  1.63it/s]Running loglikelihood requests:  70%|███████   | 281/400 [05:22<01:11,  1.66it/s]Running loglikelihood requests:  70%|███████   | 282/400 [05:23<01:10,  1.68it/s]Running loglikelihood requests:  71%|███████   | 283/400 [05:24<01:09,  1.69it/s]Running loglikelihood requests:  71%|███████   | 284/400 [05:24<01:08,  1.70it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [05:25<01:08,  1.68it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [05:25<01:07,  1.70it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [05:26<01:06,  1.71it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [05:26<01:05,  1.72it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [05:27<01:04,  1.72it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [05:28<01:03,  1.73it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [05:28<01:02,  1.73it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [05:29<01:02,  1.73it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [05:29<01:03,  1.69it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [05:30<01:02,  1.69it/s]Running loglikelihood requests:  74%|███████▍  | 295/400 [05:31<01:01,  1.70it/s]Running loglikelihood requests:  74%|███████▍  | 296/400 [05:31<01:00,  1.72it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [05:32<00:59,  1.74it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [05:32<00:58,  1.75it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [05:33<00:57,  1.76it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [05:33<00:56,  1.77it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [05:34<00:55,  1.78it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [05:35<00:55,  1.78it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [05:35<00:54,  1.79it/s]Running loglikelihood requests:  76%|███████▌  | 304/400 [05:36<00:53,  1.79it/s]Running loglikelihood requests:  76%|███████▋  | 305/400 [05:36<00:53,  1.79it/s]Running loglikelihood requests:  76%|███████▋  | 306/400 [05:37<00:52,  1.80it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [05:37<00:51,  1.80it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [05:38<00:31,  2.89it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [05:38<00:34,  2.58it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [05:39<00:37,  2.35it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [05:39<00:39,  2.19it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [05:40<00:41,  2.08it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [05:41<00:42,  2.00it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [05:41<00:43,  1.95it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [05:42<00:43,  1.92it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [05:42<00:43,  1.90it/s]Running loglikelihood requests:  80%|███████▉  | 319/400 [05:43<00:42,  1.90it/s]Running loglikelihood requests:  80%|████████  | 321/400 [05:43<00:32,  2.42it/s]Running loglikelihood requests:  80%|████████  | 322/400 [05:44<00:34,  2.27it/s]Running loglikelihood requests:  81%|████████  | 323/400 [05:44<00:35,  2.17it/s]Running loglikelihood requests:  81%|████████  | 324/400 [05:45<00:36,  2.09it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [05:45<00:36,  2.04it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [05:46<00:36,  2.00it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [05:46<00:37,  1.97it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [05:47<00:36,  1.96it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [05:47<00:36,  1.95it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [05:48<00:36,  1.94it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [05:49<00:35,  1.94it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [05:49<00:35,  1.94it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [05:50<00:36,  1.81it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [05:50<00:35,  1.86it/s]Running loglikelihood requests:  84%|████████▍ | 335/400 [05:51<00:34,  1.90it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [05:51<00:33,  1.93it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [05:52<00:32,  1.95it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [05:52<00:31,  1.97it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [05:53<00:30,  1.99it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [05:53<00:30,  2.00it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [05:54<00:29,  2.01it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [05:54<00:28,  2.01it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [05:55<00:28,  2.02it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [05:55<00:27,  2.02it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [05:56<00:27,  2.03it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [05:56<00:26,  2.04it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [05:57<00:25,  2.04it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [05:57<00:25,  2.04it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [05:58<00:24,  2.05it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [05:58<00:24,  2.05it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [05:59<00:23,  2.05it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [05:59<00:23,  2.05it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [05:59<00:22,  2.05it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [06:00<00:22,  2.06it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [06:00<00:21,  2.06it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [06:01<00:21,  2.07it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [06:01<00:21,  2.04it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [06:02<00:20,  2.06it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [06:02<00:19,  2.07it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [06:03<00:19,  2.07it/s]Running loglikelihood requests:  90%|█████████ | 361/400 [06:03<00:18,  2.08it/s]Running loglikelihood requests:  90%|█████████ | 362/400 [06:04<00:18,  2.09it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [06:04<00:17,  2.09it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [06:05<00:17,  2.10it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [06:05<00:16,  2.10it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [06:06<00:16,  2.11it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [06:06<00:11,  2.74it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [06:07<00:12,  2.55it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [06:07<00:12,  2.42it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [06:08<00:12,  2.31it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [06:08<00:09,  2.88it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [06:09<00:09,  2.66it/s]Running loglikelihood requests:  94%|█████████▍| 375/400 [06:09<00:09,  2.50it/s]Running loglikelihood requests:  94%|█████████▍| 376/400 [06:10<00:10,  2.40it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [06:10<00:09,  2.33it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [06:10<00:09,  2.28it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [06:11<00:09,  2.26it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [06:11<00:08,  2.24it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [06:12<00:08,  2.22it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [06:12<00:08,  2.22it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [06:13<00:07,  2.22it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [06:13<00:07,  2.19it/s]Running loglikelihood requests:  96%|█████████▋| 385/400 [06:14<00:06,  2.18it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [06:14<00:06,  2.18it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [06:15<00:05,  2.18it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [06:15<00:05,  2.18it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [06:15<00:05,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [06:16<00:04,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [06:16<00:04,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [06:17<00:03,  2.19it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [06:17<00:03,  2.20it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [06:18<00:02,  2.20it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [06:18<00:02,  2.21it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [06:19<00:01,  2.21it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [06:19<00:01,  2.22it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [06:20<00:00,  2.23it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [06:20<00:00,  2.21it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:20<00:00,  2.24it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:20<00:00,  1.05it/s]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'sciq': {'alias': 'sciq', 'acc,none': 0.94, 'acc_stderr,none': 0.023868325657594204, 'acc_norm,none': 0.91, 'acc_norm_stderr,none': 0.028762349126466136}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.969062788859705
0.9024924890572922
0.7706109127217512
0.8221264026535647
0.9190490061886575
0.9866654579796295
0.6586322754204971
0.7962110384246164
0.8195614021629236
0.7124178311176441
0.787697814339696
0.7034455022322618
0.8136386046534271
0.8174990104652458
0.6784276389594894
0.8698440245672888
0.8886492811850213
0.6541737276411673
0.6560861559753316
0.8139845219953913
0.6714741870309046
0.6164364868717988
0.8331581872497299
0.9065420049234512
0.9246185715568276
0.7477515960551026
0.574165362968651
0.8586446364199891
0.8889771415746612
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 2, 6, 1, 5, 0]
tensor([7, 3, 4, 2, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 5, 3, 4, 0, 7, 1]
tensor([6, 2, 5, 3, 4, 0, 7, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 6, 2, 7, 1, 4, 0]
tensor([5, 3, 6, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 4, 2, 1, 3, 5, 1]
tensor([0, 0, 4, 2, 1, 3, 5, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 3, 4, 5, 0, 1, 1]
tensor([0, 2, 3, 4, 5, 0, 1, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 0, 2, 2, 3, 1]
tensor([0, 3, 1, 0, 2, 2, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 1, 1.0, 1.0, 1.0, 1.0, 1]
tensor([0, 0, 1, 1, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 4
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 9
done!
Normal merging for layer 10
tensor([0, 1])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 11 to 12
done!
Normal merging for layer 13
tensor([0, 5])
tensor(0)
tensor([6, 7])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 14 to 19
done!
Normal merging for layer 20
tensor([0, 3])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 22 to 23
done!
Normal merging for layer 24
tensor([0, 1])
tensor(0)
tensor([2, 3, 4, 5, 6, 7])
tensor(2)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 20 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.2608 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 19 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

18
cuda:5
rte
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.17s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 31.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.69s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: rte] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 307 136
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c?recursive=False&expand=False HTTP/1.1" 200 530
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 307 139
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/ax?recursive=False&expand=False HTTP/1.1" 200 231
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 111
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/revision/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/rte?recursive=False&expand=False HTTP/1.1" 307 140
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/rte?recursive=False&expand=False HTTP/1.1" 200 354
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140375980284320 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375980284320 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375980284320 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375980284320 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_rte_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140386836059520 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140386836059520 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140386836059520 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140386836059520 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/rte/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of rte from None to 0
INFO:lm_eval.api.task:Building contexts for rte on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2648.22it/s]
DEBUG:lm_eval.evaluator:Task: rte; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:02<07:27,  2.25s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:03<03:45,  1.14s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:05<02:53,  1.12it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:06<02:30,  1.28it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:07<02:17,  1.39it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:08<02:08,  1.47it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:09<02:02,  1.52it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:11<01:57,  1.57it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:12<01:53,  1.61it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:13<01:50,  1.64it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:14<01:46,  1.68it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:15<01:41,  1.74it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:16<01:38,  1.78it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:17<01:34,  1.83it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:18<01:31,  1.88it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:19<01:28,  1.91it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:20<01:26,  1.94it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:21<01:24,  1.96it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:22<01:23,  1.96it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:23<01:22,  1.96it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:24<01:20,  1.98it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:25<01:18,  2.01it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:26<01:16,  2.02it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:27<01:14,  2.06it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:28<01:11,  2.12it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:29<01:08,  2.17it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:30<01:06,  2.21it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:31<01:03,  2.27it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:31<01:01,  2.34it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:32<00:59,  2.38it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:33<00:57,  2.43it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:34<00:55,  2.46it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:35<00:54,  2.48it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:35<00:53,  2.51it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:36<00:51,  2.53it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:37<00:50,  2.55it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:38<00:49,  2.57it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:38<00:48,  2.60it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:39<00:46,  2.63it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:40<00:45,  2.65it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:41<00:44,  2.67it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:41<00:43,  2.70it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:42<00:42,  2.72it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:43<00:41,  2.73it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:44<00:40,  2.76it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:44<00:39,  2.78it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:45<00:38,  2.80it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:46<00:37,  2.82it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:46<00:36,  2.83it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:47<00:35,  2.85it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:48<00:34,  2.87it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:48<00:33,  2.87it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:49<00:32,  2.89it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:50<00:31,  2.91it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:50<00:31,  2.92it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:51<00:30,  2.94it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:52<00:29,  2.95it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:52<00:28,  2.96it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:53<00:28,  2.96it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:54<00:27,  2.98it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:54<00:26,  2.98it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:55<00:25,  2.99it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:56<00:24,  3.00it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:56<00:24,  3.01it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:57<00:23,  3.02it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:58<00:22,  3.02it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:58<00:22,  3.04it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:59<00:21,  3.07it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:00<00:20,  3.09it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:00<00:19,  3.10it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:01<00:18,  3.12it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:02<00:18,  3.14it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:02<00:17,  3.16it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:03<00:16,  3.17it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:03<00:16,  3.18it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:04<00:15,  3.08it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:05<00:15,  3.10it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:05<00:14,  3.14it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:06<00:13,  3.18it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:07<00:12,  3.22it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:07<00:12,  3.24it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:08<00:11,  3.27it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:08<00:10,  3.28it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:09<00:09,  3.30it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:10<00:09,  3.32it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:10<00:08,  3.36it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:11<00:07,  3.38it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:11<00:07,  3.39it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:12<00:06,  3.41it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:13<00:06,  3.42it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:13<00:05,  3.43it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:14<00:04,  3.44it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:14<00:04,  3.45it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:15<00:03,  3.47it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:15<00:03,  3.47it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:16<00:02,  3.49it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:17<00:01,  3.51it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:17<00:01,  3.53it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:18<00:00,  3.61it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:18<00:00,  3.68it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:18<00:00,  2.54it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'rte': {'alias': 'rte', 'acc,none': 0.5, 'acc_stderr,none': 0.050251890762960605}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
0.5728915095234594
0.1682455054057436
0.93212414632396
0.9148362604533635
0.8268537756297094
0.7592245907029287
0.7256008379011685
0.7109756105942956
0.34161229456626735
0.905233410256777
0.5205040718697735
0.4121994254524892
0.7398116665887099
0.6225415196831932
0.7923970242263771
0.7353888240887675
0.6535613357308766
0.7757058271862038
0.734046359122903
0.4471799126982846
0.773619360921301
0.7955347039939479
0.8672068064531693
0.8652880343596522
0.3302235467760883
0.6789268064017625
0.6072221471952108
0.9194446824778495
0.4812004589187253
Total groups 73 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 7, 1, 6, 4, 3, 0]
tensor([5, 2, 7, 1, 6, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 6, 0, 7, 3, 4, 1]
tensor([5, 2, 6, 0, 7, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 1, 7, 2, 5, 4, 3, 0]
tensor([6, 1, 7, 2, 5, 4, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 7, 2, 4, 1, 5, 0]
tensor([6, 3, 7, 2, 4, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 5, 6, 2, 3, 1, 4, 0]
tensor([7, 5, 6, 2, 3, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 5, 4, 1, 0, 1, 3]
tensor([0, 2, 5, 4, 1, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 5 to 8
done!
Normal merging for layer 9
tensor([0, 5])
tensor(0)
tensor([4, 6])
tensor(4)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 30
done!
Normal merging for layer 31
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 19 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 18 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

132
cuda:6
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 31.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.57s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/mnli?recursive=False&expand=False HTTP/1.1" 200 512
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140375980720976 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375980720976 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375980720976 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375980720976 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140375975100640 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140375975100640 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375975100640 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140375975100640 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 121012.81it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:02<10:57,  2.20s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<08:08,  1.64s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:29,  1.10it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:05<04:31,  1.09it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:06<03:24,  1.43it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:07<03:37,  1.34it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:07<02:55,  1.65it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:08<03:08,  1.53it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:09<02:38,  1.81it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:10<02:52,  1.66it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:11<02:26,  1.94it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:11<02:39,  1.77it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:12<02:51,  1.65it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:13<02:22,  1.96it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:14<02:36,  1.78it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:14<02:15,  2.05it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:15<02:01,  2.26it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:16<02:16,  2.00it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:16<02:01,  2.24it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:17<02:16,  1.99it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:18<02:28,  1.81it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:19<02:38,  1.69it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:19<02:46,  1.61it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:20<02:15,  1.97it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:21<02:01,  2.18it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:21<01:50,  2.37it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:22<01:42,  2.52it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:23<01:57,  2.21it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:24<02:10,  1.98it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:24<02:20,  1.83it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:25<01:58,  2.15it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:26<01:46,  2.38it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:26<01:59,  2.10it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:27<01:46,  2.35it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:28<01:38,  2.53it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:28<01:51,  2.22it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:29<02:02,  2.00it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:30<02:12,  1.85it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:30<01:51,  2.18it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:31<01:39,  2.43it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:32<01:31,  2.60it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:32<01:44,  2.28it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:33<01:34,  2.50it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:34<01:46,  2.21it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:34<01:56,  2.00it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:35<02:05,  1.86it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:36<01:44,  2.22it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:36<01:32,  2.47it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:37<01:44,  2.19it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:38<01:53,  1.99it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:38<01:37,  2.32it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:39<01:27,  2.54it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:40<01:21,  2.71it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:40<01:32,  2.37it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:41<01:42,  2.13it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:41<01:51,  1.96it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:42<01:57,  1.84it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:43<01:36,  2.23it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:43<01:45,  2.03it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:44<01:29,  2.36it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:45<01:39,  2.12it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:45<01:26,  2.43it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:46<01:18,  2.64it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:47<01:13,  2.80it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:47<01:23,  2.43it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:48<01:16,  2.66it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:48<01:25,  2.34it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:49<01:16,  2.59it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:50<01:26,  2.29it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:50<01:34,  2.08it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:51<01:41,  1.94it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:52<01:46,  1.84it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:52<01:25,  2.25it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:53<01:33,  2.05it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:53<01:39,  1.92it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:54<01:22,  2.30it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:55<01:12,  2.57it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:55<01:06,  2.76it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:56<01:03,  2.90it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:57<01:00,  3.00it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:57<00:58,  3.07it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:58<01:07,  2.64it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [00:58<01:02,  2.82it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [00:59<01:10,  2.47it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:00<01:18,  2.22it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:00<01:24,  2.05it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:01<01:10,  2.42it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:01<01:02,  2.68it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:02<00:57,  2.89it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:03<01:05,  2.54it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:03<01:12,  2.29it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:04<01:17,  2.12it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:04<01:21,  1.99it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:05<01:24,  1.91it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:06<01:09,  2.29it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:06<01:00,  2.62it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:07<01:06,  2.36it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:07<00:57,  2.68it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:08<01:04,  2.39it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:09<01:09,  2.19it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:09<01:14,  2.05it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:10<01:00,  2.46it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:10<00:53,  2.76it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:11<00:49,  2.98it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:11<00:55,  2.60it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:12<00:49,  2.86it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:13<00:46,  3.04it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:13<00:43,  3.18it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:14<00:50,  2.75it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:14<00:45,  2.97it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:15<00:51,  2.61it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:15<00:46,  2.88it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:16<00:42,  3.07it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:17<00:48,  2.68it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:17<00:53,  2.41it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:18<01:04,  1.99it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:18<01:06,  1.92it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:19<00:52,  2.38it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:20<00:45,  2.73it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:20<00:40,  2.98it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:21<00:45,  2.63it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:21<00:49,  2.38it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:22<00:42,  2.74it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:22<00:38,  3.00it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:23<00:43,  2.63it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:24<00:38,  2.93it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:24<00:35,  3.14it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:25<00:39,  2.75it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:25<00:43,  2.48it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:26<00:37,  2.83it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:26<00:41,  2.54it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:27<00:44,  2.33it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:27<00:37,  2.74it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:28<00:40,  2.47it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:28<00:43,  2.29it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:29<00:45,  2.16it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:29<00:36,  2.62it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:30<00:32,  2.96it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:31<00:35,  2.63it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:31<00:31,  2.96it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:32<00:28,  3.19it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:32<00:26,  3.35it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:33<00:30,  2.88it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:33<00:26,  3.15it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:34<00:30,  2.79it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:34<00:32,  2.52it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:35<00:27,  2.91it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:35<00:24,  3.19it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:36<00:27,  2.82it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:36<00:24,  3.13it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:37<00:27,  2.78it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:37<00:23,  3.11it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:38<00:26,  2.76it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:38<00:28,  2.52it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:39<00:23,  2.94it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:39<00:25,  2.65it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:40<00:27,  2.45it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:40<00:28,  2.31it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:41<00:29,  2.21it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:41<00:29,  2.13it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:42<00:30,  2.09it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:42<00:30,  2.05it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:43<00:22,  2.61it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:43<00:19,  3.01it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:44<00:16,  3.30it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:44<00:15,  3.50it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:45<00:14,  3.64it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:46<00:13,  3.74it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:46<00:12,  3.81it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:47<00:11,  3.86it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:47<00:11,  3.90it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:48<00:12,  3.33it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:48<00:14,  2.94it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:49<00:12,  3.27it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:49<00:13,  2.91it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:49<00:11,  3.25it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:50<00:12,  2.89it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:50<00:13,  2.64it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:51<00:13,  2.47it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:51<00:10,  2.96it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:52<00:09,  3.31it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:52<00:07,  3.56it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:53<00:06,  3.75it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:53<00:07,  3.26it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:54<00:06,  3.55it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:54<00:07,  3.11it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:55<00:07,  2.82it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:55<00:05,  3.25it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:56<00:06,  2.92it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:56<00:06,  2.69it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:57<00:06,  2.52it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [01:57<00:04,  3.05it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [01:58<00:03,  3.42it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [01:58<00:02,  3.69it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [01:58<00:02,  3.91it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [01:59<00:02,  3.42it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [01:59<00:01,  3.07it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:00<00:01,  3.49it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:00<00:00,  3.83it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:01<00:00,  3.39it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:01<00:00,  2.48it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 18 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.5127 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 17 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

195
cuda:7
fda
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:54<00:54, 54.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 34.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.22s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:None: No `generation_kwargs` specified in task config, defaulting to {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/hazyresearch/based-fda/hazyresearch/based-fda.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 140378599768768 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140378599768768 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378599768768 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140378599768768 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Attempting to acquire lock 140353594251152 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140353594251152 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353594251152 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140353594251152 released on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:fda: Using gen_kwargs: {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of fda from None to 0
INFO:lm_eval.api.task:Building contexts for fda on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 280743.24it/s]
DEBUG:lm_eval.evaluator:Task: fda; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:19<31:58, 19.37s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<25:43, 15.75s/it]Running generate_until requests:   3%|▎         | 3/100 [00:45<23:26, 14.50s/it]Running generate_until requests:   4%|▍         | 4/100 [01:03<25:27, 15.91s/it]Running generate_until requests:   5%|▌         | 5/100 [01:19<25:07, 15.87s/it]Running generate_until requests:   6%|▌         | 6/100 [01:34<24:26, 15.61s/it]Running generate_until requests:   7%|▋         | 7/100 [01:55<27:05, 17.48s/it]Running generate_until requests:   8%|▊         | 8/100 [02:13<26:49, 17.50s/it]Running generate_until requests:   9%|▉         | 9/100 [02:26<24:14, 15.98s/it]Running generate_until requests:  10%|█         | 10/100 [02:37<21:51, 14.57s/it]Running generate_until requests:  11%|█         | 11/100 [02:48<20:06, 13.56s/it]Running generate_until requests:  12%|█▏        | 12/100 [03:06<21:43, 14.82s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:18<20:10, 13.91s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:36<21:37, 15.09s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:47<19:55, 14.06s/it]Running generate_until requests:  16%|█▌        | 16/100 [04:00<18:56, 13.53s/it]Running generate_until requests:  17%|█▋        | 17/100 [04:13<18:29, 13.37s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:30<20:07, 14.73s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:42<18:40, 13.84s/it]Running generate_until requests:  20%|██        | 20/100 [05:00<19:58, 14.99s/it]Running generate_until requests:  21%|██        | 21/100 [05:18<20:48, 15.80s/it]Running generate_until requests:  22%|██▏       | 22/100 [05:32<19:56, 15.34s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:49<20:34, 16.03s/it]Running generate_until requests:  24%|██▍       | 24/100 [06:02<18:47, 14.83s/it]Running generate_until requests:  25%|██▌       | 25/100 [06:19<19:21, 15.49s/it]Running generate_until requests:  26%|██▌       | 26/100 [06:36<19:57, 16.19s/it]Running generate_until requests:  27%|██▋       | 27/100 [06:55<20:28, 16.83s/it]Running generate_until requests:  28%|██▊       | 28/100 [07:08<18:53, 15.74s/it]Running generate_until requests:  29%|██▉       | 29/100 [07:26<19:26, 16.43s/it]Running generate_until requests:  30%|███       | 30/100 [07:39<18:06, 15.52s/it]Running generate_until requests:  31%|███       | 31/100 [07:58<18:52, 16.41s/it]Running generate_until requests:  32%|███▏      | 32/100 [08:12<17:44, 15.65s/it]Running generate_until requests:  33%|███▎      | 33/100 [08:29<17:59, 16.12s/it]Running generate_until requests:  34%|███▍      | 34/100 [08:47<18:23, 16.73s/it]Running generate_until requests:  35%|███▌      | 35/100 [09:00<16:57, 15.66s/it]Running generate_until requests:  36%|███▌      | 36/100 [09:13<15:37, 14.66s/it]Running generate_until requests:  37%|███▋      | 37/100 [09:24<14:32, 13.84s/it]Running generate_until requests:  38%|███▊      | 38/100 [09:38<14:10, 13.72s/it]Running generate_until requests:  39%|███▉      | 39/100 [09:55<14:58, 14.73s/it]Running generate_until requests:  40%|████      | 40/100 [10:08<14:11, 14.19s/it]Running generate_until requests:  41%|████      | 41/100 [10:25<14:56, 15.19s/it]Running generate_until requests:  42%|████▏     | 42/100 [10:37<13:43, 14.20s/it]Running generate_until requests:  43%|████▎     | 43/100 [10:49<12:49, 13.51s/it]Running generate_until requests:  44%|████▍     | 44/100 [11:01<12:12, 13.09s/it]Running generate_until requests:  45%|████▌     | 45/100 [11:12<11:23, 12.43s/it]Running generate_until requests:  46%|████▌     | 46/100 [11:29<12:25, 13.81s/it]Running generate_until requests:  47%|████▋     | 47/100 [11:47<13:16, 15.04s/it]Running generate_until requests:  48%|████▊     | 48/100 [12:00<12:23, 14.30s/it]Running generate_until requests:  49%|████▉     | 49/100 [12:11<11:24, 13.42s/it]Running generate_until requests:  50%|█████     | 50/100 [12:24<11:02, 13.26s/it]Running generate_until requests:  51%|█████     | 51/100 [12:37<10:38, 13.04s/it]Running generate_until requests:  52%|█████▏    | 52/100 [12:54<11:34, 14.46s/it]Running generate_until requests:  53%|█████▎    | 53/100 [13:06<10:47, 13.77s/it]Running generate_until requests:  54%|█████▍    | 54/100 [13:19<10:12, 13.31s/it]Running generate_until requests:  55%|█████▌    | 55/100 [13:37<11:04, 14.76s/it]Running generate_until requests:  56%|█████▌    | 56/100 [13:48<10:06, 13.79s/it]Running generate_until requests:  57%|█████▋    | 57/100 [14:04<10:16, 14.33s/it]Running generate_until requests:  58%|█████▊    | 58/100 [14:18<10:00, 14.29s/it]Running generate_until requests:  59%|█████▉    | 59/100 [14:37<10:46, 15.78s/it]Running generate_until requests:  60%|██████    | 60/100 [14:58<11:34, 17.37s/it]Running generate_until requests:  61%|██████    | 61/100 [15:16<11:15, 17.31s/it]Running generate_until requests:  62%|██████▏   | 62/100 [15:28<10:02, 15.85s/it]Running generate_until requests:  63%|██████▎   | 63/100 [15:40<08:58, 14.55s/it]Running generate_until requests:  64%|██████▍   | 64/100 [15:51<08:07, 13.55s/it]Running generate_until requests:  65%|██████▌   | 65/100 [16:08<08:31, 14.61s/it]Running generate_until requests:  66%|██████▌   | 66/100 [16:25<08:40, 15.30s/it]Running generate_until requests:  67%|██████▋   | 67/100 [16:42<08:45, 15.92s/it]Running generate_until requests:  68%|██████▊   | 68/100 [17:00<08:44, 16.40s/it]Running generate_until requests:  69%|██████▉   | 69/100 [17:17<08:37, 16.70s/it]Running generate_until requests:  70%|███████   | 70/100 [17:31<07:56, 15.88s/it]Running generate_until requests:  71%|███████   | 71/100 [17:50<08:02, 16.65s/it]Running generate_until requests:  72%|███████▏  | 72/100 [18:07<07:52, 16.87s/it]Running generate_until requests:  73%|███████▎  | 73/100 [18:19<06:53, 15.30s/it]Running generate_until requests:  74%|███████▍  | 74/100 [18:36<06:51, 15.84s/it]Running generate_until requests:  75%|███████▌  | 75/100 [18:48<06:07, 14.68s/it]Running generate_until requests:  76%|███████▌  | 76/100 [18:59<05:26, 13.62s/it]Running generate_until requests:  77%|███████▋  | 77/100 [19:10<04:56, 12.90s/it]Running generate_until requests:  78%|███████▊  | 78/100 [19:21<04:31, 12.35s/it]Running generate_until requests:  79%|███████▉  | 79/100 [19:38<04:48, 13.76s/it]Running generate_until requests:  80%|████████  | 80/100 [19:51<04:31, 13.59s/it]Running generate_until requests:  81%|████████  | 81/100 [20:09<04:40, 14.74s/it]Running generate_until requests:  82%|████████▏ | 82/100 [20:26<04:38, 15.46s/it]Running generate_until requests:  83%|████████▎ | 83/100 [20:39<04:10, 14.75s/it]Running generate_until requests:  84%|████████▍ | 84/100 [20:51<03:42, 13.93s/it]Running generate_until requests:  85%|████████▌ | 85/100 [21:02<03:16, 13.07s/it]Running generate_until requests:  86%|████████▌ | 86/100 [21:17<03:12, 13.72s/it]Running generate_until requests:  87%|████████▋ | 87/100 [21:29<02:51, 13.18s/it]Running generate_until requests:  88%|████████▊ | 88/100 [21:41<02:32, 12.68s/it]Running generate_until requests:  89%|████████▉ | 89/100 [21:55<02:26, 13.31s/it]Running generate_until requests:  90%|█████████ | 90/100 [22:06<02:04, 12.44s/it]Running generate_until requests:  91%|█████████ | 91/100 [22:12<01:35, 10.63s/it]Running generate_until requests:  92%|█████████▏| 92/100 [22:20<01:17,  9.66s/it]Running generate_until requests:  93%|█████████▎| 93/100 [22:30<01:08,  9.84s/it]Running generate_until requests:  94%|█████████▍| 94/100 [22:38<00:55,  9.26s/it]Running generate_until requests:  95%|█████████▌| 95/100 [22:44<00:41,  8.34s/it]Running generate_until requests:  96%|█████████▌| 96/100 [22:54<00:35,  8.90s/it]Running generate_until requests:  97%|█████████▋| 97/100 [22:58<00:22,  7.44s/it]Running generate_until requests:  98%|█████████▊| 98/100 [23:07<00:15,  7.72s/it]Running generate_until requests:  99%|█████████▉| 99/100 [23:15<00:07,  7.89s/it]Running generate_until requests: 100%|██████████| 100/100 [23:19<00:00,  6.79s/it]Running generate_until requests: 100%|██████████| 100/100 [23:19<00:00, 14.00s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'fda': {'alias': 'fda', 'contains,none': np.float64(0.87), 'contains_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 7, 0, 5, 1, 4, 3]
tensor([6, 2, 7, 0, 5, 1, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 0, 1, 5, 2, 7, 6, 3]
tensor([4, 0, 1, 5, 2, 7, 6, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 0, 4, 2, 6, 3, 7, 5]
tensor([1, 0, 4, 2, 6, 3, 7, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 6, 3, 5, 1, 4, 2]
tensor([7, 0, 6, 3, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 0, 2, 5, 1, 1, 4]
tensor([0, 3, 0, 2, 5, 1, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 1, 4, 1, 5, 2, 0]
tensor([0, 3, 1, 4, 1, 5, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 11
done!
Normal merging for layer 12
tensor([0, 2])
tensor(0)
tensor([5, 6])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 17 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 16 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

55
cuda:0
mastermind_46_easy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.84s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 34.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.63s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 778
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/flair/mastermind_46_mcq_random/flair/mastermind_46_mcq_random.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/revision/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/tree/544d077942975b1664c0bc4fd54df026050329a4?recursive=False&expand=False HTTP/1.1" 200 290
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/tree/544d077942975b1664c0bc4fd54df026050329a4/data?recursive=False&expand=False HTTP/1.1" 200 361
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/flair/mastermind_46_mcq_random/revision/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 786
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/flair/mastermind_46_mcq_random/resolve/544d077942975b1664c0bc4fd54df026050329a4/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/flair/mastermind_46_mcq_random/paths-info/544d077942975b1664c0bc4fd54df026050329a4 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 140378630880672 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 140378630880672 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378630880672 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Lock 140378630880672 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_flair___mastermind_46_mcq_random_default_0.0.0_544d077942975b1664c0bc4fd54df026050329a4.lock
DEBUG:filelock:Attempting to acquire lock 140377316692128 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 140377316692128 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377316692128 on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:filelock:Lock 140377316692128 released on /public/home/zouyifei001/.cache/huggingface/datasets/flair___mastermind_46_mcq_random/default/0.0.0/544d077942975b1664c0bc4fd54df026050329a4_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mastermind_46_easy from None to 0
INFO:lm_eval.api.task:Building contexts for mastermind_46_easy on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1472.34it/s]
DEBUG:lm_eval.evaluator:Task: mastermind_46_easy; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:02<13:30,  2.03s/it]Running loglikelihood requests:   0%|          | 2/400 [00:03<11:08,  1.68s/it]Running loglikelihood requests:   1%|          | 3/400 [00:04<10:21,  1.56s/it]Running loglikelihood requests:   1%|          | 4/400 [00:06<09:57,  1.51s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:07<09:43,  1.48s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:09<09:40,  1.47s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:10<09:32,  1.46s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:12<09:26,  1.45s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:13<09:21,  1.44s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:14<09:17,  1.43s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:16<09:13,  1.42s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:17<09:10,  1.42s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:19<09:09,  1.42s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:20<09:17,  1.45s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:22<09:23,  1.46s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:23<09:26,  1.48s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:25<09:19,  1.46s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:26<09:13,  1.45s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:27<09:09,  1.44s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:29<09:05,  1.44s/it]Running loglikelihood requests:   5%|▌         | 21/400 [00:30<09:02,  1.43s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:32<08:59,  1.43s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:33<08:57,  1.43s/it]Running loglikelihood requests:   6%|▌         | 24/400 [00:35<08:55,  1.42s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:36<08:54,  1.42s/it]Running loglikelihood requests:   6%|▋         | 26/400 [00:37<08:52,  1.42s/it]Running loglikelihood requests:   7%|▋         | 27/400 [00:39<08:49,  1.42s/it]Running loglikelihood requests:   7%|▋         | 28/400 [00:40<08:47,  1.42s/it]Running loglikelihood requests:   7%|▋         | 29/400 [00:42<08:46,  1.42s/it]Running loglikelihood requests:   8%|▊         | 30/400 [00:43<08:44,  1.42s/it]Running loglikelihood requests:   8%|▊         | 31/400 [00:44<08:43,  1.42s/it]Running loglikelihood requests:   8%|▊         | 32/400 [00:46<08:41,  1.42s/it]Running loglikelihood requests:   8%|▊         | 33/400 [00:47<08:41,  1.42s/it]Running loglikelihood requests:   8%|▊         | 34/400 [00:49<08:40,  1.42s/it]Running loglikelihood requests:   9%|▉         | 35/400 [00:50<08:38,  1.42s/it]Running loglikelihood requests:   9%|▉         | 36/400 [00:52<08:35,  1.42s/it]Running loglikelihood requests:   9%|▉         | 37/400 [00:53<08:33,  1.41s/it]Running loglikelihood requests:  10%|▉         | 38/400 [00:54<08:31,  1.41s/it]Running loglikelihood requests:  10%|▉         | 39/400 [00:56<08:30,  1.41s/it]Running loglikelihood requests:  10%|█         | 40/400 [00:57<08:28,  1.41s/it]Running loglikelihood requests:  10%|█         | 41/400 [00:59<08:26,  1.41s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:00<08:25,  1.41s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:01<08:24,  1.41s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:03<08:23,  1.41s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:04<08:20,  1.41s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:06<08:19,  1.41s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:07<08:17,  1.41s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:08<08:15,  1.41s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:10<08:14,  1.41s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:11<08:12,  1.41s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [01:13<08:10,  1.41s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [01:14<08:08,  1.40s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [01:15<08:07,  1.40s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [01:17<08:05,  1.40s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [01:18<08:03,  1.40s/it]Running loglikelihood requests:  14%|█▍        | 56/400 [01:20<08:07,  1.42s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [01:21<08:12,  1.44s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [01:23<08:14,  1.45s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [01:24<08:16,  1.46s/it]Running loglikelihood requests:  15%|█▌        | 60/400 [01:26<08:15,  1.46s/it]Running loglikelihood requests:  15%|█▌        | 61/400 [01:27<08:08,  1.44s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [01:28<08:02,  1.43s/it]Running loglikelihood requests:  16%|█▌        | 63/400 [01:30<07:58,  1.42s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [01:31<07:55,  1.41s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [01:33<07:52,  1.41s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [01:34<07:49,  1.41s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [01:35<07:47,  1.40s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [01:37<07:45,  1.40s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [01:38<07:44,  1.40s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [01:40<05:54,  1.08s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [01:41<06:19,  1.16s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [01:42<06:38,  1.22s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [01:44<06:52,  1.27s/it]Running loglikelihood requests:  19%|█▉        | 75/400 [01:45<07:03,  1.30s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [01:47<07:10,  1.33s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [01:48<07:15,  1.35s/it]Running loglikelihood requests:  20%|█▉        | 78/400 [01:49<07:18,  1.36s/it]Running loglikelihood requests:  20%|█▉        | 79/400 [01:51<07:20,  1.37s/it]Running loglikelihood requests:  20%|██        | 80/400 [01:52<07:20,  1.38s/it]Running loglikelihood requests:  20%|██        | 81/400 [01:54<07:19,  1.38s/it]Running loglikelihood requests:  20%|██        | 82/400 [01:55<07:20,  1.38s/it]Running loglikelihood requests:  21%|██        | 83/400 [01:56<07:18,  1.38s/it]Running loglikelihood requests:  21%|██        | 84/400 [01:58<07:17,  1.38s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [01:59<07:16,  1.39s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:00<07:15,  1.39s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [02:02<07:14,  1.39s/it]Running loglikelihood requests:  22%|██▏       | 88/400 [02:03<07:12,  1.39s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:05<07:10,  1.38s/it]Running loglikelihood requests:  22%|██▎       | 90/400 [02:06<07:09,  1.38s/it]Running loglikelihood requests:  23%|██▎       | 91/400 [02:07<07:07,  1.38s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [02:09<07:05,  1.38s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:10<07:03,  1.38s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [02:12<07:02,  1.38s/it]Running loglikelihood requests:  24%|██▍       | 95/400 [02:13<07:01,  1.38s/it]Running loglikelihood requests:  24%|██▍       | 96/400 [02:14<06:59,  1.38s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:16<06:58,  1.38s/it]Running loglikelihood requests:  24%|██▍       | 98/400 [02:17<06:56,  1.38s/it]Running loglikelihood requests:  25%|██▍       | 99/400 [02:18<06:55,  1.38s/it]Running loglikelihood requests:  25%|██▌       | 100/400 [02:20<06:58,  1.40s/it]Running loglikelihood requests:  25%|██▌       | 101/400 [02:21<07:00,  1.41s/it]Running loglikelihood requests:  26%|██▌       | 102/400 [02:23<07:02,  1.42s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:24<07:02,  1.42s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:26<07:02,  1.43s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [02:27<07:02,  1.43s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [02:28<06:54,  1.41s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [02:30<06:47,  1.39s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [02:31<06:42,  1.38s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [02:32<06:38,  1.37s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [02:34<06:35,  1.36s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [02:35<06:41,  1.39s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [02:37<06:36,  1.38s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [02:38<06:32,  1.37s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [02:39<06:29,  1.36s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [02:41<06:26,  1.36s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [02:42<06:24,  1.35s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [02:43<06:22,  1.35s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [02:45<06:20,  1.35s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [02:46<06:18,  1.35s/it]Running loglikelihood requests:  30%|███       | 120/400 [02:47<06:17,  1.35s/it]Running loglikelihood requests:  30%|███       | 121/400 [02:49<06:15,  1.35s/it]Running loglikelihood requests:  30%|███       | 122/400 [02:50<06:13,  1.34s/it]Running loglikelihood requests:  31%|███       | 123/400 [02:51<06:11,  1.34s/it]Running loglikelihood requests:  31%|███       | 124/400 [02:53<06:10,  1.34s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [02:54<06:08,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [02:55<06:07,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [02:57<06:05,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [02:58<06:06,  1.35s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [02:59<06:06,  1.35s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:01<06:04,  1.35s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:02<06:03,  1.35s/it]Running loglikelihood requests:  33%|███▎      | 132/400 [03:04<06:02,  1.35s/it]Running loglikelihood requests:  33%|███▎      | 133/400 [03:05<06:02,  1.36s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:06<06:00,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 135/400 [03:08<05:59,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 136/400 [03:09<05:58,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 137/400 [03:10<05:57,  1.36s/it]Running loglikelihood requests:  34%|███▍      | 138/400 [03:12<05:55,  1.36s/it]Running loglikelihood requests:  35%|███▍      | 139/400 [03:13<05:53,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 140/400 [03:14<05:51,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 141/400 [03:16<05:50,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 142/400 [03:17<05:48,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 143/400 [03:18<05:47,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 144/400 [03:20<05:45,  1.35s/it]Running loglikelihood requests:  36%|███▋      | 145/400 [03:21<05:43,  1.35s/it]Running loglikelihood requests:  36%|███▋      | 146/400 [03:22<05:42,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 147/400 [03:24<05:40,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 148/400 [03:25<05:39,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 149/400 [03:27<05:37,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [03:28<05:35,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:29<05:33,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:31<05:33,  1.35s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:32<05:33,  1.35s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:33<05:31,  1.35s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:35<05:29,  1.35s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:36<05:28,  1.34s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:37<05:26,  1.34s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:39<05:24,  1.34s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:40<05:22,  1.34s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:41<05:24,  1.35s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:43<05:22,  1.35s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:44<05:19,  1.34s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:45<05:17,  1.34s/it]Running loglikelihood requests:  41%|████      | 164/400 [03:47<05:15,  1.34s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [03:48<05:13,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [03:49<05:12,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [03:51<05:11,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [03:52<05:09,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [03:53<05:08,  1.34s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [03:55<05:07,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 171/400 [03:56<05:06,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [03:57<05:04,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 173/400 [03:59<05:03,  1.34s/it]Running loglikelihood requests:  44%|████▎     | 174/400 [04:00<05:01,  1.34s/it]Running loglikelihood requests:  44%|████▍     | 175/400 [04:01<05:00,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 176/400 [04:03<04:58,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 177/400 [04:04<04:57,  1.33s/it]Running loglikelihood requests:  44%|████▍     | 178/400 [04:05<04:55,  1.33s/it]Running loglikelihood requests:  45%|████▍     | 179/400 [04:07<04:53,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 180/400 [04:08<04:52,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 181/400 [04:09<04:53,  1.34s/it]Running loglikelihood requests:  46%|████▌     | 182/400 [04:11<04:51,  1.34s/it]Running loglikelihood requests:  46%|████▌     | 183/400 [04:12<04:49,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 184/400 [04:13<04:47,  1.33s/it]Running loglikelihood requests:  46%|████▋     | 185/400 [04:15<04:46,  1.33s/it]Running loglikelihood requests:  46%|████▋     | 186/400 [04:16<04:44,  1.33s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [04:17<04:43,  1.33s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [04:19<04:41,  1.33s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [04:20<04:39,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 190/400 [04:21<04:39,  1.33s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [04:23<04:37,  1.33s/it]Running loglikelihood requests:  48%|████▊     | 192/400 [04:24<04:35,  1.33s/it]Running loglikelihood requests:  48%|████▊     | 193/400 [04:25<04:34,  1.33s/it]Running loglikelihood requests:  48%|████▊     | 194/400 [04:27<04:33,  1.33s/it]Running loglikelihood requests:  49%|████▉     | 195/400 [04:28<04:31,  1.33s/it]Running loglikelihood requests:  49%|████▉     | 196/400 [04:29<04:30,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 197/400 [04:31<04:28,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 198/400 [04:32<04:26,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 199/400 [04:33<04:25,  1.32s/it]Running loglikelihood requests:  50%|█████     | 200/400 [04:35<04:23,  1.32s/it]Running loglikelihood requests:  50%|█████     | 201/400 [04:36<04:21,  1.32s/it]Running loglikelihood requests:  50%|█████     | 202/400 [04:37<04:20,  1.31s/it]Running loglikelihood requests:  51%|█████     | 203/400 [04:38<04:19,  1.32s/it]Running loglikelihood requests:  51%|█████     | 204/400 [04:40<04:17,  1.32s/it]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:41<04:16,  1.32s/it]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:42<04:15,  1.32s/it]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:44<04:13,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:45<04:12,  1.31s/it]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:46<04:11,  1.32s/it]Running loglikelihood requests:  52%|█████▎    | 210/400 [04:48<04:11,  1.32s/it]Running loglikelihood requests:  53%|█████▎    | 211/400 [04:49<04:09,  1.32s/it]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:50<04:07,  1.32s/it]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:52<04:05,  1.31s/it]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:53<04:03,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 215/400 [04:54<04:01,  1.30s/it]Running loglikelihood requests:  54%|█████▍    | 216/400 [04:55<03:59,  1.30s/it]Running loglikelihood requests:  54%|█████▍    | 217/400 [04:57<03:58,  1.30s/it]Running loglikelihood requests:  55%|█████▍    | 218/400 [04:58<03:56,  1.30s/it]Running loglikelihood requests:  55%|█████▍    | 219/400 [04:59<03:55,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 220/400 [05:01<03:54,  1.30s/it]Running loglikelihood requests:  55%|█████▌    | 221/400 [05:02<03:52,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 222/400 [05:03<03:51,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 223/400 [05:05<03:50,  1.30s/it]Running loglikelihood requests:  56%|█████▌    | 224/400 [05:06<03:49,  1.30s/it]Running loglikelihood requests:  56%|█████▋    | 225/400 [05:07<03:47,  1.30s/it]Running loglikelihood requests:  56%|█████▋    | 226/400 [05:08<03:45,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 227/400 [05:10<03:44,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 228/400 [05:11<03:42,  1.30s/it]Running loglikelihood requests:  57%|█████▋    | 229/400 [05:12<03:40,  1.29s/it]Running loglikelihood requests:  57%|█████▊    | 230/400 [05:14<03:38,  1.29s/it]Running loglikelihood requests:  58%|█████▊    | 231/400 [05:15<03:37,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 232/400 [05:16<03:35,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 233/400 [05:17<03:34,  1.28s/it]Running loglikelihood requests:  58%|█████▊    | 234/400 [05:19<03:32,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 235/400 [05:20<03:31,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 236/400 [05:21<03:29,  1.28s/it]Running loglikelihood requests:  59%|█████▉    | 237/400 [05:23<03:28,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 238/400 [05:24<03:27,  1.28s/it]Running loglikelihood requests:  60%|█████▉    | 239/400 [05:25<03:25,  1.28s/it]Running loglikelihood requests:  60%|██████    | 240/400 [05:26<03:23,  1.27s/it]Running loglikelihood requests:  60%|██████    | 241/400 [05:28<03:22,  1.27s/it]Running loglikelihood requests:  60%|██████    | 242/400 [05:29<03:21,  1.27s/it]Running loglikelihood requests:  61%|██████    | 243/400 [05:30<03:19,  1.27s/it]Running loglikelihood requests:  61%|██████    | 244/400 [05:31<03:18,  1.27s/it]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:33<03:16,  1.27s/it]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:34<03:14,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:35<03:13,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:37<03:11,  1.26s/it]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:38<03:10,  1.26s/it]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:39<03:09,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:40<03:07,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:42<03:06,  1.26s/it]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:43<03:04,  1.26s/it]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:44<03:03,  1.26s/it]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:45<03:01,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:47<03:00,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:48<02:58,  1.25s/it]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:50<03:21,  1.42s/it]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:51<03:12,  1.37s/it]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:52<03:06,  1.33s/it]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:54<03:08,  1.36s/it]Running loglikelihood requests:  66%|██████▌   | 262/400 [05:55<03:06,  1.35s/it]Running loglikelihood requests:  66%|██████▌   | 263/400 [05:56<03:01,  1.32s/it]Running loglikelihood requests:  66%|██████▌   | 264/400 [05:57<02:57,  1.30s/it]Running loglikelihood requests:  66%|██████▋   | 265/400 [05:59<02:53,  1.29s/it]Running loglikelihood requests:  66%|██████▋   | 266/400 [06:00<02:52,  1.29s/it]Running loglikelihood requests:  67%|██████▋   | 267/400 [06:01<02:49,  1.27s/it]Running loglikelihood requests:  67%|██████▋   | 268/400 [06:02<02:47,  1.27s/it]Running loglikelihood requests:  67%|██████▋   | 269/400 [06:04<02:44,  1.26s/it]Running loglikelihood requests:  68%|██████▊   | 270/400 [06:05<02:42,  1.25s/it]Running loglikelihood requests:  68%|██████▊   | 271/400 [06:06<02:41,  1.25s/it]Running loglikelihood requests:  68%|██████▊   | 272/400 [06:07<02:42,  1.27s/it]Running loglikelihood requests:  68%|██████▊   | 273/400 [06:09<02:40,  1.26s/it]Running loglikelihood requests:  68%|██████▊   | 274/400 [06:10<02:39,  1.27s/it]Running loglikelihood requests:  69%|██████▉   | 275/400 [06:11<02:37,  1.26s/it]Running loglikelihood requests:  69%|██████▉   | 276/400 [06:12<02:35,  1.26s/it]Running loglikelihood requests:  69%|██████▉   | 277/400 [06:14<02:34,  1.25s/it]Running loglikelihood requests:  70%|██████▉   | 278/400 [06:15<02:32,  1.25s/it]Running loglikelihood requests:  70%|██████▉   | 279/400 [06:16<02:30,  1.25s/it]Running loglikelihood requests:  70%|███████   | 280/400 [06:17<02:29,  1.25s/it]Running loglikelihood requests:  70%|███████   | 281/400 [06:19<02:28,  1.25s/it]Running loglikelihood requests:  70%|███████   | 282/400 [06:20<02:26,  1.24s/it]Running loglikelihood requests:  71%|███████   | 283/400 [06:21<02:25,  1.24s/it]Running loglikelihood requests:  71%|███████   | 284/400 [06:22<02:23,  1.24s/it]Running loglikelihood requests:  71%|███████▏  | 285/400 [06:24<02:22,  1.24s/it]Running loglikelihood requests:  72%|███████▏  | 286/400 [06:25<02:20,  1.24s/it]Running loglikelihood requests:  72%|███████▏  | 287/400 [06:26<02:19,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 288/400 [06:27<02:18,  1.23s/it]Running loglikelihood requests:  72%|███████▏  | 289/400 [06:29<02:17,  1.24s/it]Running loglikelihood requests:  72%|███████▎  | 290/400 [06:30<02:15,  1.24s/it]Running loglikelihood requests:  73%|███████▎  | 291/400 [06:31<02:14,  1.23s/it]Running loglikelihood requests:  73%|███████▎  | 292/400 [06:32<02:13,  1.23s/it]Running loglikelihood requests:  73%|███████▎  | 293/400 [06:34<02:13,  1.25s/it]Running loglikelihood requests:  74%|███████▎  | 294/400 [06:35<02:13,  1.26s/it]Running loglikelihood requests:  74%|███████▍  | 295/400 [06:36<02:12,  1.26s/it]Running loglikelihood requests:  74%|███████▍  | 296/400 [06:37<02:11,  1.27s/it]Running loglikelihood requests:  74%|███████▍  | 297/400 [06:39<02:08,  1.25s/it]Running loglikelihood requests:  74%|███████▍  | 298/400 [06:40<02:05,  1.24s/it]Running loglikelihood requests:  75%|███████▍  | 299/400 [06:41<02:03,  1.23s/it]Running loglikelihood requests:  75%|███████▌  | 300/400 [06:42<02:02,  1.22s/it]Running loglikelihood requests:  75%|███████▌  | 301/400 [06:43<02:00,  1.22s/it]Running loglikelihood requests:  76%|███████▌  | 302/400 [06:45<01:58,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 303/400 [06:46<01:57,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 304/400 [06:47<01:56,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 305/400 [06:48<01:54,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 306/400 [06:49<01:53,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 307/400 [06:51<01:52,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 308/400 [06:52<01:50,  1.21s/it]Running loglikelihood requests:  77%|███████▋  | 309/400 [06:53<01:49,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 310/400 [06:54<01:48,  1.21s/it]Running loglikelihood requests:  78%|███████▊  | 311/400 [06:55<01:47,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 312/400 [06:57<01:45,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 313/400 [06:58<01:44,  1.20s/it]Running loglikelihood requests:  78%|███████▊  | 314/400 [06:59<01:42,  1.19s/it]Running loglikelihood requests:  79%|███████▉  | 315/400 [07:00<01:41,  1.19s/it]Running loglikelihood requests:  79%|███████▉  | 316/400 [07:01<01:40,  1.19s/it]Running loglikelihood requests:  79%|███████▉  | 317/400 [07:03<01:38,  1.19s/it]Running loglikelihood requests:  80%|███████▉  | 318/400 [07:04<01:37,  1.19s/it]Running loglikelihood requests:  80%|███████▉  | 319/400 [07:05<01:36,  1.19s/it]Running loglikelihood requests:  80%|████████  | 320/400 [07:06<01:35,  1.19s/it]Running loglikelihood requests:  80%|████████  | 321/400 [07:07<01:33,  1.19s/it]Running loglikelihood requests:  80%|████████  | 322/400 [07:09<01:32,  1.19s/it]Running loglikelihood requests:  81%|████████  | 323/400 [07:10<01:32,  1.20s/it]Running loglikelihood requests:  81%|████████  | 324/400 [07:11<01:30,  1.19s/it]Running loglikelihood requests:  81%|████████▏ | 325/400 [07:12<01:29,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 326/400 [07:13<01:28,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 327/400 [07:14<01:26,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 328/400 [07:16<01:25,  1.19s/it]Running loglikelihood requests:  82%|████████▏ | 329/400 [07:17<01:24,  1.19s/it]Running loglikelihood requests:  82%|████████▎ | 330/400 [07:18<01:22,  1.19s/it]Running loglikelihood requests:  83%|████████▎ | 331/400 [07:19<01:21,  1.19s/it]Running loglikelihood requests:  83%|████████▎ | 332/400 [07:20<01:20,  1.18s/it]Running loglikelihood requests:  83%|████████▎ | 333/400 [07:22<01:19,  1.18s/it]Running loglikelihood requests:  84%|████████▎ | 334/400 [07:23<01:17,  1.18s/it]Running loglikelihood requests:  84%|████████▍ | 335/400 [07:24<01:16,  1.18s/it]Running loglikelihood requests:  84%|████████▍ | 336/400 [07:25<01:15,  1.18s/it]Running loglikelihood requests:  84%|████████▍ | 337/400 [07:26<01:14,  1.18s/it]Running loglikelihood requests:  84%|████████▍ | 338/400 [07:27<01:13,  1.18s/it]Running loglikelihood requests:  85%|████████▍ | 339/400 [07:29<01:11,  1.18s/it]Running loglikelihood requests:  85%|████████▌ | 340/400 [07:30<01:10,  1.18s/it]Running loglikelihood requests:  85%|████████▌ | 341/400 [07:31<01:09,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 342/400 [07:32<01:08,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 343/400 [07:33<01:07,  1.18s/it]Running loglikelihood requests:  86%|████████▌ | 344/400 [07:35<01:06,  1.18s/it]Running loglikelihood requests:  86%|████████▋ | 345/400 [07:36<01:04,  1.18s/it]Running loglikelihood requests:  86%|████████▋ | 346/400 [07:37<01:03,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 347/400 [07:38<01:02,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 348/400 [07:39<01:01,  1.18s/it]Running loglikelihood requests:  87%|████████▋ | 349/400 [07:40<00:59,  1.18s/it]Running loglikelihood requests:  88%|████████▊ | 350/400 [07:42<00:58,  1.17s/it]Running loglikelihood requests:  88%|████████▊ | 351/400 [07:43<00:57,  1.17s/it]Running loglikelihood requests:  88%|████████▊ | 352/400 [07:44<00:56,  1.17s/it]Running loglikelihood requests:  88%|████████▊ | 353/400 [07:45<00:55,  1.17s/it]Running loglikelihood requests:  88%|████████▊ | 354/400 [07:46<00:53,  1.17s/it]Running loglikelihood requests:  89%|████████▉ | 355/400 [07:47<00:52,  1.17s/it]Running loglikelihood requests:  89%|████████▉ | 356/400 [07:49<00:51,  1.17s/it]Running loglikelihood requests:  89%|████████▉ | 357/400 [07:50<00:50,  1.17s/it]Running loglikelihood requests:  90%|████████▉ | 358/400 [07:51<00:49,  1.17s/it]Running loglikelihood requests:  90%|████████▉ | 359/400 [07:52<00:47,  1.17s/it]Running loglikelihood requests:  90%|█████████ | 360/400 [07:53<00:46,  1.17s/it]Running loglikelihood requests:  90%|█████████ | 361/400 [07:54<00:45,  1.17s/it]Running loglikelihood requests:  90%|█████████ | 362/400 [07:56<00:44,  1.17s/it]Running loglikelihood requests:  91%|█████████ | 363/400 [07:57<00:43,  1.17s/it]Running loglikelihood requests:  91%|█████████ | 364/400 [07:58<00:42,  1.17s/it]Running loglikelihood requests:  91%|█████████▏| 365/400 [07:59<00:40,  1.17s/it]Running loglikelihood requests:  92%|█████████▏| 366/400 [08:00<00:39,  1.16s/it]Running loglikelihood requests:  92%|█████████▏| 367/400 [08:01<00:38,  1.16s/it]Running loglikelihood requests:  92%|█████████▏| 368/400 [08:03<00:37,  1.16s/it]Running loglikelihood requests:  92%|█████████▏| 369/400 [08:04<00:35,  1.16s/it]Running loglikelihood requests:  92%|█████████▎| 370/400 [08:05<00:34,  1.16s/it]Running loglikelihood requests:  93%|█████████▎| 371/400 [08:06<00:33,  1.16s/it]Running loglikelihood requests:  93%|█████████▎| 372/400 [08:07<00:32,  1.16s/it]Running loglikelihood requests:  93%|█████████▎| 373/400 [08:08<00:31,  1.16s/it]Running loglikelihood requests:  94%|█████████▎| 374/400 [08:10<00:30,  1.15s/it]Running loglikelihood requests:  94%|█████████▍| 375/400 [08:11<00:28,  1.15s/it]Running loglikelihood requests:  94%|█████████▍| 376/400 [08:12<00:27,  1.15s/it]Running loglikelihood requests:  94%|█████████▍| 377/400 [08:13<00:26,  1.14s/it]Running loglikelihood requests:  94%|█████████▍| 378/400 [08:14<00:25,  1.14s/it]Running loglikelihood requests:  95%|█████████▍| 379/400 [08:15<00:23,  1.14s/it]Running loglikelihood requests:  95%|█████████▌| 380/400 [08:16<00:22,  1.14s/it]Running loglikelihood requests:  95%|█████████▌| 381/400 [08:17<00:21,  1.13s/it]Running loglikelihood requests:  96%|█████████▌| 382/400 [08:19<00:20,  1.13s/it]Running loglikelihood requests:  96%|█████████▌| 383/400 [08:20<00:19,  1.14s/it]Running loglikelihood requests:  96%|█████████▌| 384/400 [08:21<00:18,  1.14s/it]Running loglikelihood requests:  96%|█████████▋| 385/400 [08:22<00:17,  1.14s/it]Running loglikelihood requests:  96%|█████████▋| 386/400 [08:23<00:15,  1.13s/it]Running loglikelihood requests:  97%|█████████▋| 387/400 [08:24<00:14,  1.12s/it]Running loglikelihood requests:  97%|█████████▋| 388/400 [08:25<00:13,  1.12s/it]Running loglikelihood requests:  97%|█████████▋| 389/400 [08:26<00:12,  1.10s/it]Running loglikelihood requests:  98%|█████████▊| 390/400 [08:27<00:10,  1.08s/it]Running loglikelihood requests:  98%|█████████▊| 391/400 [08:29<00:09,  1.07s/it]Running loglikelihood requests:  98%|█████████▊| 392/400 [08:30<00:08,  1.06s/it]Running loglikelihood requests:  98%|█████████▊| 393/400 [08:31<00:07,  1.05s/it]Running loglikelihood requests:  98%|█████████▊| 394/400 [08:32<00:06,  1.04s/it]Running loglikelihood requests:  99%|█████████▉| 395/400 [08:33<00:05,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 396/400 [08:34<00:04,  1.03s/it]Running loglikelihood requests:  99%|█████████▉| 397/400 [08:35<00:03,  1.01s/it]Running loglikelihood requests: 100%|█████████▉| 398/400 [08:36<00:01,  1.01it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [08:37<00:00,  1.02it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:37<00:00,  1.02it/s]Running loglikelihood requests: 100%|██████████| 400/400 [08:37<00:00,  1.29s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'mastermind_46_easy': {'alias': 'mastermind_46_easy', 'acc,none': 0.75, 'acc_stderr,none': 0.04351941398892446}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9900730655060652
0.9975621416797388
0.9971758007187725
0.9980230222224056
0.9889479987910904
0.9764864248764976
0.9903944102306983
0.9944743493554844
0.9959595842537624
0.9872350810596702
0.9630442697748985
0.9836939129473328
0.9680042833072414
0.9739989664157891
0.9945965755000291
0.9874567967365809
0.9910190996776087
0.9888895436517939
0.9820307305549418
0.9881803990776891
0.9859944271811626
0.9931460182904469
0.984259193892523
0.99673879588459
0.9800909214289261
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 2, 0, 3, 7, 6, 1, 4]
tensor([5, 2, 0, 3, 7, 6, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 3
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Normal merging for layer 5
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 16 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 15 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

153
cuda:1
fda
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.74s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:None: No `generation_kwargs` specified in task config, defaulting to {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/hazyresearch/based-fda/hazyresearch/based-fda.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/hazyresearch/based-fda HTTP/1.1" 200 1042
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/hazyresearch/based-fda/resolve/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/hazyresearch/based-fda/paths-info/42569d301e12fbcf8d5a69e04e892aa013e20314 HTTP/1.1" 200 218
DEBUG:filelock:Attempting to acquire lock 140375980308432 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140375980308432 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375980308432 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Lock 140375980308432 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_hazyresearch___based-fda_default_0.0.0_42569d301e12fbcf8d5a69e04e892aa013e20314.lock
DEBUG:filelock:Attempting to acquire lock 140375039552224 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140375039552224 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375039552224 on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:filelock:Lock 140375039552224 released on /public/home/zouyifei001/.cache/huggingface/datasets/hazyresearch___based-fda/default/0.0.0/42569d301e12fbcf8d5a69e04e892aa013e20314_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:fda: Using gen_kwargs: {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of fda from None to 0
INFO:lm_eval.api.task:Building contexts for fda on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 235900.11it/s]
DEBUG:lm_eval.evaluator:Task: fda; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:18<30:54, 18.73s/it]Running generate_until requests:   2%|▏         | 2/100 [00:31<25:09, 15.40s/it]Running generate_until requests:   3%|▎         | 3/100 [00:44<23:00, 14.24s/it]Running generate_until requests:   4%|▍         | 4/100 [01:02<24:47, 15.50s/it]Running generate_until requests:   5%|▌         | 5/100 [01:16<24:10, 15.27s/it]Running generate_until requests:   6%|▌         | 6/100 [01:31<23:23, 14.93s/it]Running generate_until requests:   7%|▋         | 7/100 [01:48<24:20, 15.71s/it]Running generate_until requests:   8%|▊         | 8/100 [02:05<24:42, 16.12s/it]Running generate_until requests:   9%|▉         | 9/100 [02:17<22:35, 14.90s/it]Running generate_until requests:  10%|█         | 10/100 [02:28<20:32, 13.69s/it]Running generate_until requests:  11%|█         | 11/100 [02:40<19:19, 13.03s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:57<21:04, 14.36s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:09<19:47, 13.65s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:27<21:09, 14.76s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:38<19:36, 13.85s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:50<18:37, 13.31s/it]Running generate_until requests:  17%|█▋        | 17/100 [04:02<17:48, 12.87s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:19<19:13, 14.06s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:31<18:04, 13.38s/it]Running generate_until requests:  20%|██        | 20/100 [04:48<19:26, 14.59s/it]Running generate_until requests:  21%|██        | 21/100 [05:05<20:15, 15.38s/it]Running generate_until requests:  22%|██▏       | 22/100 [05:20<19:29, 14.99s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:36<20:00, 15.59s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:49<18:27, 14.57s/it]Running generate_until requests:  25%|██▌       | 25/100 [06:05<19:02, 15.24s/it]Running generate_until requests:  26%|██▌       | 26/100 [06:22<19:20, 15.68s/it]Running generate_until requests:  27%|██▋       | 27/100 [06:39<19:36, 16.12s/it]Running generate_until requests:  28%|██▊       | 28/100 [06:52<18:09, 15.13s/it]Running generate_until requests:  29%|██▉       | 29/100 [07:09<18:30, 15.64s/it]Running generate_until requests:  30%|███       | 30/100 [07:22<17:22, 14.89s/it]Running generate_until requests:  31%|███       | 31/100 [07:39<17:55, 15.59s/it]Running generate_until requests:  32%|███▏      | 32/100 [07:52<16:38, 14.68s/it]Running generate_until requests:  33%|███▎      | 33/100 [08:09<17:07, 15.34s/it]Running generate_until requests:  34%|███▍      | 34/100 [08:26<17:27, 15.87s/it]Running generate_until requests:  35%|███▌      | 35/100 [08:39<16:14, 14.99s/it]Running generate_until requests:  36%|███▌      | 36/100 [08:51<15:14, 14.29s/it]Running generate_until requests:  37%|███▋      | 37/100 [09:03<14:04, 13.41s/it]Running generate_until requests:  38%|███▊      | 38/100 [09:16<13:46, 13.34s/it]Running generate_until requests:  39%|███▉      | 39/100 [09:33<14:40, 14.44s/it]Running generate_until requests:  40%|████      | 40/100 [09:46<13:52, 13.88s/it]Running generate_until requests:  41%|████      | 41/100 [10:03<14:37, 14.87s/it]Running generate_until requests:  42%|████▏     | 42/100 [10:15<13:29, 13.96s/it]Running generate_until requests:  43%|████▎     | 43/100 [10:27<12:42, 13.38s/it]Running generate_until requests:  44%|████▍     | 44/100 [10:39<12:05, 12.95s/it]Running generate_until requests:  45%|████▌     | 45/100 [10:50<11:20, 12.37s/it]Running generate_until requests:  46%|████▌     | 46/100 [11:06<12:21, 13.73s/it]Running generate_until requests:  47%|████▋     | 47/100 [11:24<13:00, 14.73s/it]Running generate_until requests:  48%|████▊     | 48/100 [11:35<12:02, 13.90s/it]Running generate_until requests:  49%|████▉     | 49/100 [11:47<11:05, 13.04s/it]Running generate_until requests:  50%|█████     | 50/100 [11:59<10:47, 12.95s/it]Running generate_until requests:  51%|█████     | 51/100 [12:11<10:16, 12.57s/it]Running generate_until requests:  52%|█████▏    | 52/100 [12:28<11:04, 13.85s/it]Running generate_until requests:  53%|█████▎    | 53/100 [12:40<10:33, 13.47s/it]Running generate_until requests:  54%|█████▍    | 54/100 [12:52<09:55, 12.95s/it]Running generate_until requests:  55%|█████▌    | 55/100 [13:09<10:30, 14.02s/it]Running generate_until requests:  56%|█████▌    | 56/100 [13:20<09:42, 13.23s/it]Running generate_until requests:  57%|█████▋    | 57/100 [13:36<10:03, 14.04s/it]Running generate_until requests:  58%|█████▊    | 58/100 [13:50<09:52, 14.11s/it]Running generate_until requests:  59%|█████▉    | 59/100 [14:08<10:18, 15.09s/it]Running generate_until requests:  60%|██████    | 60/100 [14:25<10:30, 15.76s/it]Running generate_until requests:  61%|██████    | 61/100 [14:41<10:17, 15.84s/it]Running generate_until requests:  62%|██████▏   | 62/100 [14:53<09:20, 14.76s/it]Running generate_until requests:  63%|██████▎   | 63/100 [15:04<08:25, 13.67s/it]Running generate_until requests:  64%|██████▍   | 64/100 [15:16<07:48, 13.01s/it]Running generate_until requests:  65%|██████▌   | 65/100 [15:32<08:13, 14.11s/it]Running generate_until requests:  66%|██████▌   | 66/100 [15:49<08:26, 14.91s/it]Running generate_until requests:  67%|██████▋   | 67/100 [16:06<08:28, 15.41s/it]Running generate_until requests:  68%|██████▊   | 68/100 [16:23<08:28, 15.90s/it]Running generate_until requests:  69%|██████▉   | 69/100 [16:39<08:18, 16.07s/it]Running generate_until requests:  70%|███████   | 70/100 [16:53<07:37, 15.25s/it]Running generate_until requests:  71%|███████   | 71/100 [17:10<07:39, 15.85s/it]Running generate_until requests:  72%|███████▏  | 72/100 [17:27<07:30, 16.08s/it]Running generate_until requests:  73%|███████▎  | 73/100 [17:38<06:38, 14.74s/it]Running generate_until requests:  74%|███████▍  | 74/100 [17:55<06:39, 15.35s/it]Running generate_until requests:  75%|███████▌  | 75/100 [18:07<05:56, 14.26s/it]Running generate_until requests:  76%|███████▌  | 76/100 [18:18<05:20, 13.36s/it]Running generate_until requests:  77%|███████▋  | 77/100 [18:29<04:51, 12.66s/it]Running generate_until requests:  78%|███████▊  | 78/100 [18:40<04:28, 12.22s/it]Running generate_until requests:  79%|███████▉  | 79/100 [18:57<04:44, 13.57s/it]Running generate_until requests:  80%|████████  | 80/100 [19:10<04:26, 13.34s/it]Running generate_until requests:  81%|████████  | 81/100 [19:26<04:32, 14.37s/it]Running generate_until requests:  82%|████████▏ | 82/100 [19:43<04:31, 15.10s/it]Running generate_until requests:  83%|████████▎ | 83/100 [19:56<04:05, 14.43s/it]Running generate_until requests:  84%|████████▍ | 84/100 [20:08<03:37, 13.61s/it]Running generate_until requests:  85%|████████▌ | 85/100 [20:19<03:13, 12.87s/it]Running generate_until requests:  86%|████████▌ | 86/100 [20:34<03:09, 13.53s/it]Running generate_until requests:  87%|████████▋ | 87/100 [20:45<02:47, 12.91s/it]Running generate_until requests:  88%|████████▊ | 88/100 [20:57<02:29, 12.42s/it]Running generate_until requests:  89%|████████▉ | 89/100 [21:11<02:21, 12.91s/it]Running generate_until requests:  90%|█████████ | 90/100 [21:21<02:00, 12.10s/it]Running generate_until requests:  91%|█████████ | 91/100 [21:27<01:33, 10.39s/it]Running generate_until requests:  92%|█████████▏| 92/100 [21:35<01:16,  9.53s/it]Running generate_until requests:  93%|█████████▎| 93/100 [21:45<01:08,  9.77s/it]Running generate_until requests:  94%|█████████▍| 94/100 [21:53<00:54,  9.16s/it]Running generate_until requests:  95%|█████████▌| 95/100 [21:59<00:41,  8.26s/it]Running generate_until requests:  96%|█████████▌| 96/100 [22:09<00:35,  8.80s/it]Running generate_until requests:  97%|█████████▋| 97/100 [22:13<00:22,  7.40s/it]Running generate_until requests:  98%|█████████▊| 98/100 [22:21<00:15,  7.62s/it]Running generate_until requests:  99%|█████████▉| 99/100 [22:29<00:07,  7.67s/it]Running generate_until requests: 100%|██████████| 100/100 [22:33<00:00,  6.58s/it]Running generate_until requests: 100%|██████████| 100/100 [22:33<00:00, 13.54s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'fda': {'alias': 'fda', 'contains,none': np.float64(0.87), 'contains_stderr,none': 'N/A'}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
0.1954083722558289
0.191889756656264
0.3231769309584375
0.763391177198558
0.7591908569872912
0.47699609290977873
0.24147181909203896
0.6276241833035655
0.5039903698909594
0.506775271104323
0.17806387173399968
0.3609346134453604
0.21659225770002863
0.3676799923890141
0.7718276709674655
0.684178265870135
0.5285482451872934
0.273816514287302
0.7566340923804737
0.4195302615712732
0.7048918175177445
0.8024335694665047
0.2596571673087474
0.2906758673048459
0.6559956854150746
0.2288937672529506
0.2941846927212091
0.14545644431597915
0.27237013713290037
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 7, 0, 5, 1, 4, 3]
tensor([6, 2, 7, 0, 5, 1, 4, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 0, 1, 5, 2, 7, 6, 3]
tensor([4, 0, 1, 5, 2, 7, 6, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 0, 4, 2, 6, 3, 7, 5]
tensor([1, 0, 4, 2, 6, 3, 7, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 0, 6, 3, 5, 1, 4, 2]
tensor([7, 0, 6, 3, 5, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 0, 2, 5, 1, 1, 4]
tensor([0, 3, 0, 2, 5, 1, 1, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 1, 4, 1, 5, 2, 0]
tensor([0, 3, 1, 4, 1, 5, 2, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([5])
tensor(5)
done!
Normal merging for layer 2
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Normal merging for layer 3
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 11
done!
Normal merging for layer 12
tensor([0, 2])
tensor(0)
tensor([5, 6])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
done!
Cross-layer merge completed for layers 14 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 15 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 14 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

253
cuda:2
boolq
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.17s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 35.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 39.06s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: boolq] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: boolq] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=super_glue HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/datasets/load.py:1429: FutureWarning: The repository for super_glue contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/super_glue
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/super_glue.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140377316609296 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_boolq_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140377316609296 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_boolq_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377316609296 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_boolq_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140377316609296 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_boolq_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Attempting to acquire lock 140375974616128 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140375974616128 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375974616128 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140375974616128 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/boolq/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of boolq from None to 0
INFO:lm_eval.api.task:Building contexts for boolq on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2625.23it/s]
DEBUG:lm_eval.evaluator:Task: boolq; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:04<15:00,  4.53s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:06<06:05,  1.86s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:08<04:24,  1.36s/it]Running loglikelihood requests:   4%|▎         | 7/200 [00:09<03:41,  1.15s/it]Running loglikelihood requests:   4%|▍         | 9/200 [00:11<03:15,  1.02s/it]Running loglikelihood requests:   6%|▌         | 11/200 [00:13<02:58,  1.06it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:14<02:46,  1.12it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:16<02:37,  1.17it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:17<02:29,  1.22it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:19<02:23,  1.26it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:20<02:20,  1.28it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:22<02:16,  1.30it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:23<02:12,  1.32it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:25<02:09,  1.33it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:26<02:07,  1.34it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:27<02:03,  1.36it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:29<02:00,  1.38it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:30<01:57,  1.40it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:32<01:54,  1.42it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:33<01:52,  1.43it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:34<01:50,  1.44it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:36<01:48,  1.45it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:37<01:45,  1.47it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:38<01:42,  1.49it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:40<01:40,  1.50it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:41<01:38,  1.52it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:42<01:36,  1.53it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:44<01:34,  1.53it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:45<01:32,  1.55it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:46<01:30,  1.56it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:47<01:27,  1.58it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:48<01:25,  1.60it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:50<01:23,  1.62it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:51<01:20,  1.65it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:52<01:18,  1.67it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:53<01:15,  1.70it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:54<01:14,  1.71it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:55<01:12,  1.73it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:57<01:10,  1.75it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:58<01:08,  1.77it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:59<01:07,  1.78it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [01:00<01:05,  1.79it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [01:01<01:04,  1.80it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [01:02<01:02,  1.80it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [01:03<01:01,  1.81it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [01:04<01:00,  1.81it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [01:05<00:58,  1.81it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [01:06<00:57,  1.83it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [01:08<00:56,  1.83it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [01:09<00:54,  1.84it/s]Running loglikelihood requests:  50%|█████     | 101/200 [01:10<00:53,  1.85it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [01:11<00:51,  1.87it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [01:12<00:51,  1.86it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [01:13<00:50,  1.86it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [01:14<00:49,  1.86it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [01:15<00:47,  1.86it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [01:16<00:47,  1.85it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [01:17<00:45,  1.86it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [01:18<00:44,  1.88it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [01:19<00:42,  1.90it/s]Running loglikelihood requests:  60%|██████    | 121/200 [01:20<00:41,  1.92it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [01:21<00:39,  1.95it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [01:22<00:38,  1.97it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [01:23<00:36,  1.99it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [01:24<00:35,  2.02it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [01:25<00:33,  2.04it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [01:26<00:32,  2.06it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [01:27<00:31,  2.04it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:28<00:30,  2.07it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:29<00:29,  2.09it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:30<00:27,  2.12it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:31<00:26,  2.18it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:32<00:24,  2.23it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:32<00:23,  2.27it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:33<00:22,  2.26it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:34<00:21,  2.25it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:35<00:20,  2.26it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:36<00:19,  2.27it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:37<00:18,  2.32it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:38<00:17,  2.37it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:38<00:16,  2.34it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:39<00:15,  2.37it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:40<00:14,  2.41it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:41<00:13,  2.44it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:42<00:12,  2.47it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:42<00:11,  2.51it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:43<00:10,  2.56it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:44<00:09,  2.59it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:45<00:08,  2.63it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:45<00:07,  2.65it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:46<00:07,  2.68it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:47<00:06,  2.71it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:48<00:05,  2.74it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:48<00:04,  2.79it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:49<00:03,  2.81it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:50<00:03,  2.86it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:50<00:02,  2.90it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:51<00:01,  2.96it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:51<00:00,  3.09it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:52<00:00,  3.25it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:52<00:00,  1.78it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'boolq': {'alias': 'boolq', 'acc,none': 0.67, 'acc_stderr,none': 0.04725815626252609}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9782993007407264
0.4824830207482711
0.6583529368570694
0.8822475410601947
0.3059812833421515
0.7645942683746021
0.5411564675926485
0.6399758236302138
0.752913626333875
0.9170504110771489
0.8755679311709376
0.9130694495301263
0.6399088029710222
0.5907791688883935
0.8704540476128766
0.484807489124531
0.7579322019225017
0.8465026175931075
0.8104840653949666
0.671147278193032
0.7709951349967222
0.532915988335396
0.6066099270395096
0.5511989097245372
0.4671998655475952
0.6078287002452507
0.3992240879306912
0.5299030614769079
0.5709371890677749
0.9782993007407264
0.4824830207482711
0.6583529368570694
0.8822475410601947
0.3059812833421515
0.7645942683746021
0.5411564675926485
0.6399758236302138
0.752913626333875
0.9170504110771489
0.8755679311709376
0.9130694495301263
0.6399088029710222
0.5907791688883935
0.8704540476128766
0.484807489124531
0.7579322019225017
0.8465026175931075
0.8104840653949666
0.671147278193032
0.7709951349967222
0.532915988335396
0.6066099270395096
0.5511989097245372
0.4671998655475952
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 7, 0, 5, 3, 4, 1]
tensor([6, 2, 7, 0, 5, 3, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 3, 0, 6, 1, 4, 5]
tensor([7, 2, 3, 0, 6, 1, 4, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 1, 7, 0, 6, 4, 2, 3]
tensor([5, 1, 7, 0, 6, 4, 2, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 3, 5, 1, 7, 2, 6, 0]
tensor([4, 3, 5, 1, 7, 2, 6, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 6, 7, 3, 4, 5, 0, 2]
tensor([1, 6, 7, 3, 4, 5, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 3, 4, 1, 7, 2, 5, 0]
tensor([6, 3, 4, 1, 7, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Normal merging for layer 4
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 14 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 13 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

43
cuda:3
anli_r1
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.59s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/anli/anli.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 112
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli/revision/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:filelock:Attempting to acquire lock 140353595151408 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140353595151408 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353595151408 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140353595151408 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Attempting to acquire lock 140375975411936 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140375975411936 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375975411936 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140375975411936 released on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of anli_r1 from None to 0
INFO:lm_eval.api.task:Building contexts for anli_r1 on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2559.69it/s]
DEBUG:lm_eval.evaluator:Task: anli_r1; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<09:28,  1.90s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<07:25,  1.50s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:33,  1.08it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:05<04:54,  1.00it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:06<03:54,  1.25it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:07<04:19,  1.12it/s]Running loglikelihood requests:   3%|▎         | 9/300 [00:08<04:40,  1.04it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:10<03:50,  1.26it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:11<03:24,  1.40it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:12<03:45,  1.27it/s]Running loglikelihood requests:   5%|▌         | 15/300 [00:13<04:03,  1.17it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:14<03:25,  1.38it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:15<03:46,  1.25it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:16<03:14,  1.44it/s]Running loglikelihood requests:   7%|▋         | 22/300 [00:17<02:57,  1.57it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:18<03:19,  1.39it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:19<02:58,  1.54it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:20<03:22,  1.36it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:21<02:57,  1.53it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:22<03:19,  1.36it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:23<03:36,  1.25it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:24<03:50,  1.17it/s]Running loglikelihood requests:  11%|█         | 33/300 [00:25<03:10,  1.40it/s]Running loglikelihood requests:  12%|█▏        | 35/300 [00:26<02:51,  1.55it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:28<03:11,  1.38it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:29<02:48,  1.55it/s]Running loglikelihood requests:  13%|█▎        | 39/300 [00:30<03:08,  1.39it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:31<03:25,  1.27it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:32<02:54,  1.48it/s]Running loglikelihood requests:  15%|█▍        | 44/300 [00:33<02:37,  1.63it/s]Running loglikelihood requests:  15%|█▌        | 46/300 [00:34<02:26,  1.74it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:35<02:46,  1.52it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:36<03:04,  1.37it/s]Running loglikelihood requests:  16%|█▋        | 49/300 [00:37<03:19,  1.26it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:38<03:31,  1.18it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:39<02:53,  1.43it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:40<02:33,  1.61it/s]Running loglikelihood requests:  19%|█▊        | 56/300 [00:41<02:20,  1.73it/s]Running loglikelihood requests:  19%|█▉        | 58/300 [00:42<02:12,  1.82it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:43<02:32,  1.58it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:43<02:19,  1.72it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:44<02:37,  1.51it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:45<02:20,  1.68it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:46<02:38,  1.48it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:47<02:53,  1.35it/s]Running loglikelihood requests:  23%|██▎       | 68/300 [00:48<02:28,  1.56it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:49<02:44,  1.41it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:50<02:22,  1.61it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:51<02:38,  1.44it/s]Running loglikelihood requests:  25%|██▍       | 74/300 [00:52<02:18,  1.63it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:53<02:35,  1.45it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:54<02:15,  1.64it/s]Running loglikelihood requests:  26%|██▌       | 78/300 [00:55<02:31,  1.46it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:56<02:52,  1.28it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:57<03:01,  1.21it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:58<02:28,  1.47it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:59<02:41,  1.35it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [01:00<02:16,  1.57it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [01:01<02:31,  1.41it/s]Running loglikelihood requests:  29%|██▉       | 87/300 [01:02<02:43,  1.30it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [01:03<02:16,  1.54it/s]Running loglikelihood requests:  30%|███       | 91/300 [01:04<02:02,  1.71it/s]Running loglikelihood requests:  31%|███       | 92/300 [01:05<02:17,  1.51it/s]Running loglikelihood requests:  31%|███▏      | 94/300 [01:06<02:02,  1.68it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [01:07<01:52,  1.81it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [01:08<01:46,  1.89it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [01:09<02:02,  1.64it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [01:10<01:51,  1.78it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [01:10<01:44,  1.88it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [01:11<01:59,  1.64it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [01:12<02:12,  1.47it/s]Running loglikelihood requests:  35%|███▌      | 106/300 [01:13<02:24,  1.34it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [01:14<02:32,  1.26it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [01:15<02:05,  1.52it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [01:16<01:50,  1.71it/s]Running loglikelihood requests:  37%|███▋      | 112/300 [01:17<02:04,  1.52it/s]Running loglikelihood requests:  38%|███▊      | 114/300 [01:18<01:49,  1.70it/s]Running loglikelihood requests:  39%|███▊      | 116/300 [01:19<01:40,  1.83it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [01:20<01:54,  1.60it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [01:21<01:42,  1.76it/s]Running loglikelihood requests:  40%|████      | 120/300 [01:22<01:55,  1.56it/s]Running loglikelihood requests:  41%|████      | 122/300 [01:23<01:42,  1.74it/s]Running loglikelihood requests:  41%|████      | 123/300 [01:24<01:54,  1.54it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [01:24<01:41,  1.73it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:25<01:53,  1.53it/s]Running loglikelihood requests:  43%|████▎     | 128/300 [01:26<01:39,  1.72it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:27<01:51,  1.53it/s]Running loglikelihood requests:  43%|████▎     | 130/300 [01:28<02:01,  1.40it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:29<02:09,  1.31it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:30<01:46,  1.57it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:31<01:56,  1.42it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:32<01:39,  1.65it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:33<01:29,  1.81it/s]Running loglikelihood requests:  46%|████▋     | 139/300 [01:34<01:40,  1.60it/s]Running loglikelihood requests:  47%|████▋     | 141/300 [01:35<01:29,  1.78it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:36<01:22,  1.90it/s]Running loglikelihood requests:  48%|████▊     | 144/300 [01:36<01:33,  1.66it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:37<01:24,  1.82it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:38<01:18,  1.94it/s]Running loglikelihood requests:  50%|████▉     | 149/300 [01:39<01:29,  1.69it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:40<01:39,  1.51it/s]Running loglikelihood requests:  50%|█████     | 151/300 [01:41<01:47,  1.39it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:42<01:53,  1.31it/s]Running loglikelihood requests:  51%|█████     | 153/300 [01:43<01:58,  1.24it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:44<02:01,  1.20it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:45<02:03,  1.17it/s]Running loglikelihood requests:  52%|█████▏    | 156/300 [01:45<02:04,  1.15it/s]Running loglikelihood requests:  53%|█████▎    | 158/300 [01:46<01:36,  1.47it/s]Running loglikelihood requests:  53%|█████▎    | 160/300 [01:47<01:22,  1.70it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:48<01:31,  1.52it/s]Running loglikelihood requests:  54%|█████▍    | 163/300 [01:49<01:19,  1.72it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:50<01:12,  1.86it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:51<01:07,  1.97it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:52<01:04,  2.04it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:53<01:01,  2.10it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:54<00:59,  2.14it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:55<00:57,  2.16it/s]Running loglikelihood requests:  59%|█████▊    | 176/300 [01:55<01:06,  1.85it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:56<01:15,  1.63it/s]Running loglikelihood requests:  59%|█████▉    | 178/300 [01:57<01:22,  1.48it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:58<01:28,  1.37it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:59<01:32,  1.30it/s]Running loglikelihood requests:  60%|██████    | 181/300 [02:00<01:35,  1.24it/s]Running loglikelihood requests:  61%|██████    | 183/300 [02:01<01:15,  1.54it/s]Running loglikelihood requests:  61%|██████▏   | 184/300 [02:02<01:21,  1.42it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [02:03<01:08,  1.67it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [02:03<01:00,  1.84it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [02:04<00:55,  1.97it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [02:05<00:52,  2.05it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [02:06<00:50,  2.12it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [02:07<00:48,  2.15it/s]Running loglikelihood requests:  66%|██████▌   | 197/300 [02:08<00:55,  1.84it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [02:09<01:02,  1.63it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [02:10<00:54,  1.82it/s]Running loglikelihood requests:  67%|██████▋   | 202/300 [02:10<00:50,  1.96it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [02:11<00:57,  1.70it/s]Running loglikelihood requests:  68%|██████▊   | 204/300 [02:12<01:02,  1.53it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [02:13<01:07,  1.41it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [02:14<01:10,  1.33it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [02:15<00:56,  1.62it/s]Running loglikelihood requests:  70%|███████   | 210/300 [02:16<00:49,  1.82it/s]Running loglikelihood requests:  71%|███████   | 212/300 [02:17<00:45,  1.93it/s]Running loglikelihood requests:  71%|███████▏  | 214/300 [02:18<00:42,  2.02it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [02:18<00:47,  1.77it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [02:19<00:52,  1.59it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [02:20<00:56,  1.47it/s]Running loglikelihood requests:  73%|███████▎  | 218/300 [02:21<00:59,  1.38it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [02:22<01:01,  1.31it/s]Running loglikelihood requests:  73%|███████▎  | 220/300 [02:23<01:02,  1.27it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [02:24<00:48,  1.59it/s]Running loglikelihood requests:  74%|███████▍  | 223/300 [02:24<00:52,  1.47it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [02:25<00:43,  1.73it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [02:26<00:38,  1.91it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [02:27<00:34,  2.04it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [02:28<00:32,  2.13it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [02:29<00:36,  1.85it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [02:30<00:33,  2.00it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [02:30<00:30,  2.09it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [02:31<00:34,  1.81it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [02:32<00:38,  1.62it/s]Running loglikelihood requests:  80%|████████  | 240/300 [02:33<00:32,  1.84it/s]Running loglikelihood requests:  80%|████████  | 241/300 [02:34<00:35,  1.65it/s]Running loglikelihood requests:  81%|████████  | 243/300 [02:35<00:30,  1.86it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [02:36<00:33,  1.66it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [02:36<00:28,  1.87it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [02:37<00:25,  2.02it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [02:38<00:23,  2.13it/s]Running loglikelihood requests:  84%|████████▎ | 251/300 [02:39<00:26,  1.86it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [02:40<00:28,  1.66it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [02:41<00:24,  1.88it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [02:41<00:21,  2.04it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [02:42<00:23,  1.79it/s]Running loglikelihood requests:  86%|████████▋ | 259/300 [02:43<00:20,  1.98it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [02:44<00:22,  1.76it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [02:45<00:24,  1.60it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [02:45<00:19,  1.85it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [02:46<00:17,  2.03it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [02:47<00:18,  1.79it/s]Running loglikelihood requests:  89%|████████▉ | 267/300 [02:48<00:20,  1.62it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [02:49<00:21,  1.51it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [02:50<00:16,  1.80it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [02:50<00:13,  2.00it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [02:51<00:12,  2.15it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [02:52<00:13,  1.89it/s]Running loglikelihood requests:  92%|█████████▏| 276/300 [02:53<00:14,  1.70it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [02:54<00:11,  1.89it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [02:54<00:12,  1.70it/s]Running loglikelihood requests:  93%|█████████▎| 280/300 [02:55<00:12,  1.57it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [02:56<00:09,  1.86it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [02:57<00:07,  2.06it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [02:58<00:06,  2.21it/s]Running loglikelihood requests:  96%|█████████▌| 287/300 [02:58<00:06,  1.94it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [02:59<00:06,  1.75it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [03:00<00:05,  2.00it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [03:01<00:03,  2.18it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [03:01<00:03,  1.92it/s]Running loglikelihood requests:  98%|█████████▊| 295/300 [03:02<00:02,  2.12it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [03:03<00:02,  1.88it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [03:04<00:00,  2.12it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [03:04<00:00,  1.90it/s]Running loglikelihood requests: 100%|██████████| 300/300 [03:04<00:00,  1.62it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'anli_r1': {'alias': 'anli_r1', 'acc,none': 0.34, 'acc_stderr,none': 0.04760952285695233}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8085145360888548
0.5966366801597401
0.7850954069614222
0.3768088464199145
0.7698569540910085
0.8519474773490918
0.6154497504648171
0.5367017732208939
0.8655808183618074
0.7331449280235868
0.5894481468833981
0.7378575343979396
0.5987768524435384
0.5707480004171545
0.7046807411465031
0.9577874743890299
0.8188417026504053
0.7769906458205452
0.7229714442888765
0.9478596870413392
0.9614258332451108
0.8233435366944131
0.7918737952922844
0.7114446603929027
0.8969015445812697
0.721856474247849
0.3833632973552987
0.42873941021360673
0.602970283883752
0.8085145360888548
0.5966366801597401
0.7850954069614222
0.3768088464199145
0.7698569540910085
0.8519474773490918
0.6154497504648171
0.5367017732208939
0.8655808183618074
0.7331449280235868
0.5894481468833981
0.7378575343979396
0.5987768524435384
0.5707480004171545
0.7046807411465031
0.9577874743890299
0.8188417026504053
0.7769906458205452
0.7229714442888765
0.9478596870413392
0.9614258332451108
0.8233435366944131
0.7918737952922844
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 3, 6, 0, 7, 2, 4, 1]
tensor([5, 3, 6, 0, 7, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 7, 1, 6, 0, 4, 2]
tensor([5, 3, 7, 1, 6, 0, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[3, 5, 7, 1, 6, 0, 4, 2]
tensor([3, 5, 7, 1, 6, 0, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[3, 4, 7, 0, 6, 2, 5, 1]
tensor([3, 4, 7, 0, 6, 2, 5, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 0, 5, 3, 7, 1, 4, 2]
tensor([6, 0, 5, 3, 7, 1, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 4, 7, 3, 6, 0, 5, 2]
tensor([1, 4, 7, 3, 6, 0, 5, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 2
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([1])
tensor(1)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 5
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 13 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 12 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

118
cuda:4
logiqa
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.17s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/EleutherAI/logiqa HTTP/1.1" 200 743
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/logiqa/EleutherAI/logiqa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=EleutherAI/logiqa HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/EleutherAI/logiqa/EleutherAI/logiqa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/logiqa/resolve/main/logiqa.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/logiqa/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/EleutherAI/logiqa/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140375980307760 on /public/home/zouyifei001/.cache/huggingface/modules/datasets_modules/datasets/EleutherAI--logiqa.lock
DEBUG:filelock:Lock 140375980307760 acquired on /public/home/zouyifei001/.cache/huggingface/modules/datasets_modules/datasets/EleutherAI--logiqa.lock
DEBUG:filelock:Attempting to release lock 140375980307760 on /public/home/zouyifei001/.cache/huggingface/modules/datasets_modules/datasets/EleutherAI--logiqa.lock
DEBUG:filelock:Lock 140375980307760 released on /public/home/zouyifei001/.cache/huggingface/modules/datasets_modules/datasets/EleutherAI--logiqa.lock
DEBUG:filelock:Attempting to acquire lock 140353595283872 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___logiqa_logiqa_0.0.1_5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81.lock
DEBUG:filelock:Lock 140353595283872 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___logiqa_logiqa_0.0.1_5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353595283872 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___logiqa_logiqa_0.0.1_5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81.lock
DEBUG:filelock:Lock 140353595283872 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_EleutherAI___logiqa_logiqa_0.0.1_5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81.lock
DEBUG:filelock:Attempting to acquire lock 140353595150736 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81_builder.lock
DEBUG:filelock:Lock 140353595150736 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353595150736 on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81_builder.lock
DEBUG:filelock:Lock 140353595150736 released on /public/home/zouyifei001/.cache/huggingface/datasets/EleutherAI___logiqa/logiqa/0.0.1/5f02e925d138de34af1cba698b682982c58753f9d7e741715d6b5171f60ede81_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of logiqa from None to 0
INFO:lm_eval.api.task:Building contexts for logiqa on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2284.64it/s]
DEBUG:lm_eval.evaluator:Task: logiqa; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:03<20:59,  3.16s/it]Running loglikelihood requests:   0%|          | 2/400 [00:05<17:52,  2.69s/it]Running loglikelihood requests:   1%|          | 3/400 [00:07<16:57,  2.56s/it]Running loglikelihood requests:   1%|          | 4/400 [00:10<16:03,  2.43s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:12<15:26,  2.34s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:14<15:01,  2.29s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:16<14:57,  2.28s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:19<14:56,  2.29s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:21<14:52,  2.28s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:23<14:46,  2.27s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:25<14:23,  2.22s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:27<13:58,  2.16s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:29<13:41,  2.12s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:31<13:28,  2.10s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:33<13:30,  2.11s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:36<13:34,  2.12s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:38<13:36,  2.13s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:40<13:40,  2.15s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:42<13:20,  2.10s/it]Running loglikelihood requests:   5%|▌         | 20/400 [00:44<13:04,  2.06s/it]Running loglikelihood requests:   5%|▌         | 21/400 [00:46<12:49,  2.03s/it]Running loglikelihood requests:   6%|▌         | 22/400 [00:48<12:39,  2.01s/it]Running loglikelihood requests:   6%|▌         | 23/400 [00:50<12:31,  1.99s/it]Running loglikelihood requests:   6%|▌         | 24/400 [00:52<12:23,  1.98s/it]Running loglikelihood requests:   6%|▋         | 25/400 [00:54<12:22,  1.98s/it]Running loglikelihood requests:   6%|▋         | 26/400 [00:56<12:16,  1.97s/it]Running loglikelihood requests:   7%|▋         | 27/400 [00:58<12:09,  1.96s/it]Running loglikelihood requests:   7%|▋         | 28/400 [01:00<12:04,  1.95s/it]Running loglikelihood requests:   7%|▋         | 29/400 [01:01<11:56,  1.93s/it]Running loglikelihood requests:   8%|▊         | 30/400 [01:03<11:52,  1.92s/it]Running loglikelihood requests:   8%|▊         | 31/400 [01:05<11:51,  1.93s/it]Running loglikelihood requests:   8%|▊         | 32/400 [01:07<11:47,  1.92s/it]Running loglikelihood requests:   8%|▊         | 33/400 [01:09<11:43,  1.92s/it]Running loglikelihood requests:   8%|▊         | 34/400 [01:11<11:40,  1.91s/it]Running loglikelihood requests:   9%|▉         | 35/400 [01:13<11:36,  1.91s/it]Running loglikelihood requests:   9%|▉         | 36/400 [01:15<11:34,  1.91s/it]Running loglikelihood requests:   9%|▉         | 37/400 [01:17<11:28,  1.90s/it]Running loglikelihood requests:  10%|▉         | 38/400 [01:19<11:22,  1.89s/it]Running loglikelihood requests:  10%|▉         | 39/400 [01:20<11:17,  1.88s/it]Running loglikelihood requests:  10%|█         | 40/400 [01:22<11:12,  1.87s/it]Running loglikelihood requests:  10%|█         | 41/400 [01:24<11:08,  1.86s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:26<11:04,  1.86s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:28<11:00,  1.85s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:30<10:56,  1.85s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:31<10:53,  1.84s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:33<10:50,  1.84s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:35<10:45,  1.83s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:37<10:41,  1.82s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:39<10:39,  1.82s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [01:40<10:38,  1.82s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [01:42<10:35,  1.82s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [01:44<10:31,  1.81s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [01:46<10:28,  1.81s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [01:48<10:27,  1.81s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [01:50<10:23,  1.81s/it]Running loglikelihood requests:  14%|█▍        | 56/400 [01:51<10:19,  1.80s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [01:53<10:13,  1.79s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [01:55<10:08,  1.78s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [01:57<10:04,  1.77s/it]Running loglikelihood requests:  15%|█▌        | 60/400 [01:58<10:00,  1.77s/it]Running loglikelihood requests:  15%|█▌        | 61/400 [02:00<09:54,  1.75s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [02:02<09:48,  1.74s/it]Running loglikelihood requests:  16%|█▌        | 63/400 [02:03<09:43,  1.73s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [02:05<09:39,  1.73s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [02:07<09:34,  1.72s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [02:09<09:29,  1.70s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [02:10<09:22,  1.69s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [02:12<09:17,  1.68s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [02:14<09:17,  1.68s/it]Running loglikelihood requests:  18%|█▊        | 70/400 [02:15<09:14,  1.68s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [02:17<09:12,  1.68s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [02:19<09:09,  1.67s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [02:20<09:04,  1.66s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [02:22<08:58,  1.65s/it]Running loglikelihood requests:  19%|█▉        | 75/400 [02:24<08:57,  1.66s/it]Running loglikelihood requests:  19%|█▉        | 76/400 [02:25<08:53,  1.65s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [02:27<08:47,  1.63s/it]Running loglikelihood requests:  20%|█▉        | 78/400 [02:28<08:43,  1.63s/it]Running loglikelihood requests:  20%|█▉        | 79/400 [02:30<08:38,  1.62s/it]Running loglikelihood requests:  20%|██        | 80/400 [02:32<08:34,  1.61s/it]Running loglikelihood requests:  20%|██        | 81/400 [02:33<08:29,  1.60s/it]Running loglikelihood requests:  20%|██        | 82/400 [02:35<08:25,  1.59s/it]Running loglikelihood requests:  21%|██        | 83/400 [02:36<08:21,  1.58s/it]Running loglikelihood requests:  21%|██        | 84/400 [02:38<08:19,  1.58s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:39<08:17,  1.58s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:41<08:14,  1.57s/it]Running loglikelihood requests:  22%|██▏       | 87/400 [02:43<08:13,  1.58s/it]Running loglikelihood requests:  22%|██▏       | 88/400 [02:44<08:09,  1.57s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:46<08:07,  1.57s/it]Running loglikelihood requests:  22%|██▎       | 90/400 [02:47<08:04,  1.56s/it]Running loglikelihood requests:  23%|██▎       | 91/400 [02:49<08:05,  1.57s/it]Running loglikelihood requests:  23%|██▎       | 92/400 [02:50<08:02,  1.57s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:52<07:57,  1.56s/it]Running loglikelihood requests:  24%|██▎       | 94/400 [02:53<07:53,  1.55s/it]Running loglikelihood requests:  24%|██▍       | 95/400 [02:55<07:49,  1.54s/it]Running loglikelihood requests:  24%|██▍       | 96/400 [02:56<07:45,  1.53s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:58<07:43,  1.53s/it]Running loglikelihood requests:  24%|██▍       | 98/400 [02:59<07:40,  1.52s/it]Running loglikelihood requests:  25%|██▍       | 99/400 [03:01<07:38,  1.52s/it]Running loglikelihood requests:  25%|██▌       | 100/400 [03:03<07:36,  1.52s/it]Running loglikelihood requests:  25%|██▌       | 101/400 [03:04<07:34,  1.52s/it]Running loglikelihood requests:  26%|██▌       | 102/400 [03:06<07:35,  1.53s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [03:07<07:32,  1.53s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [03:09<07:29,  1.52s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [03:10<07:27,  1.52s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [03:12<07:26,  1.52s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [03:13<07:23,  1.51s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [03:15<07:20,  1.51s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [03:16<07:17,  1.50s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [03:18<07:19,  1.52s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [03:19<07:17,  1.52s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [03:21<07:16,  1.52s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [03:22<07:15,  1.52s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [03:24<07:12,  1.51s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [03:25<07:09,  1.51s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [03:27<07:08,  1.51s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [03:28<07:06,  1.51s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [03:30<07:03,  1.50s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [03:31<07:01,  1.50s/it]Running loglikelihood requests:  30%|███       | 120/400 [03:33<06:59,  1.50s/it]Running loglikelihood requests:  30%|███       | 121/400 [03:34<06:57,  1.49s/it]Running loglikelihood requests:  30%|███       | 122/400 [03:36<06:54,  1.49s/it]Running loglikelihood requests:  31%|███       | 123/400 [03:37<06:53,  1.49s/it]Running loglikelihood requests:  31%|███       | 124/400 [03:39<06:50,  1.49s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [03:40<06:49,  1.49s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [03:42<06:47,  1.49s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [03:43<06:44,  1.48s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:45<06:41,  1.48s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:46<06:38,  1.47s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:47<06:36,  1.47s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:49<06:34,  1.47s/it]Running loglikelihood requests:  33%|███▎      | 132/400 [03:50<06:35,  1.48s/it]Running loglikelihood requests:  33%|███▎      | 133/400 [03:52<06:38,  1.49s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:54<06:39,  1.50s/it]Running loglikelihood requests:  34%|███▍      | 135/400 [03:55<06:40,  1.51s/it]Running loglikelihood requests:  34%|███▍      | 136/400 [03:57<06:40,  1.52s/it]Running loglikelihood requests:  34%|███▍      | 137/400 [03:58<06:40,  1.52s/it]Running loglikelihood requests:  34%|███▍      | 138/400 [04:00<06:46,  1.55s/it]Running loglikelihood requests:  35%|███▍      | 139/400 [04:01<06:38,  1.52s/it]Running loglikelihood requests:  35%|███▌      | 140/400 [04:03<06:34,  1.52s/it]Running loglikelihood requests:  36%|███▌      | 142/400 [04:04<04:57,  1.15s/it]Running loglikelihood requests:  36%|███▌      | 143/400 [04:06<05:15,  1.23s/it]Running loglikelihood requests:  36%|███▌      | 144/400 [04:07<05:28,  1.28s/it]Running loglikelihood requests:  36%|███▋      | 145/400 [04:08<05:38,  1.33s/it]Running loglikelihood requests:  36%|███▋      | 146/400 [04:10<05:45,  1.36s/it]Running loglikelihood requests:  37%|███▋      | 147/400 [04:11<05:50,  1.38s/it]Running loglikelihood requests:  37%|███▋      | 148/400 [04:13<05:53,  1.40s/it]Running loglikelihood requests:  37%|███▋      | 149/400 [04:14<05:54,  1.41s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [04:16<05:54,  1.42s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [04:17<05:54,  1.43s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [04:19<05:57,  1.44s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [04:20<05:55,  1.44s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [04:21<05:53,  1.44s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [04:23<05:53,  1.44s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [04:24<05:51,  1.44s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [04:26<05:49,  1.44s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [04:27<05:47,  1.44s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [04:29<05:45,  1.43s/it]Running loglikelihood requests:  40%|████      | 160/400 [04:30<05:43,  1.43s/it]Running loglikelihood requests:  40%|████      | 161/400 [04:31<05:40,  1.42s/it]Running loglikelihood requests:  40%|████      | 162/400 [04:33<05:41,  1.44s/it]Running loglikelihood requests:  41%|████      | 163/400 [04:34<05:45,  1.46s/it]Running loglikelihood requests:  41%|████      | 164/400 [04:36<05:45,  1.47s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [04:37<05:39,  1.45s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [04:39<05:34,  1.43s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [04:40<05:30,  1.42s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [04:42<05:26,  1.41s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [04:43<05:24,  1.40s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [04:44<05:22,  1.40s/it]Running loglikelihood requests:  43%|████▎     | 171/400 [04:46<05:20,  1.40s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [04:47<05:17,  1.39s/it]Running loglikelihood requests:  43%|████▎     | 173/400 [04:48<05:15,  1.39s/it]Running loglikelihood requests:  44%|████▎     | 174/400 [04:50<05:15,  1.40s/it]Running loglikelihood requests:  44%|████▍     | 175/400 [04:51<05:14,  1.40s/it]Running loglikelihood requests:  44%|████▍     | 176/400 [04:53<05:14,  1.40s/it]Running loglikelihood requests:  44%|████▍     | 177/400 [04:54<05:12,  1.40s/it]Running loglikelihood requests:  44%|████▍     | 178/400 [04:55<05:10,  1.40s/it]Running loglikelihood requests:  45%|████▍     | 179/400 [04:57<05:09,  1.40s/it]Running loglikelihood requests:  45%|████▌     | 180/400 [04:58<05:07,  1.40s/it]Running loglikelihood requests:  45%|████▌     | 181/400 [05:00<05:05,  1.40s/it]Running loglikelihood requests:  46%|████▌     | 182/400 [05:01<05:03,  1.39s/it]Running loglikelihood requests:  46%|████▌     | 183/400 [05:02<05:01,  1.39s/it]Running loglikelihood requests:  46%|████▌     | 184/400 [05:04<04:59,  1.39s/it]Running loglikelihood requests:  46%|████▋     | 185/400 [05:05<04:57,  1.39s/it]Running loglikelihood requests:  46%|████▋     | 186/400 [05:07<04:56,  1.38s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [05:08<04:54,  1.38s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [05:09<04:52,  1.38s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [05:11<04:50,  1.38s/it]Running loglikelihood requests:  48%|████▊     | 190/400 [05:12<04:50,  1.38s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [05:13<04:47,  1.38s/it]Running loglikelihood requests:  48%|████▊     | 192/400 [05:15<04:45,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 193/400 [05:16<04:43,  1.37s/it]Running loglikelihood requests:  48%|████▊     | 194/400 [05:18<04:41,  1.37s/it]Running loglikelihood requests:  49%|████▉     | 195/400 [05:19<04:42,  1.38s/it]Running loglikelihood requests:  49%|████▉     | 196/400 [05:20<04:42,  1.38s/it]Running loglikelihood requests:  49%|████▉     | 197/400 [05:22<04:41,  1.39s/it]Running loglikelihood requests:  50%|████▉     | 198/400 [05:23<04:41,  1.40s/it]Running loglikelihood requests:  50%|████▉     | 199/400 [05:25<04:42,  1.41s/it]Running loglikelihood requests:  50%|█████     | 200/400 [05:26<04:40,  1.40s/it]Running loglikelihood requests:  50%|█████     | 201/400 [05:27<04:43,  1.42s/it]Running loglikelihood requests:  50%|█████     | 202/400 [05:29<04:40,  1.42s/it]Running loglikelihood requests:  51%|█████     | 203/400 [05:30<04:38,  1.41s/it]Running loglikelihood requests:  51%|█████     | 204/400 [05:32<04:33,  1.40s/it]Running loglikelihood requests:  51%|█████▏    | 205/400 [05:33<04:28,  1.38s/it]Running loglikelihood requests:  52%|█████▏    | 206/400 [05:34<04:23,  1.36s/it]Running loglikelihood requests:  52%|█████▏    | 207/400 [05:36<04:19,  1.35s/it]Running loglikelihood requests:  52%|█████▏    | 208/400 [05:37<04:18,  1.35s/it]Running loglikelihood requests:  52%|█████▏    | 209/400 [05:38<04:15,  1.34s/it]Running loglikelihood requests:  52%|█████▎    | 210/400 [05:40<04:13,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 211/400 [05:41<04:11,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 212/400 [05:42<04:09,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 213/400 [05:44<04:08,  1.33s/it]Running loglikelihood requests:  54%|█████▎    | 214/400 [05:45<04:07,  1.33s/it]Running loglikelihood requests:  54%|█████▍    | 215/400 [05:46<04:04,  1.32s/it]Running loglikelihood requests:  54%|█████▍    | 216/400 [05:48<04:02,  1.32s/it]Running loglikelihood requests:  54%|█████▍    | 217/400 [05:49<04:01,  1.32s/it]Running loglikelihood requests:  55%|█████▍    | 218/400 [05:50<03:59,  1.32s/it]Running loglikelihood requests:  55%|█████▍    | 219/400 [05:51<03:58,  1.32s/it]Running loglikelihood requests:  55%|█████▌    | 220/400 [05:53<03:56,  1.31s/it]Running loglikelihood requests:  55%|█████▌    | 221/400 [05:54<03:54,  1.31s/it]Running loglikelihood requests:  56%|█████▌    | 222/400 [05:55<03:52,  1.31s/it]Running loglikelihood requests:  56%|█████▌    | 223/400 [05:57<03:51,  1.31s/it]Running loglikelihood requests:  56%|█████▌    | 224/400 [05:58<03:50,  1.31s/it]Running loglikelihood requests:  56%|█████▋    | 225/400 [05:59<03:48,  1.31s/it]Running loglikelihood requests:  56%|█████▋    | 226/400 [06:01<03:51,  1.33s/it]Running loglikelihood requests:  57%|█████▋    | 227/400 [06:02<03:48,  1.32s/it]Running loglikelihood requests:  57%|█████▋    | 228/400 [06:03<03:46,  1.31s/it]Running loglikelihood requests:  57%|█████▋    | 229/400 [06:05<03:43,  1.31s/it]Running loglikelihood requests:  57%|█████▊    | 230/400 [06:06<03:41,  1.30s/it]Running loglikelihood requests:  58%|█████▊    | 231/400 [06:07<03:40,  1.30s/it]Running loglikelihood requests:  58%|█████▊    | 232/400 [06:08<03:38,  1.30s/it]Running loglikelihood requests:  58%|█████▊    | 233/400 [06:10<03:37,  1.30s/it]Running loglikelihood requests:  58%|█████▊    | 234/400 [06:11<03:35,  1.30s/it]Running loglikelihood requests:  59%|█████▉    | 235/400 [06:12<03:33,  1.30s/it]Running loglikelihood requests:  59%|█████▉    | 236/400 [06:14<03:31,  1.29s/it]Running loglikelihood requests:  59%|█████▉    | 237/400 [06:15<03:29,  1.29s/it]Running loglikelihood requests:  60%|█████▉    | 238/400 [06:16<03:28,  1.29s/it]Running loglikelihood requests:  60%|█████▉    | 239/400 [06:17<03:27,  1.29s/it]Running loglikelihood requests:  60%|██████    | 240/400 [06:19<03:25,  1.29s/it]Running loglikelihood requests:  60%|██████    | 241/400 [06:20<03:24,  1.29s/it]Running loglikelihood requests:  60%|██████    | 242/400 [06:21<03:23,  1.29s/it]Running loglikelihood requests:  61%|██████    | 243/400 [06:23<03:21,  1.28s/it]Running loglikelihood requests:  61%|██████    | 244/400 [06:24<03:20,  1.28s/it]Running loglikelihood requests:  61%|██████▏   | 245/400 [06:25<03:18,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 246/400 [06:26<03:17,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 247/400 [06:28<03:16,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 248/400 [06:29<03:14,  1.28s/it]Running loglikelihood requests:  62%|██████▏   | 249/400 [06:30<03:13,  1.28s/it]Running loglikelihood requests:  62%|██████▎   | 250/400 [06:32<03:11,  1.28s/it]Running loglikelihood requests:  63%|██████▎   | 251/400 [06:33<03:10,  1.28s/it]Running loglikelihood requests:  63%|██████▎   | 252/400 [06:34<03:09,  1.28s/it]Running loglikelihood requests:  63%|██████▎   | 253/400 [06:35<03:07,  1.28s/it]Running loglikelihood requests:  64%|██████▎   | 254/400 [06:37<03:06,  1.28s/it]Running loglikelihood requests:  64%|██████▍   | 255/400 [06:38<03:04,  1.27s/it]Running loglikelihood requests:  64%|██████▍   | 256/400 [06:39<03:02,  1.27s/it]Running loglikelihood requests:  64%|██████▍   | 257/400 [06:40<03:01,  1.27s/it]Running loglikelihood requests:  64%|██████▍   | 258/400 [06:42<02:59,  1.27s/it]Running loglikelihood requests:  65%|██████▍   | 259/400 [06:43<02:58,  1.27s/it]Running loglikelihood requests:  65%|██████▌   | 260/400 [06:44<02:57,  1.26s/it]Running loglikelihood requests:  65%|██████▌   | 261/400 [06:46<02:59,  1.29s/it]Running loglikelihood requests:  66%|██████▌   | 262/400 [06:47<03:00,  1.31s/it]Running loglikelihood requests:  66%|██████▌   | 263/400 [06:48<03:05,  1.35s/it]Running loglikelihood requests:  66%|██████▌   | 264/400 [06:50<03:00,  1.32s/it]Running loglikelihood requests:  66%|██████▋   | 265/400 [06:51<02:55,  1.30s/it]Running loglikelihood requests:  66%|██████▋   | 266/400 [06:52<02:52,  1.28s/it]Running loglikelihood requests:  67%|██████▋   | 267/400 [06:53<02:49,  1.27s/it]Running loglikelihood requests:  67%|██████▋   | 268/400 [06:55<02:50,  1.29s/it]Running loglikelihood requests:  67%|██████▋   | 269/400 [06:56<02:48,  1.29s/it]Running loglikelihood requests:  68%|██████▊   | 270/400 [06:57<02:45,  1.27s/it]Running loglikelihood requests:  68%|██████▊   | 271/400 [06:58<02:42,  1.26s/it]Running loglikelihood requests:  68%|██████▊   | 272/400 [07:00<02:40,  1.25s/it]Running loglikelihood requests:  68%|██████▊   | 273/400 [07:01<02:38,  1.25s/it]Running loglikelihood requests:  68%|██████▊   | 274/400 [07:02<02:37,  1.25s/it]Running loglikelihood requests:  69%|██████▉   | 275/400 [07:03<02:35,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 276/400 [07:05<02:33,  1.24s/it]Running loglikelihood requests:  69%|██████▉   | 277/400 [07:06<02:31,  1.24s/it]Running loglikelihood requests:  70%|██████▉   | 278/400 [07:07<02:31,  1.24s/it]Running loglikelihood requests:  70%|███████   | 280/400 [07:08<01:54,  1.05it/s]Running loglikelihood requests:  70%|███████   | 281/400 [07:10<02:01,  1.02s/it]Running loglikelihood requests:  70%|███████   | 282/400 [07:11<02:06,  1.07s/it]Running loglikelihood requests:  71%|███████   | 283/400 [07:12<02:09,  1.11s/it]Running loglikelihood requests:  71%|███████   | 284/400 [07:13<02:11,  1.14s/it]Running loglikelihood requests:  71%|███████▏  | 285/400 [07:14<02:13,  1.16s/it]Running loglikelihood requests:  72%|███████▏  | 286/400 [07:16<02:13,  1.17s/it]Running loglikelihood requests:  72%|███████▏  | 287/400 [07:17<02:13,  1.18s/it]Running loglikelihood requests:  72%|███████▏  | 288/400 [07:18<02:13,  1.19s/it]Running loglikelihood requests:  72%|███████▏  | 289/400 [07:19<02:12,  1.19s/it]Running loglikelihood requests:  72%|███████▎  | 290/400 [07:20<02:10,  1.19s/it]Running loglikelihood requests:  73%|███████▎  | 291/400 [07:22<02:10,  1.20s/it]Running loglikelihood requests:  73%|███████▎  | 292/400 [07:23<02:11,  1.22s/it]Running loglikelihood requests:  73%|███████▎  | 293/400 [07:24<02:11,  1.23s/it]Running loglikelihood requests:  74%|███████▎  | 294/400 [07:25<02:10,  1.24s/it]Running loglikelihood requests:  74%|███████▍  | 295/400 [07:27<02:10,  1.24s/it]Running loglikelihood requests:  74%|███████▍  | 296/400 [07:28<02:09,  1.24s/it]Running loglikelihood requests:  74%|███████▍  | 297/400 [07:29<02:09,  1.26s/it]Running loglikelihood requests:  74%|███████▍  | 298/400 [07:30<02:05,  1.23s/it]Running loglikelihood requests:  75%|███████▍  | 299/400 [07:32<02:02,  1.21s/it]Running loglikelihood requests:  75%|███████▌  | 300/400 [07:33<01:59,  1.20s/it]Running loglikelihood requests:  75%|███████▌  | 301/400 [07:34<01:59,  1.20s/it]Running loglikelihood requests:  76%|███████▌  | 302/400 [07:35<01:58,  1.21s/it]Running loglikelihood requests:  76%|███████▌  | 303/400 [07:36<01:58,  1.22s/it]Running loglikelihood requests:  76%|███████▌  | 304/400 [07:38<01:55,  1.21s/it]Running loglikelihood requests:  76%|███████▋  | 305/400 [07:39<01:53,  1.20s/it]Running loglikelihood requests:  76%|███████▋  | 306/400 [07:40<01:51,  1.19s/it]Running loglikelihood requests:  77%|███████▋  | 307/400 [07:41<01:50,  1.18s/it]Running loglikelihood requests:  77%|███████▋  | 308/400 [07:42<01:48,  1.18s/it]Running loglikelihood requests:  77%|███████▋  | 309/400 [07:43<01:46,  1.17s/it]Running loglikelihood requests:  78%|███████▊  | 310/400 [07:45<01:45,  1.17s/it]Running loglikelihood requests:  78%|███████▊  | 311/400 [07:46<01:44,  1.17s/it]Running loglikelihood requests:  78%|███████▊  | 312/400 [07:47<01:42,  1.17s/it]Running loglikelihood requests:  78%|███████▊  | 313/400 [07:48<01:41,  1.17s/it]Running loglikelihood requests:  78%|███████▊  | 314/400 [07:49<01:40,  1.16s/it]Running loglikelihood requests:  79%|███████▉  | 315/400 [07:50<01:38,  1.16s/it]Running loglikelihood requests:  79%|███████▉  | 316/400 [07:52<01:37,  1.16s/it]Running loglikelihood requests:  79%|███████▉  | 317/400 [07:53<01:36,  1.16s/it]Running loglikelihood requests:  80%|███████▉  | 318/400 [07:54<01:35,  1.16s/it]Running loglikelihood requests:  80%|███████▉  | 319/400 [07:55<01:33,  1.16s/it]Running loglikelihood requests:  80%|████████  | 320/400 [07:56<01:32,  1.16s/it]Running loglikelihood requests:  80%|████████  | 321/400 [07:57<01:31,  1.16s/it]Running loglikelihood requests:  80%|████████  | 322/400 [07:59<01:30,  1.15s/it]Running loglikelihood requests:  81%|████████  | 323/400 [08:00<01:28,  1.15s/it]Running loglikelihood requests:  81%|████████  | 324/400 [08:01<01:27,  1.15s/it]Running loglikelihood requests:  81%|████████▏ | 325/400 [08:02<01:25,  1.15s/it]Running loglikelihood requests:  82%|████████▏ | 326/400 [08:03<01:24,  1.15s/it]Running loglikelihood requests:  82%|████████▏ | 327/400 [08:04<01:23,  1.14s/it]Running loglikelihood requests:  82%|████████▏ | 328/400 [08:05<01:22,  1.14s/it]Running loglikelihood requests:  82%|████████▏ | 329/400 [08:07<01:21,  1.14s/it]Running loglikelihood requests:  82%|████████▎ | 330/400 [08:08<01:19,  1.14s/it]Running loglikelihood requests:  83%|████████▎ | 331/400 [08:09<01:18,  1.14s/it]Running loglikelihood requests:  83%|████████▎ | 332/400 [08:10<01:17,  1.14s/it]Running loglikelihood requests:  83%|████████▎ | 333/400 [08:11<01:16,  1.13s/it]Running loglikelihood requests:  84%|████████▎ | 334/400 [08:12<01:14,  1.13s/it]Running loglikelihood requests:  84%|████████▍ | 335/400 [08:13<01:13,  1.13s/it]Running loglikelihood requests:  84%|████████▍ | 336/400 [08:14<01:11,  1.12s/it]Running loglikelihood requests:  84%|████████▍ | 337/400 [08:16<01:10,  1.12s/it]Running loglikelihood requests:  84%|████████▍ | 338/400 [08:17<01:09,  1.12s/it]Running loglikelihood requests:  85%|████████▍ | 339/400 [08:18<01:08,  1.12s/it]Running loglikelihood requests:  85%|████████▌ | 340/400 [08:19<01:06,  1.11s/it]Running loglikelihood requests:  85%|████████▌ | 341/400 [08:20<01:05,  1.11s/it]Running loglikelihood requests:  86%|████████▌ | 342/400 [08:21<01:04,  1.11s/it]Running loglikelihood requests:  86%|████████▌ | 343/400 [08:22<01:02,  1.10s/it]Running loglikelihood requests:  86%|████████▌ | 344/400 [08:23<01:01,  1.10s/it]Running loglikelihood requests:  86%|████████▋ | 345/400 [08:24<01:00,  1.10s/it]Running loglikelihood requests:  86%|████████▋ | 346/400 [08:25<00:59,  1.09s/it]Running loglikelihood requests:  87%|████████▋ | 347/400 [08:26<00:57,  1.09s/it]Running loglikelihood requests:  87%|████████▋ | 348/400 [08:28<00:56,  1.09s/it]Running loglikelihood requests:  87%|████████▋ | 349/400 [08:29<00:56,  1.11s/it]Running loglikelihood requests:  88%|████████▊ | 350/400 [08:30<00:56,  1.13s/it]Running loglikelihood requests:  88%|████████▊ | 351/400 [08:31<00:55,  1.13s/it]Running loglikelihood requests:  88%|████████▊ | 352/400 [08:32<00:56,  1.17s/it]Running loglikelihood requests:  88%|████████▊ | 353/400 [08:34<00:55,  1.19s/it]Running loglikelihood requests:  88%|████████▊ | 354/400 [08:35<00:53,  1.16s/it]Running loglikelihood requests:  89%|████████▉ | 355/400 [08:36<00:50,  1.13s/it]Running loglikelihood requests:  89%|████████▉ | 356/400 [08:37<00:49,  1.12s/it]Running loglikelihood requests:  89%|████████▉ | 357/400 [08:38<00:47,  1.11s/it]Running loglikelihood requests:  90%|████████▉ | 358/400 [08:39<00:46,  1.10s/it]Running loglikelihood requests:  90%|████████▉ | 359/400 [08:40<00:44,  1.10s/it]Running loglikelihood requests:  90%|█████████ | 360/400 [08:41<00:43,  1.09s/it]Running loglikelihood requests:  90%|█████████ | 361/400 [08:42<00:42,  1.09s/it]Running loglikelihood requests:  90%|█████████ | 362/400 [08:43<00:41,  1.08s/it]Running loglikelihood requests:  91%|█████████ | 363/400 [08:44<00:40,  1.08s/it]Running loglikelihood requests:  91%|█████████ | 364/400 [08:45<00:38,  1.07s/it]Running loglikelihood requests:  91%|█████████▏| 365/400 [08:46<00:37,  1.07s/it]Running loglikelihood requests:  92%|█████████▏| 366/400 [08:47<00:36,  1.06s/it]Running loglikelihood requests:  92%|█████████▏| 367/400 [08:49<00:34,  1.06s/it]Running loglikelihood requests:  92%|█████████▏| 368/400 [08:50<00:33,  1.06s/it]Running loglikelihood requests:  92%|█████████▏| 369/400 [08:51<00:32,  1.05s/it]Running loglikelihood requests:  92%|█████████▎| 370/400 [08:52<00:31,  1.05s/it]Running loglikelihood requests:  93%|█████████▎| 371/400 [08:53<00:30,  1.05s/it]Running loglikelihood requests:  93%|█████████▎| 372/400 [08:54<00:29,  1.04s/it]Running loglikelihood requests:  93%|█████████▎| 373/400 [08:55<00:28,  1.04s/it]Running loglikelihood requests:  94%|█████████▎| 374/400 [08:56<00:26,  1.03s/it]Running loglikelihood requests:  94%|█████████▍| 375/400 [08:57<00:25,  1.03s/it]Running loglikelihood requests:  94%|█████████▍| 376/400 [08:58<00:24,  1.03s/it]Running loglikelihood requests:  94%|█████████▍| 377/400 [08:59<00:23,  1.02s/it]Running loglikelihood requests:  94%|█████████▍| 378/400 [09:00<00:22,  1.01s/it]Running loglikelihood requests:  95%|█████████▍| 379/400 [09:01<00:20,  1.00it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [09:02<00:19,  1.01it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [09:03<00:18,  1.02it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [09:04<00:17,  1.03it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [09:05<00:16,  1.04it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [09:06<00:15,  1.04it/s]Running loglikelihood requests:  96%|█████████▋| 385/400 [09:07<00:14,  1.04it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [09:08<00:13,  1.03it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [09:09<00:12,  1.03it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [09:09<00:08,  1.36it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [09:10<00:07,  1.28it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [09:11<00:07,  1.23it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [09:12<00:04,  1.54it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [09:13<00:04,  1.44it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [09:14<00:03,  1.36it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [09:15<00:03,  1.30it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [09:16<00:02,  1.26it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [09:16<00:01,  1.25it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [09:17<00:00,  1.23it/s]Running loglikelihood requests: 100%|██████████| 400/400 [09:18<00:00,  1.22it/s]Running loglikelihood requests: 100%|██████████| 400/400 [09:18<00:00,  1.40s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'logiqa': {'alias': 'logiqa', 'acc,none': 0.29, 'acc_stderr,none': 0.045604802157206865, 'acc_norm,none': 0.33, 'acc_norm_stderr,none': 0.04725815626252609}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9179964803140478
0.7817057225882229
0.8413553272072316
0.9274797474668193
0.8768807463293081
0.9494139907523571
0.8960692461846443
0.9131107283061946
0.6329173647892901
0.8375042173336539
0.8817471801904351
0.8172295355829869
0.7824572665005357
0.9227400642857845
0.9246594853497696
0.8075911590072223
0.6900210787422486
0.599615993999193
0.9308030044211123
0.9504015361511146
0.8866807231108503
0.540104242930401
0.6701728801805507
0.9744992661822648
0.8193037468812308
0.840784693447352
0.9052511591891966
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[3, 6, 7, 1, 5, 2, 4, 0]
tensor([3, 6, 7, 1, 5, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 6, 3, 7, 1, 5, 0]
tensor([4, 2, 6, 3, 7, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 3, 6, 1, 7, 2, 4, 0]
tensor([5, 3, 6, 1, 7, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 6, 1, 7, 2, 3, 0]
tensor([5, 4, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 0, 2, 1, 0, 4, 1]
tensor([5, 3, 0, 2, 1, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[4, 0, 5, 0, 1, 2, 3, 1]
tensor([4, 0, 5, 0, 1, 2, 3, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([2, 5])
tensor(2)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 10 to 13
done!
Normal merging for layer 14
tensor([1, 3])
tensor(1)
tensor([4, 7])
tensor(4)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 15 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 12 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 11 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

202
cuda:5
qqp
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.17s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.31s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qqp] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but aggregation is not. using default aggregation=f1
WARNING:lm_eval.api.task:[Task: qqp] metric f1 is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 307 140
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qqp?recursive=False&expand=False HTTP/1.1" 200 355
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140377316694576 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140377316694576 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377316694576 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140377316694576 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qqp_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140377316621872 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140377316621872 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140377316621872 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140377316621872 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qqp/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qqp from None to 0
INFO:lm_eval.api.task:Building contexts for qqp on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2404.94it/s]
DEBUG:lm_eval.evaluator:Task: qqp; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:24,  1.63s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:24,  1.37it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:47,  1.81it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:32,  2.08it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:04<01:23,  2.29it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:05<01:17,  2.44it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:06<01:13,  2.54it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:06<01:10,  2.62it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:07<01:08,  2.67it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:08<01:06,  2.72it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:09<01:04,  2.76it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:09<01:02,  2.83it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:10<01:00,  2.88it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:10<00:59,  2.93it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:11<00:57,  2.96it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:12<00:56,  2.99it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:12<00:55,  3.01it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:13<00:54,  3.03it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:14<00:53,  3.04it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:14<00:52,  3.05it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:15<00:51,  3.06it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:16<00:51,  3.07it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:16<00:50,  3.08it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:17<00:49,  3.09it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:18<00:48,  3.10it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:18<00:47,  3.12it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:19<00:46,  3.13it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:20<00:46,  3.14it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:20<00:45,  3.14it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:21<00:44,  3.16it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:21<00:43,  3.17it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:22<00:43,  3.18it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:23<00:42,  3.20it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:23<00:41,  3.21it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:24<00:40,  3.22it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:25<00:39,  3.23it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:25<00:39,  3.23it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:26<00:38,  3.24it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:26<00:37,  3.25it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:27<00:37,  3.26it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:28<00:36,  3.27it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:28<00:35,  3.28it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:29<00:34,  3.29it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:29<00:34,  3.29it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:30<00:33,  3.30it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:31<00:32,  3.30it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:31<00:32,  3.31it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:32<00:31,  3.32it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:32<00:31,  3.32it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:33<00:30,  3.31it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:34<00:29,  3.32it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:34<00:29,  3.34it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:35<00:28,  3.35it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:35<00:27,  3.37it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:36<00:26,  3.39it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:37<00:26,  3.36it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:37<00:25,  3.37it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:38<00:25,  3.37it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:38<00:24,  3.33it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:39<00:24,  3.37it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:40<00:23,  3.40it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:40<00:22,  3.42it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:41<00:21,  3.44it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:41<00:21,  3.46it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:42<00:20,  3.48it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:42<00:19,  3.49it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:43<00:19,  3.51it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:43<00:18,  3.51it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:44<00:17,  3.52it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:45<00:17,  3.53it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:45<00:16,  3.54it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:46<00:16,  3.56it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:46<00:15,  3.56it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:47<00:14,  3.56it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:47<00:14,  3.42it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:48<00:14,  3.49it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:49<00:13,  3.48it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:49<00:12,  3.51it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:50<00:12,  3.55it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:50<00:11,  3.58it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:51<00:10,  3.60it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:51<00:10,  3.61it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:52<00:09,  3.62it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [00:52<00:09,  3.63it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [00:53<00:08,  3.64it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [00:54<00:07,  3.65it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [00:54<00:07,  3.65it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [00:55<00:06,  3.63it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [00:55<00:06,  3.65it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [00:56<00:05,  3.67it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [00:56<00:05,  3.69it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [00:57<00:04,  3.69it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [00:57<00:04,  3.69it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [00:58<00:03,  3.70it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [00:58<00:02,  3.71it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [00:59<00:02,  3.74it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [00:59<00:01,  3.73it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:00<00:01,  3.76it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:01<00:00,  3.79it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:01<00:00,  3.84it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:01<00:00,  3.25it/s]
bootstrapping for stddev (sequential): f1_score
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:58,  1.20s/it]  2%|▏         | 2/100 [00:02<02:00,  1.23s/it]  3%|▎         | 3/100 [00:03<01:57,  1.21s/it]  4%|▍         | 4/100 [00:04<01:55,  1.20s/it]  5%|▌         | 5/100 [00:06<01:53,  1.20s/it]  6%|▌         | 6/100 [00:07<01:54,  1.22s/it]  7%|▋         | 7/100 [00:08<01:52,  1.21s/it]  8%|▊         | 8/100 [00:09<01:50,  1.21s/it]  9%|▉         | 9/100 [00:10<01:49,  1.20s/it] 10%|█         | 10/100 [00:12<01:48,  1.20s/it] 11%|█         | 11/100 [00:13<01:47,  1.20s/it] 12%|█▏        | 12/100 [00:14<01:45,  1.20s/it] 13%|█▎        | 13/100 [00:15<01:44,  1.20s/it] 14%|█▍        | 14/100 [00:16<01:43,  1.21s/it] 15%|█▌        | 15/100 [00:18<01:43,  1.21s/it] 16%|█▌        | 16/100 [00:19<01:41,  1.21s/it] 17%|█▋        | 17/100 [00:20<01:39,  1.20s/it] 18%|█▊        | 18/100 [00:21<01:38,  1.20s/it] 19%|█▉        | 19/100 [00:22<01:38,  1.21s/it] 20%|██        | 20/100 [00:24<01:36,  1.21s/it] 21%|██        | 21/100 [00:25<01:35,  1.21s/it] 22%|██▏       | 22/100 [00:26<01:34,  1.21s/it] 23%|██▎       | 23/100 [00:27<01:35,  1.23s/it] 24%|██▍       | 24/100 [00:29<01:33,  1.23s/it] 25%|██▌       | 25/100 [00:30<01:31,  1.22s/it] 26%|██▌       | 26/100 [00:31<01:29,  1.21s/it] 27%|██▋       | 27/100 [00:32<01:28,  1.21s/it] 28%|██▊       | 28/100 [00:33<01:27,  1.22s/it] 29%|██▉       | 29/100 [00:35<01:26,  1.22s/it] 30%|███       | 30/100 [00:36<01:24,  1.21s/it] 31%|███       | 31/100 [00:37<01:23,  1.22s/it] 32%|███▏      | 32/100 [00:38<01:22,  1.21s/it] 33%|███▎      | 33/100 [00:39<01:21,  1.21s/it] 34%|███▍      | 34/100 [00:41<01:19,  1.21s/it] 35%|███▌      | 35/100 [00:42<01:18,  1.21s/it] 36%|███▌      | 36/100 [00:43<01:17,  1.21s/it] 37%|███▋      | 37/100 [00:44<01:15,  1.21s/it] 38%|███▊      | 38/100 [00:45<01:14,  1.20s/it] 39%|███▉      | 39/100 [00:47<01:13,  1.20s/it] 40%|████      | 40/100 [00:48<01:11,  1.20s/it] 41%|████      | 41/100 [00:49<01:10,  1.20s/it] 42%|████▏     | 42/100 [00:50<01:09,  1.20s/it] 43%|████▎     | 43/100 [00:51<01:08,  1.20s/it] 44%|████▍     | 44/100 [00:53<01:07,  1.20s/it] 45%|████▌     | 45/100 [00:54<01:05,  1.20s/it] 46%|████▌     | 46/100 [00:55<01:04,  1.20s/it] 47%|████▋     | 47/100 [00:56<01:03,  1.19s/it] 48%|████▊     | 48/100 [00:57<01:02,  1.19s/it] 49%|████▉     | 49/100 [00:59<01:00,  1.19s/it] 50%|█████     | 50/100 [01:00<00:59,  1.20s/it] 51%|█████     | 51/100 [01:01<00:58,  1.19s/it] 52%|█████▏    | 52/100 [01:02<00:57,  1.20s/it] 53%|█████▎    | 53/100 [01:03<00:56,  1.20s/it] 54%|█████▍    | 54/100 [01:05<00:55,  1.20s/it] 55%|█████▌    | 55/100 [01:06<00:53,  1.20s/it] 56%|█████▌    | 56/100 [01:07<00:52,  1.20s/it] 57%|█████▋    | 57/100 [01:08<00:51,  1.20s/it] 58%|█████▊    | 58/100 [01:09<00:50,  1.20s/it] 59%|█████▉    | 59/100 [01:11<00:49,  1.20s/it] 60%|██████    | 60/100 [01:12<00:48,  1.20s/it] 61%|██████    | 61/100 [01:13<00:46,  1.20s/it] 62%|██████▏   | 62/100 [01:14<00:45,  1.20s/it] 63%|██████▎   | 63/100 [01:15<00:44,  1.21s/it] 64%|██████▍   | 64/100 [01:17<00:43,  1.22s/it] 65%|██████▌   | 65/100 [01:18<00:42,  1.21s/it] 66%|██████▌   | 66/100 [01:19<00:41,  1.21s/it] 67%|██████▋   | 67/100 [01:20<00:39,  1.20s/it] 68%|██████▊   | 68/100 [01:21<00:38,  1.20s/it] 69%|██████▉   | 69/100 [01:23<00:37,  1.20s/it] 70%|███████   | 70/100 [01:24<00:35,  1.20s/it] 71%|███████   | 71/100 [01:25<00:34,  1.20s/it] 72%|███████▏  | 72/100 [01:26<00:33,  1.20s/it] 73%|███████▎  | 73/100 [01:27<00:32,  1.20s/it] 74%|███████▍  | 74/100 [01:29<00:31,  1.20s/it] 75%|███████▌  | 75/100 [01:30<00:30,  1.20s/it] 76%|███████▌  | 76/100 [01:31<00:28,  1.20s/it] 77%|███████▋  | 77/100 [01:32<00:27,  1.20s/it] 78%|███████▊  | 78/100 [01:33<00:26,  1.20s/it] 79%|███████▉  | 79/100 [01:35<00:25,  1.20s/it] 80%|████████  | 80/100 [01:36<00:23,  1.20s/it] 81%|████████  | 81/100 [01:37<00:22,  1.20s/it] 82%|████████▏ | 82/100 [01:38<00:21,  1.20s/it] 83%|████████▎ | 83/100 [01:39<00:20,  1.20s/it] 84%|████████▍ | 84/100 [01:41<00:19,  1.20s/it] 85%|████████▌ | 85/100 [01:42<00:18,  1.20s/it] 86%|████████▌ | 86/100 [01:43<00:16,  1.20s/it] 87%|████████▋ | 87/100 [01:44<00:15,  1.20s/it] 88%|████████▊ | 88/100 [01:45<00:14,  1.20s/it] 89%|████████▉ | 89/100 [01:47<00:13,  1.20s/it] 90%|█████████ | 90/100 [01:48<00:12,  1.21s/it] 91%|█████████ | 91/100 [01:49<00:10,  1.21s/it] 92%|█████████▏| 92/100 [01:50<00:09,  1.21s/it] 93%|█████████▎| 93/100 [01:51<00:08,  1.21s/it] 94%|█████████▍| 94/100 [01:53<00:07,  1.20s/it] 95%|█████████▌| 95/100 [01:54<00:06,  1.20s/it] 96%|█████████▌| 96/100 [01:55<00:04,  1.20s/it] 97%|█████████▋| 97/100 [01:56<00:03,  1.20s/it] 98%|█████████▊| 98/100 [01:57<00:02,  1.20s/it] 99%|█████████▉| 99/100 [01:59<00:01,  1.20s/it]100%|██████████| 100/100 [02:00<00:00,  1.20s/it]100%|██████████| 100/100 [02:00<00:00,  1.20s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'qqp': {'alias': 'qqp', 'acc,none': 0.3, 'acc_stderr,none': 0.04605661864718382, 'f1,none': np.float64(0.46153846153846156), 'f1_stderr,none': 0.05409397997448054}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
0.5983336442242687
0.5414593978662989
0.3299447012562784
0.4799857918750434
0.8524920468933548
0.713165518996795
0.7956670939612598
0.9434665619842647
0.7711450328862919
0.8003111158987146
0.8660685706927677
0.6448594355779524
0.8450704433196731
0.7858702319299253
0.44571740342828275
0.8279983705061201
0.5649013775668057
0.5764430622159564
0.7600312367627909
0.4667905570890965
0.6441885742762831
0.5956490746171949
0.7561037067659027
0.6832036593513438
0.703034342774608
0.741950763385666
0.9094352412525417
0.3828457019607829
0.592762753179094
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 5, 2, 6, 1, 3, 0]
tensor([7, 4, 5, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 4, 6, 2, 7, 1, 3, 0]
tensor([5, 4, 6, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[6, 4, 5, 2, 7, 3, 0, 1]
tensor([6, 4, 5, 2, 7, 3, 0, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 7, 4, 2, 5, 0, 1, 3]
tensor([6, 7, 4, 2, 5, 0, 1, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 6, 4, 3, 7, 1, 0, 2]
tensor([5, 6, 4, 3, 7, 1, 0, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 6
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
done!
Normal merging for layer 7
tensor([6])
tensor(6)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 8 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 11 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.1348 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 10 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

168
cuda:6
qnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 31.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.90s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 307 141
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue/tree/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/qnli?recursive=False&expand=False HTTP/1.1" 200 361
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140373960677744 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140373960677744 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140373960677744 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140373960677744 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140378122413424 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140378122413424 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378122413424 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140378122413424 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qnli from None to 0
INFO:lm_eval.api.task:Building contexts for qnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2585.31it/s]
DEBUG:lm_eval.evaluator:Task: qnli; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<05:48,  1.75s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:50,  1.15it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<02:11,  1.49it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:53,  1.70it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:44,  1.82it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:38,  1.91it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:32,  2.01it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:27,  2.11it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:22,  2.22it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:18,  2.31it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:10<01:15,  2.38it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:11<01:12,  2.44it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:12<01:10,  2.48it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:13<01:08,  2.51it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:13<01:07,  2.54it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:14<01:06,  2.56it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:15<01:04,  2.58it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:16<01:03,  2.59it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:16<01:02,  2.60it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:17<01:01,  2.61it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:18<01:00,  2.62it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:19<00:59,  2.64it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:19<00:58,  2.66it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:20<00:57,  2.68it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:21<00:56,  2.66it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:22<00:56,  2.65it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:23<00:56,  2.59it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:23<00:55,  2.61it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:24<00:55,  2.59it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:25<00:53,  2.62it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:26<00:52,  2.65it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:26<00:51,  2.68it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:27<00:49,  2.70it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:28<00:48,  2.74it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:28<00:47,  2.76it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:29<00:46,  2.78it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:30<00:45,  2.80it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:31<00:44,  2.82it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:31<00:43,  2.86it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:32<00:42,  2.88it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:33<00:41,  2.88it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:33<00:40,  2.92it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:34<00:38,  2.95it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:35<00:37,  2.98it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:35<00:37,  3.00it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:36<00:36,  2.96it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:37<00:36,  2.95it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:37<00:35,  2.98it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:38<00:34,  3.01it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:39<00:33,  3.03it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:39<00:33,  2.99it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:40<00:32,  2.99it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:41<00:31,  2.98it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:41<00:31,  2.99it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:42<00:30,  2.98it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:43<00:29,  2.99it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:43<00:29,  3.00it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:44<00:28,  3.00it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:45<00:27,  3.01it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:45<00:26,  3.03it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:46<00:26,  3.02it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:47<00:25,  3.07it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:47<00:24,  3.12it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:48<00:23,  3.16it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:48<00:22,  3.19it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:49<00:21,  3.20it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:50<00:21,  3.18it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:50<00:20,  3.13it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:51<00:19,  3.16it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:52<00:19,  3.19it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:52<00:18,  3.21it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:53<00:17,  3.24it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:53<00:17,  3.22it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:54<00:16,  3.20it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:55<00:15,  3.22it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:55<00:15,  3.22it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:56<00:14,  3.18it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [00:56<00:13,  3.22it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [00:57<00:13,  3.25it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [00:58<00:12,  3.28it/s]Running loglikelihood requests:  80%|████████  | 161/200 [00:58<00:11,  3.30it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [00:59<00:11,  3.32it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [00:59<00:10,  3.34it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:00<00:09,  3.36it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:01<00:09,  3.38it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:01<00:08,  3.41it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:02<00:07,  3.44it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:02<00:07,  3.46it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:03<00:06,  3.47it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:03<00:06,  3.49it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:04<00:05,  3.47it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:05<00:04,  3.49it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:05<00:04,  3.52it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:06<00:03,  3.50it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:06<00:03,  3.58it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:07<00:02,  3.63it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:07<00:01,  3.68it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:08<00:01,  3.74it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:08<00:00,  3.79it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:09<00:00,  3.83it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:09<00:00,  2.88it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'qnli': {'alias': 'qnli', 'acc,none': 0.46, 'acc_stderr,none': 0.05009082659620332}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
0.48800861061165646
0.4420522818267443
0.9519161971847797
0.7484302940574024
0.5133259423607681
0.5588784666822361
0.6658633104669237
0.7569182042181317
0.5308683195195316
0.8457203515884096
0.2160432078364904
0.9025653665852331
0.9196489243365332
0.6742217686289
0.8668007010904994
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 5, 4, 2, 6, 1, 3, 0]
tensor([7, 5, 4, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 1, 3, 6, 2, 7, 0]
tensor([4, 5, 1, 3, 6, 2, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 4, 1, 2, 5, 0]
tensor([0, 1, 3, 4, 1, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 5, 2, 4, 1, 3, 0]
tensor([0, 1, 5, 2, 4, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 4, 1, 2, 1, 3, 5, 0]
tensor([0, 4, 1, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[2, 4, 3, 0, 5, 1, 1, 0]
tensor([2, 4, 3, 0, 5, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 4, 2, 1, 1, 5, 0]
tensor([0, 3, 4, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 1, 3, 2, 0, 3, 1]
tensor([0, 2, 1, 3, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([0, 7])
tensor(0)
tensor([1, 5])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 11
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
done!
Normal merging for layer 12
tensor([3, 7])
tensor(3)
tensor([5, 6])
tensor(5)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 14 to 15
done!
Normal merging for layer 16
tensor([0, 5])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3, 6])
tensor(3)
done!
Cross-layer merge completed for layers 17 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 10 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 9 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

228
cuda:7
qnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.39s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: qnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140353598690496 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140353598690496 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353598690496 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140353598690496 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_qnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140353598694816 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140353598694816 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353598694816 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140353598694816 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/qnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of qnli from None to 0
INFO:lm_eval.api.task:Building contexts for qnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2585.28it/s]
DEBUG:lm_eval.evaluator:Task: qnli; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<06:19,  1.91s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:03<03:02,  1.08it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:04<02:19,  1.40it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:05<02:03,  1.57it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:06<01:52,  1.70it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:07<01:44,  1.81it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:08<01:37,  1.91it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:09<01:33,  1.98it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:28,  2.07it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:24,  2.15it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:11<01:23,  2.13it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:12<01:19,  2.23it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:13<01:23,  2.10it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:14<01:22,  2.10it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:15<01:18,  2.18it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:16<01:15,  2.23it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:17<01:13,  2.28it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:17<01:11,  2.31it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:18<01:10,  2.33it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:19<01:08,  2.36it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:20<01:07,  2.37it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:21<01:05,  2.39it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:21<01:02,  2.47it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:22<01:00,  2.51it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:23<00:59,  2.53it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:24<00:58,  2.56it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:25<00:57,  2.57it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:25<00:55,  2.59it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:26<00:54,  2.60it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:27<00:54,  2.60it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:28<00:53,  2.60it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:28<00:52,  2.61it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:29<00:51,  2.62it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:30<00:50,  2.66it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:31<00:48,  2.69it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:31<00:48,  2.67it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:32<00:47,  2.68it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:33<00:45,  2.74it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:33<00:44,  2.79it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:34<00:43,  2.80it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:35<00:43,  2.76it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:36<00:42,  2.75it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:36<00:41,  2.78it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:37<00:40,  2.82it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:38<00:38,  2.86it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:38<00:38,  2.86it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:39<00:37,  2.89it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:40<00:36,  2.89it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:40<00:35,  2.89it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:41<00:34,  2.91it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:42<00:33,  2.92it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:42<00:32,  2.95it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:43<00:32,  2.94it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:44<00:31,  2.94it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:44<00:30,  2.95it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:45<00:30,  2.95it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:46<00:29,  2.97it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:47<00:28,  2.97it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:47<00:27,  2.98it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:48<00:27,  2.99it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:49<00:26,  3.00it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:49<00:25,  3.00it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [00:50<00:24,  3.04it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [00:50<00:23,  3.10it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [00:51<00:22,  3.13it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [00:52<00:21,  3.15it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [00:52<00:21,  3.17it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [00:53<00:20,  3.10it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [00:54<00:20,  3.11it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [00:54<00:19,  3.09it/s]Running loglikelihood requests:  70%|███████   | 141/200 [00:55<00:22,  2.57it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [00:56<00:22,  2.54it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [00:57<00:20,  2.74it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [00:57<00:18,  2.90it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [00:58<00:16,  3.02it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [00:59<00:15,  3.11it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [00:59<00:14,  3.14it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:00<00:14,  3.20it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:00<00:13,  3.25it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:01<00:12,  3.29it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:02<00:11,  3.31it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:02<00:11,  3.34it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:03<00:10,  3.36it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:03<00:09,  3.38it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:04<00:09,  3.36it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:04<00:08,  3.40it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:05<00:07,  3.43it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:06<00:07,  3.45it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:06<00:06,  3.47it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:07<00:06,  3.49it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:07<00:05,  3.50it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:08<00:04,  3.48it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:08<00:04,  3.49it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:09<00:03,  3.46it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:10<00:03,  3.43it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:10<00:02,  3.44it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:11<00:02,  3.45it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:11<00:01,  3.46it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:12<00:00,  3.46it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:13<00:00,  3.50it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:13<00:00,  2.74it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:0'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
full model:
{'qnli': {'alias': 'qnli', 'acc,none': 0.46, 'acc_stderr,none': 0.05009082659620332}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
0.48800861061165646
0.4420522818267443
0.9519161971847797
0.7484302940574024
0.5133259423607681
0.5588784666822361
0.6658633104669237
0.7569182042181317
0.5308683195195316
0.8457203515884096
0.2160432078364904
0.9025653665852331
0.9196489243365332
0.6742217686289
0.8668007010904994
0.9846426504484882
0.5824664507839472
0.519615692575773
0.501155542927289
0.7945367166753022
0.308422053695068
0.8640142063914085
0.9138139850456612
0.4633856064809356
0.6590614315196575
0.6979080802987999
0.7199917897264415
0.7749024201981475
0.6702564595367945
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[7, 5, 4, 2, 6, 1, 3, 0]
tensor([7, 5, 4, 2, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 5, 1, 3, 6, 2, 7, 0]
tensor([4, 5, 1, 3, 6, 2, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 3, 4, 1, 2, 5, 0]
tensor([0, 1, 3, 4, 1, 2, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 1, 5, 2, 4, 1, 3, 0]
tensor([0, 1, 5, 2, 4, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 4, 1, 2, 1, 3, 5, 0]
tensor([0, 4, 1, 2, 1, 3, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[2, 4, 3, 0, 5, 1, 1, 0]
tensor([2, 4, 3, 0, 5, 1, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 3, 4, 2, 1, 1, 5, 0]
tensor([0, 3, 4, 2, 1, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 1, 3, 2, 0, 3, 1]
tensor([0, 2, 1, 3, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([0, 7])
tensor(0)
tensor([1, 5])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 11
tensor([0, 7])
tensor(0)
tensor([2, 4])
tensor(2)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
done!
Normal merging for layer 12
tensor([3, 7])
tensor(3)
tensor([5, 6])
tensor(5)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
done!
Normal merging for layer 13
tensor([0, 7])
tensor(0)
tensor([4, 5])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 14 to 15
done!
Normal merging for layer 16
tensor([0, 5])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3, 6])
tensor(3)
done!
Cross-layer merge completed for layers 17 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 9 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 8 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

115
cuda:0
multirc
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 32.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.66s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: multirc] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: multirc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/super_glue HTTP/1.1" 307 63
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/aps/super_glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=super_glue HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/super_glue/super_glue.py HTTP/1.1" 200 0
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/datasets/load.py:1429: FutureWarning: The repository for super_glue contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/super_glue
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/super_glue.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/super_glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/super_glue/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/aps/super_glue/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140376920168720 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_multirc_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140376920168720 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_multirc_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140376920168720 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_multirc_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Lock 140376920168720 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_super_glue_multirc_1.0.3_bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed.lock
DEBUG:filelock:Attempting to acquire lock 140376918635296 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140376918635296 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed/dataset_info.json
DEBUG:filelock:Attempting to release lock 140376918635296 on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:filelock:Lock 140376918635296 released on /public/home/zouyifei001/.cache/huggingface/datasets/super_glue/multirc/1.0.3/bb9675f958ebfee0d5d6dc5476fafe38c79123727a7258d515c450873dbdbbed_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of multirc from None to 0
INFO:lm_eval.api.task:Building contexts for multirc on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1272.21it/s]
DEBUG:lm_eval.evaluator:Task: multirc; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:03<10:35,  3.19s/it]Running loglikelihood requests:   2%|▏         | 3/200 [00:05<05:44,  1.75s/it]Running loglikelihood requests:   2%|▎         | 5/200 [00:08<04:50,  1.49s/it]Running loglikelihood requests:   4%|▎         | 7/200 [00:10<04:27,  1.39s/it]Running loglikelihood requests:   4%|▍         | 9/200 [00:13<04:14,  1.33s/it]Running loglikelihood requests:   6%|▌         | 11/200 [00:15<04:05,  1.30s/it]Running loglikelihood requests:   6%|▋         | 13/200 [00:18<03:58,  1.27s/it]Running loglikelihood requests:   8%|▊         | 15/200 [00:20<03:52,  1.26s/it]Running loglikelihood requests:   8%|▊         | 17/200 [00:22<03:47,  1.25s/it]Running loglikelihood requests:  10%|▉         | 19/200 [00:25<03:44,  1.24s/it]Running loglikelihood requests:  10%|█         | 21/200 [00:27<03:40,  1.23s/it]Running loglikelihood requests:  12%|█▏        | 23/200 [00:30<03:37,  1.23s/it]Running loglikelihood requests:  12%|█▎        | 25/200 [00:32<03:34,  1.23s/it]Running loglikelihood requests:  14%|█▎        | 27/200 [00:35<03:31,  1.22s/it]Running loglikelihood requests:  14%|█▍        | 29/200 [00:37<03:28,  1.22s/it]Running loglikelihood requests:  16%|█▌        | 31/200 [00:40<03:26,  1.22s/it]Running loglikelihood requests:  16%|█▋        | 33/200 [00:42<03:23,  1.22s/it]Running loglikelihood requests:  18%|█▊        | 35/200 [00:44<03:21,  1.22s/it]Running loglikelihood requests:  18%|█▊        | 37/200 [00:47<03:18,  1.22s/it]Running loglikelihood requests:  20%|█▉        | 39/200 [00:49<03:15,  1.22s/it]Running loglikelihood requests:  20%|██        | 41/200 [00:52<03:13,  1.22s/it]Running loglikelihood requests:  22%|██▏       | 43/200 [00:54<03:11,  1.22s/it]Running loglikelihood requests:  22%|██▎       | 45/200 [00:57<03:09,  1.22s/it]Running loglikelihood requests:  24%|██▎       | 47/200 [00:59<03:05,  1.21s/it]Running loglikelihood requests:  24%|██▍       | 49/200 [01:01<03:02,  1.21s/it]Running loglikelihood requests:  26%|██▌       | 51/200 [01:04<02:59,  1.20s/it]Running loglikelihood requests:  26%|██▋       | 53/200 [01:06<02:56,  1.20s/it]Running loglikelihood requests:  28%|██▊       | 55/200 [01:09<02:54,  1.20s/it]Running loglikelihood requests:  28%|██▊       | 57/200 [01:11<02:51,  1.20s/it]Running loglikelihood requests:  30%|██▉       | 59/200 [01:13<02:48,  1.20s/it]Running loglikelihood requests:  30%|███       | 61/200 [01:16<02:46,  1.20s/it]Running loglikelihood requests:  32%|███▏      | 63/200 [01:18<02:43,  1.19s/it]Running loglikelihood requests:  32%|███▎      | 65/200 [01:20<02:41,  1.19s/it]Running loglikelihood requests:  34%|███▎      | 67/200 [01:23<02:38,  1.19s/it]Running loglikelihood requests:  34%|███▍      | 69/200 [01:25<02:35,  1.19s/it]Running loglikelihood requests:  36%|███▌      | 71/200 [01:28<02:33,  1.19s/it]Running loglikelihood requests:  36%|███▋      | 73/200 [01:30<02:31,  1.20s/it]Running loglikelihood requests:  38%|███▊      | 75/200 [01:32<02:29,  1.19s/it]Running loglikelihood requests:  38%|███▊      | 77/200 [01:35<02:26,  1.19s/it]Running loglikelihood requests:  40%|███▉      | 79/200 [01:37<02:23,  1.19s/it]Running loglikelihood requests:  40%|████      | 81/200 [01:40<02:21,  1.19s/it]Running loglikelihood requests:  42%|████▏     | 83/200 [01:42<02:18,  1.19s/it]Running loglikelihood requests:  42%|████▎     | 85/200 [01:44<02:16,  1.19s/it]Running loglikelihood requests:  44%|████▎     | 87/200 [01:47<02:15,  1.20s/it]Running loglikelihood requests:  44%|████▍     | 89/200 [01:49<02:14,  1.21s/it]Running loglikelihood requests:  46%|████▌     | 91/200 [01:52<02:12,  1.22s/it]Running loglikelihood requests:  46%|████▋     | 93/200 [01:54<02:12,  1.23s/it]Running loglikelihood requests:  48%|████▊     | 95/200 [01:57<02:10,  1.24s/it]Running loglikelihood requests:  48%|████▊     | 97/200 [01:59<02:08,  1.25s/it]Running loglikelihood requests:  50%|████▉     | 99/200 [02:02<02:05,  1.25s/it]Running loglikelihood requests:  50%|█████     | 101/200 [02:04<02:03,  1.25s/it]Running loglikelihood requests:  52%|█████▏    | 103/200 [02:07<02:00,  1.25s/it]Running loglikelihood requests:  52%|█████▎    | 105/200 [02:09<01:57,  1.24s/it]Running loglikelihood requests:  54%|█████▎    | 107/200 [02:12<01:54,  1.23s/it]Running loglikelihood requests:  55%|█████▍    | 109/200 [02:14<01:51,  1.23s/it]Running loglikelihood requests:  56%|█████▌    | 111/200 [02:16<01:48,  1.22s/it]Running loglikelihood requests:  56%|█████▋    | 113/200 [02:19<01:45,  1.21s/it]Running loglikelihood requests:  57%|█████▊    | 115/200 [02:21<01:43,  1.21s/it]Running loglikelihood requests:  58%|█████▊    | 117/200 [02:24<01:40,  1.21s/it]Running loglikelihood requests:  60%|█████▉    | 119/200 [02:26<01:37,  1.21s/it]Running loglikelihood requests:  60%|██████    | 121/200 [02:28<01:35,  1.21s/it]Running loglikelihood requests:  62%|██████▏   | 123/200 [02:31<01:32,  1.20s/it]Running loglikelihood requests:  62%|██████▎   | 125/200 [02:33<01:30,  1.20s/it]Running loglikelihood requests:  64%|██████▎   | 127/200 [02:36<01:27,  1.20s/it]Running loglikelihood requests:  64%|██████▍   | 129/200 [02:38<01:25,  1.20s/it]Running loglikelihood requests:  66%|██████▌   | 131/200 [02:40<01:22,  1.20s/it]Running loglikelihood requests:  66%|██████▋   | 133/200 [02:43<01:20,  1.20s/it]Running loglikelihood requests:  68%|██████▊   | 135/200 [02:44<01:09,  1.08s/it]Running loglikelihood requests:  68%|██████▊   | 137/200 [02:46<01:01,  1.02it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [02:47<00:56,  1.09it/s]Running loglikelihood requests:  70%|███████   | 141/200 [02:49<00:51,  1.15it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [02:51<00:47,  1.19it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [02:52<00:44,  1.23it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [02:54<00:42,  1.26it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [02:55<00:39,  1.28it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [02:57<00:37,  1.30it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [02:58<00:35,  1.32it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [02:59<00:33,  1.33it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [03:01<00:32,  1.34it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [03:02<00:30,  1.35it/s]Running loglikelihood requests:  80%|████████  | 161/200 [03:04<00:28,  1.36it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [03:05<00:26,  1.40it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [03:06<00:24,  1.44it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [03:08<00:22,  1.46it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [03:09<00:20,  1.48it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [03:10<00:19,  1.50it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [03:12<00:18,  1.49it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [03:13<00:16,  1.49it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [03:14<00:15,  1.51it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [03:16<00:13,  1.52it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [03:17<00:12,  1.52it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [03:18<00:11,  1.53it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [03:20<00:09,  1.54it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [03:21<00:08,  1.55it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [03:22<00:07,  1.55it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [03:23<00:05,  1.56it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [03:25<00:04,  1.56it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [03:26<00:03,  1.56it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [03:27<00:01,  1.56it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [03:28<00:00,  1.56it/s]Running loglikelihood requests: 100%|██████████| 200/200 [03:28<00:00,  1.04s/it]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:1'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:1'}
full model:
{'multirc': {'alias': 'multirc', 'acc,none': 0.54, 'acc_stderr,none': 0.05009082659620331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.6089030413152259
0.13723554564825818
0.32639298774801107
0.39554004962513223
0.17838079452737773
0.18172395498612623
0.4458149326815675
0.2599923469162762
0.44953845901781375
0.264228421159195
0.28453253935496087
0.5178234519727917
0.18549509579986273
0.3164231435223059
0.47622435667997154
0.5789910219470605
0.38414027299756903
0.6648306636715198
0.2288657593104162
0.30014630918632723
0.28954340172694804
0.7956189982678256
0.789982900191189
0.3644425339397572
0.37373995160413354
0.19965826892219962
0.3752330861186013
0.6279352732581062
0.3474029418882723
0.6089030413152259
0.13723554564825818
0.32639298774801107
0.39554004962513223
0.17838079452737773
0.18172395498612623
0.4458149326815675
0.2599923469162762
0.44953845901781375
0.264228421159195
0.28453253935496087
0.5178234519727917
0.18549509579986273
0.3164231435223059
0.47622435667997154
0.5789910219470605
0.38414027299756903
0.6648306636715198
0.2288657593104162
0.30014630918632723
0.28954340172694804
0.7956189982678256
0.789982900191189
0.3644425339397572
0.37373995160413354
0.19965826892219962
0.3752330861186013
0.6279352732581062
0.3474029418882723
0.6089030413152259
0.13723554564825818
0.32639298774801107
0.39554004962513223
0.17838079452737773
0.18172395498612623
0.4458149326815675
0.2599923469162762
0.44953845901781375
0.264228421159195
0.28453253935496087
0.5178234519727917
0.18549509579986273
0.3164231435223059
0.47622435667997154
0.5789910219470605
0.38414027299756903
0.6648306636715198
0.2288657593104162
0.30014630918632723
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[5, 3, 7, 0, 6, 2, 4, 1]
tensor([5, 3, 7, 0, 6, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 7, 4, 2, 1, 3, 6, 0]
tensor([5, 7, 4, 2, 1, 3, 6, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[2, 1, 3, 6, 0, 5, 7, 4]
tensor([2, 1, 3, 6, 0, 5, 7, 4], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[7, 4, 1, 6, 0, 2, 3, 5]
tensor([7, 4, 1, 6, 0, 2, 3, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 6, 3, 2, 5, 1, 7, 0]
tensor([4, 6, 3, 2, 5, 1, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[5, 0, 2, 1, 4, 7, 3, 6]
tensor([5, 0, 2, 1, 4, 7, 3, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 0, 1, 1.0, 1.0, 1.0]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
done!
Normal merging for layer 2
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 3 to 4
done!
Normal merging for layer 5
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
done!
Normal merging for layer 6
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
done!
Normal merging for layer 7
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
done!
Cross-layer merge completed for layers 8 to 25
done!
Normal merging for layer 26
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 8 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.3238 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 7 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

78
cuda:1
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.06s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140375442406336 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375442406336 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375442406336 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375442406336 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140353594248656 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140353594248656 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353594248656 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140353594248656 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 118919.88it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<09:20,  1.87s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<07:23,  1.49s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:12,  1.17it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:04<04:19,  1.14it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:05<03:18,  1.47it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:06<03:32,  1.38it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:07<02:52,  1.68it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:08<03:06,  1.55it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:09<02:36,  1.84it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:09<02:50,  1.68it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:10<02:24,  1.96it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:11<02:37,  1.79it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:12<02:50,  1.65it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:12<02:23,  1.95it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:13<02:39,  1.75it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:14<02:17,  2.02it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:15<02:03,  2.23it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:15<02:18,  1.98it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:16<02:02,  2.22it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:17<02:17,  1.98it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:18<02:29,  1.80it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:18<02:39,  1.68it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:19<02:47,  1.60it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:20<02:17,  1.94it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:20<02:00,  2.19it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:21<01:50,  2.38it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:22<01:42,  2.53it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:23<01:57,  2.21it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:23<02:10,  1.98it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:24<02:20,  1.82it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:25<01:58,  2.14it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:25<01:46,  2.37it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:26<02:00,  2.10it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:27<01:46,  2.34it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:27<01:38,  2.52it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:28<01:51,  2.21it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:29<02:03,  1.99it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:29<02:13,  1.84it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:30<01:51,  2.17it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:31<01:39,  2.41it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:31<01:32,  2.58it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:32<01:45,  2.26it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:33<01:35,  2.48it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:33<01:47,  2.19it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:34<01:57,  1.99it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:35<02:06,  1.84it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:35<01:46,  2.18it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:36<01:33,  2.44it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:37<01:45,  2.17it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:37<01:54,  1.98it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:38<01:37,  2.30it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:39<01:28,  2.53it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:39<01:22,  2.69it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:40<01:33,  2.35it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:41<01:43,  2.11it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:41<01:52,  1.94it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:42<01:59,  1.82it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:43<01:37,  2.21it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:43<01:46,  2.01it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:44<01:30,  2.34it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:44<01:40,  2.10it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:45<01:26,  2.41it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:46<01:18,  2.63it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:46<01:13,  2.78it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:47<01:24,  2.42it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:48<01:16,  2.64it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:48<01:26,  2.32it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:49<01:18,  2.54it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:50<01:27,  2.26it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:50<01:35,  2.05it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:51<01:42,  1.92it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:51<01:47,  1.82it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:52<01:26,  2.23it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:53<01:33,  2.04it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:53<01:40,  1.91it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:54<01:22,  2.29it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:55<01:14,  2.51it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:55<01:08,  2.69it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:56<01:04,  2.82it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:57<01:02,  2.91it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:57<01:00,  2.97it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:58<01:09,  2.55it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [00:59<01:04,  2.73it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [00:59<01:13,  2.38it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:00<01:21,  2.15it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:00<01:27,  1.98it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:01<01:13,  2.34it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:02<01:05,  2.59it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:02<00:59,  2.79it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:03<01:07,  2.46it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:03<01:14,  2.21it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:04<01:20,  2.05it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:05<01:24,  1.93it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:05<01:27,  1.84it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:06<01:10,  2.27it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:07<01:00,  2.59it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:07<01:07,  2.33it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:08<00:58,  2.64it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:08<01:05,  2.36it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:09<01:10,  2.16it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:09<01:15,  2.02it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:10<01:01,  2.43it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:11<00:54,  2.73it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:11<00:49,  2.94it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:12<00:56,  2.57it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:12<00:50,  2.83it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:13<00:46,  3.00it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:14<00:44,  3.13it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:14<00:50,  2.71it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:15<00:46,  2.93it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:15<00:52,  2.57it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:16<00:46,  2.84it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:16<00:43,  3.03it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:17<00:49,  2.64it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:18<00:54,  2.37it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:18<00:58,  2.19it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:19<01:01,  2.06it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:19<00:50,  2.49it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:20<00:43,  2.80it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:20<00:40,  3.02it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:21<00:45,  2.64it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:22<00:49,  2.38it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:22<00:42,  2.74it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:23<00:38,  2.99it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:23<00:43,  2.63it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:24<00:38,  2.91it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:24<00:35,  3.12it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:25<00:39,  2.73it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:25<00:43,  2.46it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:26<00:37,  2.81it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:27<00:41,  2.51it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:27<00:45,  2.28it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:28<00:37,  2.69it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:28<00:41,  2.44it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:29<00:44,  2.25it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:29<00:46,  2.11it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:30<00:37,  2.58it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:30<00:32,  2.91it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:31<00:36,  2.59it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:32<00:31,  2.92it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:32<00:28,  3.15it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:33<00:26,  3.32it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:33<00:30,  2.88it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:34<00:27,  3.13it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:34<00:30,  2.76it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:35<00:33,  2.49it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:35<00:28,  2.87it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:36<00:25,  3.14it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:36<00:28,  2.76it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:37<00:24,  3.06it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:37<00:27,  2.72it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:38<00:23,  3.05it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:38<00:26,  2.70it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:39<00:28,  2.47it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:39<00:24,  2.87it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:40<00:26,  2.58it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:41<00:28,  2.39it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:41<00:29,  2.24it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:42<00:30,  2.15it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:42<00:30,  2.08it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:43<00:31,  2.03it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:43<00:31,  2.00it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:44<00:23,  2.55it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:44<00:19,  2.94it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:45<00:17,  3.21it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:45<00:15,  3.41it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:46<00:15,  3.28it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:46<00:14,  3.37it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:47<00:13,  3.51it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:47<00:12,  3.61it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:48<00:11,  3.69it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:48<00:13,  3.20it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:49<00:14,  2.84it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:49<00:12,  3.17it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:50<00:13,  2.82it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:50<00:11,  3.17it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:51<00:12,  2.82it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:52<00:13,  2.58it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:52<00:14,  2.41it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:52<00:11,  2.89it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:53<00:09,  3.22it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:53<00:08,  3.46it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:54<00:07,  3.65it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:54<00:07,  3.18it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:55<00:06,  3.46it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:55<00:07,  3.04it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:56<00:07,  2.76it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:56<00:05,  3.18it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:57<00:06,  2.85it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:57<00:06,  2.63it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:58<00:06,  2.46it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [01:58<00:04,  2.98it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [01:59<00:03,  3.35it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [01:59<00:02,  3.60it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [02:00<00:02,  3.78it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [02:00<00:02,  3.30it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:01<00:02,  2.97it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:01<00:01,  3.39it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:02<00:00,  3.73it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:02<00:00,  3.32it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:02<00:00,  2.45it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:2'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:2'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 7 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.5127 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 6 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

17
cuda:2
truthfulqa_gen
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:56<00:56, 56.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 32.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:12<00:00, 36.06s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:truthfulqa_gen: No `generation_kwargs` specified in task config, defaulting to {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa HTTP/1.1" 307 71
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/truthful_qa/truthful_qa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa HTTP/1.1" 307 71
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthfulqa/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa/revision/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 121
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa/revision/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490?recursive=False&expand=False HTTP/1.1" 307 146
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490?recursive=False&expand=False HTTP/1.1" 200 401
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490/generation?recursive=False&expand=False HTTP/1.1" 307 157
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490/generation?recursive=False&expand=False HTTP/1.1" 200 247
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa/revision/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 121
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa/revision/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthfulqa/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:filelock:Attempting to acquire lock 140353600382416 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_generation_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Lock 140353600382416 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_generation_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353600382416 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_generation_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Lock 140353600382416 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_generation_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Attempting to acquire lock 140353573707872 on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:filelock:Lock 140353573707872 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353573707872 on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:filelock:Lock 140353573707872 released on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/generation/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:truthfulqa_gen: Using gen_kwargs: {'until': ['\n\n'], 'do_sample': False, 'temperature': 0}
INFO:lm_eval.evaluator:num_fewshot has been set to 0 for truthfulqa_gen in its config. Manual configuration will be ignored.
INFO:lm_eval.api.task:Building contexts for truthfulqa_gen on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1568.93it/s]
DEBUG:lm_eval.evaluator:Task: truthfulqa_gen; number of requests on this rank: 100
INFO:lm_eval.evaluator:Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:05<08:27,  5.12s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<07:14,  4.44s/it]Running generate_until requests:   3%|▎         | 3/100 [00:14<07:45,  4.80s/it]Running generate_until requests:   4%|▍         | 4/100 [00:19<08:02,  5.02s/it]Running generate_until requests:   5%|▌         | 5/100 [00:24<07:40,  4.84s/it]Running generate_until requests:   6%|▌         | 6/100 [00:26<06:18,  4.03s/it]Running generate_until requests:   7%|▋         | 7/100 [00:31<06:42,  4.32s/it]Running generate_until requests:   8%|▊         | 8/100 [00:34<06:09,  4.02s/it]Running generate_until requests:   9%|▉         | 9/100 [00:40<06:47,  4.47s/it]Running generate_until requests:  10%|█         | 10/100 [00:42<05:49,  3.89s/it]Running generate_until requests:  11%|█         | 11/100 [00:46<05:34,  3.76s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:49<05:05,  3.47s/it]Running generate_until requests:  13%|█▎        | 13/100 [00:53<05:15,  3.62s/it]Running generate_until requests:  14%|█▍        | 14/100 [00:56<05:00,  3.49s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:00<05:16,  3.72s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:03<04:55,  3.51s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:07<05:09,  3.73s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:10<04:48,  3.52s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:13<04:15,  3.15s/it]Running generate_until requests:  20%|██        | 20/100 [01:16<04:25,  3.31s/it]Running generate_until requests:  21%|██        | 21/100 [01:20<04:25,  3.35s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:22<03:56,  3.03s/it]Running generate_until requests:  23%|██▎       | 23/100 [01:25<03:47,  2.96s/it]Running generate_until requests:  24%|██▍       | 24/100 [01:28<03:36,  2.85s/it]Running generate_until requests:  25%|██▌       | 25/100 [01:31<03:39,  2.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [01:35<03:57,  3.21s/it]Running generate_until requests:  27%|██▋       | 27/100 [01:38<04:06,  3.38s/it]Running generate_until requests:  28%|██▊       | 28/100 [01:42<04:11,  3.49s/it]Running generate_until requests:  29%|██▉       | 29/100 [01:46<04:21,  3.69s/it]Running generate_until requests:  30%|███       | 30/100 [01:49<03:58,  3.40s/it]Running generate_until requests:  31%|███       | 31/100 [01:51<03:32,  3.08s/it]Running generate_until requests:  32%|███▏      | 32/100 [01:55<03:46,  3.33s/it]Running generate_until requests:  33%|███▎      | 33/100 [01:58<03:22,  3.03s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:01<03:35,  3.27s/it]Running generate_until requests:  35%|███▌      | 35/100 [02:05<03:47,  3.51s/it]Running generate_until requests:  36%|███▌      | 36/100 [02:09<03:52,  3.64s/it]Running generate_until requests:  37%|███▋      | 37/100 [02:14<04:02,  3.84s/it]Running generate_until requests:  38%|███▊      | 38/100 [02:18<04:07,  3.99s/it]Running generate_until requests:  39%|███▉      | 39/100 [02:22<03:55,  3.86s/it]Running generate_until requests:  40%|████      | 40/100 [02:24<03:29,  3.49s/it]Running generate_until requests:  41%|████      | 41/100 [02:27<03:06,  3.16s/it]Running generate_until requests:  42%|████▏     | 42/100 [02:31<03:17,  3.40s/it]Running generate_until requests:  43%|████▎     | 43/100 [02:35<03:25,  3.61s/it]Running generate_until requests:  44%|████▍     | 44/100 [02:39<03:32,  3.80s/it]Running generate_until requests:  45%|████▌     | 45/100 [02:42<03:24,  3.72s/it]Running generate_until requests:  46%|████▌     | 46/100 [02:46<03:14,  3.60s/it]Running generate_until requests:  47%|████▋     | 47/100 [02:49<03:04,  3.48s/it]Running generate_until requests:  48%|████▊     | 48/100 [02:54<03:23,  3.92s/it]Running generate_until requests:  49%|████▉     | 49/100 [02:56<02:58,  3.50s/it]Running generate_until requests:  50%|█████     | 50/100 [03:01<03:15,  3.90s/it]Running generate_until requests:  51%|█████     | 51/100 [03:05<03:06,  3.82s/it]Running generate_until requests:  52%|█████▏    | 52/100 [03:08<02:46,  3.47s/it]Running generate_until requests:  53%|█████▎    | 53/100 [03:10<02:32,  3.23s/it]Running generate_until requests:  54%|█████▍    | 54/100 [03:14<02:36,  3.39s/it]Running generate_until requests:  55%|█████▌    | 55/100 [03:18<02:37,  3.49s/it]Running generate_until requests:  56%|█████▌    | 56/100 [03:21<02:32,  3.48s/it]Running generate_until requests:  57%|█████▋    | 57/100 [03:24<02:17,  3.20s/it]Running generate_until requests:  58%|█████▊    | 58/100 [03:27<02:18,  3.31s/it]Running generate_until requests:  59%|█████▉    | 59/100 [03:31<02:24,  3.51s/it]Running generate_until requests:  60%|██████    | 60/100 [03:34<02:08,  3.22s/it]Running generate_until requests:  61%|██████    | 61/100 [03:36<01:54,  2.93s/it]Running generate_until requests:  62%|██████▏   | 62/100 [03:38<01:44,  2.76s/it]Running generate_until requests:  63%|██████▎   | 63/100 [03:42<01:49,  2.95s/it]Running generate_until requests:  64%|██████▍   | 64/100 [03:46<02:00,  3.35s/it]Running generate_until requests:  65%|██████▌   | 65/100 [03:50<02:02,  3.49s/it]Running generate_until requests:  66%|██████▌   | 66/100 [03:53<01:53,  3.35s/it]Running generate_until requests:  67%|██████▋   | 67/100 [03:56<01:47,  3.25s/it]Running generate_until requests:  68%|██████▊   | 68/100 [04:00<01:54,  3.57s/it]Running generate_until requests:  69%|██████▉   | 69/100 [04:03<01:44,  3.37s/it]Running generate_until requests:  70%|███████   | 70/100 [04:07<01:47,  3.57s/it]Running generate_until requests:  71%|███████   | 71/100 [04:10<01:36,  3.32s/it]Running generate_until requests:  72%|███████▏  | 72/100 [04:14<01:41,  3.61s/it]Running generate_until requests:  73%|███████▎  | 73/100 [04:18<01:37,  3.62s/it]Running generate_until requests:  74%|███████▍  | 74/100 [04:22<01:39,  3.83s/it]Running generate_until requests:  75%|███████▌  | 75/100 [04:26<01:34,  3.78s/it]Running generate_until requests:  76%|███████▌  | 76/100 [04:29<01:26,  3.59s/it]Running generate_until requests:  77%|███████▋  | 77/100 [04:32<01:19,  3.47s/it]Running generate_until requests:  78%|███████▊  | 78/100 [04:36<01:16,  3.47s/it]Running generate_until requests:  79%|███████▉  | 79/100 [04:38<01:07,  3.20s/it]Running generate_until requests:  80%|████████  | 80/100 [04:41<01:04,  3.21s/it]Running generate_until requests:  81%|████████  | 81/100 [04:44<00:59,  3.14s/it]Running generate_until requests:  82%|████████▏ | 82/100 [04:48<00:56,  3.15s/it]Running generate_until requests:  83%|████████▎ | 83/100 [04:50<00:51,  3.04s/it]Running generate_until requests:  84%|████████▍ | 84/100 [04:54<00:49,  3.09s/it]Running generate_until requests:  85%|████████▌ | 85/100 [04:57<00:50,  3.33s/it]Running generate_until requests:  86%|████████▌ | 86/100 [05:02<00:50,  3.63s/it]Running generate_until requests:  87%|████████▋ | 87/100 [05:05<00:45,  3.48s/it]Running generate_until requests:  88%|████████▊ | 88/100 [05:08<00:40,  3.39s/it]Running generate_until requests:  89%|████████▉ | 89/100 [05:12<00:37,  3.41s/it]Running generate_until requests:  90%|█████████ | 90/100 [05:17<00:40,  4.02s/it]Running generate_until requests:  91%|█████████ | 91/100 [05:20<00:33,  3.69s/it]Running generate_until requests:  92%|█████████▏| 92/100 [05:24<00:30,  3.77s/it]Running generate_until requests:  93%|█████████▎| 93/100 [05:28<00:27,  3.87s/it]Running generate_until requests:  94%|█████████▍| 94/100 [05:31<00:21,  3.66s/it]Running generate_until requests:  95%|█████████▌| 95/100 [05:34<00:17,  3.47s/it]Running generate_until requests:  96%|█████████▌| 96/100 [05:37<00:13,  3.38s/it]Running generate_until requests:  97%|█████████▋| 97/100 [05:40<00:09,  3.20s/it]Running generate_until requests:  98%|█████████▊| 98/100 [05:43<00:06,  3.07s/it]Running generate_until requests:  99%|█████████▉| 99/100 [05:46<00:03,  3.18s/it]Running generate_until requests: 100%|██████████| 100/100 [05:49<00:00,  2.94s/it]Running generate_until requests: 100%|██████████| 100/100 [05:49<00:00,  3.49s/it]
INFO:absl:Using default tokenizer.
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/nltk/app/__init__.py:29: UserWarning: nltk.app package not loaded (please install Tkinter library).
  warnings.warn("nltk.app package not loaded (please install Tkinter library).")
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/nltk/draw/__init__.py:15: UserWarning: nltk.draw package not loaded (please install Tkinter library).
  warnings.warn("nltk.draw package not loaded (please install Tkinter library).")
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:3'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:3'}
full model:
{'truthfulqa_gen': {'alias': 'truthfulqa_gen', 'bleu_max,none': np.float64(26.40127661894181), 'bleu_max_stderr,none': 2.1754749062902548, 'bleu_acc,none': 0.31, 'bleu_acc_stderr,none': 0.04648231987117317, 'bleu_diff,none': np.float64(-8.38421628699615), 'bleu_diff_stderr,none': 2.233659318450408, 'rouge1_max,none': np.float64(52.39257501507105), 'rouge1_max_stderr,none': 2.497988696291605, 'rouge1_acc,none': 0.33, 'rouge1_acc_stderr,none': 0.04725815626252609, 'rouge1_diff,none': np.float64(-8.49233688805195), 'rouge1_diff_stderr,none': 2.4527766146725396, 'rouge2_max,none': np.float64(36.528836260260114), 'rouge2_max_stderr,none': 2.9070636540161603, 'rouge2_acc,none': 0.25, 'rouge2_acc_stderr,none': 0.04351941398892446, 'rouge2_diff,none': np.float64(-11.286841635138686), 'rouge2_diff_stderr,none': 2.8045752963587796, 'rougeL_max,none': np.float64(50.18713258146154), 'rougeL_max_stderr,none': 2.574531398670641, 'rougeL_acc,none': 0.29, 'rougeL_acc_stderr,none': 0.045604802157206865, 'rougeL_diff,none': np.float64(-9.010647268655035), 'rougeL_diff_stderr,none': 2.478788547467544}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.7928891029272103
0.48508195745512417
0.5388000385178897
0.8984933069430049
0.9057708532745775
0.629059352007021
0.795760846916901
0.4825438519822694
0.5028114826155397
0.4836254802690467
0.7584074197492217
0.6112907464450953
0.25539744450989454
0.29584156479011836
0.49554318735616293
0.5399450729287507
0.8968987727187346
0.6254425115433571
0.8768382043653237
0.9322600237654863
0.6508343302077328
0.3635071819343989
0.9743990376375885
0.8547940855609614
0.2488551561967485
0.21102746852224197
0.3645409505083988
0.27755218152593486
0.7041951975794944
0.7928891029272103
0.48508195745512417
0.5388000385178897
0.8984933069430049
0.9057708532745775
0.629059352007021
0.795760846916901
0.4825438519822694
0.5028114826155397
0.4836254802690467
0.7584074197492217
0.6112907464450953
0.25539744450989454
0.29584156479011836
0.49554318735616293
0.5399450729287507
0.8968987727187346
0.6254425115433571
0.8768382043653237
0.9322600237654863
0.6508343302077328
0.3635071819343989
0.9743990376375885
0.8547940855609614
0.2488551561967485
0.21102746852224197
0.3645409505083988
0.27755218152593486
0.7041951975794944
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[2, 1, 7, 0, 6, 4, 3, 5]
tensor([2, 1, 7, 0, 6, 4, 3, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[0, 5, 7, 4, 6, 1, 2, 3]
tensor([0, 5, 7, 4, 6, 1, 2, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[3, 7, 4, 1, 5, 0, 2, 6]
tensor([3, 7, 4, 1, 5, 0, 2, 6], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[0, 3, 5, 2, 4, 6, 1, 7]
tensor([0, 3, 5, 2, 4, 6, 1, 7], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[1, 6, 7, 4, 2, 0, 3, 5]
tensor([1, 6, 7, 4, 2, 0, 3, 5], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[3, 0, 0, 1, 2, 3, 2, 1]
tensor([3, 0, 0, 1, 2, 3, 2, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([0])
tensor(0)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 2 to 3
done!
Normal merging for layer 4
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
done!
Normal merging for layer 5
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([7])
tensor(7)
done!
Normal merging for layer 6
tensor([5])
tensor(5)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 7 to 17
done!
Normal merging for layer 18
tensor([1, 2])
tensor(1)
tensor([3, 7])
tensor(3)
tensor([4, 6])
tensor(4)
tensor([0, 5])
tensor(0)
done!
Cross-layer merge completed for layers 19 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 6 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.9458 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 5 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

92
cuda:3
truthfulqa_mc2
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.26s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.59s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa HTTP/1.1" 307 71
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/truthful_qa/truthful_qa.py HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa HTTP/1.1" 307 71
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa HTTP/1.1" 200 1309
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthfulqa/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 240
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/truthfulqa/truthful_qa/resolve/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 245
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490/multiple_choice?recursive=False&expand=False HTTP/1.1" 307 162
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/truthfulqa/truthful_qa/tree/741b8276f2d1982aa3d5b832d3ee81ed3b896490/multiple_choice?recursive=False&expand=False HTTP/1.1" 200 252
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 307 123
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/truthfulqa/truthful_qa/paths-info/741b8276f2d1982aa3d5b832d3ee81ed3b896490 HTTP/1.1" 200 245
DEBUG:filelock:Attempting to acquire lock 140355701962944 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_multiple_choice_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Lock 140355701962944 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_multiple_choice_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_info.json
DEBUG:filelock:Attempting to release lock 140355701962944 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_multiple_choice_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Lock 140355701962944 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_truthful_qa_multiple_choice_0.0.0_741b8276f2d1982aa3d5b832d3ee81ed3b896490.lock
DEBUG:filelock:Attempting to acquire lock 140375036157376 on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:filelock:Lock 140375036157376 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375036157376 on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:filelock:Lock 140375036157376 released on /public/home/zouyifei001/.cache/huggingface/datasets/truthful_qa/multiple_choice/0.0.0/741b8276f2d1982aa3d5b832d3ee81ed3b896490_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
INFO:lm_eval.evaluator:num_fewshot has been set to 0 for truthfulqa_mc2 in its config. Manual configuration will be ignored.
INFO:lm_eval.api.task:Building contexts for truthfulqa_mc2 on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 98%|█████████▊| 98/100 [00:00<00:00, 976.88it/s]100%|██████████| 100/100 [00:00<00:00, 975.49it/s]
DEBUG:lm_eval.evaluator:Task: truthfulqa_mc2; number of requests on this rank: 741
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/741 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/741 [00:02<27:08,  2.20s/it]Running loglikelihood requests:   0%|          | 2/741 [00:03<22:11,  1.80s/it]Running loglikelihood requests:   0%|          | 3/741 [00:05<20:31,  1.67s/it]Running loglikelihood requests:   1%|          | 4/741 [00:06<19:41,  1.60s/it]Running loglikelihood requests:   1%|          | 5/741 [00:08<19:12,  1.57s/it]Running loglikelihood requests:   1%|          | 6/741 [00:09<18:55,  1.55s/it]Running loglikelihood requests:   1%|          | 7/741 [00:11<18:41,  1.53s/it]Running loglikelihood requests:   1%|          | 8/741 [00:12<18:31,  1.52s/it]Running loglikelihood requests:   1%|          | 9/741 [00:14<18:24,  1.51s/it]Running loglikelihood requests:   1%|▏         | 10/741 [00:15<18:21,  1.51s/it]Running loglikelihood requests:   1%|▏         | 11/741 [00:17<18:11,  1.50s/it]Running loglikelihood requests:   2%|▏         | 12/741 [00:18<18:02,  1.48s/it]Running loglikelihood requests:   2%|▏         | 13/741 [00:20<17:54,  1.48s/it]Running loglikelihood requests:   2%|▏         | 14/741 [00:21<17:47,  1.47s/it]Running loglikelihood requests:   2%|▏         | 15/741 [00:23<17:43,  1.46s/it]Running loglikelihood requests:   2%|▏         | 16/741 [00:24<17:41,  1.46s/it]Running loglikelihood requests:   2%|▏         | 17/741 [00:25<17:36,  1.46s/it]Running loglikelihood requests:   2%|▏         | 18/741 [00:27<17:32,  1.46s/it]Running loglikelihood requests:   3%|▎         | 19/741 [00:28<17:27,  1.45s/it]Running loglikelihood requests:   3%|▎         | 20/741 [00:30<17:24,  1.45s/it]Running loglikelihood requests:   3%|▎         | 21/741 [00:31<17:20,  1.45s/it]Running loglikelihood requests:   3%|▎         | 22/741 [00:33<17:18,  1.44s/it]Running loglikelihood requests:   3%|▎         | 23/741 [00:34<18:00,  1.50s/it]Running loglikelihood requests:   3%|▎         | 24/741 [00:36<17:44,  1.48s/it]Running loglikelihood requests:   3%|▎         | 25/741 [00:37<17:32,  1.47s/it]Running loglikelihood requests:   4%|▎         | 26/741 [00:39<17:24,  1.46s/it]Running loglikelihood requests:   4%|▎         | 27/741 [00:40<17:17,  1.45s/it]Running loglikelihood requests:   4%|▍         | 28/741 [00:41<17:11,  1.45s/it]Running loglikelihood requests:   4%|▍         | 29/741 [00:43<17:07,  1.44s/it]Running loglikelihood requests:   4%|▍         | 30/741 [00:44<17:09,  1.45s/it]Running loglikelihood requests:   4%|▍         | 31/741 [00:46<17:01,  1.44s/it]Running loglikelihood requests:   4%|▍         | 32/741 [00:47<16:54,  1.43s/it]Running loglikelihood requests:   4%|▍         | 33/741 [00:49<16:51,  1.43s/it]Running loglikelihood requests:   5%|▍         | 34/741 [00:50<16:42,  1.42s/it]Running loglikelihood requests:   5%|▍         | 35/741 [00:51<16:34,  1.41s/it]Running loglikelihood requests:   5%|▍         | 36/741 [00:53<16:38,  1.42s/it]Running loglikelihood requests:   5%|▍         | 37/741 [00:54<16:34,  1.41s/it]Running loglikelihood requests:   5%|▌         | 38/741 [00:56<16:32,  1.41s/it]Running loglikelihood requests:   5%|▌         | 39/741 [00:57<16:29,  1.41s/it]Running loglikelihood requests:   5%|▌         | 40/741 [00:58<16:26,  1.41s/it]Running loglikelihood requests:   6%|▌         | 41/741 [01:00<16:24,  1.41s/it]Running loglikelihood requests:   6%|▌         | 42/741 [01:01<16:30,  1.42s/it]Running loglikelihood requests:   6%|▌         | 43/741 [01:03<16:22,  1.41s/it]Running loglikelihood requests:   6%|▌         | 44/741 [01:04<16:17,  1.40s/it]Running loglikelihood requests:   6%|▌         | 45/741 [01:05<16:12,  1.40s/it]Running loglikelihood requests:   6%|▌         | 46/741 [01:07<16:08,  1.39s/it]Running loglikelihood requests:   6%|▋         | 47/741 [01:08<16:05,  1.39s/it]Running loglikelihood requests:   6%|▋         | 48/741 [01:10<16:02,  1.39s/it]Running loglikelihood requests:   7%|▋         | 49/741 [01:11<16:14,  1.41s/it]Running loglikelihood requests:   7%|▋         | 50/741 [01:12<16:07,  1.40s/it]Running loglikelihood requests:   7%|▋         | 51/741 [01:14<16:02,  1.40s/it]Running loglikelihood requests:   7%|▋         | 52/741 [01:15<15:58,  1.39s/it]Running loglikelihood requests:   7%|▋         | 53/741 [01:17<15:57,  1.39s/it]Running loglikelihood requests:   7%|▋         | 54/741 [01:18<15:54,  1.39s/it]Running loglikelihood requests:   7%|▋         | 55/741 [01:19<16:02,  1.40s/it]Running loglikelihood requests:   8%|▊         | 56/741 [01:21<16:04,  1.41s/it]Running loglikelihood requests:   8%|▊         | 57/741 [01:22<16:07,  1.41s/it]Running loglikelihood requests:   8%|▊         | 58/741 [01:24<16:06,  1.41s/it]Running loglikelihood requests:   8%|▊         | 59/741 [01:25<15:57,  1.40s/it]Running loglikelihood requests:   8%|▊         | 60/741 [01:26<15:51,  1.40s/it]Running loglikelihood requests:   8%|▊         | 61/741 [01:28<15:47,  1.39s/it]Running loglikelihood requests:   8%|▊         | 62/741 [01:29<15:43,  1.39s/it]Running loglikelihood requests:   9%|▊         | 63/741 [01:31<15:40,  1.39s/it]Running loglikelihood requests:   9%|▊         | 64/741 [01:32<15:37,  1.38s/it]Running loglikelihood requests:   9%|▉         | 65/741 [01:33<15:37,  1.39s/it]Running loglikelihood requests:   9%|▉         | 66/741 [01:35<15:36,  1.39s/it]Running loglikelihood requests:   9%|▉         | 67/741 [01:36<15:35,  1.39s/it]Running loglikelihood requests:   9%|▉         | 68/741 [01:38<15:34,  1.39s/it]Running loglikelihood requests:   9%|▉         | 69/741 [01:39<15:35,  1.39s/it]Running loglikelihood requests:   9%|▉         | 70/741 [01:40<15:36,  1.40s/it]Running loglikelihood requests:  10%|▉         | 71/741 [01:42<15:32,  1.39s/it]Running loglikelihood requests:  10%|▉         | 72/741 [01:43<15:33,  1.40s/it]Running loglikelihood requests:  10%|▉         | 73/741 [01:45<15:28,  1.39s/it]Running loglikelihood requests:  10%|▉         | 74/741 [01:46<15:24,  1.39s/it]Running loglikelihood requests:  10%|█         | 75/741 [01:47<15:20,  1.38s/it]Running loglikelihood requests:  10%|█         | 76/741 [01:49<15:26,  1.39s/it]Running loglikelihood requests:  10%|█         | 77/741 [01:50<15:25,  1.39s/it]Running loglikelihood requests:  11%|█         | 78/741 [01:51<15:23,  1.39s/it]Running loglikelihood requests:  11%|█         | 79/741 [01:53<15:23,  1.40s/it]Running loglikelihood requests:  11%|█         | 80/741 [01:54<15:21,  1.39s/it]Running loglikelihood requests:  11%|█         | 81/741 [01:56<15:20,  1.40s/it]Running loglikelihood requests:  11%|█         | 82/741 [01:57<15:23,  1.40s/it]Running loglikelihood requests:  11%|█         | 83/741 [01:58<15:22,  1.40s/it]Running loglikelihood requests:  11%|█▏        | 84/741 [02:00<15:19,  1.40s/it]Running loglikelihood requests:  11%|█▏        | 85/741 [02:01<15:20,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 86/741 [02:03<15:16,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 87/741 [02:04<15:15,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 88/741 [02:05<15:12,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 89/741 [02:07<15:11,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 90/741 [02:08<15:08,  1.40s/it]Running loglikelihood requests:  12%|█▏        | 91/741 [02:10<15:06,  1.39s/it]Running loglikelihood requests:  12%|█▏        | 92/741 [02:11<15:03,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 93/741 [02:12<15:00,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 94/741 [02:14<15:03,  1.40s/it]Running loglikelihood requests:  13%|█▎        | 95/741 [02:15<14:58,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 96/741 [02:17<14:55,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 97/741 [02:18<14:52,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 98/741 [02:19<14:52,  1.39s/it]Running loglikelihood requests:  13%|█▎        | 99/741 [02:21<14:47,  1.38s/it]Running loglikelihood requests:  13%|█▎        | 100/741 [02:22<14:54,  1.40s/it]Running loglikelihood requests:  14%|█▎        | 101/741 [02:24<14:46,  1.38s/it]Running loglikelihood requests:  14%|█▍        | 102/741 [02:25<14:43,  1.38s/it]Running loglikelihood requests:  14%|█▍        | 103/741 [02:26<14:38,  1.38s/it]Running loglikelihood requests:  14%|█▍        | 104/741 [02:28<14:33,  1.37s/it]Running loglikelihood requests:  14%|█▍        | 105/741 [02:29<14:29,  1.37s/it]Running loglikelihood requests:  14%|█▍        | 106/741 [02:30<14:25,  1.36s/it]Running loglikelihood requests:  14%|█▍        | 107/741 [02:32<14:23,  1.36s/it]Running loglikelihood requests:  15%|█▍        | 108/741 [02:33<14:25,  1.37s/it]Running loglikelihood requests:  15%|█▍        | 109/741 [02:34<14:26,  1.37s/it]Running loglikelihood requests:  15%|█▍        | 110/741 [02:36<14:30,  1.38s/it]Running loglikelihood requests:  15%|█▍        | 111/741 [02:37<14:28,  1.38s/it]Running loglikelihood requests:  15%|█▌        | 112/741 [02:39<14:25,  1.38s/it]Running loglikelihood requests:  15%|█▌        | 113/741 [02:40<14:23,  1.37s/it]Running loglikelihood requests:  15%|█▌        | 114/741 [02:41<14:21,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 115/741 [02:43<14:17,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 116/741 [02:44<14:15,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 117/741 [02:45<14:13,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 118/741 [02:47<14:10,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 119/741 [02:48<14:12,  1.37s/it]Running loglikelihood requests:  16%|█▌        | 120/741 [02:50<14:12,  1.37s/it]Running loglikelihood requests:  16%|█▋        | 121/741 [02:51<14:11,  1.37s/it]Running loglikelihood requests:  16%|█▋        | 122/741 [02:52<14:05,  1.37s/it]Running loglikelihood requests:  17%|█▋        | 123/741 [02:54<14:00,  1.36s/it]Running loglikelihood requests:  17%|█▋        | 124/741 [02:55<13:56,  1.36s/it]Running loglikelihood requests:  17%|█▋        | 125/741 [02:56<13:52,  1.35s/it]Running loglikelihood requests:  17%|█▋        | 126/741 [02:58<13:50,  1.35s/it]Running loglikelihood requests:  17%|█▋        | 127/741 [02:59<13:48,  1.35s/it]Running loglikelihood requests:  17%|█▋        | 128/741 [03:00<13:46,  1.35s/it]Running loglikelihood requests:  17%|█▋        | 129/741 [03:02<13:44,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 130/741 [03:03<13:43,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 131/741 [03:04<13:42,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 132/741 [03:06<13:40,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 133/741 [03:07<13:39,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 134/741 [03:08<13:37,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 135/741 [03:10<13:35,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 136/741 [03:11<13:35,  1.35s/it]Running loglikelihood requests:  18%|█▊        | 137/741 [03:12<13:35,  1.35s/it]Running loglikelihood requests:  19%|█▊        | 138/741 [03:14<13:39,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 139/741 [03:15<13:40,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 140/741 [03:17<13:36,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 141/741 [03:18<13:34,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 142/741 [03:19<13:33,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 143/741 [03:21<13:30,  1.36s/it]Running loglikelihood requests:  19%|█▉        | 144/741 [03:22<13:29,  1.36s/it]Running loglikelihood requests:  20%|█▉        | 145/741 [03:23<13:27,  1.35s/it]Running loglikelihood requests:  20%|█▉        | 146/741 [03:25<13:24,  1.35s/it]Running loglikelihood requests:  20%|█▉        | 147/741 [03:26<13:22,  1.35s/it]Running loglikelihood requests:  20%|█▉        | 148/741 [03:27<13:19,  1.35s/it]Running loglikelihood requests:  20%|██        | 149/741 [03:29<13:17,  1.35s/it]Running loglikelihood requests:  20%|██        | 150/741 [03:30<13:15,  1.35s/it]Running loglikelihood requests:  20%|██        | 151/741 [03:31<13:14,  1.35s/it]Running loglikelihood requests:  21%|██        | 152/741 [03:33<13:16,  1.35s/it]Running loglikelihood requests:  21%|██        | 153/741 [03:34<13:13,  1.35s/it]Running loglikelihood requests:  21%|██        | 154/741 [03:35<13:10,  1.35s/it]Running loglikelihood requests:  21%|██        | 155/741 [03:37<13:08,  1.35s/it]Running loglikelihood requests:  21%|██        | 156/741 [03:38<13:50,  1.42s/it]Running loglikelihood requests:  21%|██        | 157/741 [03:40<13:35,  1.40s/it]Running loglikelihood requests:  21%|██▏       | 158/741 [03:41<13:28,  1.39s/it]Running loglikelihood requests:  21%|██▏       | 159/741 [03:42<13:19,  1.37s/it]Running loglikelihood requests:  22%|██▏       | 160/741 [03:44<13:12,  1.36s/it]Running loglikelihood requests:  22%|██▏       | 161/741 [03:45<13:06,  1.36s/it]Running loglikelihood requests:  22%|██▏       | 162/741 [03:47<13:19,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 163/741 [03:48<13:11,  1.37s/it]Running loglikelihood requests:  22%|██▏       | 164/741 [03:49<13:23,  1.39s/it]Running loglikelihood requests:  22%|██▏       | 165/741 [03:51<13:13,  1.38s/it]Running loglikelihood requests:  22%|██▏       | 166/741 [03:52<13:20,  1.39s/it]Running loglikelihood requests:  23%|██▎       | 167/741 [03:53<13:10,  1.38s/it]Running loglikelihood requests:  23%|██▎       | 168/741 [03:55<13:08,  1.38s/it]Running loglikelihood requests:  23%|██▎       | 169/741 [03:56<13:04,  1.37s/it]Running loglikelihood requests:  23%|██▎       | 170/741 [03:58<13:02,  1.37s/it]Running loglikelihood requests:  23%|██▎       | 171/741 [03:59<12:58,  1.37s/it]Running loglikelihood requests:  23%|██▎       | 172/741 [04:00<12:55,  1.36s/it]Running loglikelihood requests:  23%|██▎       | 173/741 [04:02<12:58,  1.37s/it]Running loglikelihood requests:  23%|██▎       | 174/741 [04:03<12:56,  1.37s/it]Running loglikelihood requests:  24%|██▎       | 175/741 [04:04<12:52,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 176/741 [04:06<12:49,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 177/741 [04:07<12:47,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 178/741 [04:08<12:45,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 179/741 [04:10<12:43,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 180/741 [04:11<12:45,  1.36s/it]Running loglikelihood requests:  24%|██▍       | 181/741 [04:13<12:42,  1.36s/it]Running loglikelihood requests:  25%|██▍       | 182/741 [04:14<12:43,  1.37s/it]Running loglikelihood requests:  25%|██▍       | 183/741 [04:15<12:47,  1.38s/it]Running loglikelihood requests:  25%|██▍       | 184/741 [04:17<12:42,  1.37s/it]Running loglikelihood requests:  25%|██▍       | 185/741 [04:18<12:36,  1.36s/it]Running loglikelihood requests:  25%|██▌       | 186/741 [04:19<12:32,  1.36s/it]Running loglikelihood requests:  25%|██▌       | 187/741 [04:21<12:28,  1.35s/it]Running loglikelihood requests:  25%|██▌       | 188/741 [04:22<12:24,  1.35s/it]Running loglikelihood requests:  26%|██▌       | 189/741 [04:23<12:21,  1.34s/it]Running loglikelihood requests:  26%|██▌       | 190/741 [04:25<12:31,  1.36s/it]Running loglikelihood requests:  26%|██▌       | 191/741 [04:26<12:25,  1.36s/it]Running loglikelihood requests:  26%|██▌       | 192/741 [04:27<12:21,  1.35s/it]Running loglikelihood requests:  26%|██▌       | 193/741 [04:29<12:18,  1.35s/it]Running loglikelihood requests:  26%|██▌       | 194/741 [04:30<12:21,  1.36s/it]Running loglikelihood requests:  26%|██▋       | 195/741 [04:32<12:21,  1.36s/it]Running loglikelihood requests:  26%|██▋       | 196/741 [04:33<12:24,  1.37s/it]Running loglikelihood requests:  27%|██▋       | 197/741 [04:34<12:19,  1.36s/it]Running loglikelihood requests:  27%|██▋       | 198/741 [04:36<12:15,  1.35s/it]Running loglikelihood requests:  27%|██▋       | 199/741 [04:37<12:12,  1.35s/it]Running loglikelihood requests:  27%|██▋       | 200/741 [04:38<12:09,  1.35s/it]Running loglikelihood requests:  27%|██▋       | 201/741 [04:40<12:17,  1.37s/it]Running loglikelihood requests:  27%|██▋       | 202/741 [04:41<12:14,  1.36s/it]Running loglikelihood requests:  27%|██▋       | 203/741 [04:42<12:13,  1.36s/it]Running loglikelihood requests:  28%|██▊       | 204/741 [04:44<12:07,  1.36s/it]Running loglikelihood requests:  28%|██▊       | 205/741 [04:45<12:04,  1.35s/it]Running loglikelihood requests:  28%|██▊       | 206/741 [04:46<12:01,  1.35s/it]Running loglikelihood requests:  28%|██▊       | 207/741 [04:48<11:58,  1.35s/it]Running loglikelihood requests:  28%|██▊       | 208/741 [04:49<11:55,  1.34s/it]Running loglikelihood requests:  28%|██▊       | 209/741 [04:50<11:53,  1.34s/it]Running loglikelihood requests:  28%|██▊       | 210/741 [04:52<11:51,  1.34s/it]Running loglikelihood requests:  28%|██▊       | 211/741 [04:53<11:49,  1.34s/it]Running loglikelihood requests:  29%|██▊       | 212/741 [04:54<11:48,  1.34s/it]Running loglikelihood requests:  29%|██▊       | 213/741 [04:56<11:47,  1.34s/it]Running loglikelihood requests:  29%|██▉       | 214/741 [04:57<11:45,  1.34s/it]Running loglikelihood requests:  29%|██▉       | 215/741 [04:58<11:44,  1.34s/it]Running loglikelihood requests:  29%|██▉       | 216/741 [05:00<11:43,  1.34s/it]Running loglikelihood requests:  29%|██▉       | 217/741 [05:01<11:41,  1.34s/it]Running loglikelihood requests:  29%|██▉       | 218/741 [05:02<11:40,  1.34s/it]Running loglikelihood requests:  30%|██▉       | 219/741 [05:04<11:39,  1.34s/it]Running loglikelihood requests:  30%|██▉       | 220/741 [05:05<11:37,  1.34s/it]Running loglikelihood requests:  30%|██▉       | 221/741 [05:07<11:36,  1.34s/it]Running loglikelihood requests:  30%|██▉       | 222/741 [05:08<11:34,  1.34s/it]Running loglikelihood requests:  30%|███       | 223/741 [05:09<11:33,  1.34s/it]Running loglikelihood requests:  30%|███       | 224/741 [05:11<11:32,  1.34s/it]Running loglikelihood requests:  30%|███       | 225/741 [05:12<11:30,  1.34s/it]Running loglikelihood requests:  30%|███       | 226/741 [05:13<11:32,  1.35s/it]Running loglikelihood requests:  31%|███       | 227/741 [05:15<11:30,  1.34s/it]Running loglikelihood requests:  31%|███       | 228/741 [05:16<11:28,  1.34s/it]Running loglikelihood requests:  31%|███       | 229/741 [05:17<11:32,  1.35s/it]Running loglikelihood requests:  31%|███       | 230/741 [05:19<11:28,  1.35s/it]Running loglikelihood requests:  31%|███       | 231/741 [05:20<11:33,  1.36s/it]Running loglikelihood requests:  31%|███▏      | 232/741 [05:21<11:31,  1.36s/it]Running loglikelihood requests:  31%|███▏      | 233/741 [05:23<11:28,  1.36s/it]Running loglikelihood requests:  32%|███▏      | 234/741 [05:24<11:28,  1.36s/it]Running loglikelihood requests:  32%|███▏      | 235/741 [05:25<11:23,  1.35s/it]Running loglikelihood requests:  32%|███▏      | 236/741 [05:27<11:18,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 237/741 [05:28<11:15,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 238/741 [05:29<11:13,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 239/741 [05:31<11:10,  1.34s/it]Running loglikelihood requests:  32%|███▏      | 240/741 [05:32<11:08,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 241/741 [05:33<11:06,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 242/741 [05:35<11:04,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 243/741 [05:36<11:03,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 244/741 [05:37<11:02,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 245/741 [05:39<11:00,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 246/741 [05:40<10:59,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 247/741 [05:41<10:58,  1.33s/it]Running loglikelihood requests:  33%|███▎      | 248/741 [05:43<11:04,  1.35s/it]Running loglikelihood requests:  34%|███▎      | 249/741 [05:44<11:02,  1.35s/it]Running loglikelihood requests:  34%|███▎      | 250/741 [05:45<11:01,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 251/741 [05:47<11:00,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 252/741 [05:48<10:59,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 253/741 [05:50<10:57,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 254/741 [05:51<10:56,  1.35s/it]Running loglikelihood requests:  34%|███▍      | 255/741 [05:52<10:55,  1.35s/it]Running loglikelihood requests:  35%|███▍      | 256/741 [05:54<10:54,  1.35s/it]Running loglikelihood requests:  35%|███▍      | 257/741 [05:55<10:52,  1.35s/it]Running loglikelihood requests:  35%|███▍      | 258/741 [05:56<10:52,  1.35s/it]Running loglikelihood requests:  35%|███▍      | 259/741 [05:58<10:52,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 260/741 [05:59<10:49,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 261/741 [06:00<10:47,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 262/741 [06:02<10:44,  1.35s/it]Running loglikelihood requests:  35%|███▌      | 263/741 [06:03<10:42,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 264/741 [06:04<10:44,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 265/741 [06:06<10:41,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 266/741 [06:07<10:39,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 267/741 [06:08<10:37,  1.35s/it]Running loglikelihood requests:  36%|███▌      | 268/741 [06:10<10:36,  1.35s/it]Running loglikelihood requests:  36%|███▋      | 269/741 [06:11<10:34,  1.35s/it]Running loglikelihood requests:  36%|███▋      | 270/741 [06:12<10:33,  1.34s/it]Running loglikelihood requests:  37%|███▋      | 271/741 [06:14<10:31,  1.34s/it]Running loglikelihood requests:  37%|███▋      | 272/741 [06:15<10:34,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 273/741 [06:16<10:31,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 274/741 [06:18<10:28,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 275/741 [06:19<10:26,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 276/741 [06:21<10:28,  1.35s/it]Running loglikelihood requests:  37%|███▋      | 277/741 [06:22<10:25,  1.35s/it]Running loglikelihood requests:  38%|███▊      | 278/741 [06:23<10:22,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 279/741 [06:25<10:19,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 280/741 [06:26<10:17,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 281/741 [06:27<10:16,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 282/741 [06:29<10:14,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 283/741 [06:30<10:13,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 284/741 [06:31<10:12,  1.34s/it]Running loglikelihood requests:  38%|███▊      | 285/741 [06:33<10:12,  1.34s/it]Running loglikelihood requests:  39%|███▊      | 286/741 [06:34<10:13,  1.35s/it]Running loglikelihood requests:  39%|███▊      | 287/741 [06:35<10:12,  1.35s/it]Running loglikelihood requests:  39%|███▉      | 288/741 [06:37<10:09,  1.35s/it]Running loglikelihood requests:  39%|███▉      | 289/741 [06:38<10:44,  1.43s/it]Running loglikelihood requests:  39%|███▉      | 290/741 [06:40<10:32,  1.40s/it]Running loglikelihood requests:  39%|███▉      | 291/741 [06:41<10:22,  1.38s/it]Running loglikelihood requests:  39%|███▉      | 292/741 [06:42<10:16,  1.37s/it]Running loglikelihood requests:  40%|███▉      | 293/741 [06:44<10:11,  1.36s/it]Running loglikelihood requests:  40%|███▉      | 294/741 [06:45<10:05,  1.35s/it]Running loglikelihood requests:  40%|███▉      | 295/741 [06:46<10:00,  1.35s/it]Running loglikelihood requests:  40%|███▉      | 296/741 [06:48<09:58,  1.35s/it]Running loglikelihood requests:  40%|████      | 297/741 [06:49<09:56,  1.34s/it]Running loglikelihood requests:  40%|████      | 298/741 [06:50<09:53,  1.34s/it]Running loglikelihood requests:  40%|████      | 299/741 [06:52<09:51,  1.34s/it]Running loglikelihood requests:  40%|████      | 300/741 [06:53<09:49,  1.34s/it]Running loglikelihood requests:  41%|████      | 301/741 [06:54<09:48,  1.34s/it]Running loglikelihood requests:  41%|████      | 302/741 [06:56<09:46,  1.34s/it]Running loglikelihood requests:  41%|████      | 303/741 [06:57<09:45,  1.34s/it]Running loglikelihood requests:  41%|████      | 304/741 [06:58<09:43,  1.33s/it]Running loglikelihood requests:  41%|████      | 305/741 [07:00<09:43,  1.34s/it]Running loglikelihood requests:  41%|████▏     | 306/741 [07:01<09:41,  1.34s/it]Running loglikelihood requests:  41%|████▏     | 307/741 [07:02<09:38,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 308/741 [07:04<09:37,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 309/741 [07:05<09:35,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 310/741 [07:06<09:34,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 311/741 [07:08<09:32,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 312/741 [07:09<09:31,  1.33s/it]Running loglikelihood requests:  42%|████▏     | 313/741 [07:10<09:34,  1.34s/it]Running loglikelihood requests:  42%|████▏     | 314/741 [07:12<09:33,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 315/741 [07:13<09:37,  1.36s/it]Running loglikelihood requests:  43%|████▎     | 316/741 [07:14<09:32,  1.35s/it]Running loglikelihood requests:  43%|████▎     | 317/741 [07:16<09:29,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 318/741 [07:17<09:29,  1.35s/it]Running loglikelihood requests:  43%|████▎     | 319/741 [07:18<09:28,  1.35s/it]Running loglikelihood requests:  43%|████▎     | 320/741 [07:20<09:23,  1.34s/it]Running loglikelihood requests:  43%|████▎     | 321/741 [07:21<10:10,  1.45s/it]Running loglikelihood requests:  43%|████▎     | 322/741 [07:23<09:58,  1.43s/it]Running loglikelihood requests:  44%|████▎     | 323/741 [07:24<09:43,  1.40s/it]Running loglikelihood requests:  44%|████▎     | 324/741 [07:25<09:33,  1.37s/it]Running loglikelihood requests:  44%|████▍     | 325/741 [07:27<09:25,  1.36s/it]Running loglikelihood requests:  44%|████▍     | 326/741 [07:28<09:19,  1.35s/it]Running loglikelihood requests:  44%|████▍     | 327/741 [07:29<09:14,  1.34s/it]Running loglikelihood requests:  44%|████▍     | 328/741 [07:31<09:11,  1.34s/it]Running loglikelihood requests:  44%|████▍     | 329/741 [07:32<09:09,  1.33s/it]Running loglikelihood requests:  45%|████▍     | 330/741 [07:33<09:06,  1.33s/it]Running loglikelihood requests:  45%|████▍     | 331/741 [07:35<09:07,  1.34s/it]Running loglikelihood requests:  45%|████▍     | 332/741 [07:36<09:07,  1.34s/it]Running loglikelihood requests:  45%|████▍     | 333/741 [07:37<09:04,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 334/741 [07:39<09:01,  1.33s/it]Running loglikelihood requests:  45%|████▌     | 335/741 [07:40<09:02,  1.34s/it]Running loglikelihood requests:  45%|████▌     | 336/741 [07:41<09:01,  1.34s/it]Running loglikelihood requests:  45%|████▌     | 337/741 [07:43<09:01,  1.34s/it]Running loglikelihood requests:  46%|████▌     | 338/741 [07:44<08:57,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 339/741 [07:45<08:54,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 340/741 [07:47<08:52,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 341/741 [07:48<08:50,  1.33s/it]Running loglikelihood requests:  46%|████▌     | 342/741 [07:49<08:48,  1.33s/it]Running loglikelihood requests:  46%|████▋     | 343/741 [07:51<08:46,  1.32s/it]Running loglikelihood requests:  46%|████▋     | 344/741 [07:52<08:45,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 345/741 [07:53<08:43,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 346/741 [07:55<08:41,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 347/741 [07:56<08:40,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 348/741 [07:57<08:39,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 349/741 [07:59<08:38,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 350/741 [08:00<08:36,  1.32s/it]Running loglikelihood requests:  47%|████▋     | 351/741 [08:01<08:35,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 352/741 [08:03<08:35,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 353/741 [08:04<08:33,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 354/741 [08:05<08:31,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 355/741 [08:07<08:29,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 356/741 [08:08<08:28,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 357/741 [08:09<08:26,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 358/741 [08:11<08:26,  1.32s/it]Running loglikelihood requests:  48%|████▊     | 359/741 [08:12<08:24,  1.32s/it]Running loglikelihood requests:  49%|████▊     | 360/741 [08:13<08:23,  1.32s/it]Running loglikelihood requests:  49%|████▊     | 361/741 [08:15<08:21,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 362/741 [08:16<08:20,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 363/741 [08:17<08:18,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 364/741 [08:18<08:17,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 365/741 [08:20<08:15,  1.32s/it]Running loglikelihood requests:  49%|████▉     | 366/741 [08:21<08:14,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 367/741 [08:22<08:13,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 368/741 [08:24<08:13,  1.32s/it]Running loglikelihood requests:  50%|████▉     | 369/741 [08:25<08:16,  1.33s/it]Running loglikelihood requests:  50%|████▉     | 370/741 [08:26<08:15,  1.34s/it]Running loglikelihood requests:  50%|█████     | 371/741 [08:28<08:14,  1.34s/it]Running loglikelihood requests:  50%|█████     | 372/741 [08:29<08:13,  1.34s/it]Running loglikelihood requests:  50%|█████     | 373/741 [08:30<08:12,  1.34s/it]Running loglikelihood requests:  50%|█████     | 374/741 [08:32<08:11,  1.34s/it]Running loglikelihood requests:  51%|█████     | 375/741 [08:33<08:09,  1.34s/it]Running loglikelihood requests:  51%|█████     | 376/741 [08:34<08:07,  1.34s/it]Running loglikelihood requests:  51%|█████     | 377/741 [08:36<08:09,  1.34s/it]Running loglikelihood requests:  51%|█████     | 378/741 [08:37<08:11,  1.35s/it]Running loglikelihood requests:  51%|█████     | 379/741 [08:39<08:08,  1.35s/it]Running loglikelihood requests:  51%|█████▏    | 380/741 [08:40<08:05,  1.34s/it]Running loglikelihood requests:  51%|█████▏    | 381/741 [08:41<08:02,  1.34s/it]Running loglikelihood requests:  52%|█████▏    | 382/741 [08:43<08:01,  1.34s/it]Running loglikelihood requests:  52%|█████▏    | 383/741 [08:44<07:57,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 384/741 [08:45<07:53,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 385/741 [08:47<07:51,  1.32s/it]Running loglikelihood requests:  52%|█████▏    | 386/741 [08:48<07:51,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 387/741 [08:49<07:48,  1.32s/it]Running loglikelihood requests:  52%|█████▏    | 388/741 [08:50<07:47,  1.33s/it]Running loglikelihood requests:  52%|█████▏    | 389/741 [08:52<07:50,  1.34s/it]Running loglikelihood requests:  53%|█████▎    | 390/741 [08:53<07:48,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 391/741 [08:55<07:46,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 392/741 [08:56<07:42,  1.33s/it]Running loglikelihood requests:  53%|█████▎    | 393/741 [08:57<07:39,  1.32s/it]Running loglikelihood requests:  53%|█████▎    | 394/741 [08:58<07:36,  1.32s/it]Running loglikelihood requests:  53%|█████▎    | 395/741 [09:00<07:34,  1.31s/it]Running loglikelihood requests:  53%|█████▎    | 396/741 [09:01<07:33,  1.31s/it]Running loglikelihood requests:  54%|█████▎    | 397/741 [09:02<07:31,  1.31s/it]Running loglikelihood requests:  54%|█████▎    | 398/741 [09:04<07:30,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 399/741 [09:05<07:28,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 400/741 [09:06<07:27,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 401/741 [09:08<07:25,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 402/741 [09:09<07:24,  1.31s/it]Running loglikelihood requests:  54%|█████▍    | 403/741 [09:10<07:22,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 404/741 [09:12<07:21,  1.31s/it]Running loglikelihood requests:  55%|█████▍    | 405/741 [09:13<07:32,  1.35s/it]Running loglikelihood requests:  55%|█████▍    | 406/741 [09:14<07:27,  1.33s/it]Running loglikelihood requests:  55%|█████▍    | 407/741 [09:16<07:23,  1.33s/it]Running loglikelihood requests:  55%|█████▌    | 408/741 [09:17<07:20,  1.32s/it]Running loglikelihood requests:  55%|█████▌    | 409/741 [09:18<07:23,  1.34s/it]Running loglikelihood requests:  55%|█████▌    | 410/741 [09:20<07:19,  1.33s/it]Running loglikelihood requests:  55%|█████▌    | 411/741 [09:21<07:21,  1.34s/it]Running loglikelihood requests:  56%|█████▌    | 412/741 [09:22<07:20,  1.34s/it]Running loglikelihood requests:  56%|█████▌    | 413/741 [09:24<07:19,  1.34s/it]Running loglikelihood requests:  56%|█████▌    | 414/741 [09:25<07:16,  1.34s/it]Running loglikelihood requests:  56%|█████▌    | 415/741 [09:26<07:17,  1.34s/it]Running loglikelihood requests:  56%|█████▌    | 416/741 [09:28<07:44,  1.43s/it]Running loglikelihood requests:  56%|█████▋    | 417/741 [09:29<07:32,  1.40s/it]Running loglikelihood requests:  56%|█████▋    | 418/741 [09:31<07:22,  1.37s/it]Running loglikelihood requests:  57%|█████▋    | 419/741 [09:32<07:19,  1.37s/it]Running loglikelihood requests:  57%|█████▋    | 420/741 [09:33<07:13,  1.35s/it]Running loglikelihood requests:  57%|█████▋    | 421/741 [09:35<07:08,  1.34s/it]Running loglikelihood requests:  57%|█████▋    | 422/741 [09:36<07:03,  1.33s/it]Running loglikelihood requests:  57%|█████▋    | 423/741 [09:37<07:00,  1.32s/it]Running loglikelihood requests:  57%|█████▋    | 424/741 [09:38<06:58,  1.32s/it]Running loglikelihood requests:  57%|█████▋    | 425/741 [09:40<06:56,  1.32s/it]Running loglikelihood requests:  57%|█████▋    | 426/741 [09:41<06:54,  1.32s/it]Running loglikelihood requests:  58%|█████▊    | 427/741 [09:42<06:52,  1.31s/it]Running loglikelihood requests:  58%|█████▊    | 428/741 [09:44<06:50,  1.31s/it]Running loglikelihood requests:  58%|█████▊    | 429/741 [09:45<06:48,  1.31s/it]Running loglikelihood requests:  58%|█████▊    | 430/741 [09:46<06:47,  1.31s/it]Running loglikelihood requests:  58%|█████▊    | 431/741 [09:48<06:48,  1.32s/it]Running loglikelihood requests:  58%|█████▊    | 432/741 [09:49<06:48,  1.32s/it]Running loglikelihood requests:  58%|█████▊    | 433/741 [09:50<06:47,  1.32s/it]Running loglikelihood requests:  59%|█████▊    | 434/741 [09:52<06:55,  1.35s/it]Running loglikelihood requests:  59%|█████▊    | 435/741 [09:53<06:55,  1.36s/it]Running loglikelihood requests:  59%|█████▉    | 436/741 [09:54<06:51,  1.35s/it]Running loglikelihood requests:  59%|█████▉    | 437/741 [09:56<06:47,  1.34s/it]Running loglikelihood requests:  59%|█████▉    | 438/741 [09:57<06:44,  1.34s/it]Running loglikelihood requests:  59%|█████▉    | 439/741 [09:58<06:42,  1.33s/it]Running loglikelihood requests:  59%|█████▉    | 440/741 [10:00<06:39,  1.33s/it]Running loglikelihood requests:  60%|█████▉    | 441/741 [10:01<06:40,  1.33s/it]Running loglikelihood requests:  60%|█████▉    | 442/741 [10:02<06:38,  1.33s/it]Running loglikelihood requests:  60%|█████▉    | 443/741 [10:04<06:36,  1.33s/it]Running loglikelihood requests:  60%|█████▉    | 444/741 [10:05<06:33,  1.33s/it]Running loglikelihood requests:  60%|██████    | 445/741 [10:06<06:31,  1.32s/it]Running loglikelihood requests:  60%|██████    | 446/741 [10:08<06:29,  1.32s/it]Running loglikelihood requests:  60%|██████    | 447/741 [10:09<06:27,  1.32s/it]Running loglikelihood requests:  60%|██████    | 448/741 [10:10<06:26,  1.32s/it]Running loglikelihood requests:  61%|██████    | 449/741 [10:12<06:24,  1.32s/it]Running loglikelihood requests:  61%|██████    | 450/741 [10:13<06:22,  1.32s/it]Running loglikelihood requests:  61%|██████    | 451/741 [10:14<06:21,  1.31s/it]Running loglikelihood requests:  61%|██████    | 452/741 [10:16<06:19,  1.31s/it]Running loglikelihood requests:  61%|██████    | 453/741 [10:17<06:18,  1.31s/it]Running loglikelihood requests:  61%|██████▏   | 454/741 [10:18<06:17,  1.32s/it]Running loglikelihood requests:  61%|██████▏   | 455/741 [10:20<06:16,  1.32s/it]Running loglikelihood requests:  62%|██████▏   | 456/741 [10:21<06:14,  1.32s/it]Running loglikelihood requests:  62%|██████▏   | 457/741 [10:22<06:13,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 458/741 [10:23<06:11,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 459/741 [10:25<06:10,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 460/741 [10:26<06:08,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 461/741 [10:27<06:07,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 462/741 [10:29<06:05,  1.31s/it]Running loglikelihood requests:  62%|██████▏   | 463/741 [10:30<06:05,  1.32s/it]Running loglikelihood requests:  63%|██████▎   | 464/741 [10:31<06:04,  1.32s/it]Running loglikelihood requests:  63%|██████▎   | 465/741 [10:33<06:02,  1.31s/it]Running loglikelihood requests:  63%|██████▎   | 466/741 [10:34<06:00,  1.31s/it]Running loglikelihood requests:  63%|██████▎   | 467/741 [10:35<05:59,  1.31s/it]Running loglikelihood requests:  63%|██████▎   | 468/741 [10:37<05:57,  1.31s/it]Running loglikelihood requests:  63%|██████▎   | 469/741 [10:38<05:56,  1.31s/it]Running loglikelihood requests:  63%|██████▎   | 470/741 [10:39<05:55,  1.31s/it]Running loglikelihood requests:  64%|██████▎   | 471/741 [10:41<05:55,  1.32s/it]Running loglikelihood requests:  64%|██████▎   | 472/741 [10:42<05:56,  1.32s/it]Running loglikelihood requests:  64%|██████▍   | 473/741 [10:44<06:28,  1.45s/it]Running loglikelihood requests:  64%|██████▍   | 474/741 [10:45<06:31,  1.47s/it]Running loglikelihood requests:  64%|██████▍   | 475/741 [10:46<06:18,  1.42s/it]Running loglikelihood requests:  64%|██████▍   | 476/741 [10:48<06:08,  1.39s/it]Running loglikelihood requests:  64%|██████▍   | 477/741 [10:49<06:01,  1.37s/it]Running loglikelihood requests:  65%|██████▍   | 478/741 [10:50<05:56,  1.36s/it]Running loglikelihood requests:  65%|██████▍   | 479/741 [10:52<05:53,  1.35s/it]Running loglikelihood requests:  65%|██████▍   | 480/741 [10:53<05:49,  1.34s/it]Running loglikelihood requests:  65%|██████▍   | 481/741 [10:54<05:45,  1.33s/it]Running loglikelihood requests:  65%|██████▌   | 482/741 [10:56<05:43,  1.32s/it]Running loglikelihood requests:  65%|██████▌   | 483/741 [10:57<05:40,  1.32s/it]Running loglikelihood requests:  65%|██████▌   | 484/741 [10:58<05:38,  1.32s/it]Running loglikelihood requests:  65%|██████▌   | 485/741 [11:00<05:36,  1.32s/it]Running loglikelihood requests:  66%|██████▌   | 486/741 [11:01<05:35,  1.31s/it]Running loglikelihood requests:  66%|██████▌   | 487/741 [11:02<05:33,  1.31s/it]Running loglikelihood requests:  66%|██████▌   | 488/741 [11:04<05:32,  1.32s/it]Running loglikelihood requests:  66%|██████▌   | 489/741 [11:05<05:31,  1.31s/it]Running loglikelihood requests:  66%|██████▌   | 490/741 [11:06<05:29,  1.31s/it]Running loglikelihood requests:  66%|██████▋   | 491/741 [11:07<05:28,  1.31s/it]Running loglikelihood requests:  66%|██████▋   | 492/741 [11:09<05:27,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 493/741 [11:10<05:25,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 494/741 [11:11<05:24,  1.32s/it]Running loglikelihood requests:  67%|██████▋   | 495/741 [11:13<05:23,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 496/741 [11:14<05:21,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 497/741 [11:15<05:20,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 498/741 [11:17<05:19,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 499/741 [11:18<05:18,  1.31s/it]Running loglikelihood requests:  67%|██████▋   | 500/741 [11:19<05:16,  1.31s/it]Running loglikelihood requests:  68%|██████▊   | 501/741 [11:21<05:16,  1.32s/it]Running loglikelihood requests:  68%|██████▊   | 502/741 [11:22<05:15,  1.32s/it]Running loglikelihood requests:  68%|██████▊   | 503/741 [11:23<05:14,  1.32s/it]Running loglikelihood requests:  68%|██████▊   | 504/741 [11:25<05:29,  1.39s/it]Running loglikelihood requests:  68%|██████▊   | 505/741 [11:26<05:26,  1.38s/it]Running loglikelihood requests:  68%|██████▊   | 506/741 [11:28<05:19,  1.36s/it]Running loglikelihood requests:  68%|██████▊   | 507/741 [11:29<05:15,  1.35s/it]Running loglikelihood requests:  69%|██████▊   | 508/741 [11:30<05:11,  1.34s/it]Running loglikelihood requests:  69%|██████▊   | 509/741 [11:31<05:08,  1.33s/it]Running loglikelihood requests:  69%|██████▉   | 510/741 [11:33<05:05,  1.32s/it]Running loglikelihood requests:  69%|██████▉   | 511/741 [11:34<05:02,  1.32s/it]Running loglikelihood requests:  69%|██████▉   | 512/741 [11:35<05:00,  1.31s/it]Running loglikelihood requests:  69%|██████▉   | 513/741 [11:37<04:58,  1.31s/it]Running loglikelihood requests:  69%|██████▉   | 514/741 [11:38<04:59,  1.32s/it]Running loglikelihood requests:  70%|██████▉   | 515/741 [11:39<04:57,  1.31s/it]Running loglikelihood requests:  70%|██████▉   | 516/741 [11:41<04:55,  1.31s/it]Running loglikelihood requests:  70%|██████▉   | 517/741 [11:42<04:53,  1.31s/it]Running loglikelihood requests:  70%|██████▉   | 518/741 [11:43<04:53,  1.32s/it]Running loglikelihood requests:  70%|███████   | 519/741 [11:45<04:51,  1.31s/it]Running loglikelihood requests:  70%|███████   | 520/741 [11:46<04:52,  1.32s/it]Running loglikelihood requests:  70%|███████   | 521/741 [11:47<04:50,  1.32s/it]Running loglikelihood requests:  70%|███████   | 522/741 [11:49<04:49,  1.32s/it]Running loglikelihood requests:  71%|███████   | 523/741 [11:50<04:48,  1.33s/it]Running loglikelihood requests:  71%|███████   | 524/741 [11:51<04:47,  1.32s/it]Running loglikelihood requests:  71%|███████   | 525/741 [11:53<04:45,  1.32s/it]Running loglikelihood requests:  71%|███████   | 526/741 [11:54<04:43,  1.32s/it]Running loglikelihood requests:  71%|███████   | 527/741 [11:55<04:42,  1.32s/it]Running loglikelihood requests:  71%|███████▏  | 528/741 [11:56<04:41,  1.32s/it]Running loglikelihood requests:  71%|███████▏  | 529/741 [11:58<04:41,  1.33s/it]Running loglikelihood requests:  72%|███████▏  | 530/741 [11:59<04:39,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 531/741 [12:00<04:37,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 532/741 [12:02<04:35,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 533/741 [12:03<04:34,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 534/741 [12:04<04:33,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 535/741 [12:06<04:31,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 536/741 [12:07<04:30,  1.32s/it]Running loglikelihood requests:  72%|███████▏  | 537/741 [12:08<04:29,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 538/741 [12:10<04:27,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 539/741 [12:11<04:26,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 540/741 [12:12<04:26,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 541/741 [12:14<04:24,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 542/741 [12:15<04:23,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 543/741 [12:16<04:21,  1.32s/it]Running loglikelihood requests:  73%|███████▎  | 544/741 [12:18<04:19,  1.32s/it]Running loglikelihood requests:  74%|███████▎  | 545/741 [12:19<04:18,  1.32s/it]Running loglikelihood requests:  74%|███████▎  | 546/741 [12:20<04:17,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 547/741 [12:22<04:15,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 548/741 [12:23<04:15,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 549/741 [12:24<04:13,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 550/741 [12:26<04:12,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 551/741 [12:27<04:11,  1.32s/it]Running loglikelihood requests:  74%|███████▍  | 552/741 [12:28<04:09,  1.32s/it]Running loglikelihood requests:  75%|███████▍  | 553/741 [12:30<04:08,  1.32s/it]Running loglikelihood requests:  75%|███████▍  | 554/741 [12:31<04:08,  1.33s/it]Running loglikelihood requests:  75%|███████▍  | 555/741 [12:32<04:04,  1.32s/it]Running loglikelihood requests:  75%|███████▌  | 556/741 [12:33<04:02,  1.31s/it]Running loglikelihood requests:  75%|███████▌  | 557/741 [12:35<03:59,  1.30s/it]Running loglikelihood requests:  75%|███████▌  | 558/741 [12:36<03:59,  1.31s/it]Running loglikelihood requests:  75%|███████▌  | 559/741 [12:37<03:58,  1.31s/it]Running loglikelihood requests:  76%|███████▌  | 560/741 [12:39<03:56,  1.31s/it]Running loglikelihood requests:  76%|███████▌  | 561/741 [12:40<03:54,  1.30s/it]Running loglikelihood requests:  76%|███████▌  | 562/741 [12:41<03:52,  1.30s/it]Running loglikelihood requests:  76%|███████▌  | 563/741 [12:43<03:52,  1.31s/it]Running loglikelihood requests:  76%|███████▌  | 564/741 [12:44<03:51,  1.31s/it]Running loglikelihood requests:  76%|███████▌  | 565/741 [12:45<03:50,  1.31s/it]Running loglikelihood requests:  76%|███████▋  | 566/741 [12:47<03:50,  1.32s/it]Running loglikelihood requests:  77%|███████▋  | 567/741 [12:48<03:49,  1.32s/it]Running loglikelihood requests:  77%|███████▋  | 568/741 [12:49<03:49,  1.33s/it]Running loglikelihood requests:  77%|███████▋  | 569/741 [12:50<03:46,  1.31s/it]Running loglikelihood requests:  77%|███████▋  | 570/741 [12:52<03:43,  1.31s/it]Running loglikelihood requests:  77%|███████▋  | 571/741 [12:53<03:41,  1.30s/it]Running loglikelihood requests:  77%|███████▋  | 572/741 [12:54<03:39,  1.30s/it]Running loglikelihood requests:  77%|███████▋  | 573/741 [12:56<03:39,  1.30s/it]Running loglikelihood requests:  77%|███████▋  | 574/741 [12:57<03:37,  1.30s/it]Running loglikelihood requests:  78%|███████▊  | 575/741 [12:58<03:36,  1.30s/it]Running loglikelihood requests:  78%|███████▊  | 576/741 [13:00<03:34,  1.30s/it]Running loglikelihood requests:  78%|███████▊  | 577/741 [13:01<03:34,  1.31s/it]Running loglikelihood requests:  78%|███████▊  | 578/741 [13:02<03:32,  1.30s/it]Running loglikelihood requests:  78%|███████▊  | 579/741 [13:04<03:32,  1.31s/it]Running loglikelihood requests:  78%|███████▊  | 580/741 [13:05<03:30,  1.31s/it]Running loglikelihood requests:  78%|███████▊  | 581/741 [13:06<03:28,  1.30s/it]Running loglikelihood requests:  79%|███████▊  | 582/741 [13:08<03:34,  1.35s/it]Running loglikelihood requests:  79%|███████▊  | 583/741 [13:09<03:31,  1.34s/it]Running loglikelihood requests:  79%|███████▉  | 584/741 [13:10<03:28,  1.33s/it]Running loglikelihood requests:  79%|███████▉  | 585/741 [13:11<03:25,  1.32s/it]Running loglikelihood requests:  79%|███████▉  | 586/741 [13:13<03:23,  1.31s/it]Running loglikelihood requests:  79%|███████▉  | 587/741 [13:14<03:21,  1.31s/it]Running loglikelihood requests:  79%|███████▉  | 588/741 [13:15<03:19,  1.30s/it]Running loglikelihood requests:  79%|███████▉  | 589/741 [13:17<03:17,  1.30s/it]Running loglikelihood requests:  80%|███████▉  | 590/741 [13:18<03:15,  1.29s/it]Running loglikelihood requests:  80%|███████▉  | 591/741 [13:19<03:14,  1.29s/it]Running loglikelihood requests:  80%|███████▉  | 592/741 [13:21<03:12,  1.29s/it]Running loglikelihood requests:  80%|████████  | 593/741 [13:22<03:11,  1.29s/it]Running loglikelihood requests:  80%|████████  | 594/741 [13:23<03:09,  1.29s/it]Running loglikelihood requests:  80%|████████  | 595/741 [13:24<03:08,  1.29s/it]Running loglikelihood requests:  80%|████████  | 596/741 [13:26<03:07,  1.29s/it]Running loglikelihood requests:  81%|████████  | 597/741 [13:27<03:06,  1.29s/it]Running loglikelihood requests:  81%|████████  | 598/741 [13:28<03:04,  1.29s/it]Running loglikelihood requests:  81%|████████  | 599/741 [13:30<03:05,  1.30s/it]Running loglikelihood requests:  81%|████████  | 600/741 [13:31<03:03,  1.30s/it]Running loglikelihood requests:  81%|████████  | 601/741 [13:32<03:01,  1.30s/it]Running loglikelihood requests:  81%|████████  | 602/741 [13:33<02:59,  1.29s/it]Running loglikelihood requests:  81%|████████▏ | 603/741 [13:35<03:02,  1.32s/it]Running loglikelihood requests:  82%|████████▏ | 604/741 [13:36<03:00,  1.31s/it]Running loglikelihood requests:  82%|████████▏ | 605/741 [13:37<02:57,  1.31s/it]Running loglikelihood requests:  82%|████████▏ | 606/741 [13:39<02:55,  1.30s/it]Running loglikelihood requests:  82%|████████▏ | 607/741 [13:40<02:54,  1.30s/it]Running loglikelihood requests:  82%|████████▏ | 608/741 [13:41<02:52,  1.30s/it]Running loglikelihood requests:  82%|████████▏ | 609/741 [13:43<02:51,  1.30s/it]Running loglikelihood requests:  82%|████████▏ | 610/741 [13:44<03:02,  1.39s/it]Running loglikelihood requests:  82%|████████▏ | 611/741 [13:46<02:57,  1.37s/it]Running loglikelihood requests:  83%|████████▎ | 612/741 [13:47<02:54,  1.35s/it]Running loglikelihood requests:  83%|████████▎ | 613/741 [13:48<02:51,  1.34s/it]Running loglikelihood requests:  83%|████████▎ | 614/741 [13:49<02:49,  1.33s/it]Running loglikelihood requests:  83%|████████▎ | 615/741 [13:51<02:47,  1.33s/it]Running loglikelihood requests:  83%|████████▎ | 616/741 [13:52<02:45,  1.32s/it]Running loglikelihood requests:  83%|████████▎ | 617/741 [13:53<02:43,  1.32s/it]Running loglikelihood requests:  83%|████████▎ | 618/741 [13:55<02:41,  1.32s/it]Running loglikelihood requests:  84%|████████▎ | 619/741 [13:56<02:40,  1.31s/it]Running loglikelihood requests:  84%|████████▎ | 620/741 [13:57<02:38,  1.31s/it]Running loglikelihood requests:  84%|████████▍ | 621/741 [13:59<02:36,  1.31s/it]Running loglikelihood requests:  84%|████████▍ | 622/741 [14:00<02:35,  1.30s/it]Running loglikelihood requests:  84%|████████▍ | 623/741 [14:01<02:33,  1.30s/it]Running loglikelihood requests:  84%|████████▍ | 624/741 [14:03<02:32,  1.30s/it]Running loglikelihood requests:  84%|████████▍ | 625/741 [14:04<02:30,  1.30s/it]Running loglikelihood requests:  84%|████████▍ | 626/741 [14:05<02:29,  1.30s/it]Running loglikelihood requests:  85%|████████▍ | 627/741 [14:06<02:27,  1.30s/it]Running loglikelihood requests:  85%|████████▍ | 628/741 [14:08<02:26,  1.30s/it]Running loglikelihood requests:  85%|████████▍ | 629/741 [14:09<02:24,  1.29s/it]Running loglikelihood requests:  85%|████████▌ | 630/741 [14:10<02:23,  1.29s/it]Running loglikelihood requests:  85%|████████▌ | 631/741 [14:12<02:25,  1.33s/it]Running loglikelihood requests:  85%|████████▌ | 632/741 [14:13<02:23,  1.32s/it]Running loglikelihood requests:  85%|████████▌ | 633/741 [14:14<02:21,  1.31s/it]Running loglikelihood requests:  86%|████████▌ | 634/741 [14:16<02:20,  1.31s/it]Running loglikelihood requests:  86%|████████▌ | 635/741 [14:17<02:18,  1.31s/it]Running loglikelihood requests:  86%|████████▌ | 636/741 [14:18<02:17,  1.31s/it]Running loglikelihood requests:  86%|████████▌ | 637/741 [14:20<02:18,  1.33s/it]Running loglikelihood requests:  86%|████████▌ | 638/741 [14:21<02:16,  1.33s/it]Running loglikelihood requests:  86%|████████▌ | 639/741 [14:22<02:14,  1.32s/it]Running loglikelihood requests:  86%|████████▋ | 640/741 [14:24<02:12,  1.31s/it]Running loglikelihood requests:  87%|████████▋ | 641/741 [14:25<02:10,  1.30s/it]Running loglikelihood requests:  87%|████████▋ | 642/741 [14:26<02:08,  1.30s/it]Running loglikelihood requests:  87%|████████▋ | 643/741 [14:27<02:06,  1.29s/it]Running loglikelihood requests:  87%|████████▋ | 644/741 [14:29<02:05,  1.29s/it]Running loglikelihood requests:  87%|████████▋ | 645/741 [14:30<02:03,  1.29s/it]Running loglikelihood requests:  87%|████████▋ | 646/741 [14:31<02:02,  1.29s/it]Running loglikelihood requests:  87%|████████▋ | 647/741 [14:32<02:00,  1.28s/it]Running loglikelihood requests:  87%|████████▋ | 648/741 [14:34<01:59,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 649/741 [14:35<01:58,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 650/741 [14:36<01:56,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 651/741 [14:38<01:55,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 652/741 [14:39<01:54,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 653/741 [14:40<01:52,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 654/741 [14:41<01:51,  1.28s/it]Running loglikelihood requests:  88%|████████▊ | 655/741 [14:43<01:50,  1.28s/it]Running loglikelihood requests:  89%|████████▊ | 656/741 [14:44<01:48,  1.28s/it]Running loglikelihood requests:  89%|████████▊ | 657/741 [14:45<01:47,  1.29s/it]Running loglikelihood requests:  89%|████████▉ | 658/741 [14:47<01:46,  1.29s/it]Running loglikelihood requests:  89%|████████▉ | 659/741 [14:48<01:45,  1.28s/it]Running loglikelihood requests:  89%|████████▉ | 660/741 [14:49<01:43,  1.28s/it]Running loglikelihood requests:  89%|████████▉ | 661/741 [14:50<01:42,  1.28s/it]Running loglikelihood requests:  89%|████████▉ | 662/741 [14:52<01:40,  1.28s/it]Running loglikelihood requests:  89%|████████▉ | 663/741 [14:53<01:39,  1.28s/it]Running loglikelihood requests:  90%|████████▉ | 664/741 [14:54<01:39,  1.29s/it]Running loglikelihood requests:  90%|████████▉ | 665/741 [14:56<01:38,  1.30s/it]Running loglikelihood requests:  90%|████████▉ | 666/741 [14:57<01:40,  1.34s/it]Running loglikelihood requests:  90%|█████████ | 667/741 [14:58<01:38,  1.33s/it]Running loglikelihood requests:  90%|█████████ | 668/741 [15:00<01:36,  1.32s/it]Running loglikelihood requests:  90%|█████████ | 669/741 [15:01<01:34,  1.31s/it]Running loglikelihood requests:  90%|█████████ | 670/741 [15:02<01:32,  1.30s/it]Running loglikelihood requests:  91%|█████████ | 671/741 [15:03<01:30,  1.29s/it]Running loglikelihood requests:  91%|█████████ | 672/741 [15:05<01:28,  1.29s/it]Running loglikelihood requests:  91%|█████████ | 673/741 [15:06<01:27,  1.29s/it]Running loglikelihood requests:  91%|█████████ | 674/741 [15:07<01:26,  1.29s/it]Running loglikelihood requests:  91%|█████████ | 675/741 [15:09<01:24,  1.29s/it]Running loglikelihood requests:  91%|█████████ | 676/741 [15:10<01:23,  1.28s/it]Running loglikelihood requests:  91%|█████████▏| 677/741 [15:11<01:21,  1.28s/it]Running loglikelihood requests:  91%|█████████▏| 678/741 [15:12<01:20,  1.28s/it]Running loglikelihood requests:  92%|█████████▏| 679/741 [15:14<01:19,  1.28s/it]Running loglikelihood requests:  92%|█████████▏| 680/741 [15:15<01:17,  1.27s/it]Running loglikelihood requests:  92%|█████████▏| 681/741 [15:16<01:16,  1.27s/it]Running loglikelihood requests:  92%|█████████▏| 682/741 [15:18<01:15,  1.27s/it]Running loglikelihood requests:  92%|█████████▏| 683/741 [15:19<01:14,  1.29s/it]Running loglikelihood requests:  92%|█████████▏| 684/741 [15:20<01:13,  1.28s/it]Running loglikelihood requests:  92%|█████████▏| 685/741 [15:21<01:11,  1.28s/it]Running loglikelihood requests:  93%|█████████▎| 686/741 [15:23<01:10,  1.28s/it]Running loglikelihood requests:  93%|█████████▎| 687/741 [15:24<01:08,  1.27s/it]Running loglikelihood requests:  93%|█████████▎| 688/741 [15:25<01:07,  1.28s/it]Running loglikelihood requests:  93%|█████████▎| 689/741 [15:27<01:06,  1.28s/it]Running loglikelihood requests:  93%|█████████▎| 690/741 [15:28<01:05,  1.28s/it]Running loglikelihood requests:  93%|█████████▎| 691/741 [15:29<01:04,  1.29s/it]Running loglikelihood requests:  93%|█████████▎| 692/741 [15:30<01:02,  1.28s/it]Running loglikelihood requests:  94%|█████████▎| 693/741 [15:32<01:01,  1.28s/it]Running loglikelihood requests:  94%|█████████▎| 694/741 [15:33<01:00,  1.28s/it]Running loglikelihood requests:  94%|█████████▍| 695/741 [15:34<00:58,  1.27s/it]Running loglikelihood requests:  94%|█████████▍| 696/741 [15:35<00:57,  1.29s/it]Running loglikelihood requests:  94%|█████████▍| 697/741 [15:37<00:56,  1.29s/it]Running loglikelihood requests:  94%|█████████▍| 698/741 [15:38<00:55,  1.29s/it]Running loglikelihood requests:  94%|█████████▍| 699/741 [15:39<00:53,  1.28s/it]Running loglikelihood requests:  94%|█████████▍| 700/741 [15:41<00:53,  1.30s/it]Running loglikelihood requests:  95%|█████████▍| 701/741 [15:42<00:53,  1.34s/it]Running loglikelihood requests:  95%|█████████▍| 702/741 [15:43<00:51,  1.33s/it]Running loglikelihood requests:  95%|█████████▍| 703/741 [15:45<00:50,  1.32s/it]Running loglikelihood requests:  95%|█████████▌| 704/741 [15:46<00:48,  1.31s/it]Running loglikelihood requests:  95%|█████████▌| 705/741 [15:47<00:47,  1.32s/it]Running loglikelihood requests:  95%|█████████▌| 706/741 [15:49<00:46,  1.32s/it]Running loglikelihood requests:  95%|█████████▌| 707/741 [15:50<00:44,  1.31s/it]Running loglikelihood requests:  96%|█████████▌| 708/741 [15:51<00:43,  1.31s/it]Running loglikelihood requests:  96%|█████████▌| 709/741 [15:53<00:41,  1.30s/it]Running loglikelihood requests:  96%|█████████▌| 710/741 [15:54<00:40,  1.31s/it]Running loglikelihood requests:  96%|█████████▌| 711/741 [15:55<00:38,  1.29s/it]Running loglikelihood requests:  96%|█████████▌| 712/741 [15:56<00:37,  1.28s/it]Running loglikelihood requests:  96%|█████████▌| 713/741 [15:58<00:35,  1.27s/it]Running loglikelihood requests:  96%|█████████▋| 714/741 [15:59<00:34,  1.27s/it]Running loglikelihood requests:  96%|█████████▋| 715/741 [16:00<00:33,  1.27s/it]Running loglikelihood requests:  97%|█████████▋| 716/741 [16:01<00:31,  1.27s/it]Running loglikelihood requests:  97%|█████████▋| 717/741 [16:03<00:30,  1.26s/it]Running loglikelihood requests:  97%|█████████▋| 718/741 [16:04<00:29,  1.26s/it]Running loglikelihood requests:  97%|█████████▋| 719/741 [16:05<00:27,  1.26s/it]Running loglikelihood requests:  97%|█████████▋| 720/741 [16:06<00:26,  1.26s/it]Running loglikelihood requests:  97%|█████████▋| 721/741 [16:08<00:25,  1.26s/it]Running loglikelihood requests:  97%|█████████▋| 722/741 [16:09<00:23,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 723/741 [16:10<00:22,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 724/741 [16:11<00:21,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 725/741 [16:13<00:20,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 726/741 [16:14<00:18,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 727/741 [16:15<00:17,  1.26s/it]Running loglikelihood requests:  98%|█████████▊| 728/741 [16:16<00:16,  1.25s/it]Running loglikelihood requests:  98%|█████████▊| 729/741 [16:18<00:15,  1.25s/it]Running loglikelihood requests:  99%|█████████▊| 730/741 [16:19<00:13,  1.26s/it]Running loglikelihood requests:  99%|█████████▊| 731/741 [16:20<00:12,  1.26s/it]Running loglikelihood requests:  99%|█████████▉| 732/741 [16:22<00:11,  1.25s/it]Running loglikelihood requests:  99%|█████████▉| 733/741 [16:23<00:10,  1.25s/it]Running loglikelihood requests:  99%|█████████▉| 734/741 [16:24<00:08,  1.25s/it]Running loglikelihood requests:  99%|█████████▉| 735/741 [16:25<00:07,  1.25s/it]Running loglikelihood requests:  99%|█████████▉| 736/741 [16:26<00:06,  1.25s/it]Running loglikelihood requests:  99%|█████████▉| 737/741 [16:28<00:04,  1.25s/it]Running loglikelihood requests: 100%|█████████▉| 738/741 [16:29<00:03,  1.25s/it]Running loglikelihood requests: 100%|█████████▉| 739/741 [16:30<00:02,  1.25s/it]Running loglikelihood requests: 100%|█████████▉| 740/741 [16:31<00:01,  1.25s/it]Running loglikelihood requests: 100%|██████████| 741/741 [16:33<00:00,  1.25s/it]Running loglikelihood requests: 100%|██████████| 741/741 [16:33<00:00,  1.34s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:4'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:4'}
full model:
{'truthfulqa_mc2': {'alias': 'truthfulqa_mc2', 'acc,none': np.float64(0.35072717781225216), 'acc_stderr,none': 0.03908337537958344}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9974333709910631
0.9839493373638512
0.9597548008928544
0.946156937857738
0.9578725356443297
0.9860276925684309
0.9851700783389155
0.9785443538007016
0.9840609592351508
0.9866747084272959
0.993847005700813
0.9821256043437374
0.9785597638337488
0.9913560881472286
0.9857807865468037
0.9768835593867952
0.9712970825073506
0.9739507797127384
0.9812604243865042
0.9863435152335076
0.9906203910133119
0.9914566385573707
0.9976075903157836
0.9906762413225836
0.9818609340094854
Total groups 74 exceeded the threshold, stopping comparison.
The group tensor is
[3, 2, 7, 4, 5, 0, 6, 1]
tensor([3, 2, 7, 4, 5, 0, 6, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 7, 3, 6, 1, 5, 0]
tensor([4, 2, 7, 3, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 7, 3, 6, 1, 5, 0]
tensor([4, 2, 7, 3, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 7, 3, 6, 1, 5, 0]
tensor([4, 2, 7, 3, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 7, 3, 6, 1, 5, 0]
tensor([4, 2, 7, 3, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 2, 7, 3, 6, 1, 5, 0]
tensor([4, 2, 7, 3, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 4
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 6 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 5 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.0718 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 4 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

110
cuda:4
anli_r2
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:55<00:55, 55.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 33.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:13<00:00, 36.77s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/anli/anli.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/anli HTTP/1.1" 307 62
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/facebook/anli HTTP/1.1" 200 1535
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/facebook/anli/resolve/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 307 114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/facebook/anli/paths-info/8e4813d81f46d313dac7892e1c28076917cfcdf9 HTTP/1.1" 200 241
DEBUG:filelock:Attempting to acquire lock 140353595287472 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140353595287472 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353595287472 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Lock 140353595287472 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_anli_plain_text_0.0.0_8e4813d81f46d313dac7892e1c28076917cfcdf9.lock
DEBUG:filelock:Attempting to acquire lock 140355691707952 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140355691707952 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9/dataset_info.json
DEBUG:filelock:Attempting to release lock 140355691707952 on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:filelock:Lock 140355691707952 released on /public/home/zouyifei001/.cache/huggingface/datasets/anli/plain_text/0.0.0/8e4813d81f46d313dac7892e1c28076917cfcdf9_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of anli_r2 from None to 0
INFO:lm_eval.api.task:Building contexts for anli_r2 on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2590.37it/s]
DEBUG:lm_eval.evaluator:Task: anli_r2; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<08:51,  1.78s/it]Running loglikelihood requests:   1%|          | 2/300 [00:02<06:57,  1.40s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:04<04:17,  1.15it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:05<04:37,  1.06it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:06<03:40,  1.33it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:07<04:03,  1.20it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:08<03:25,  1.41it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:09<03:48,  1.27it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:10<03:16,  1.46it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:11<03:38,  1.31it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:12<03:09,  1.50it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:13<03:31,  1.34it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:14<03:49,  1.23it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:15<03:14,  1.44it/s]Running loglikelihood requests:   7%|▋         | 22/300 [00:16<02:54,  1.59it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:17<03:20,  1.38it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:18<02:57,  1.55it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:19<03:18,  1.38it/s]Running loglikelihood requests:   9%|▉         | 27/300 [00:20<03:35,  1.26it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:21<03:49,  1.18it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:22<03:10,  1.42it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:23<03:28,  1.29it/s]Running loglikelihood requests:  11%|█         | 33/300 [00:24<02:58,  1.49it/s]Running loglikelihood requests:  12%|█▏        | 35/300 [00:25<02:41,  1.64it/s]Running loglikelihood requests:  12%|█▏        | 37/300 [00:26<02:30,  1.74it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:27<02:51,  1.52it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:28<02:35,  1.67it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:29<02:56,  1.47it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:30<02:36,  1.64it/s]Running loglikelihood requests:  15%|█▍        | 44/300 [00:31<02:58,  1.44it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:32<03:13,  1.32it/s]Running loglikelihood requests:  15%|█▌        | 46/300 [00:33<03:25,  1.23it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:34<02:50,  1.48it/s]Running loglikelihood requests:  16%|█▋        | 49/300 [00:35<03:06,  1.34it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:36<03:19,  1.25it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:37<02:45,  1.50it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:38<03:01,  1.36it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:39<02:35,  1.57it/s]Running loglikelihood requests:  19%|█▊        | 56/300 [00:40<02:53,  1.40it/s]Running loglikelihood requests:  19%|█▉        | 58/300 [00:41<02:30,  1.60it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:42<02:47,  1.43it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:43<02:26,  1.63it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:44<02:43,  1.45it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:45<02:23,  1.64it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:46<02:11,  1.78it/s]Running loglikelihood requests:  23%|██▎       | 68/300 [00:47<02:03,  1.87it/s]Running loglikelihood requests:  23%|██▎       | 70/300 [00:48<01:59,  1.93it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:49<02:17,  1.67it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:50<02:34,  1.48it/s]Running loglikelihood requests:  25%|██▍       | 74/300 [00:51<02:15,  1.66it/s]Running loglikelihood requests:  25%|██▌       | 76/300 [00:52<02:04,  1.80it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:53<02:20,  1.58it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:53<02:06,  1.75it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:54<02:22,  1.55it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:55<02:36,  1.40it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:56<02:13,  1.63it/s]Running loglikelihood requests:  28%|██▊       | 84/300 [00:57<02:27,  1.46it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:58<02:08,  1.67it/s]Running loglikelihood requests:  29%|██▉       | 87/300 [00:59<02:22,  1.49it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [01:00<02:34,  1.37it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [01:01<02:44,  1.28it/s]Running loglikelihood requests:  30%|███       | 91/300 [01:02<02:15,  1.55it/s]Running loglikelihood requests:  31%|███       | 92/300 [01:03<02:27,  1.41it/s]Running loglikelihood requests:  31%|███▏      | 94/300 [01:04<02:06,  1.63it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [01:05<02:19,  1.47it/s]Running loglikelihood requests:  32%|███▏      | 97/300 [01:06<02:00,  1.68it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [01:06<01:49,  1.83it/s]Running loglikelihood requests:  33%|███▎      | 100/300 [01:07<02:04,  1.61it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [01:08<02:17,  1.45it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [01:09<01:58,  1.67it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [01:10<01:47,  1.81it/s]Running loglikelihood requests:  35%|███▌      | 106/300 [01:11<02:01,  1.60it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [01:12<01:48,  1.77it/s]Running loglikelihood requests:  37%|███▋      | 110/300 [01:13<01:40,  1.89it/s]Running loglikelihood requests:  37%|███▋      | 112/300 [01:14<01:35,  1.97it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [01:15<01:49,  1.71it/s]Running loglikelihood requests:  38%|███▊      | 114/300 [01:16<02:02,  1.52it/s]Running loglikelihood requests:  39%|███▊      | 116/300 [01:17<01:46,  1.72it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [01:17<01:59,  1.53it/s]Running loglikelihood requests:  39%|███▉      | 118/300 [01:18<02:09,  1.40it/s]Running loglikelihood requests:  40%|████      | 120/300 [01:19<01:50,  1.64it/s]Running loglikelihood requests:  40%|████      | 121/300 [01:20<02:01,  1.47it/s]Running loglikelihood requests:  41%|████      | 123/300 [01:21<01:44,  1.69it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [01:22<01:35,  1.84it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [01:23<01:47,  1.62it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:24<01:58,  1.46it/s]Running loglikelihood requests:  43%|████▎     | 128/300 [01:25<02:06,  1.36it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:26<02:13,  1.28it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:27<01:48,  1.56it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:27<01:35,  1.76it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:28<01:27,  1.90it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:29<01:21,  1.99it/s]Running loglikelihood requests:  46%|████▋     | 139/300 [01:30<01:23,  1.92it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:31<01:34,  1.69it/s]Running loglikelihood requests:  47%|████▋     | 141/300 [01:32<01:44,  1.52it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:33<01:31,  1.72it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:34<01:25,  1.81it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:35<01:36,  1.60it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:36<01:45,  1.45it/s]Running loglikelihood requests:  50%|████▉     | 149/300 [01:37<01:29,  1.68it/s]Running loglikelihood requests:  50%|█████     | 151/300 [01:38<01:20,  1.84it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:39<01:30,  1.63it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:40<01:21,  1.78it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:40<01:31,  1.59it/s]Running loglikelihood requests:  52%|█████▏    | 156/300 [01:41<01:39,  1.45it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:42<01:46,  1.35it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:43<01:27,  1.61it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:44<01:17,  1.80it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:45<01:29,  1.54it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:46<01:20,  1.70it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:47<01:27,  1.54it/s]Running loglikelihood requests:  55%|█████▌    | 166/300 [01:48<01:34,  1.42it/s]Running loglikelihood requests:  56%|█████▌    | 168/300 [01:49<01:19,  1.67it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:50<01:26,  1.51it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:50<01:14,  1.74it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:51<01:06,  1.90it/s]Running loglikelihood requests:  58%|█████▊    | 174/300 [01:52<01:15,  1.67it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:53<01:22,  1.52it/s]Running loglikelihood requests:  59%|█████▊    | 176/300 [01:54<01:28,  1.41it/s]Running loglikelihood requests:  59%|█████▉    | 178/300 [01:55<01:13,  1.67it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:56<01:04,  1.85it/s]Running loglikelihood requests:  61%|██████    | 182/300 [01:57<00:59,  1.98it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:57<01:07,  1.74it/s]Running loglikelihood requests:  61%|██████▏   | 184/300 [01:58<01:14,  1.56it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:59<01:04,  1.77it/s]Running loglikelihood requests:  62%|██████▏   | 187/300 [02:00<01:11,  1.58it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [02:01<01:16,  1.46it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [02:02<01:04,  1.71it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [02:03<00:57,  1.89it/s]Running loglikelihood requests:  64%|██████▍   | 193/300 [02:03<01:04,  1.67it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [02:04<00:56,  1.86it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [02:05<01:03,  1.63it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [02:06<00:55,  1.83it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [02:07<00:52,  1.91it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [02:08<00:58,  1.69it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [02:09<00:51,  1.87it/s]Running loglikelihood requests:  68%|██████▊   | 204/300 [02:10<00:57,  1.66it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [02:11<01:02,  1.51it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [02:11<01:06,  1.41it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [02:12<00:54,  1.68it/s]Running loglikelihood requests:  70%|██████▉   | 209/300 [02:13<00:59,  1.53it/s]Running loglikelihood requests:  70%|███████   | 210/300 [02:14<01:03,  1.42it/s]Running loglikelihood requests:  71%|███████   | 212/300 [02:15<00:52,  1.69it/s]Running loglikelihood requests:  71%|███████   | 213/300 [02:16<00:56,  1.53it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [02:17<00:47,  1.77it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [02:17<00:42,  1.94it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [02:18<00:39,  2.06it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [02:19<00:36,  2.14it/s]Running loglikelihood requests:  74%|███████▍  | 223/300 [02:20<00:34,  2.21it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [02:21<00:40,  1.88it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [02:22<00:44,  1.67it/s]Running loglikelihood requests:  75%|███████▌  | 226/300 [02:23<00:48,  1.52it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [02:23<00:51,  1.41it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [02:24<00:53,  1.34it/s]Running loglikelihood requests:  77%|███████▋  | 230/300 [02:25<00:42,  1.64it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [02:26<00:36,  1.86it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [02:27<00:40,  1.66it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [02:28<00:34,  1.87it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [02:28<00:31,  2.02it/s]Running loglikelihood requests:  80%|███████▉  | 239/300 [02:29<00:28,  2.12it/s]Running loglikelihood requests:  80%|████████  | 240/300 [02:30<00:32,  1.84it/s]Running loglikelihood requests:  80%|████████  | 241/300 [02:31<00:35,  1.65it/s]Running loglikelihood requests:  81%|████████  | 242/300 [02:32<00:38,  1.51it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [02:33<00:31,  1.77it/s]Running loglikelihood requests:  82%|████████▏ | 245/300 [02:34<00:34,  1.60it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [02:34<00:36,  1.48it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [02:35<00:29,  1.75it/s]Running loglikelihood requests:  83%|████████▎ | 249/300 [02:36<00:32,  1.57it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [02:37<00:34,  1.46it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [02:38<00:27,  1.74it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [02:39<00:23,  1.93it/s]Running loglikelihood requests:  85%|████████▌ | 255/300 [02:39<00:26,  1.71it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [02:40<00:22,  1.91it/s]Running loglikelihood requests:  86%|████████▋ | 259/300 [02:41<00:19,  2.06it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [02:42<00:18,  2.16it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [02:43<00:16,  2.23it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [02:44<00:15,  2.27it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [02:44<00:17,  1.93it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [02:45<00:15,  2.07it/s]Running loglikelihood requests:  90%|████████▉ | 269/300 [02:46<00:17,  1.82it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [02:47<00:18,  1.64it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [02:48<00:14,  1.88it/s]Running loglikelihood requests:  91%|█████████ | 273/300 [02:49<00:16,  1.68it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [02:49<00:13,  1.90it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [02:50<00:11,  2.07it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [02:51<00:12,  1.83it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [02:52<00:12,  1.66it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [02:53<00:09,  1.91it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [02:53<00:08,  2.10it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [02:54<00:08,  1.85it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [02:55<00:06,  2.06it/s]Running loglikelihood requests:  96%|█████████▌| 287/300 [02:56<00:07,  1.84it/s]Running loglikelihood requests:  96%|█████████▋| 289/300 [02:57<00:05,  2.06it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [02:57<00:05,  1.83it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [02:58<00:03,  2.09it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [02:59<00:03,  1.88it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:59<00:03,  1.73it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [03:00<00:01,  2.03it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [03:01<00:00,  2.25it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [03:02<00:00,  2.01it/s]Running loglikelihood requests: 100%|██████████| 300/300 [03:02<00:00,  1.65it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:5'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:5'}
full model:
{'anli_r2': {'alias': 'anli_r2', 'acc,none': 0.37, 'acc_stderr,none': 0.048523658709390974}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9244540984883116
0.6900634246033951
0.6134543380435296
0.8689565152016014
0.5290243051877711
0.7748268733440488
0.7132980094248668
0.845368865582677
0.7053618777073042
0.6889888656720503
0.9230723594921337
0.4684089585032466
0.5839945995145656
0.7845879028041718
0.9669809976680984
0.8909865725318488
0.8707549857768956
0.8761905659343966
0.9352559118245083
0.8979872032046015
0.47865782275043
0.7992206780601334
0.7024602165948844
0.7606289964270208
0.7242167732145116
0.8657453170519599
0.4497158131255318
0.8558369825493786
0.7206718639663227
0.9244540984883116
0.6900634246033951
0.6134543380435296
0.8689565152016014
0.5290243051877711
0.7748268733440488
0.7132980094248668
0.845368865582677
0.7053618777073042
0.6889888656720503
0.9230723594921337
0.4684089585032466
0.5839945995145656
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[5, 3, 6, 0, 7, 2, 4, 1]
tensor([5, 3, 6, 0, 7, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 4, 5, 2, 7, 1, 3, 0]
tensor([6, 4, 5, 2, 7, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[4, 3, 5, 1, 7, 0, 6, 2]
tensor([4, 3, 5, 1, 7, 0, 6, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 6, 0, 7, 2, 4, 1]
tensor([5, 3, 6, 0, 7, 2, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[0, 3, 5, 2, 1, 0, 4, 1]
tensor([0, 3, 5, 2, 1, 0, 4, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[4, 1, 0, 2, 1, 0, 5, 3]
tensor([4, 1, 0, 2, 1, 0, 5, 3], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[5, 1, 0, 0, 1, 3, 4, 2]
tensor([5, 1, 0, 0, 1, 3, 4, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([4])
tensor(4)
done!
Normal merging for layer 2
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 3 to 6
done!
Normal merging for layer 7
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Normal merging for layer 8
tensor([0, 5])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Normal merging for layer 9
tensor([2, 5])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([3])
tensor(3)
tensor([7])
tensor(7)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Normal merging for layer 10
tensor([2, 3])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 11 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 4 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.2608 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 3 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

13
cuda:5
mnli
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.99s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but aggregation is not. using default aggregation=mean
WARNING:lm_eval.api.task:[Task: mnli] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/glue/glue.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/glue HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/nyu-mll/glue HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 233
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/nyu-mll/glue/resolve/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/nyu-mll/glue/paths-info/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c HTTP/1.1" 200 236
DEBUG:filelock:Attempting to acquire lock 140375974658560 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375974658560 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375974658560 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Lock 140375974658560 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_glue_mnli_0.0.0_bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c.lock
DEBUG:filelock:Attempting to acquire lock 140374906208384 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140374906208384 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c/dataset_info.json
DEBUG:filelock:Attempting to release lock 140374906208384 on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:filelock:Lock 140374906208384 released on /public/home/zouyifei001/.cache/huggingface/datasets/glue/mnli/0.0.0/bcdcba79d07bc864c1c254ccfcedcce55bcc9a8c_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of mnli from None to 0
INFO:lm_eval.api.task:Building contexts for mnli on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 129174.75it/s]
DEBUG:lm_eval.evaluator:Task: mnli; number of requests on this rank: 300
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/300 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/300 [00:01<08:53,  1.78s/it]Running loglikelihood requests:   1%|          | 2/300 [00:03<07:16,  1.47s/it]Running loglikelihood requests:   1%|▏         | 4/300 [00:03<04:08,  1.19it/s]Running loglikelihood requests:   2%|▏         | 5/300 [00:04<04:16,  1.15it/s]Running loglikelihood requests:   2%|▏         | 7/300 [00:05<03:14,  1.50it/s]Running loglikelihood requests:   3%|▎         | 8/300 [00:06<03:28,  1.40it/s]Running loglikelihood requests:   3%|▎         | 10/300 [00:07<02:49,  1.71it/s]Running loglikelihood requests:   4%|▎         | 11/300 [00:08<03:03,  1.57it/s]Running loglikelihood requests:   4%|▍         | 13/300 [00:09<02:34,  1.86it/s]Running loglikelihood requests:   5%|▍         | 14/300 [00:09<02:49,  1.69it/s]Running loglikelihood requests:   5%|▌         | 16/300 [00:10<02:23,  1.98it/s]Running loglikelihood requests:   6%|▌         | 17/300 [00:11<02:37,  1.80it/s]Running loglikelihood requests:   6%|▌         | 18/300 [00:12<02:48,  1.67it/s]Running loglikelihood requests:   7%|▋         | 20/300 [00:12<02:20,  1.99it/s]Running loglikelihood requests:   7%|▋         | 21/300 [00:13<02:34,  1.81it/s]Running loglikelihood requests:   8%|▊         | 23/300 [00:14<02:12,  2.08it/s]Running loglikelihood requests:   8%|▊         | 25/300 [00:14<01:59,  2.29it/s]Running loglikelihood requests:   9%|▊         | 26/300 [00:15<02:14,  2.03it/s]Running loglikelihood requests:   9%|▉         | 28/300 [00:16<02:00,  2.26it/s]Running loglikelihood requests:  10%|▉         | 29/300 [00:17<02:14,  2.01it/s]Running loglikelihood requests:  10%|█         | 30/300 [00:17<02:27,  1.83it/s]Running loglikelihood requests:  10%|█         | 31/300 [00:18<02:37,  1.71it/s]Running loglikelihood requests:  11%|█         | 32/300 [00:19<02:45,  1.62it/s]Running loglikelihood requests:  11%|█▏        | 34/300 [00:19<02:14,  1.98it/s]Running loglikelihood requests:  12%|█▏        | 36/300 [00:20<01:57,  2.24it/s]Running loglikelihood requests:  13%|█▎        | 38/300 [00:21<01:48,  2.42it/s]Running loglikelihood requests:  13%|█▎        | 40/300 [00:21<01:41,  2.56it/s]Running loglikelihood requests:  14%|█▎        | 41/300 [00:22<01:55,  2.24it/s]Running loglikelihood requests:  14%|█▍        | 42/300 [00:23<02:08,  2.01it/s]Running loglikelihood requests:  14%|█▍        | 43/300 [00:24<02:19,  1.85it/s]Running loglikelihood requests:  15%|█▌        | 45/300 [00:24<01:57,  2.17it/s]Running loglikelihood requests:  16%|█▌        | 47/300 [00:25<01:45,  2.40it/s]Running loglikelihood requests:  16%|█▌        | 48/300 [00:26<01:58,  2.12it/s]Running loglikelihood requests:  17%|█▋        | 50/300 [00:26<01:45,  2.36it/s]Running loglikelihood requests:  17%|█▋        | 52/300 [00:27<01:37,  2.54it/s]Running loglikelihood requests:  18%|█▊        | 53/300 [00:28<01:50,  2.23it/s]Running loglikelihood requests:  18%|█▊        | 54/300 [00:28<02:02,  2.01it/s]Running loglikelihood requests:  18%|█▊        | 55/300 [00:29<02:11,  1.86it/s]Running loglikelihood requests:  19%|█▉        | 57/300 [00:30<01:50,  2.20it/s]Running loglikelihood requests:  20%|█▉        | 59/300 [00:30<01:38,  2.45it/s]Running loglikelihood requests:  20%|██        | 61/300 [00:31<01:32,  2.58it/s]Running loglikelihood requests:  21%|██        | 62/300 [00:32<01:45,  2.25it/s]Running loglikelihood requests:  21%|██▏       | 64/300 [00:32<01:36,  2.46it/s]Running loglikelihood requests:  22%|██▏       | 65/300 [00:33<01:48,  2.17it/s]Running loglikelihood requests:  22%|██▏       | 66/300 [00:34<02:00,  1.95it/s]Running loglikelihood requests:  22%|██▏       | 67/300 [00:34<02:08,  1.82it/s]Running loglikelihood requests:  23%|██▎       | 69/300 [00:35<01:46,  2.18it/s]Running loglikelihood requests:  24%|██▎       | 71/300 [00:36<01:34,  2.43it/s]Running loglikelihood requests:  24%|██▍       | 72/300 [00:36<01:47,  2.12it/s]Running loglikelihood requests:  24%|██▍       | 73/300 [00:37<01:56,  1.94it/s]Running loglikelihood requests:  25%|██▌       | 75/300 [00:38<01:39,  2.27it/s]Running loglikelihood requests:  26%|██▌       | 77/300 [00:38<01:29,  2.50it/s]Running loglikelihood requests:  26%|██▋       | 79/300 [00:39<01:22,  2.67it/s]Running loglikelihood requests:  27%|██▋       | 80/300 [00:40<01:34,  2.34it/s]Running loglikelihood requests:  27%|██▋       | 81/300 [00:40<01:44,  2.10it/s]Running loglikelihood requests:  27%|██▋       | 82/300 [00:41<01:52,  1.93it/s]Running loglikelihood requests:  28%|██▊       | 83/300 [00:42<01:59,  1.82it/s]Running loglikelihood requests:  28%|██▊       | 85/300 [00:42<01:37,  2.20it/s]Running loglikelihood requests:  29%|██▊       | 86/300 [00:43<01:46,  2.01it/s]Running loglikelihood requests:  29%|██▉       | 88/300 [00:43<01:30,  2.33it/s]Running loglikelihood requests:  30%|██▉       | 89/300 [00:44<01:40,  2.10it/s]Running loglikelihood requests:  30%|███       | 91/300 [00:45<01:27,  2.39it/s]Running loglikelihood requests:  31%|███       | 93/300 [00:45<01:19,  2.61it/s]Running loglikelihood requests:  32%|███▏      | 95/300 [00:46<01:14,  2.75it/s]Running loglikelihood requests:  32%|███▏      | 96/300 [00:47<01:25,  2.40it/s]Running loglikelihood requests:  33%|███▎      | 98/300 [00:47<01:17,  2.62it/s]Running loglikelihood requests:  33%|███▎      | 99/300 [00:48<01:27,  2.31it/s]Running loglikelihood requests:  34%|███▎      | 101/300 [00:49<01:17,  2.56it/s]Running loglikelihood requests:  34%|███▍      | 102/300 [00:49<01:27,  2.26it/s]Running loglikelihood requests:  34%|███▍      | 103/300 [00:50<01:35,  2.06it/s]Running loglikelihood requests:  35%|███▍      | 104/300 [00:51<01:42,  1.92it/s]Running loglikelihood requests:  35%|███▌      | 105/300 [00:51<01:47,  1.82it/s]Running loglikelihood requests:  36%|███▌      | 107/300 [00:52<01:26,  2.22it/s]Running loglikelihood requests:  36%|███▌      | 108/300 [00:52<01:34,  2.03it/s]Running loglikelihood requests:  36%|███▋      | 109/300 [00:53<01:40,  1.90it/s]Running loglikelihood requests:  37%|███▋      | 111/300 [00:54<01:22,  2.28it/s]Running loglikelihood requests:  38%|███▊      | 113/300 [00:54<01:13,  2.54it/s]Running loglikelihood requests:  38%|███▊      | 115/300 [00:55<01:07,  2.74it/s]Running loglikelihood requests:  39%|███▉      | 117/300 [00:56<01:03,  2.87it/s]Running loglikelihood requests:  40%|███▉      | 119/300 [00:56<01:00,  2.97it/s]Running loglikelihood requests:  40%|████      | 121/300 [00:57<00:58,  3.03it/s]Running loglikelihood requests:  41%|████      | 122/300 [00:57<01:08,  2.61it/s]Running loglikelihood requests:  41%|████▏     | 124/300 [00:58<01:02,  2.80it/s]Running loglikelihood requests:  42%|████▏     | 125/300 [00:59<01:11,  2.45it/s]Running loglikelihood requests:  42%|████▏     | 126/300 [00:59<01:19,  2.20it/s]Running loglikelihood requests:  42%|████▏     | 127/300 [01:00<01:25,  2.03it/s]Running loglikelihood requests:  43%|████▎     | 129/300 [01:01<01:11,  2.40it/s]Running loglikelihood requests:  44%|████▎     | 131/300 [01:01<01:03,  2.66it/s]Running loglikelihood requests:  44%|████▍     | 133/300 [01:02<00:58,  2.86it/s]Running loglikelihood requests:  45%|████▍     | 134/300 [01:02<01:06,  2.51it/s]Running loglikelihood requests:  45%|████▌     | 135/300 [01:03<01:12,  2.27it/s]Running loglikelihood requests:  45%|████▌     | 136/300 [01:04<01:18,  2.09it/s]Running loglikelihood requests:  46%|████▌     | 137/300 [01:04<01:22,  1.97it/s]Running loglikelihood requests:  46%|████▌     | 138/300 [01:05<01:25,  1.88it/s]Running loglikelihood requests:  47%|████▋     | 140/300 [01:05<01:08,  2.33it/s]Running loglikelihood requests:  47%|████▋     | 142/300 [01:06<00:59,  2.64it/s]Running loglikelihood requests:  48%|████▊     | 143/300 [01:06<01:06,  2.36it/s]Running loglikelihood requests:  48%|████▊     | 145/300 [01:07<00:58,  2.67it/s]Running loglikelihood requests:  49%|████▊     | 146/300 [01:08<01:04,  2.38it/s]Running loglikelihood requests:  49%|████▉     | 147/300 [01:08<01:10,  2.17it/s]Running loglikelihood requests:  49%|████▉     | 148/300 [01:09<01:14,  2.03it/s]Running loglikelihood requests:  50%|█████     | 150/300 [01:09<01:01,  2.44it/s]Running loglikelihood requests:  51%|█████     | 152/300 [01:10<00:54,  2.72it/s]Running loglikelihood requests:  51%|█████▏    | 154/300 [01:11<00:49,  2.93it/s]Running loglikelihood requests:  52%|█████▏    | 155/300 [01:11<00:56,  2.56it/s]Running loglikelihood requests:  52%|█████▏    | 157/300 [01:12<00:50,  2.81it/s]Running loglikelihood requests:  53%|█████▎    | 159/300 [01:12<00:47,  2.99it/s]Running loglikelihood requests:  54%|█████▎    | 161/300 [01:13<00:44,  3.12it/s]Running loglikelihood requests:  54%|█████▍    | 162/300 [01:14<00:51,  2.70it/s]Running loglikelihood requests:  55%|█████▍    | 164/300 [01:14<00:46,  2.92it/s]Running loglikelihood requests:  55%|█████▌    | 165/300 [01:15<00:52,  2.57it/s]Running loglikelihood requests:  56%|█████▌    | 167/300 [01:15<00:46,  2.84it/s]Running loglikelihood requests:  56%|█████▋    | 169/300 [01:16<00:43,  3.02it/s]Running loglikelihood requests:  57%|█████▋    | 170/300 [01:16<00:49,  2.64it/s]Running loglikelihood requests:  57%|█████▋    | 171/300 [01:17<00:54,  2.38it/s]Running loglikelihood requests:  57%|█████▋    | 172/300 [01:18<00:59,  2.16it/s]Running loglikelihood requests:  58%|█████▊    | 173/300 [01:18<01:03,  2.01it/s]Running loglikelihood requests:  58%|█████▊    | 175/300 [01:19<00:55,  2.23it/s]Running loglikelihood requests:  59%|█████▉    | 177/300 [01:20<00:47,  2.60it/s]Running loglikelihood requests:  60%|█████▉    | 179/300 [01:20<00:42,  2.87it/s]Running loglikelihood requests:  60%|██████    | 180/300 [01:21<00:46,  2.56it/s]Running loglikelihood requests:  60%|██████    | 181/300 [01:21<00:51,  2.29it/s]Running loglikelihood requests:  61%|██████    | 183/300 [01:22<00:44,  2.66it/s]Running loglikelihood requests:  62%|██████▏   | 185/300 [01:22<00:39,  2.93it/s]Running loglikelihood requests:  62%|██████▏   | 186/300 [01:23<00:43,  2.60it/s]Running loglikelihood requests:  63%|██████▎   | 188/300 [01:23<00:38,  2.91it/s]Running loglikelihood requests:  63%|██████▎   | 190/300 [01:24<00:35,  3.13it/s]Running loglikelihood requests:  64%|██████▎   | 191/300 [01:25<00:39,  2.74it/s]Running loglikelihood requests:  64%|██████▍   | 192/300 [01:25<00:43,  2.48it/s]Running loglikelihood requests:  65%|██████▍   | 194/300 [01:26<00:37,  2.84it/s]Running loglikelihood requests:  65%|██████▌   | 195/300 [01:26<00:41,  2.54it/s]Running loglikelihood requests:  65%|██████▌   | 196/300 [01:27<00:44,  2.33it/s]Running loglikelihood requests:  66%|██████▌   | 198/300 [01:27<00:37,  2.74it/s]Running loglikelihood requests:  66%|██████▋   | 199/300 [01:28<00:40,  2.48it/s]Running loglikelihood requests:  67%|██████▋   | 200/300 [01:28<00:43,  2.29it/s]Running loglikelihood requests:  67%|██████▋   | 201/300 [01:29<00:45,  2.16it/s]Running loglikelihood requests:  68%|██████▊   | 203/300 [01:29<00:36,  2.62it/s]Running loglikelihood requests:  68%|██████▊   | 205/300 [01:30<00:32,  2.95it/s]Running loglikelihood requests:  69%|██████▊   | 206/300 [01:30<00:35,  2.62it/s]Running loglikelihood requests:  69%|██████▉   | 208/300 [01:31<00:31,  2.95it/s]Running loglikelihood requests:  70%|███████   | 210/300 [01:32<00:28,  3.19it/s]Running loglikelihood requests:  71%|███████   | 212/300 [01:32<00:26,  3.35it/s]Running loglikelihood requests:  71%|███████   | 213/300 [01:33<00:29,  2.92it/s]Running loglikelihood requests:  72%|███████▏  | 215/300 [01:33<00:26,  3.17it/s]Running loglikelihood requests:  72%|███████▏  | 216/300 [01:34<00:30,  2.79it/s]Running loglikelihood requests:  72%|███████▏  | 217/300 [01:34<00:32,  2.52it/s]Running loglikelihood requests:  73%|███████▎  | 219/300 [01:35<00:27,  2.89it/s]Running loglikelihood requests:  74%|███████▎  | 221/300 [01:35<00:24,  3.17it/s]Running loglikelihood requests:  74%|███████▍  | 222/300 [01:36<00:28,  2.78it/s]Running loglikelihood requests:  75%|███████▍  | 224/300 [01:36<00:24,  3.09it/s]Running loglikelihood requests:  75%|███████▌  | 225/300 [01:37<00:27,  2.74it/s]Running loglikelihood requests:  76%|███████▌  | 227/300 [01:37<00:23,  3.07it/s]Running loglikelihood requests:  76%|███████▌  | 228/300 [01:38<00:26,  2.73it/s]Running loglikelihood requests:  76%|███████▋  | 229/300 [01:38<00:28,  2.49it/s]Running loglikelihood requests:  77%|███████▋  | 231/300 [01:39<00:23,  2.90it/s]Running loglikelihood requests:  77%|███████▋  | 232/300 [01:39<00:26,  2.61it/s]Running loglikelihood requests:  78%|███████▊  | 233/300 [01:40<00:27,  2.41it/s]Running loglikelihood requests:  78%|███████▊  | 234/300 [01:40<00:29,  2.27it/s]Running loglikelihood requests:  78%|███████▊  | 235/300 [01:41<00:29,  2.17it/s]Running loglikelihood requests:  79%|███████▊  | 236/300 [01:42<00:30,  2.10it/s]Running loglikelihood requests:  79%|███████▉  | 237/300 [01:42<00:30,  2.05it/s]Running loglikelihood requests:  79%|███████▉  | 238/300 [01:43<00:30,  2.02it/s]Running loglikelihood requests:  80%|████████  | 240/300 [01:43<00:23,  2.58it/s]Running loglikelihood requests:  81%|████████  | 242/300 [01:44<00:19,  2.96it/s]Running loglikelihood requests:  81%|████████▏ | 244/300 [01:44<00:17,  3.24it/s]Running loglikelihood requests:  82%|████████▏ | 246/300 [01:45<00:15,  3.44it/s]Running loglikelihood requests:  83%|████████▎ | 248/300 [01:45<00:14,  3.58it/s]Running loglikelihood requests:  83%|████████▎ | 250/300 [01:46<00:13,  3.68it/s]Running loglikelihood requests:  84%|████████▍ | 252/300 [01:46<00:12,  3.74it/s]Running loglikelihood requests:  85%|████████▍ | 254/300 [01:47<00:12,  3.79it/s]Running loglikelihood requests:  85%|████████▌ | 256/300 [01:47<00:11,  3.84it/s]Running loglikelihood requests:  86%|████████▌ | 257/300 [01:48<00:13,  3.29it/s]Running loglikelihood requests:  86%|████████▌ | 258/300 [01:48<00:14,  2.90it/s]Running loglikelihood requests:  87%|████████▋ | 260/300 [01:49<00:12,  3.23it/s]Running loglikelihood requests:  87%|████████▋ | 261/300 [01:49<00:13,  2.87it/s]Running loglikelihood requests:  88%|████████▊ | 263/300 [01:50<00:11,  3.21it/s]Running loglikelihood requests:  88%|████████▊ | 264/300 [01:50<00:12,  2.85it/s]Running loglikelihood requests:  88%|████████▊ | 265/300 [01:51<00:13,  2.61it/s]Running loglikelihood requests:  89%|████████▊ | 266/300 [01:51<00:13,  2.43it/s]Running loglikelihood requests:  89%|████████▉ | 268/300 [01:52<00:10,  2.92it/s]Running loglikelihood requests:  90%|█████████ | 270/300 [01:52<00:09,  3.25it/s]Running loglikelihood requests:  91%|█████████ | 272/300 [01:53<00:08,  3.50it/s]Running loglikelihood requests:  91%|█████████▏| 274/300 [01:53<00:07,  3.68it/s]Running loglikelihood requests:  92%|█████████▏| 275/300 [01:54<00:07,  3.21it/s]Running loglikelihood requests:  92%|█████████▏| 277/300 [01:54<00:06,  3.50it/s]Running loglikelihood requests:  93%|█████████▎| 278/300 [01:55<00:07,  3.07it/s]Running loglikelihood requests:  93%|█████████▎| 279/300 [01:55<00:07,  2.79it/s]Running loglikelihood requests:  94%|█████████▎| 281/300 [01:55<00:05,  3.21it/s]Running loglikelihood requests:  94%|█████████▍| 282/300 [01:56<00:06,  2.88it/s]Running loglikelihood requests:  94%|█████████▍| 283/300 [01:56<00:06,  2.65it/s]Running loglikelihood requests:  95%|█████████▍| 284/300 [01:57<00:06,  2.49it/s]Running loglikelihood requests:  95%|█████████▌| 286/300 [01:57<00:04,  3.01it/s]Running loglikelihood requests:  96%|█████████▌| 288/300 [01:58<00:03,  3.38it/s]Running loglikelihood requests:  97%|█████████▋| 290/300 [01:58<00:02,  3.66it/s]Running loglikelihood requests:  97%|█████████▋| 292/300 [01:59<00:02,  3.86it/s]Running loglikelihood requests:  98%|█████████▊| 293/300 [01:59<00:02,  3.37it/s]Running loglikelihood requests:  98%|█████████▊| 294/300 [02:00<00:01,  3.02it/s]Running loglikelihood requests:  99%|█████████▊| 296/300 [02:00<00:01,  3.43it/s]Running loglikelihood requests:  99%|█████████▉| 298/300 [02:01<00:00,  3.76it/s]Running loglikelihood requests: 100%|█████████▉| 299/300 [02:01<00:00,  3.33it/s]Running loglikelihood requests: 100%|██████████| 300/300 [02:01<00:00,  2.47it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:6'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:6'}
full model:
{'mnli': {'alias': 'mnli', 'acc,none': 0.4, 'acc_stderr,none': 0.0492365963917331}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.8171409999433525
0.8739893758684915
0.8333413990263023
0.8782828649633461
0.7602933913725962
0.7047335470608914
0.9813668198386444
0.7850949920891616
0.748983595161589
0.6557873189175887
0.7043210867322975
0.9420132312730142
0.9548348739467002
0.8459964595909506
0.6932219150662173
0.8804855383939617
0.868566987197908
0.8437399449827557
0.9153450822718411
0.8433082326287293
0.910397090611448
0.7626694638419581
0.752151649412453
0.8346986395359313
0.9530736745854924
0.8635918585764104
0.8647192950921815
Total groups 75 exceeded the threshold, stopping comparison.
The group tensor is
[4, 5, 6, 1, 7, 2, 3, 0]
tensor([4, 5, 6, 1, 7, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 4, 6, 2, 5, 1, 3, 0]
tensor([7, 4, 6, 2, 5, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 7, 3, 5, 1, 4, 0]
tensor([6, 2, 7, 3, 5, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[7, 2, 5, 4, 6, 1, 3, 0]
tensor([7, 2, 5, 4, 6, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 5, 3, 1, 2, 4, 0]
tensor([0, 1, 5, 3, 1, 2, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 2, 3, 1, 2, 0, 3, 1]
tensor([0, 2, 3, 1, 2, 0, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 2, 2, 1, 3, 0]
tensor([0, 3, 1, 2, 2, 1, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1.0, 1.0, 1.0, 0, 1.0, 1]
tensor([0, 1, 1, 1, 1, 0, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([1])
tensor(1)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
done!
Normal merging for layer 2
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
done!
Normal merging for layer 3
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([3])
tensor(3)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 4 to 8
done!
Normal merging for layer 9
tensor([0, 7])
tensor(0)
tensor([1, 4])
tensor(1)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([6])
tensor(6)
tensor([2])
tensor(2)
done!
Cross-layer merge completed for layers 10 to 20
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 22
tensor([0, 5])
tensor(0)
tensor([3, 7])
tensor(3)
tensor([1, 4])
tensor(1)
tensor([2, 6])
tensor(2)
done!
Normal merging for layer 23
tensor([0, 7])
tensor(0)
tensor([2, 5])
tensor(2)
tensor([3, 4])
tensor(3)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 24 to 25
done!
Normal merging for layer 26
tensor([0, 5])
tensor(0)
tensor([1, 2, 3, 4, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 27 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 3 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.5127 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 2 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

159
cuda:6
winogrande
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 33.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:14<00:00, 37.04s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/winogrande HTTP/1.1" 307 67
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/winogrande HTTP/1.1" 200 1036
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=winogrande HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/winogrande.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140355685381376 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 140355685381376 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 140355685381376 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 140355685381376 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Attempting to acquire lock 140355682329440 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 140355682329440 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 140355682329440 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 140355682329440 released on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:doc_to_text returned an int. Assuming multiple inputs.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of winogrande from None to 0
INFO:lm_eval.api.task:Building contexts for winogrande on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 137970.53it/s]
DEBUG:lm_eval.evaluator:Task: winogrande; number of requests on this rank: 200
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/200 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/200 [00:01<04:19,  1.31s/it]Running loglikelihood requests:   1%|          | 2/200 [00:01<02:50,  1.16it/s]Running loglikelihood requests:   2%|▏         | 3/200 [00:02<02:18,  1.42it/s]Running loglikelihood requests:   2%|▏         | 4/200 [00:02<02:02,  1.59it/s]Running loglikelihood requests:   2%|▎         | 5/200 [00:03<01:53,  1.72it/s]Running loglikelihood requests:   3%|▎         | 6/200 [00:03<01:47,  1.80it/s]Running loglikelihood requests:   4%|▎         | 7/200 [00:04<01:43,  1.86it/s]Running loglikelihood requests:   4%|▍         | 8/200 [00:04<01:40,  1.90it/s]Running loglikelihood requests:   4%|▍         | 9/200 [00:05<01:38,  1.94it/s]Running loglikelihood requests:   5%|▌         | 10/200 [00:05<01:36,  1.96it/s]Running loglikelihood requests:   6%|▌         | 11/200 [00:06<01:35,  1.98it/s]Running loglikelihood requests:   6%|▌         | 12/200 [00:06<01:34,  1.99it/s]Running loglikelihood requests:   6%|▋         | 13/200 [00:07<01:33,  1.99it/s]Running loglikelihood requests:   7%|▋         | 14/200 [00:07<01:32,  2.00it/s]Running loglikelihood requests:   8%|▊         | 15/200 [00:08<01:32,  2.01it/s]Running loglikelihood requests:   8%|▊         | 16/200 [00:08<01:31,  2.02it/s]Running loglikelihood requests:   8%|▊         | 17/200 [00:09<01:30,  2.02it/s]Running loglikelihood requests:   9%|▉         | 18/200 [00:09<01:29,  2.03it/s]Running loglikelihood requests:  10%|▉         | 19/200 [00:10<01:29,  2.03it/s]Running loglikelihood requests:  10%|█         | 20/200 [00:10<01:28,  2.03it/s]Running loglikelihood requests:  10%|█         | 21/200 [00:11<01:28,  2.03it/s]Running loglikelihood requests:  11%|█         | 22/200 [00:11<01:27,  2.04it/s]Running loglikelihood requests:  12%|█▏        | 23/200 [00:12<01:26,  2.04it/s]Running loglikelihood requests:  12%|█▏        | 24/200 [00:12<01:27,  2.02it/s]Running loglikelihood requests:  12%|█▎        | 25/200 [00:13<01:26,  2.03it/s]Running loglikelihood requests:  13%|█▎        | 26/200 [00:13<01:25,  2.04it/s]Running loglikelihood requests:  14%|█▎        | 27/200 [00:14<01:24,  2.04it/s]Running loglikelihood requests:  14%|█▍        | 28/200 [00:14<01:23,  2.05it/s]Running loglikelihood requests:  14%|█▍        | 29/200 [00:15<01:23,  2.05it/s]Running loglikelihood requests:  15%|█▌        | 30/200 [00:15<01:22,  2.05it/s]Running loglikelihood requests:  16%|█▌        | 31/200 [00:16<01:22,  2.06it/s]Running loglikelihood requests:  16%|█▌        | 32/200 [00:16<01:21,  2.06it/s]Running loglikelihood requests:  16%|█▋        | 33/200 [00:17<01:20,  2.07it/s]Running loglikelihood requests:  17%|█▋        | 34/200 [00:17<01:20,  2.07it/s]Running loglikelihood requests:  18%|█▊        | 35/200 [00:18<01:19,  2.07it/s]Running loglikelihood requests:  18%|█▊        | 36/200 [00:18<01:19,  2.07it/s]Running loglikelihood requests:  18%|█▊        | 37/200 [00:19<01:18,  2.08it/s]Running loglikelihood requests:  19%|█▉        | 38/200 [00:19<01:17,  2.08it/s]Running loglikelihood requests:  20%|█▉        | 39/200 [00:20<01:17,  2.08it/s]Running loglikelihood requests:  20%|██        | 40/200 [00:20<01:16,  2.08it/s]Running loglikelihood requests:  20%|██        | 41/200 [00:20<01:16,  2.09it/s]Running loglikelihood requests:  21%|██        | 42/200 [00:21<01:15,  2.09it/s]Running loglikelihood requests:  22%|██▏       | 43/200 [00:21<01:15,  2.09it/s]Running loglikelihood requests:  22%|██▏       | 44/200 [00:22<01:14,  2.09it/s]Running loglikelihood requests:  22%|██▎       | 45/200 [00:22<01:14,  2.09it/s]Running loglikelihood requests:  23%|██▎       | 46/200 [00:23<01:13,  2.09it/s]Running loglikelihood requests:  24%|██▎       | 47/200 [00:23<01:13,  2.09it/s]Running loglikelihood requests:  24%|██▍       | 48/200 [00:24<01:12,  2.09it/s]Running loglikelihood requests:  24%|██▍       | 49/200 [00:24<01:12,  2.09it/s]Running loglikelihood requests:  25%|██▌       | 50/200 [00:25<01:11,  2.09it/s]Running loglikelihood requests:  26%|██▌       | 51/200 [00:25<01:11,  2.09it/s]Running loglikelihood requests:  26%|██▌       | 52/200 [00:26<01:10,  2.09it/s]Running loglikelihood requests:  26%|██▋       | 53/200 [00:26<01:10,  2.09it/s]Running loglikelihood requests:  27%|██▋       | 54/200 [00:27<01:09,  2.09it/s]Running loglikelihood requests:  28%|██▊       | 55/200 [00:27<01:09,  2.09it/s]Running loglikelihood requests:  28%|██▊       | 56/200 [00:28<01:08,  2.09it/s]Running loglikelihood requests:  28%|██▊       | 57/200 [00:28<01:08,  2.10it/s]Running loglikelihood requests:  29%|██▉       | 58/200 [00:29<01:07,  2.10it/s]Running loglikelihood requests:  30%|██▉       | 59/200 [00:29<01:07,  2.10it/s]Running loglikelihood requests:  30%|███       | 60/200 [00:30<01:06,  2.10it/s]Running loglikelihood requests:  30%|███       | 61/200 [00:30<01:06,  2.10it/s]Running loglikelihood requests:  31%|███       | 62/200 [00:31<01:05,  2.11it/s]Running loglikelihood requests:  32%|███▏      | 63/200 [00:31<01:04,  2.12it/s]Running loglikelihood requests:  32%|███▏      | 64/200 [00:31<01:04,  2.11it/s]Running loglikelihood requests:  32%|███▎      | 65/200 [00:32<01:04,  2.11it/s]Running loglikelihood requests:  33%|███▎      | 66/200 [00:32<01:04,  2.07it/s]Running loglikelihood requests:  34%|███▎      | 67/200 [00:33<01:05,  2.04it/s]Running loglikelihood requests:  34%|███▍      | 68/200 [00:33<01:04,  2.06it/s]Running loglikelihood requests:  34%|███▍      | 69/200 [00:34<01:03,  2.07it/s]Running loglikelihood requests:  35%|███▌      | 70/200 [00:34<01:02,  2.08it/s]Running loglikelihood requests:  36%|███▌      | 71/200 [00:35<01:01,  2.09it/s]Running loglikelihood requests:  36%|███▌      | 72/200 [00:35<01:01,  2.09it/s]Running loglikelihood requests:  36%|███▋      | 73/200 [00:36<01:00,  2.09it/s]Running loglikelihood requests:  37%|███▋      | 74/200 [00:36<00:59,  2.10it/s]Running loglikelihood requests:  38%|███▊      | 75/200 [00:37<00:59,  2.11it/s]Running loglikelihood requests:  38%|███▊      | 76/200 [00:37<00:58,  2.11it/s]Running loglikelihood requests:  38%|███▊      | 77/200 [00:38<00:58,  2.12it/s]Running loglikelihood requests:  39%|███▉      | 78/200 [00:38<00:57,  2.12it/s]Running loglikelihood requests:  40%|███▉      | 79/200 [00:39<00:57,  2.12it/s]Running loglikelihood requests:  40%|████      | 80/200 [00:39<00:56,  2.12it/s]Running loglikelihood requests:  40%|████      | 81/200 [00:40<00:56,  2.12it/s]Running loglikelihood requests:  41%|████      | 82/200 [00:40<00:55,  2.12it/s]Running loglikelihood requests:  42%|████▏     | 83/200 [00:41<00:55,  2.13it/s]Running loglikelihood requests:  42%|████▏     | 84/200 [00:41<00:54,  2.14it/s]Running loglikelihood requests:  42%|████▎     | 85/200 [00:41<00:53,  2.14it/s]Running loglikelihood requests:  43%|████▎     | 86/200 [00:42<00:53,  2.14it/s]Running loglikelihood requests:  44%|████▎     | 87/200 [00:42<00:52,  2.14it/s]Running loglikelihood requests:  44%|████▍     | 88/200 [00:43<00:52,  2.14it/s]Running loglikelihood requests:  44%|████▍     | 89/200 [00:43<00:51,  2.15it/s]Running loglikelihood requests:  45%|████▌     | 90/200 [00:44<00:51,  2.15it/s]Running loglikelihood requests:  46%|████▌     | 91/200 [00:44<00:50,  2.15it/s]Running loglikelihood requests:  46%|████▌     | 92/200 [00:45<00:50,  2.15it/s]Running loglikelihood requests:  46%|████▋     | 93/200 [00:45<00:49,  2.15it/s]Running loglikelihood requests:  47%|████▋     | 94/200 [00:46<00:49,  2.14it/s]Running loglikelihood requests:  48%|████▊     | 95/200 [00:46<00:49,  2.14it/s]Running loglikelihood requests:  48%|████▊     | 96/200 [00:47<00:48,  2.14it/s]Running loglikelihood requests:  48%|████▊     | 97/200 [00:47<00:48,  2.14it/s]Running loglikelihood requests:  49%|████▉     | 98/200 [00:48<00:47,  2.14it/s]Running loglikelihood requests:  50%|████▉     | 99/200 [00:48<00:47,  2.15it/s]Running loglikelihood requests:  50%|█████     | 100/200 [00:48<00:46,  2.15it/s]Running loglikelihood requests:  50%|█████     | 101/200 [00:49<00:45,  2.15it/s]Running loglikelihood requests:  51%|█████     | 102/200 [00:49<00:45,  2.16it/s]Running loglikelihood requests:  52%|█████▏    | 103/200 [00:50<00:44,  2.17it/s]Running loglikelihood requests:  52%|█████▏    | 104/200 [00:50<00:44,  2.17it/s]Running loglikelihood requests:  52%|█████▎    | 105/200 [00:51<00:43,  2.17it/s]Running loglikelihood requests:  53%|█████▎    | 106/200 [00:51<00:43,  2.18it/s]Running loglikelihood requests:  54%|█████▎    | 107/200 [00:52<00:42,  2.18it/s]Running loglikelihood requests:  54%|█████▍    | 108/200 [00:52<00:42,  2.18it/s]Running loglikelihood requests:  55%|█████▍    | 109/200 [00:53<00:41,  2.17it/s]Running loglikelihood requests:  55%|█████▌    | 110/200 [00:53<00:41,  2.17it/s]Running loglikelihood requests:  56%|█████▌    | 111/200 [00:53<00:40,  2.17it/s]Running loglikelihood requests:  56%|█████▌    | 112/200 [00:54<00:40,  2.15it/s]Running loglikelihood requests:  56%|█████▋    | 113/200 [00:54<00:40,  2.16it/s]Running loglikelihood requests:  57%|█████▋    | 114/200 [00:55<00:39,  2.17it/s]Running loglikelihood requests:  57%|█████▊    | 115/200 [00:55<00:39,  2.17it/s]Running loglikelihood requests:  58%|█████▊    | 116/200 [00:56<00:38,  2.18it/s]Running loglikelihood requests:  58%|█████▊    | 117/200 [00:56<00:38,  2.18it/s]Running loglikelihood requests:  59%|█████▉    | 118/200 [00:57<00:37,  2.18it/s]Running loglikelihood requests:  60%|█████▉    | 119/200 [00:57<00:37,  2.18it/s]Running loglikelihood requests:  60%|██████    | 120/200 [00:58<00:36,  2.18it/s]Running loglikelihood requests:  60%|██████    | 121/200 [00:58<00:36,  2.18it/s]Running loglikelihood requests:  61%|██████    | 122/200 [00:59<00:35,  2.18it/s]Running loglikelihood requests:  62%|██████▏   | 123/200 [00:59<00:35,  2.18it/s]Running loglikelihood requests:  62%|██████▏   | 124/200 [00:59<00:34,  2.19it/s]Running loglikelihood requests:  62%|██████▎   | 125/200 [01:00<00:34,  2.19it/s]Running loglikelihood requests:  63%|██████▎   | 126/200 [01:00<00:33,  2.19it/s]Running loglikelihood requests:  64%|██████▎   | 127/200 [01:01<00:33,  2.19it/s]Running loglikelihood requests:  64%|██████▍   | 128/200 [01:01<00:32,  2.19it/s]Running loglikelihood requests:  64%|██████▍   | 129/200 [01:02<00:32,  2.20it/s]Running loglikelihood requests:  65%|██████▌   | 130/200 [01:02<00:32,  2.17it/s]Running loglikelihood requests:  66%|██████▌   | 131/200 [01:03<00:31,  2.18it/s]Running loglikelihood requests:  66%|██████▌   | 132/200 [01:03<00:30,  2.20it/s]Running loglikelihood requests:  66%|██████▋   | 133/200 [01:04<00:30,  2.19it/s]Running loglikelihood requests:  67%|██████▋   | 134/200 [01:04<00:29,  2.20it/s]Running loglikelihood requests:  68%|██████▊   | 135/200 [01:04<00:29,  2.20it/s]Running loglikelihood requests:  68%|██████▊   | 136/200 [01:05<00:29,  2.20it/s]Running loglikelihood requests:  68%|██████▊   | 137/200 [01:05<00:28,  2.21it/s]Running loglikelihood requests:  69%|██████▉   | 138/200 [01:06<00:28,  2.21it/s]Running loglikelihood requests:  70%|██████▉   | 139/200 [01:06<00:27,  2.21it/s]Running loglikelihood requests:  70%|███████   | 140/200 [01:07<00:27,  2.21it/s]Running loglikelihood requests:  70%|███████   | 141/200 [01:07<00:26,  2.21it/s]Running loglikelihood requests:  71%|███████   | 142/200 [01:08<00:26,  2.21it/s]Running loglikelihood requests:  72%|███████▏  | 143/200 [01:08<00:25,  2.22it/s]Running loglikelihood requests:  72%|███████▏  | 144/200 [01:09<00:25,  2.22it/s]Running loglikelihood requests:  72%|███████▎  | 145/200 [01:09<00:24,  2.22it/s]Running loglikelihood requests:  73%|███████▎  | 146/200 [01:09<00:24,  2.21it/s]Running loglikelihood requests:  74%|███████▎  | 147/200 [01:10<00:23,  2.22it/s]Running loglikelihood requests:  74%|███████▍  | 148/200 [01:10<00:23,  2.22it/s]Running loglikelihood requests:  74%|███████▍  | 149/200 [01:11<00:22,  2.23it/s]Running loglikelihood requests:  75%|███████▌  | 150/200 [01:11<00:23,  2.13it/s]Running loglikelihood requests:  76%|███████▌  | 151/200 [01:12<00:22,  2.15it/s]Running loglikelihood requests:  76%|███████▌  | 152/200 [01:12<00:22,  2.18it/s]Running loglikelihood requests:  76%|███████▋  | 153/200 [01:13<00:21,  2.20it/s]Running loglikelihood requests:  77%|███████▋  | 154/200 [01:13<00:20,  2.22it/s]Running loglikelihood requests:  78%|███████▊  | 155/200 [01:14<00:20,  2.23it/s]Running loglikelihood requests:  78%|███████▊  | 156/200 [01:14<00:19,  2.23it/s]Running loglikelihood requests:  78%|███████▊  | 157/200 [01:14<00:19,  2.23it/s]Running loglikelihood requests:  79%|███████▉  | 158/200 [01:15<00:18,  2.23it/s]Running loglikelihood requests:  80%|███████▉  | 159/200 [01:15<00:18,  2.24it/s]Running loglikelihood requests:  80%|████████  | 160/200 [01:16<00:17,  2.23it/s]Running loglikelihood requests:  80%|████████  | 161/200 [01:16<00:17,  2.23it/s]Running loglikelihood requests:  81%|████████  | 162/200 [01:17<00:17,  2.23it/s]Running loglikelihood requests:  82%|████████▏ | 163/200 [01:17<00:16,  2.24it/s]Running loglikelihood requests:  82%|████████▏ | 164/200 [01:18<00:16,  2.24it/s]Running loglikelihood requests:  82%|████████▎ | 165/200 [01:18<00:15,  2.24it/s]Running loglikelihood requests:  83%|████████▎ | 166/200 [01:18<00:15,  2.23it/s]Running loglikelihood requests:  84%|████████▎ | 167/200 [01:19<00:14,  2.24it/s]Running loglikelihood requests:  84%|████████▍ | 168/200 [01:19<00:14,  2.24it/s]Running loglikelihood requests:  84%|████████▍ | 169/200 [01:20<00:13,  2.25it/s]Running loglikelihood requests:  85%|████████▌ | 170/200 [01:20<00:13,  2.25it/s]Running loglikelihood requests:  86%|████████▌ | 171/200 [01:21<00:12,  2.26it/s]Running loglikelihood requests:  86%|████████▌ | 172/200 [01:21<00:12,  2.27it/s]Running loglikelihood requests:  86%|████████▋ | 173/200 [01:22<00:11,  2.27it/s]Running loglikelihood requests:  87%|████████▋ | 174/200 [01:22<00:11,  2.27it/s]Running loglikelihood requests:  88%|████████▊ | 175/200 [01:22<00:10,  2.27it/s]Running loglikelihood requests:  88%|████████▊ | 176/200 [01:23<00:10,  2.28it/s]Running loglikelihood requests:  88%|████████▊ | 177/200 [01:23<00:10,  2.28it/s]Running loglikelihood requests:  89%|████████▉ | 178/200 [01:24<00:09,  2.24it/s]Running loglikelihood requests:  90%|████████▉ | 179/200 [01:24<00:09,  2.16it/s]Running loglikelihood requests:  90%|█████████ | 180/200 [01:25<00:09,  2.21it/s]Running loglikelihood requests:  90%|█████████ | 181/200 [01:25<00:08,  2.25it/s]Running loglikelihood requests:  91%|█████████ | 182/200 [01:26<00:07,  2.28it/s]Running loglikelihood requests:  92%|█████████▏| 183/200 [01:26<00:07,  2.30it/s]Running loglikelihood requests:  92%|█████████▏| 184/200 [01:26<00:06,  2.31it/s]Running loglikelihood requests:  92%|█████████▎| 185/200 [01:27<00:06,  2.31it/s]Running loglikelihood requests:  93%|█████████▎| 186/200 [01:27<00:06,  2.31it/s]Running loglikelihood requests:  94%|█████████▎| 187/200 [01:28<00:05,  2.31it/s]Running loglikelihood requests:  94%|█████████▍| 188/200 [01:28<00:05,  2.26it/s]Running loglikelihood requests:  94%|█████████▍| 189/200 [01:29<00:04,  2.21it/s]Running loglikelihood requests:  95%|█████████▌| 190/200 [01:29<00:04,  2.13it/s]Running loglikelihood requests:  96%|█████████▌| 191/200 [01:30<00:04,  2.20it/s]Running loglikelihood requests:  96%|█████████▌| 192/200 [01:30<00:03,  2.25it/s]Running loglikelihood requests:  96%|█████████▋| 193/200 [01:31<00:03,  2.05it/s]Running loglikelihood requests:  97%|█████████▋| 194/200 [01:31<00:02,  2.14it/s]Running loglikelihood requests:  98%|█████████▊| 195/200 [01:31<00:02,  2.21it/s]Running loglikelihood requests:  98%|█████████▊| 196/200 [01:32<00:01,  2.25it/s]Running loglikelihood requests:  98%|█████████▊| 197/200 [01:32<00:01,  2.28it/s]Running loglikelihood requests:  99%|█████████▉| 198/200 [01:33<00:00,  2.31it/s]Running loglikelihood requests: 100%|█████████▉| 199/200 [01:33<00:00,  2.33it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:34<00:00,  2.35it/s]Running loglikelihood requests: 100%|██████████| 200/200 [01:34<00:00,  2.13it/s]
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
DEBUG:lm_eval.tasks:File _evalita-mp_ner_adg.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_fic.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
DEBUG:lm_eval.tasks:File _evalita-mp_ner_wn.yaml in /public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/lm_eval/tasks/evalita_llm could not be loaded
WARNING:accelerate.utils.other:Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
INFO:lm_eval.models.huggingface:Using device 'cuda:7'
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:7'}
full model:
{'winogrande': {'alias': 'winogrande', 'acc,none': 0.69, 'acc_stderr,none': 0.046482319871173176}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.9565474555896152
0.9256436871263655
0.919777800952949
0.8502516827829548
0.9788217808920475
0.7842184683361061
0.5847175538207384
0.7741211354638314
0.8734705119073022
0.9731317123565076
0.9046875380381674
0.8858535931048256
0.9314298098713261
0.8442403312485581
0.7166029053748131
0.7061450250233585
0.7563059483803782
0.6877563559653158
0.8738989590810852
0.784285727893607
0.8409178900131131
0.8425380927376759
0.6782655591765769
0.7228968829640015
0.8418686487797186
0.9141168065903919
0.8562481461255738
0.6139553840231665
0.934088538459943
Total groups 66 exceeded the threshold, stopping comparison.
The group tensor is
[6, 2, 4, 3, 5, 1, 7, 0]
tensor([6, 2, 4, 3, 5, 1, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 3, 1, 5, 4, 7, 0]
tensor([6, 2, 3, 1, 5, 4, 7, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 4, 1, 0, 3, 0, 1, 2]
tensor([5, 4, 1, 0, 3, 0, 1, 2], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 3, 1, 4, 5, 1, 0]
tensor([0, 2, 3, 1, 4, 5, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[5, 1, 2, 3, 4, 0, 1, 0]
tensor([5, 1, 2, 3, 4, 0, 1, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[0, 2, 1, 1, 2, 3, 3, 0]
tensor([0, 2, 1, 1, 2, 3, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 1, 1, 1.0, 1.0, 1.0, 1.0, 0]
tensor([0, 1, 1, 1, 1, 1, 1, 0], dtype=torch.int32)
[0, 1]
The group tensor is
[0, 1, 1.0, 0, 1.0, 1.0, 1.0, 1]
tensor([0, 1, 1, 0, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([7])
tensor(7)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([5])
tensor(5)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 7
done!
Normal merging for layer 8
tensor([3, 5])
tensor(3)
tensor([2, 6])
tensor(2)
tensor([7])
tensor(7)
tensor([4])
tensor(4)
tensor([1])
tensor(1)
tensor([0])
tensor(0)
done!
Cross-layer merge completed for layers 9 to 13
done!
Normal merging for layer 14
tensor([0, 7])
tensor(0)
tensor([3, 6])
tensor(3)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
tensor([5])
tensor(5)
done!
Normal merging for layer 15
tensor([5, 7])
tensor(5)
tensor([1, 6])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([0])
tensor(0)
done!
Normal merging for layer 16
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([1, 4])
tensor(1)
tensor([5, 6])
tensor(5)
done!
Cross-layer merge completed for layers 17 to 23
done!
Normal merging for layer 24
tensor([0, 7])
tensor(0)
tensor([1, 2, 3, 4, 5, 6])
tensor(1)
done!
Normal merging for layer 25
tensor([0, 3])
tensor(0)
tensor([1, 2, 4, 5, 6, 7])
tensor(1)
done!
Cross-layer merge completed for layers 26 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 2 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 11.8828 GB

===== 🚀【CUDA 检查开始】[after create model] =====
🔍 找到 1 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

96
cuda:7
sciq
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 34.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.72s/it]
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/sciq/sciq.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/sciq HTTP/1.1" 307 61
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/sciq HTTP/1.1" 200 1238
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/README.md HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/sciq/resolve/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 307 113
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "POST /api/datasets/allenai/sciq/paths-info/2c94ad3e1aafab77146f384e23536f97a4849815 HTTP/1.1" 200 235
DEBUG:filelock:Attempting to acquire lock 140351336911056 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140351336911056 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140351336911056 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Lock 140351336911056 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_sciq_default_0.0.0_2c94ad3e1aafab77146f384e23536f97a4849815.lock
DEBUG:filelock:Attempting to acquire lock 140375975108416 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140375975108416 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815/dataset_info.json
DEBUG:filelock:Attempting to release lock 140375975108416 on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:filelock:Lock 140375975108416 released on /public/home/zouyifei001/.cache/huggingface/datasets/sciq/default/0.0.0/2c94ad3e1aafab77146f384e23536f97a4849815_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of sciq from None to 0
INFO:lm_eval.api.task:Building contexts for sciq on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 1033.09it/s]
DEBUG:lm_eval.evaluator:Task: sciq; number of requests on this rank: 400
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/400 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/400 [00:04<27:30,  4.14s/it]Running loglikelihood requests:   0%|          | 2/400 [00:07<24:41,  3.72s/it]Running loglikelihood requests:   1%|          | 3/400 [00:11<23:57,  3.62s/it]Running loglikelihood requests:   1%|          | 4/400 [00:14<23:31,  3.56s/it]Running loglikelihood requests:   1%|▏         | 5/400 [00:17<23:08,  3.52s/it]Running loglikelihood requests:   2%|▏         | 6/400 [00:21<22:47,  3.47s/it]Running loglikelihood requests:   2%|▏         | 7/400 [00:24<22:28,  3.43s/it]Running loglikelihood requests:   2%|▏         | 8/400 [00:28<22:13,  3.40s/it]Running loglikelihood requests:   2%|▏         | 9/400 [00:31<21:19,  3.27s/it]Running loglikelihood requests:   2%|▎         | 10/400 [00:33<20:30,  3.16s/it]Running loglikelihood requests:   3%|▎         | 11/400 [00:36<20:03,  3.09s/it]Running loglikelihood requests:   3%|▎         | 12/400 [00:39<19:49,  3.07s/it]Running loglikelihood requests:   3%|▎         | 13/400 [00:42<19:03,  2.96s/it]Running loglikelihood requests:   4%|▎         | 14/400 [00:45<18:30,  2.88s/it]Running loglikelihood requests:   4%|▍         | 15/400 [00:47<18:03,  2.81s/it]Running loglikelihood requests:   4%|▍         | 16/400 [00:50<17:51,  2.79s/it]Running loglikelihood requests:   4%|▍         | 17/400 [00:53<17:19,  2.71s/it]Running loglikelihood requests:   4%|▍         | 18/400 [00:55<16:54,  2.66s/it]Running loglikelihood requests:   5%|▍         | 19/400 [00:58<16:35,  2.61s/it]Running loglikelihood requests:   5%|▌         | 20/400 [01:00<16:27,  2.60s/it]Running loglikelihood requests:   5%|▌         | 21/400 [01:03<16:18,  2.58s/it]Running loglikelihood requests:   6%|▌         | 22/400 [01:05<16:04,  2.55s/it]Running loglikelihood requests:   6%|▌         | 23/400 [01:08<15:52,  2.53s/it]Running loglikelihood requests:   6%|▌         | 24/400 [01:10<15:44,  2.51s/it]Running loglikelihood requests:   6%|▋         | 25/400 [01:13<15:23,  2.46s/it]Running loglikelihood requests:   6%|▋         | 26/400 [01:15<15:05,  2.42s/it]Running loglikelihood requests:   7%|▋         | 27/400 [01:17<14:51,  2.39s/it]Running loglikelihood requests:   7%|▋         | 28/400 [01:20<14:39,  2.36s/it]Running loglikelihood requests:   7%|▋         | 29/400 [01:22<14:09,  2.29s/it]Running loglikelihood requests:   8%|▊         | 30/400 [01:24<13:47,  2.24s/it]Running loglikelihood requests:   8%|▊         | 31/400 [01:26<13:30,  2.20s/it]Running loglikelihood requests:   8%|▊         | 32/400 [01:28<13:16,  2.17s/it]Running loglikelihood requests:   8%|▊         | 33/400 [01:30<12:55,  2.11s/it]Running loglikelihood requests:   8%|▊         | 34/400 [01:32<12:42,  2.08s/it]Running loglikelihood requests:   9%|▉         | 35/400 [01:34<12:28,  2.05s/it]Running loglikelihood requests:   9%|▉         | 36/400 [01:36<12:26,  2.05s/it]Running loglikelihood requests:   9%|▉         | 37/400 [01:38<12:15,  2.03s/it]Running loglikelihood requests:  10%|▉         | 38/400 [01:40<12:10,  2.02s/it]Running loglikelihood requests:  10%|█         | 40/400 [01:42<09:20,  1.56s/it]Running loglikelihood requests:  10%|█         | 41/400 [01:44<09:40,  1.62s/it]Running loglikelihood requests:  10%|█         | 42/400 [01:46<09:55,  1.66s/it]Running loglikelihood requests:  11%|█         | 43/400 [01:47<10:06,  1.70s/it]Running loglikelihood requests:  11%|█         | 44/400 [01:49<10:15,  1.73s/it]Running loglikelihood requests:  11%|█▏        | 45/400 [01:51<10:15,  1.73s/it]Running loglikelihood requests:  12%|█▏        | 46/400 [01:53<10:11,  1.73s/it]Running loglikelihood requests:  12%|█▏        | 47/400 [01:54<10:12,  1.74s/it]Running loglikelihood requests:  12%|█▏        | 48/400 [01:56<10:09,  1.73s/it]Running loglikelihood requests:  12%|█▏        | 49/400 [01:58<10:07,  1.73s/it]Running loglikelihood requests:  12%|█▎        | 50/400 [02:00<10:03,  1.72s/it]Running loglikelihood requests:  13%|█▎        | 51/400 [02:01<10:00,  1.72s/it]Running loglikelihood requests:  13%|█▎        | 52/400 [02:03<10:01,  1.73s/it]Running loglikelihood requests:  13%|█▎        | 53/400 [02:05<09:43,  1.68s/it]Running loglikelihood requests:  14%|█▎        | 54/400 [02:06<09:29,  1.65s/it]Running loglikelihood requests:  14%|█▍        | 55/400 [02:08<09:18,  1.62s/it]Running loglikelihood requests:  14%|█▍        | 57/400 [02:09<06:55,  1.21s/it]Running loglikelihood requests:  14%|█▍        | 58/400 [02:11<07:17,  1.28s/it]Running loglikelihood requests:  15%|█▍        | 59/400 [02:12<07:34,  1.33s/it]Running loglikelihood requests:  16%|█▌        | 62/400 [02:14<04:59,  1.13it/s]Running loglikelihood requests:  16%|█▌        | 63/400 [02:15<05:39,  1.01s/it]Running loglikelihood requests:  16%|█▌        | 64/400 [02:17<06:16,  1.12s/it]Running loglikelihood requests:  16%|█▋        | 65/400 [02:18<06:38,  1.19s/it]Running loglikelihood requests:  16%|█▋        | 66/400 [02:20<07:06,  1.28s/it]Running loglikelihood requests:  17%|█▋        | 67/400 [02:21<07:20,  1.32s/it]Running loglikelihood requests:  17%|█▋        | 68/400 [02:23<07:35,  1.37s/it]Running loglikelihood requests:  17%|█▋        | 69/400 [02:24<07:33,  1.37s/it]Running loglikelihood requests:  18%|█▊        | 70/400 [02:26<08:40,  1.58s/it]Running loglikelihood requests:  18%|█▊        | 71/400 [02:27<08:24,  1.53s/it]Running loglikelihood requests:  18%|█▊        | 72/400 [02:29<08:13,  1.50s/it]Running loglikelihood requests:  18%|█▊        | 73/400 [02:30<08:02,  1.48s/it]Running loglikelihood requests:  18%|█▊        | 74/400 [02:32<07:52,  1.45s/it]Running loglikelihood requests:  19%|█▉        | 77/400 [02:33<04:46,  1.13it/s]Running loglikelihood requests:  20%|█▉        | 78/400 [02:34<05:20,  1.01it/s]Running loglikelihood requests:  20%|█▉        | 79/400 [02:36<05:45,  1.08s/it]Running loglikelihood requests:  20%|██        | 81/400 [02:37<04:47,  1.11it/s]Running loglikelihood requests:  20%|██        | 82/400 [02:38<05:07,  1.03it/s]Running loglikelihood requests:  21%|██        | 83/400 [02:40<05:33,  1.05s/it]Running loglikelihood requests:  21%|██        | 84/400 [02:41<05:47,  1.10s/it]Running loglikelihood requests:  21%|██▏       | 85/400 [02:42<05:56,  1.13s/it]Running loglikelihood requests:  22%|██▏       | 86/400 [02:43<06:03,  1.16s/it]Running loglikelihood requests:  22%|██▏       | 89/400 [02:44<03:51,  1.34it/s]Running loglikelihood requests:  22%|██▎       | 90/400 [02:46<04:19,  1.19it/s]Running loglikelihood requests:  23%|██▎       | 91/400 [02:47<04:49,  1.07it/s]Running loglikelihood requests:  23%|██▎       | 92/400 [02:48<05:09,  1.01s/it]Running loglikelihood requests:  23%|██▎       | 93/400 [02:49<05:25,  1.06s/it]Running loglikelihood requests:  24%|██▍       | 97/400 [02:50<03:01,  1.67it/s]Running loglikelihood requests:  24%|██▍       | 98/400 [02:52<03:37,  1.39it/s]Running loglikelihood requests:  25%|██▍       | 99/400 [02:53<04:06,  1.22it/s]Running loglikelihood requests:  25%|██▌       | 100/400 [02:54<04:29,  1.11it/s]Running loglikelihood requests:  25%|██▌       | 101/400 [02:55<04:51,  1.03it/s]Running loglikelihood requests:  26%|██▌       | 102/400 [02:57<05:03,  1.02s/it]Running loglikelihood requests:  26%|██▌       | 103/400 [02:58<05:23,  1.09s/it]Running loglikelihood requests:  26%|██▌       | 104/400 [02:59<05:26,  1.10s/it]Running loglikelihood requests:  26%|██▋       | 105/400 [03:00<05:34,  1.14s/it]Running loglikelihood requests:  26%|██▋       | 106/400 [03:01<05:39,  1.16s/it]Running loglikelihood requests:  27%|██▋       | 107/400 [03:02<05:36,  1.15s/it]Running loglikelihood requests:  27%|██▋       | 108/400 [03:04<05:48,  1.19s/it]Running loglikelihood requests:  27%|██▋       | 109/400 [03:05<05:44,  1.19s/it]Running loglikelihood requests:  28%|██▊       | 110/400 [03:06<05:38,  1.17s/it]Running loglikelihood requests:  28%|██▊       | 111/400 [03:07<05:35,  1.16s/it]Running loglikelihood requests:  28%|██▊       | 112/400 [03:08<05:32,  1.15s/it]Running loglikelihood requests:  28%|██▊       | 113/400 [03:09<05:28,  1.14s/it]Running loglikelihood requests:  28%|██▊       | 114/400 [03:11<05:23,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 115/400 [03:12<05:22,  1.13s/it]Running loglikelihood requests:  29%|██▉       | 116/400 [03:13<05:25,  1.14s/it]Running loglikelihood requests:  29%|██▉       | 117/400 [03:14<05:22,  1.14s/it]Running loglikelihood requests:  30%|██▉       | 118/400 [03:15<05:18,  1.13s/it]Running loglikelihood requests:  30%|██▉       | 119/400 [03:16<05:11,  1.11s/it]Running loglikelihood requests:  30%|███       | 120/400 [03:17<05:08,  1.10s/it]Running loglikelihood requests:  30%|███       | 121/400 [03:18<05:10,  1.11s/it]Running loglikelihood requests:  30%|███       | 122/400 [03:20<05:20,  1.15s/it]Running loglikelihood requests:  31%|███       | 123/400 [03:21<05:14,  1.14s/it]Running loglikelihood requests:  31%|███       | 124/400 [03:22<05:11,  1.13s/it]Running loglikelihood requests:  31%|███▏      | 125/400 [03:23<05:07,  1.12s/it]Running loglikelihood requests:  32%|███▏      | 126/400 [03:24<05:02,  1.10s/it]Running loglikelihood requests:  32%|███▏      | 127/400 [03:25<04:59,  1.10s/it]Running loglikelihood requests:  32%|███▏      | 128/400 [03:26<04:56,  1.09s/it]Running loglikelihood requests:  32%|███▏      | 129/400 [03:27<04:52,  1.08s/it]Running loglikelihood requests:  32%|███▎      | 130/400 [03:28<04:49,  1.07s/it]Running loglikelihood requests:  33%|███▎      | 131/400 [03:29<04:48,  1.07s/it]Running loglikelihood requests:  34%|███▎      | 134/400 [03:30<02:55,  1.52it/s]Running loglikelihood requests:  34%|███▍      | 135/400 [03:31<03:17,  1.34it/s]Running loglikelihood requests:  34%|███▍      | 136/400 [03:33<03:37,  1.21it/s]Running loglikelihood requests:  34%|███▍      | 137/400 [03:34<03:52,  1.13it/s]Running loglikelihood requests:  34%|███▍      | 138/400 [03:35<04:02,  1.08it/s]Running loglikelihood requests:  35%|███▍      | 139/400 [03:36<04:09,  1.05it/s]Running loglikelihood requests:  36%|███▌      | 142/400 [03:37<02:42,  1.59it/s]Running loglikelihood requests:  36%|███▌      | 143/400 [03:38<03:03,  1.40it/s]Running loglikelihood requests:  36%|███▌      | 144/400 [03:39<03:22,  1.26it/s]Running loglikelihood requests:  36%|███▋      | 145/400 [03:40<03:36,  1.18it/s]Running loglikelihood requests:  36%|███▋      | 146/400 [03:41<03:47,  1.11it/s]Running loglikelihood requests:  37%|███▋      | 147/400 [03:42<03:55,  1.07it/s]Running loglikelihood requests:  37%|███▋      | 148/400 [03:43<04:01,  1.04it/s]Running loglikelihood requests:  37%|███▋      | 149/400 [03:44<04:11,  1.00s/it]Running loglikelihood requests:  38%|███▊      | 150/400 [03:45<04:13,  1.01s/it]Running loglikelihood requests:  38%|███▊      | 151/400 [03:46<04:09,  1.00s/it]Running loglikelihood requests:  38%|███▊      | 152/400 [03:47<04:14,  1.02s/it]Running loglikelihood requests:  38%|███▊      | 153/400 [03:48<04:17,  1.04s/it]Running loglikelihood requests:  38%|███▊      | 154/400 [03:49<04:14,  1.03s/it]Running loglikelihood requests:  39%|███▉      | 155/400 [03:50<04:15,  1.04s/it]Running loglikelihood requests:  39%|███▉      | 156/400 [03:51<04:11,  1.03s/it]Running loglikelihood requests:  39%|███▉      | 157/400 [03:52<04:10,  1.03s/it]Running loglikelihood requests:  40%|███▉      | 158/400 [03:53<04:16,  1.06s/it]Running loglikelihood requests:  40%|███▉      | 159/400 [03:55<04:19,  1.08s/it]Running loglikelihood requests:  40%|████      | 160/400 [03:56<04:14,  1.06s/it]Running loglikelihood requests:  40%|████      | 161/400 [03:57<04:29,  1.13s/it]Running loglikelihood requests:  40%|████      | 162/400 [03:58<04:20,  1.10s/it]Running loglikelihood requests:  41%|████      | 163/400 [03:59<04:19,  1.10s/it]Running loglikelihood requests:  41%|████      | 164/400 [04:00<04:24,  1.12s/it]Running loglikelihood requests:  41%|████▏     | 165/400 [04:01<04:18,  1.10s/it]Running loglikelihood requests:  42%|████▏     | 166/400 [04:02<04:06,  1.05s/it]Running loglikelihood requests:  42%|████▏     | 167/400 [04:03<04:09,  1.07s/it]Running loglikelihood requests:  42%|████▏     | 168/400 [04:04<04:06,  1.06s/it]Running loglikelihood requests:  42%|████▏     | 169/400 [04:05<04:04,  1.06s/it]Running loglikelihood requests:  42%|████▎     | 170/400 [04:06<03:56,  1.03s/it]Running loglikelihood requests:  43%|████▎     | 172/400 [04:07<03:01,  1.26it/s]Running loglikelihood requests:  43%|████▎     | 173/400 [04:08<03:12,  1.18it/s]Running loglikelihood requests:  44%|████▎     | 174/400 [04:09<03:18,  1.14it/s]Running loglikelihood requests:  44%|████▍     | 177/400 [04:10<02:09,  1.72it/s]Running loglikelihood requests:  44%|████▍     | 178/400 [04:11<02:27,  1.51it/s]Running loglikelihood requests:  45%|████▍     | 179/400 [04:12<02:42,  1.36it/s]Running loglikelihood requests:  45%|████▌     | 180/400 [04:13<02:55,  1.26it/s]Running loglikelihood requests:  45%|████▌     | 181/400 [04:14<03:02,  1.20it/s]Running loglikelihood requests:  46%|████▌     | 182/400 [04:15<03:13,  1.13it/s]Running loglikelihood requests:  46%|████▌     | 183/400 [04:16<03:12,  1.13it/s]Running loglikelihood requests:  46%|████▌     | 184/400 [04:17<03:17,  1.10it/s]Running loglikelihood requests:  46%|████▋     | 185/400 [04:18<03:16,  1.10it/s]Running loglikelihood requests:  46%|████▋     | 186/400 [04:19<03:39,  1.02s/it]Running loglikelihood requests:  47%|████▋     | 187/400 [04:20<03:36,  1.01s/it]Running loglikelihood requests:  47%|████▋     | 188/400 [04:21<03:33,  1.01s/it]Running loglikelihood requests:  47%|████▋     | 189/400 [04:22<03:24,  1.03it/s]Running loglikelihood requests:  48%|████▊     | 190/400 [04:23<03:32,  1.01s/it]Running loglikelihood requests:  48%|████▊     | 191/400 [04:24<03:22,  1.03it/s]Running loglikelihood requests:  48%|████▊     | 192/400 [04:25<03:24,  1.02it/s]Running loglikelihood requests:  48%|████▊     | 193/400 [04:26<03:15,  1.06it/s]Running loglikelihood requests:  48%|████▊     | 194/400 [04:27<03:14,  1.06it/s]Running loglikelihood requests:  49%|████▉     | 195/400 [04:28<03:12,  1.06it/s]Running loglikelihood requests:  49%|████▉     | 196/400 [04:29<03:15,  1.04it/s]Running loglikelihood requests:  49%|████▉     | 197/400 [04:30<03:07,  1.08it/s]Running loglikelihood requests:  50%|████▉     | 198/400 [04:31<03:08,  1.07it/s]Running loglikelihood requests:  50%|████▉     | 199/400 [04:32<03:02,  1.10it/s]Running loglikelihood requests:  50%|█████     | 200/400 [04:32<02:59,  1.11it/s]Running loglikelihood requests:  50%|█████     | 201/400 [04:34<03:17,  1.01it/s]Running loglikelihood requests:  50%|█████     | 202/400 [04:34<03:06,  1.06it/s]Running loglikelihood requests:  51%|█████     | 203/400 [04:35<02:59,  1.10it/s]Running loglikelihood requests:  51%|█████     | 204/400 [04:36<02:53,  1.13it/s]Running loglikelihood requests:  51%|█████▏    | 205/400 [04:37<03:11,  1.02it/s]Running loglikelihood requests:  52%|█████▏    | 206/400 [04:38<03:01,  1.07it/s]Running loglikelihood requests:  52%|█████▏    | 207/400 [04:39<03:04,  1.05it/s]Running loglikelihood requests:  52%|█████▏    | 208/400 [04:40<02:59,  1.07it/s]Running loglikelihood requests:  52%|█████▏    | 209/400 [04:41<02:57,  1.08it/s]Running loglikelihood requests:  53%|█████▎    | 212/400 [04:42<01:48,  1.73it/s]Running loglikelihood requests:  53%|█████▎    | 213/400 [04:43<01:58,  1.58it/s]Running loglikelihood requests:  54%|█████▎    | 214/400 [04:44<02:08,  1.45it/s]Running loglikelihood requests:  54%|█████▍    | 215/400 [04:45<02:17,  1.35it/s]Running loglikelihood requests:  54%|█████▍    | 216/400 [04:45<02:21,  1.30it/s]Running loglikelihood requests:  54%|█████▍    | 217/400 [04:46<02:24,  1.27it/s]Running loglikelihood requests:  55%|█████▍    | 218/400 [04:47<02:31,  1.20it/s]Running loglikelihood requests:  55%|█████▍    | 219/400 [04:48<02:36,  1.15it/s]Running loglikelihood requests:  55%|█████▌    | 220/400 [04:49<02:38,  1.14it/s]Running loglikelihood requests:  55%|█████▌    | 221/400 [04:50<02:36,  1.14it/s]Running loglikelihood requests:  56%|█████▌    | 222/400 [04:51<02:36,  1.14it/s]Running loglikelihood requests:  56%|█████▌    | 223/400 [04:52<02:38,  1.12it/s]Running loglikelihood requests:  56%|█████▌    | 224/400 [04:53<02:33,  1.15it/s]Running loglikelihood requests:  56%|█████▋    | 225/400 [04:53<02:34,  1.13it/s]Running loglikelihood requests:  56%|█████▋    | 226/400 [04:54<02:30,  1.16it/s]Running loglikelihood requests:  57%|█████▋    | 227/400 [04:55<02:31,  1.14it/s]Running loglikelihood requests:  57%|█████▋    | 228/400 [04:56<02:27,  1.17it/s]Running loglikelihood requests:  57%|█████▋    | 229/400 [04:57<02:37,  1.09it/s]Running loglikelihood requests:  57%|█████▊    | 230/400 [04:58<02:32,  1.12it/s]Running loglikelihood requests:  58%|█████▊    | 231/400 [04:59<02:34,  1.09it/s]Running loglikelihood requests:  58%|█████▊    | 232/400 [05:00<02:36,  1.08it/s]Running loglikelihood requests:  58%|█████▊    | 233/400 [05:01<02:31,  1.10it/s]Running loglikelihood requests:  58%|█████▊    | 234/400 [05:02<02:30,  1.11it/s]Running loglikelihood requests:  59%|█████▉    | 235/400 [05:02<02:28,  1.11it/s]Running loglikelihood requests:  59%|█████▉    | 236/400 [05:03<02:26,  1.12it/s]Running loglikelihood requests:  59%|█████▉    | 237/400 [05:04<02:25,  1.12it/s]Running loglikelihood requests:  60%|██████    | 240/400 [05:05<01:28,  1.81it/s]Running loglikelihood requests:  60%|██████    | 241/400 [05:06<01:38,  1.61it/s]Running loglikelihood requests:  60%|██████    | 242/400 [05:07<01:44,  1.51it/s]Running loglikelihood requests:  61%|██████    | 243/400 [05:08<01:51,  1.41it/s]Running loglikelihood requests:  61%|██████    | 244/400 [05:08<01:55,  1.35it/s]Running loglikelihood requests:  61%|██████▏   | 245/400 [05:09<01:58,  1.31it/s]Running loglikelihood requests:  62%|██████▏   | 246/400 [05:10<02:01,  1.27it/s]Running loglikelihood requests:  62%|██████▏   | 247/400 [05:11<02:04,  1.23it/s]Running loglikelihood requests:  62%|██████▏   | 248/400 [05:12<02:04,  1.22it/s]Running loglikelihood requests:  62%|██████▏   | 249/400 [05:13<02:06,  1.19it/s]Running loglikelihood requests:  62%|██████▎   | 250/400 [05:14<02:09,  1.16it/s]Running loglikelihood requests:  63%|██████▎   | 251/400 [05:15<02:09,  1.15it/s]Running loglikelihood requests:  63%|██████▎   | 252/400 [05:15<02:11,  1.13it/s]Running loglikelihood requests:  63%|██████▎   | 253/400 [05:16<02:10,  1.13it/s]Running loglikelihood requests:  64%|██████▎   | 254/400 [05:17<02:07,  1.14it/s]Running loglikelihood requests:  64%|██████▍   | 255/400 [05:18<02:07,  1.14it/s]Running loglikelihood requests:  64%|██████▍   | 256/400 [05:19<02:12,  1.09it/s]Running loglikelihood requests:  64%|██████▍   | 257/400 [05:20<02:12,  1.08it/s]Running loglikelihood requests:  64%|██████▍   | 258/400 [05:21<02:08,  1.10it/s]Running loglikelihood requests:  65%|██████▍   | 259/400 [05:22<02:07,  1.11it/s]Running loglikelihood requests:  65%|██████▌   | 260/400 [05:23<02:08,  1.09it/s]Running loglikelihood requests:  65%|██████▌   | 261/400 [05:24<02:02,  1.14it/s]Running loglikelihood requests:  66%|██████▌   | 262/400 [05:25<02:09,  1.07it/s]Running loglikelihood requests:  66%|██████▌   | 263/400 [05:25<02:02,  1.12it/s]Running loglikelihood requests:  66%|██████▌   | 264/400 [05:26<02:00,  1.13it/s]Running loglikelihood requests:  66%|██████▋   | 265/400 [05:27<01:55,  1.17it/s]Running loglikelihood requests:  66%|██████▋   | 266/400 [05:28<01:53,  1.18it/s]Running loglikelihood requests:  67%|██████▋   | 267/400 [05:29<01:51,  1.20it/s]Running loglikelihood requests:  67%|██████▋   | 268/400 [05:29<01:49,  1.21it/s]Running loglikelihood requests:  67%|██████▋   | 269/400 [05:30<01:51,  1.17it/s]Running loglikelihood requests:  68%|██████▊   | 270/400 [05:31<01:51,  1.17it/s]Running loglikelihood requests:  68%|██████▊   | 271/400 [05:32<01:49,  1.18it/s]Running loglikelihood requests:  68%|██████▊   | 272/400 [05:33<01:46,  1.20it/s]Running loglikelihood requests:  68%|██████▊   | 273/400 [05:34<01:42,  1.24it/s]Running loglikelihood requests:  68%|██████▊   | 274/400 [05:34<01:40,  1.26it/s]Running loglikelihood requests:  69%|██████▉   | 275/400 [05:35<01:39,  1.26it/s]Running loglikelihood requests:  69%|██████▉   | 276/400 [05:36<01:38,  1.26it/s]Running loglikelihood requests:  69%|██████▉   | 277/400 [05:37<01:37,  1.26it/s]Running loglikelihood requests:  70%|██████▉   | 278/400 [05:38<01:35,  1.27it/s]Running loglikelihood requests:  70%|██████▉   | 279/400 [05:38<01:34,  1.28it/s]Running loglikelihood requests:  70%|███████   | 280/400 [05:39<01:30,  1.33it/s]Running loglikelihood requests:  70%|███████   | 281/400 [05:40<01:29,  1.33it/s]Running loglikelihood requests:  70%|███████   | 282/400 [05:41<01:28,  1.33it/s]Running loglikelihood requests:  71%|███████   | 283/400 [05:41<01:27,  1.34it/s]Running loglikelihood requests:  71%|███████   | 284/400 [05:42<01:26,  1.34it/s]Running loglikelihood requests:  71%|███████▏  | 285/400 [05:43<01:21,  1.41it/s]Running loglikelihood requests:  72%|███████▏  | 286/400 [05:43<01:23,  1.37it/s]Running loglikelihood requests:  72%|███████▏  | 287/400 [05:44<01:24,  1.33it/s]Running loglikelihood requests:  72%|███████▏  | 288/400 [05:45<01:22,  1.36it/s]Running loglikelihood requests:  72%|███████▏  | 289/400 [05:46<01:20,  1.37it/s]Running loglikelihood requests:  72%|███████▎  | 290/400 [05:46<01:17,  1.42it/s]Running loglikelihood requests:  73%|███████▎  | 291/400 [05:47<01:17,  1.41it/s]Running loglikelihood requests:  73%|███████▎  | 292/400 [05:48<01:16,  1.41it/s]Running loglikelihood requests:  73%|███████▎  | 293/400 [05:48<01:17,  1.38it/s]Running loglikelihood requests:  74%|███████▎  | 294/400 [05:49<01:16,  1.39it/s]Running loglikelihood requests:  74%|███████▍  | 295/400 [05:50<01:14,  1.40it/s]Running loglikelihood requests:  74%|███████▍  | 296/400 [05:51<01:13,  1.41it/s]Running loglikelihood requests:  74%|███████▍  | 297/400 [05:51<01:12,  1.42it/s]Running loglikelihood requests:  74%|███████▍  | 298/400 [05:52<01:11,  1.43it/s]Running loglikelihood requests:  75%|███████▍  | 299/400 [05:53<01:09,  1.45it/s]Running loglikelihood requests:  75%|███████▌  | 300/400 [05:53<01:09,  1.45it/s]Running loglikelihood requests:  75%|███████▌  | 301/400 [05:54<01:09,  1.43it/s]Running loglikelihood requests:  76%|███████▌  | 302/400 [05:55<01:08,  1.43it/s]Running loglikelihood requests:  76%|███████▌  | 303/400 [05:55<01:07,  1.43it/s]Running loglikelihood requests:  76%|███████▌  | 304/400 [05:56<01:08,  1.41it/s]Running loglikelihood requests:  76%|███████▋  | 305/400 [05:57<01:08,  1.40it/s]Running loglikelihood requests:  76%|███████▋  | 306/400 [05:58<01:08,  1.37it/s]Running loglikelihood requests:  77%|███████▋  | 307/400 [05:59<01:12,  1.29it/s]Running loglikelihood requests:  78%|███████▊  | 310/400 [05:59<00:43,  2.09it/s]Running loglikelihood requests:  78%|███████▊  | 311/400 [06:00<00:46,  1.91it/s]Running loglikelihood requests:  78%|███████▊  | 312/400 [06:01<00:49,  1.77it/s]Running loglikelihood requests:  78%|███████▊  | 313/400 [06:01<00:51,  1.68it/s]Running loglikelihood requests:  78%|███████▊  | 314/400 [06:02<00:52,  1.65it/s]Running loglikelihood requests:  79%|███████▉  | 315/400 [06:03<01:01,  1.39it/s]Running loglikelihood requests:  79%|███████▉  | 316/400 [06:04<01:08,  1.22it/s]Running loglikelihood requests:  79%|███████▉  | 317/400 [06:05<01:09,  1.20it/s]Running loglikelihood requests:  80%|███████▉  | 318/400 [06:06<01:04,  1.26it/s]Running loglikelihood requests:  80%|███████▉  | 319/400 [06:06<01:01,  1.32it/s]Running loglikelihood requests:  80%|████████  | 321/400 [06:07<00:43,  1.83it/s]Running loglikelihood requests:  80%|████████  | 322/400 [06:08<00:45,  1.72it/s]Running loglikelihood requests:  81%|████████  | 323/400 [06:08<00:46,  1.64it/s]Running loglikelihood requests:  81%|████████  | 324/400 [06:09<00:48,  1.58it/s]Running loglikelihood requests:  81%|████████▏ | 325/400 [06:10<00:49,  1.53it/s]Running loglikelihood requests:  82%|████████▏ | 326/400 [06:10<00:50,  1.48it/s]Running loglikelihood requests:  82%|████████▏ | 327/400 [06:11<00:49,  1.49it/s]Running loglikelihood requests:  82%|████████▏ | 328/400 [06:12<00:47,  1.50it/s]Running loglikelihood requests:  82%|████████▏ | 329/400 [06:12<00:47,  1.50it/s]Running loglikelihood requests:  82%|████████▎ | 330/400 [06:13<00:46,  1.50it/s]Running loglikelihood requests:  83%|████████▎ | 331/400 [06:14<00:47,  1.46it/s]Running loglikelihood requests:  83%|████████▎ | 332/400 [06:14<00:45,  1.48it/s]Running loglikelihood requests:  83%|████████▎ | 333/400 [06:15<00:42,  1.56it/s]Running loglikelihood requests:  84%|████████▎ | 334/400 [06:16<00:43,  1.51it/s]Running loglikelihood requests:  84%|████████▍ | 335/400 [06:16<00:42,  1.51it/s]Running loglikelihood requests:  84%|████████▍ | 336/400 [06:17<00:42,  1.52it/s]Running loglikelihood requests:  84%|████████▍ | 337/400 [06:18<00:41,  1.52it/s]Running loglikelihood requests:  84%|████████▍ | 338/400 [06:18<00:40,  1.55it/s]Running loglikelihood requests:  85%|████████▍ | 339/400 [06:19<00:41,  1.49it/s]Running loglikelihood requests:  85%|████████▌ | 340/400 [06:20<00:41,  1.45it/s]Running loglikelihood requests:  85%|████████▌ | 341/400 [06:20<00:39,  1.51it/s]Running loglikelihood requests:  86%|████████▌ | 342/400 [06:21<00:37,  1.56it/s]Running loglikelihood requests:  86%|████████▌ | 343/400 [06:22<00:36,  1.55it/s]Running loglikelihood requests:  86%|████████▌ | 344/400 [06:22<00:36,  1.54it/s]Running loglikelihood requests:  86%|████████▋ | 345/400 [06:23<00:35,  1.57it/s]Running loglikelihood requests:  86%|████████▋ | 346/400 [06:24<00:34,  1.55it/s]Running loglikelihood requests:  87%|████████▋ | 347/400 [06:24<00:33,  1.59it/s]Running loglikelihood requests:  87%|████████▋ | 348/400 [06:25<00:33,  1.57it/s]Running loglikelihood requests:  87%|████████▋ | 349/400 [06:25<00:33,  1.53it/s]Running loglikelihood requests:  88%|████████▊ | 350/400 [06:26<00:32,  1.54it/s]Running loglikelihood requests:  88%|████████▊ | 351/400 [06:27<00:34,  1.40it/s]Running loglikelihood requests:  88%|████████▊ | 352/400 [06:28<00:33,  1.43it/s]Running loglikelihood requests:  88%|████████▊ | 353/400 [06:28<00:31,  1.50it/s]Running loglikelihood requests:  88%|████████▊ | 354/400 [06:29<00:28,  1.59it/s]Running loglikelihood requests:  89%|████████▉ | 355/400 [06:29<00:28,  1.56it/s]Running loglikelihood requests:  89%|████████▉ | 356/400 [06:30<00:26,  1.67it/s]Running loglikelihood requests:  89%|████████▉ | 357/400 [06:31<00:26,  1.64it/s]Running loglikelihood requests:  90%|████████▉ | 358/400 [06:31<00:24,  1.70it/s]Running loglikelihood requests:  90%|████████▉ | 359/400 [06:32<00:23,  1.72it/s]Running loglikelihood requests:  90%|█████████ | 360/400 [06:32<00:23,  1.70it/s]Running loglikelihood requests:  90%|█████████ | 361/400 [06:33<00:22,  1.75it/s]Running loglikelihood requests:  90%|█████████ | 362/400 [06:33<00:22,  1.71it/s]Running loglikelihood requests:  91%|█████████ | 363/400 [06:34<00:20,  1.79it/s]Running loglikelihood requests:  91%|█████████ | 364/400 [06:35<00:21,  1.69it/s]Running loglikelihood requests:  91%|█████████▏| 365/400 [06:35<00:20,  1.75it/s]Running loglikelihood requests:  92%|█████████▏| 366/400 [06:36<00:18,  1.81it/s]Running loglikelihood requests:  92%|█████████▏| 368/400 [06:36<00:13,  2.29it/s]Running loglikelihood requests:  92%|█████████▏| 369/400 [06:37<00:14,  2.18it/s]Running loglikelihood requests:  92%|█████████▎| 370/400 [06:37<00:15,  1.97it/s]Running loglikelihood requests:  93%|█████████▎| 371/400 [06:38<00:14,  1.98it/s]Running loglikelihood requests:  93%|█████████▎| 373/400 [06:39<00:11,  2.32it/s]Running loglikelihood requests:  94%|█████████▎| 374/400 [06:39<00:11,  2.23it/s]Running loglikelihood requests:  94%|█████████▍| 375/400 [06:40<00:12,  2.08it/s]Running loglikelihood requests:  94%|█████████▍| 376/400 [06:40<00:12,  1.90it/s]Running loglikelihood requests:  94%|█████████▍| 377/400 [06:41<00:11,  1.93it/s]Running loglikelihood requests:  94%|█████████▍| 378/400 [06:42<00:13,  1.65it/s]Running loglikelihood requests:  95%|█████████▍| 379/400 [06:42<00:12,  1.72it/s]Running loglikelihood requests:  95%|█████████▌| 380/400 [06:43<00:11,  1.79it/s]Running loglikelihood requests:  95%|█████████▌| 381/400 [06:43<00:11,  1.67it/s]Running loglikelihood requests:  96%|█████████▌| 382/400 [06:44<00:10,  1.75it/s]Running loglikelihood requests:  96%|█████████▌| 383/400 [06:44<00:09,  1.84it/s]Running loglikelihood requests:  96%|█████████▌| 384/400 [06:45<00:08,  1.81it/s]Running loglikelihood requests:  96%|█████████▋| 385/400 [06:45<00:08,  1.81it/s]Running loglikelihood requests:  96%|█████████▋| 386/400 [06:46<00:07,  1.89it/s]Running loglikelihood requests:  97%|█████████▋| 387/400 [06:47<00:07,  1.76it/s]Running loglikelihood requests:  97%|█████████▋| 388/400 [06:47<00:06,  1.87it/s]Running loglikelihood requests:  97%|█████████▋| 389/400 [06:48<00:05,  1.89it/s]Running loglikelihood requests:  98%|█████████▊| 390/400 [06:48<00:05,  1.79it/s]Running loglikelihood requests:  98%|█████████▊| 391/400 [06:49<00:04,  1.87it/s]Running loglikelihood requests:  98%|█████████▊| 392/400 [06:49<00:04,  1.75it/s]Running loglikelihood requests:  98%|█████████▊| 393/400 [06:50<00:03,  1.85it/s]Running loglikelihood requests:  98%|█████████▊| 394/400 [06:50<00:03,  1.92it/s]Running loglikelihood requests:  99%|█████████▉| 395/400 [06:51<00:02,  1.76it/s]Running loglikelihood requests:  99%|█████████▉| 396/400 [06:51<00:02,  1.87it/s]Running loglikelihood requests:  99%|█████████▉| 397/400 [06:52<00:01,  1.83it/s]Running loglikelihood requests: 100%|█████████▉| 398/400 [06:53<00:01,  1.85it/s]Running loglikelihood requests: 100%|█████████▉| 399/400 [06:53<00:00,  1.94it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:54<00:00,  1.83it/s]Running loglikelihood requests: 100%|██████████| 400/400 [06:54<00:00,  1.04s/it]
DEBUG:urllib3.connectionpool:Resetting dropped connection: hf-mirror.com
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/models/llama-moe/LLaMA-MoE-v1-3_5B-2_8/revision/main HTTP/1.1" 200 927
/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/site-packages/torch/__init__.py:1117: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  return isinstance(obj, torch.Tensor)
/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/task_util.py:69: FutureWarning: `torch.distributed.reduce_op` is deprecated, please use `torch.distributed.ReduceOp` instead
  if torch.is_tensor(obj) or (hasattr(obj, 'data') and torch.is_tensor(obj.data)):
WARNING:lm_eval.models.huggingface:`pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
INFO:lm_eval.models.huggingface:Model type cannot be determined. Using default model type 'causal'
WARNING:lm_eval.models.huggingface:Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
full model:
{'sciq': {'alias': 'sciq', 'acc,none': 0.94, 'acc_stderr,none': 0.023868325657594204, 'acc_norm,none': 0.91, 'acc_norm_stderr,none': 0.028762349126466136}}
length of layer 0 is :8
length of layer 1 is :8
length of layer 2 is :8
length of layer 3 is :8
length of layer 4 is :8
length of layer 5 is :8
length of layer 6 is :8
length of layer 7 is :8
length of layer 8 is :8
length of layer 9 is :8
length of layer 10 is :8
length of layer 11 is :8
length of layer 12 is :8
length of layer 13 is :8
length of layer 14 is :8
length of layer 15 is :8
length of layer 16 is :8
length of layer 17 is :8
length of layer 18 is :8
length of layer 19 is :8
length of layer 20 is :8
length of layer 21 is :8
length of layer 22 is :8
length of layer 23 is :8
length of layer 24 is :8
length of layer 25 is :8
length of layer 26 is :8
length of layer 27 is :8
length of layer 28 is :8
length of layer 29 is :8
length of layer 30 is :8
length of layer 31 is :8
0.969062788859705
0.9024924890572922
0.7706109127217512
0.8221264026535647
0.9190490061886575
0.9866654579796295
0.6586322754204971
0.7962110384246164
0.8195614021629236
0.7124178311176441
0.787697814339696
0.7034455022322618
0.8136386046534271
0.8174990104652458
0.6784276389594894
0.8698440245672888
0.8886492811850213
0.6541737276411673
0.6560861559753316
0.8139845219953913
0.6714741870309046
0.6164364868717988
0.8331581872497299
0.9065420049234512
0.9246185715568276
0.7477515960551026
0.574165362968651
0.8586446364199891
0.8889771415746612
Total groups 70 exceeded the threshold, stopping comparison.
The group tensor is
[7, 3, 4, 2, 6, 1, 5, 0]
tensor([7, 3, 4, 2, 6, 1, 5, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[6, 2, 5, 3, 4, 0, 7, 1]
tensor([6, 2, 5, 3, 4, 0, 7, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[5, 3, 6, 2, 7, 1, 4, 0]
tensor([5, 3, 6, 2, 7, 1, 4, 0], dtype=torch.int32)
[0, 1, 2, 3, 4, 5, 6, 7]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 4, 2, 1, 3, 5, 1]
tensor([0, 0, 4, 2, 1, 3, 5, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 2, 3, 4, 5, 0, 1, 1]
tensor([0, 2, 3, 4, 5, 0, 1, 1], dtype=torch.int32)
[0, 1, 2, 3, 4, 5]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 3, 1, 0, 2, 2, 3, 1]
tensor([0, 3, 1, 0, 2, 2, 3, 1], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[0, 3, 1, 1, 2, 2, 3, 0]
tensor([0, 3, 1, 1, 2, 2, 3, 0], dtype=torch.int32)
[0, 1, 2, 3]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
The group tensor is
[0, 0, 1, 1.0, 1.0, 1.0, 1.0, 1]
tensor([0, 0, 1, 1, 1, 1, 1, 1], dtype=torch.int32)
[0, 1]
The group tensor is
[-2, -2, -2, -2, -2, -2, -2, -2]
tensor([-2, -2, -2, -2, -2, -2, -2, -2], dtype=torch.int32)
[-2]
Normal merging for layer 1
tensor([5])
tensor(5)
tensor([7])
tensor(7)
tensor([1])
tensor(1)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
tensor([2])
tensor(2)
tensor([0])
tensor(0)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 2 to 4
done!
Normal merging for layer 5
tensor([7])
tensor(7)
tensor([5])
tensor(5)
tensor([3])
tensor(3)
tensor([1])
tensor(1)
tensor([6])
tensor(6)
tensor([0])
tensor(0)
tensor([2])
tensor(2)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 6 to 9
done!
Normal merging for layer 10
tensor([0, 1])
tensor(0)
tensor([4, 7])
tensor(4)
tensor([3])
tensor(3)
tensor([5])
tensor(5)
tensor([2])
tensor(2)
tensor([6])
tensor(6)
done!
Cross-layer merge completed for layers 11 to 12
done!
Normal merging for layer 13
tensor([0, 5])
tensor(0)
tensor([6, 7])
tensor(6)
tensor([1])
tensor(1)
tensor([2])
tensor(2)
tensor([3])
tensor(3)
tensor([4])
tensor(4)
done!
Cross-layer merge completed for layers 14 to 19
done!
Normal merging for layer 20
tensor([0, 3])
tensor(0)
tensor([2, 7])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Normal merging for layer 21
tensor([0, 7])
tensor(0)
tensor([2, 3])
tensor(2)
tensor([4, 5])
tensor(4)
tensor([1, 6])
tensor(1)
done!
Cross-layer merge completed for layers 22 to 23
done!
Normal merging for layer 24
tensor([0, 1])
tensor(0)
tensor([2, 3, 4, 5, 6, 7])
tensor(2)
done!
Cross-layer merge completed for layers 25 to 31
done!
all done!

===== 🚀【CUDA 检查开始】[after model release] =====
🔍 找到 1 个仍驻留在 CUDA 上的张量:
  - 类型: Parameter            | 尺寸: (1, 1) | 显存: 0.00 MB
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after model release] =====

Model size: 12.2608 GB

===== 🚀【CUDA 检查开始】[after create model] =====
✅ 没有发现任何驻留在 CUDA 上的张量，显存清理成功。
🧠 总占用 CUDA 显存（非缓存）: 0.00 MB
===== ✅【CUDA 检查结束】[after create model] =====

Node 245 Flask server is running on port 5245...
Node 227 Flask server is running on port 5227...
Node 26 Flask server is running on port 5026...
Node 114 Flask server is running on port 5114...
Node 113 Flask server is running on port 5113...
Node 18 Flask server is running on port 5018...
Node 132 Flask server is running on port 5132...
Node 195 Flask server is running on port 5195...
Node 55 Flask server is running on port 5055...
Node 153 Flask server is running on port 5153...
Node 253 Flask server is running on port 5253...
Node 43 Flask server is running on port 5043...
Node 118 Flask server is running on port 5118...
Node 202 Flask server is running on port 5202...
Node 168 Flask server is running on port 5168...
Node 228 Flask server is running on port 5228...
Node 115 Flask server is running on port 5115...
Node 78 Flask server is running on port 5078...
Node 17 Flask server is running on port 5017...
Node 92 Flask server is running on port 5092...
Node 110 Flask server is running on port 5110...
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
Node 13 Flask server is running on port 5013...
Node 159 Flask server is running on port 5159...
 * Debug mode: off
Node 96 Flask server is running on port 5096...
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Using pre-initialized model
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
 * Debug mode: off
Traceback (most recent call last):
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
  File "/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/Node_llama_expert_merge_our_layerCross.py", line 1811, in <module>
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
    initialize_model_sequentially(nodes)
  File "/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/Node_llama_expert_merge_our_layerCross.py", line 1689, in initialize_model_sequentially
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
 * Serving Flask app 'Node_llama_expert_merge_our_layerCross'
 * Debug mode: off
    processes = start_nodes_with_limited_concurrency(nodes, max_concurrent=2)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/public/home/zouyifei001/project/mo-e_-merge_and_-update_-mec/Node_llama_expert_merge_our_layerCross.py", line 47, in start_nodes_with_limited_concurrency
    p.start()
  File "/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
                  ^^^^^^^^^^^^^^^^^
  File "/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/multiprocessing/context.py", line 224, in _Popen
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5114
 * Running on http://173.0.64.7:5114
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/winogrande HTTP/1.1" 307 67
INFO:werkzeug:[33mPress CTRL+C to quit[0m
    return _default_context.get_context().Process._Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5018
 * Running on http://173.0.64.7:5018
  File "/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/multiprocessing/context.py", line 282, in _Popen
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5245
 * Running on http://173.0.64.7:5245
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
    return Popen(process_obj)
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5017
 * Running on http://173.0.64.7:5017
           ^^^^^^^^^^^^^^^^^^
  File "/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/multiprocessing/popen_fork.py", line 19, in __init__
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5195
 * Running on http://173.0.64.7:5195
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5078
 * Running on http://173.0.64.7:5078
    self._launch(process_obj)
  File "/public/home/zouyifei001/perl5/miniconda3/envs/MoEUpdate/lib/python3.12/multiprocessing/popen_fork.py", line 66, in _launch
INFO:werkzeug:[33mPress CTRL+C to quit[0m
    self.pid = os.fork()
INFO:werkzeug:[33mPress CTRL+C to quit[0m
               ^^^^^^^^^
OSError: [Errno 12] Cannot allocate memory
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5055
 * Running on http://173.0.64.7:5055
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5228
 * Running on http://173.0.64.7:5228
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5132
 * Running on http://173.0.64.7:5132
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5118
 * Running on http://173.0.64.7:5118
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5110
 * Running on http://173.0.64.7:5110
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5159
 * Running on http://173.0.64.7:5159
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5168
 * Running on http://173.0.64.7:5168
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5227
 * Running on http://173.0.64.7:5227
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5153
 * Running on http://173.0.64.7:5153
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5043
 * Running on http://173.0.64.7:5043
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5253
 * Running on http://173.0.64.7:5253
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5092
 * Running on http://173.0.64.7:5092
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5113
 * Running on http://173.0.64.7:5113
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5096
 * Running on http://173.0.64.7:5096
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5202
 * Running on http://173.0.64.7:5202
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5013
 * Running on http://173.0.64.7:5013
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5026
 * Running on http://173.0.64.7:5026
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5115
 * Running on http://173.0.64.7:5115
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[33mPress CTRL+C to quit[0m
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET /api/datasets/allenai/winogrande HTTP/1.1" 200 1036
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://datasets-server.hf-mirror.com:443 "GET /parquet?dataset=winogrande HTTP/1.1" 302 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "GET / HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): s3.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/winogrande/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/winogrande.py HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/winogrande.py HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/dataset_infos.json HTTP/1.1" 404 0
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-mirror.com:443
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/winogrande/resolve/main/README.md HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:https://hf-mirror.com:443 "HEAD /datasets/allenai/winogrande/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 140378523227040 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 140378523227040 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 140378523227040 on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Lock 140378523227040 released on /public/home/zouyifei001/.cache/huggingface/datasets/_public_home_zouyifei001_.cache_huggingface_datasets_winogrande_winogrande_xl_1.1.0_a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2.lock
DEBUG:filelock:Attempting to acquire lock 140353831555424 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 140353831555424 acquired on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:fsspec.local:open file: /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2/dataset_info.json
DEBUG:filelock:Attempting to release lock 140353831555424 on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:filelock:Lock 140353831555424 released on /public/home/zouyifei001/.cache/huggingface/datasets/winogrande/winogrande_xl/1.1.0/a826c3d3506aefe0e9e9390dcb53271070536586bab95849876b2c1743df56e2_builder.lock
DEBUG:lm_eval.api.task:No custom filters defined. Using default 'take_first' filter for handling repeats.
DEBUG:lm_eval.api.task:doc_to_text returned an int. Assuming multiple inputs.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of winogrande from None to 0
INFO:lm_eval.api.task:Building contexts for winogrande on rank 0...
