2025-04-13:18:47:00,213 INFO     [huggingface.py:132] Using device 'cuda'
2025-04-13:18:47:00,485 INFO     [huggingface.py:369] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
SwitchTransformersForConditionalGeneration(
  (shared): Embedding(32128, 768)
  (encoder): SwitchTransformersStack(
    (embed_tokens): Embedding(32128, 768)
    (block): ModuleList(
      (0): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
              (relative_attention_bias): Embedding(32, 12)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (1): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (2): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (3): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (4): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (5): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (6): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (7): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (8): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (9): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (10): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (11): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (final_layer_norm): SwitchTransformersLayerNorm()
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (decoder): SwitchTransformersStack(
    (embed_tokens): Embedding(32128, 768)
    (block): ModuleList(
      (0): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
              (relative_attention_bias): Embedding(32, 12)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (1): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (2): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (3): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (4): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (5): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (6): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (7): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (8): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (9): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (10): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersDenseActDense(
              (wi): Linear(in_features=768, out_features=3072, bias=False)
              (wo): Linear(in_features=3072, out_features=768, bias=False)
              (dropout): Dropout(p=0.1, inplace=False)
              (act): ReLU()
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (11): SwitchTransformersBlock(
        (layer): ModuleList(
          (0): SwitchTransformersLayerSelfAttention(
            (SelfAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (1): SwitchTransformersLayerCrossAttention(
            (EncDecAttention): SwitchTransformersAttention(
              (q): Linear(in_features=768, out_features=768, bias=False)
              (k): Linear(in_features=768, out_features=768, bias=False)
              (v): Linear(in_features=768, out_features=768, bias=False)
              (o): Linear(in_features=768, out_features=768, bias=False)
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (2): SwitchTransformersLayerFF(
            (mlp): SwitchTransformersSparseMLP(
              (router): SwitchTransformersTop1Router(
                (classifier): Linear(in_features=768, out_features=32, bias=False)
              )
              (experts): ModuleDict(
                (expert_0): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_1): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_2): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_3): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_4): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_5): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_6): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_7): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_8): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_9): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_10): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_11): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_12): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_13): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_14): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_15): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_16): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_17): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_18): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_19): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_20): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_21): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_22): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_23): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_24): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_25): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_26): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_27): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_28): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_29): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_30): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
                (expert_31): SwitchTransformersDenseActDense(
                  (wi): Linear(in_features=768, out_features=3072, bias=False)
                  (wo): Linear(in_features=3072, out_features=768, bias=False)
                  (dropout): Dropout(p=0.1, inplace=False)
                  (act): ReLU()
                )
              )
            )
            (layer_norm): SwitchTransformersLayerNorm()
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (final_layer_norm): SwitchTransformersLayerNorm()
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (lm_head): Linear(in_features=768, out_features=32128, bias=False)
)2025-04-13:18:47:12,442 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-04-13:18:47:12,442 INFO     [evaluator.py:217] Using pre-initialized model

all_gate number:12
Traceback (most recent call last):
  File "/root/autodl-tmp/lm-evaluation-harness/A_expert_merge_our_layerCross.py", line 548, in <module>
    results = lm_eval.simple_evaluate( # call simple_evaluate squad_completion
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/utils.py", line 402, in _wrapper
    return fn(*args, **kwargs)
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/evaluator.py", line 235, in simple_evaluate
    task_dict = get_task_dict(tasks, task_manager)
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/tasks/__init__.py", line 618, in get_task_dict
    task_name_from_string_dict = task_manager.load_task_or_group(
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/tasks/__init__.py", line 414, in load_task_or_group
    collections.ChainMap(*map(self._load_individual_task_or_group, task_list))
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/tasks/__init__.py", line 314, in _load_individual_task_or_group
    return _load_task(task_config, task=name_or_config)
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/tasks/__init__.py", line 280, in _load_task
    task_object = ConfigurableTask(config=config)
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/api/task.py", line 819, in __init__
    self.download(self.config.dataset_kwargs)
  File "/root/autodl-tmp/lm-evaluation-harness/lm_eval/api/task.py", line 926, in download
    self.dataset = datasets.load_dataset(
  File "/root/miniconda3/lib/python3.10/site-packages/datasets/load.py", line 2556, in load_dataset
    builder_instance = load_dataset_builder(
  File "/root/miniconda3/lib/python3.10/site-packages/datasets/load.py", line 2228, in load_dataset_builder
    dataset_module = dataset_module_factory(
  File "/root/miniconda3/lib/python3.10/site-packages/datasets/load.py", line 1797, in dataset_module_factory
    dataset_info = hf_api.dataset_info(
  File "/root/miniconda3/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/huggingface_hub/hf_api.py", line 2605, in dataset_info
    r = get_session().get(path, headers=headers, timeout=timeout, params=params)
  File "/root/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 93, in send
    return super().send(request, *args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/root/miniconda3/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
KeyboardInterrupt
